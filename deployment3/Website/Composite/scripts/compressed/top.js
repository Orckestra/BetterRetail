function List(a){return this._index=0,this._array=[],this.isDisposed=!1,a&&this.init(a),this}function Map(a){if(this._map={},null!=a)for(var b in a)this.set(b,a[b])}function SystemNodeList(){return this._entityTokens=new List([]),this}function _LocalStorage(){}function _BroadcastMessages(){}function _EventBroadcaster(){}function _Constants(){}function ContextContainer(){this.logger=SystemLogger.getLogger("ContextContainer"),this._data={}}function _Client(){var a=navigator.userAgent.toLowerCase(),b=navigator.platform.toLowerCase(),c="Microsoft Internet Explorer"==navigator.appName,d=!c&&"undefined"!=typeof document.createTreeWalker,e=d&&(a.indexOf("webrunner")>-1||a.indexOf("prism")>-1),f=null!=history.pushState;this.isMozilla=d,this.isFirefox=a.indexOf("firefox")>-1,this.isWebKit=a.indexOf("webkit")>-1,this.isPerformanceTest=a.indexOf("performance")>-1,this.isExplorer=c,this.isExplorer6=this.isExplorer&&(a.indexOf("msie 6.0")>-1||a.indexOf("msie 6.1")>-1),this.isExplorer8=this.isExplorer&&null!=window.XDomainRequest,this.isExplorer11=!!navigator.userAgent.match(/Trident\/7\./),this.isEdge=!!navigator.userAgent.match(/Edge\/\d+/g),this.isAnyExplorer=this.isExplorer||this.isExplorer11||this.isEdge,this.isPrism=e,this.isWindows=b.indexOf("win")>-1,this.isVista=this.isWindows&&a.indexOf("windows nt 6")>-1,this.isMac=b.indexOf("mac")>-1,this.isPad=null!=navigator.userAgent.match(/iPad/i),this.isOS7=null!=navigator.userAgent.match(/CPU.*OS 7_\d/i);var g=this._getFlashVersion();return this.hasFlash=g&&g>=9,this.hasTransitions=f,this.canvas=!!document.createElement("canvas").getContext,this.hasSpellcheck=!0,this.hasXSLTProcessor=this.isMozilla&&!this.isExplorer11,this}function SystemLogger(a){this.identifier=a}function SystemTimer(a){this.logger=SystemLogger.getLogger("SystemTimer"),this._id=a,this._time=(new Date).getTime()}function _SystemDebug(){}function _Interfaces(){var a=SystemLogger.getLogger("Interfaces");this.isImplemented=function(b,c,d){var e=!0;for(var f in b)if(typeof c[f]==Types.UNDEFINED?e=!1:typeof b[f]!=typeof c[f]&&(e=!1),!e)break;return e||d&&a.fine(c+" invalid. Interface check abandoned at: "+f),e}}function _Types(){}function _KeyMaster(){}function _ImageProvider(){}function _Resolver(){}function _Download(){}function _Cookies(){}function _StatusBar(){function a(a,d,e,f){e&&(a=Resolver.resolveVars(a,e)),c?(c.setLabel(a),c.setImage(d),f&&c.startFadeOut(StatusBar.AUTOCLEAR_TIMEOUT)):b.error("Message not initialized for display: "+a)}this.AUTOCLEAR_TIMEOUT=5e3,this.GROUP_LANGUAGETOOLS="languagetools",this.document=null,this.state=null,this.ERROR="error",this.WARN="warn",this.BUSY="busy",this.READY="ready",this._groups=new Map;var b=SystemLogger.getLogger("StatusBar"),c=null,d="${icon:error}",e="${icon:warning}",f="${icon:loading}",g="${icon:message}",h=null,i=null,j=null,k=null;this.initialize=function(a){h=StringBundle.getString("ui","Website.App.StatusBar.Error"),i=StringBundle.getString("ui","Website.App.StatusBar.Warn"),j=StringBundle.getString("ui","Website.App.StatusBar.Busy"),k=StringBundle.getString("ui","Website.App.StatusBar.Ready"),c=a,this.document=a.bindingDocument},this.error=function(b,c){this.state=StatusBar.ERROR,b=b?b:h,a(b,d,c,!1)},this.warn=function(b,c){this.state=StatusBar.WARN,b=b?b:i,a(b,e,c,!1)},this.busy=function(b,c){this.state=StatusBar.BUSY,b=b?b:j,a(b,f,c,!1)},this.ready=function(b,c){this.state=StatusBar.READY,b=b?b:k,a(b,g,c,!0)},this.report=function(b,c,d,e){this.state=null,a(b,c,d,e)},this.clear=function(){this.state=null,c&&c.clear()},this.addToGroup=function(a,b){this._groups.has(a)||this._groups.set(a,c.addRight(ToolBarGroupBinding.newInstance(this.document))),this._groups.get(a).add(b)}}function _Localization(){EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_LOGIN,this),EventBroadcaster.subscribe(BroadcastMessages.LANGUAGES_UPDATED,this),EventBroadcaster.subscribe(BroadcastMessages.FROMLANGUAGE_UPDATED,this),EventBroadcaster.subscribe(BroadcastMessages.TOLANGUAGE_UPDATED,this)}function _Validator(){}function _DOMEvents(){}function _DOMSerializer(){}function _DOMUtil(){}function _XMLParser(){}function XPathResolver(){this.logger=SystemLogger.getLogger("XPathResolver"),this._evaluator=window.XPathEvaluator?new XPathEvaluator:null,this._nsResolver=null}function XSLTransformer(){this.logger=SystemLogger.getLogger("XSLTransformer"),this._processor=null,this._cache=null}function _CSSUtil(){}function _CSSComputer(){}function SystemNode(a){this.logger=SystemLogger.getLogger("SystemNode"),this._data=a,this._datas=null,this._actionProfile=null,this._propertyBag=null,this._registerSystemActions(),this.searchToken=null,null!=this._data.TagValue&&SystemNode.taggedNodes.set(this._data.TagValue,this)}function SystemAction(a){this.logger=SystemLogger.getLogger("SystemAction"),this._data=a,null!=this._data.TagValue&&SystemAction.taggedActions.set(this._data.TagValue,this)}function _UpdateManager(){var a=null;return window.UpdateManager||(this._construct(),a=this),a}function _UpdateAssistant(){var a=null;return window.UpdateAssistant||(this._construct(),a=this),a}function UpdatePlugin(){this.handleElement=function(a,b){var c=!1;switch(a.nodeName.toLowerCase()){case"input":case"textarea":switch(a.getAttribute("id")){case"__EVENTTARGET":case"__EVENTARGUMENT":case"__VIEWSTATE":case"__EVENTVALIDATION":c=!1}}return c},this.updateElement=function(a,b){var c=a.getAttribute("id"),d=document.getElementById(c);if(null!=d){var e=null;switch(d.nodeName.toLowerCase()){case"input":e=a.getAttribute("value");break;case"textarea":e=a.textContent?a.textContent:a.text}null==e&&(e=""),e!=d.value&&(d.value=e,UpdateManager.report('Property [value] updated on field "'+c+'"'))}return!0}}function Update(){return this}function ReplaceUpdate(a,b){return this.type=Update.TYPE_REPLACE,this.id=a,this.element=b,this}function SiblingUpdate(a,b,c,d){return this.type=a,this.id=b,this.element=c,this.isFirst=d,this}function AttributesUpdate(a,b,c){return this.type=type=Update.TYPE_ATTRIBUTES,this.id=a,this.element=b,this.currentElement=c,this._summary=[],this}function _WindowManager(){this._construct(KeyMaster.getUniqueKey())}function _Application(){this._construct()}function _Installation(){EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_KICKSTART,this)}function _Keyboard(){}function _Persistance(){}function StandardEventHandler(a,b){this.logger=SystemLogger.getLogger("StandardEventHandler ["+a.title+"]"),this._contextDocument=a,this._contextWindow=DOMUtil.getParentWindow(a),this.hasNativeKeys=!1,this._isAllowTabs=!1,this._isMouseHandlerOnly=b,this._addListeners()}function Action(a,b){this.target=a,this.type=b,this.listener=null,this.isConsumed=!1,this.isCancelled=!1}function Animation(a){this.id=KeyMaster.getUniqueKey(),this.interval=25,this.iterator=0,this.modifier=1,this.endcount=90;for(var b in a)this[b]=a[b]}function Point(a,b){this.x=a,this.y=b}function Dimension(a,b){this.w=a,this.h=b}function Geometry(a,b,c,d){this.x=a,this.y=b,this.w=c,this.h=d}function BindingAcceptor(a){return this.logger=SystemLogger.getLogger("BindingDragger"),this._binding=a,this._acceptedList={},this._isAccepting=!1,this._corsor=null,this._initialize(),this}function BindingBoxObject(a){this._domElement=a.getBindingElement()}function BindingDragger(a){this.logger=SystemLogger.getLogger("BindingDragger"),this.binding=a,this.isDragReady=!1,this.isDragging=!1,this.startPoint=null,this.currentEvent=null}function BindingParser(a){this.logger=SystemLogger.getLogger("BindingParser"),this._ownerDocument=a,this._rootElement=null}function BindingSerializer(){this.logger=SystemLogger.getLogger("BindingSerializer"),this._dom=DOMUtil.getDOMDocument(),alert("BindingSerializer: Convert to Crawler!"),this._pointers=[]}function ImageProfile(a){this._default=a.image,this._hover=a.imageHover,this._active=a.imageActive,this._disabled=a.imageDisabled}function _BindingFinder(){}function NodeCrawler(){return this._construct(),this}function ElementCrawler(){return this._construct(),this}function BindingCrawler(){return this._construct(),this}function Crawler(){return this.id=null,this.response=null,this._construct(),this}function FlexBoxCrawler(){return this.id=FlexBoxCrawler.ID,this.mode=FlexBoxCrawler.MODE_NORMAL,this.startBinding=null,this._construct(),this}function FocusCrawler(){return this.id=FocusCrawler.ID,this._construct(),this}function FitnessCrawler(){return this.id=FitnessCrawler.ID,this.mode=FitnessCrawler.MODE_TRAINING,this._construct(),this}function _DocumentUpdatePlugin(){null!=window.UpdateManager&&(UpdateManager.plugins.push(this),this._setup())}function DocumentCrawler(){return this.mode=DocumentCrawler.MODE_REGISTER,this.id=DocumentCrawler.ID,this._construct(),this}function _DocumentManager(){this._construct()}function _DataManager(){}function _Templates(){}function DialogButton(a){if(this.label=null,this.image=null,this.response=null,this.isFocusable=!0,this.isDefault=!1,this.isFocused=!1,a)for(var b in a)"undefined"!=typeof this[b]&&(this[b]=a[b])}function _Dialog(){}function _Commands(){this._construct()}function _Prism(){}function Uri(a){a=a?a:"";var b=/^(~?\/|(\.\.\/)+|https?:\/\/[\w\d-\.:]*\/)(media|page)(\(|%28)[\w\d-\:]+(\)|%29)/,c=b.exec(a);c&&("media"==c[3]?this.isMedia=!0:"page"==c[3]&&(this.isPage=!0));var d={};return a.replace(/^[^\?]*/g,"").replace(/([^?=&]+)(=([^&]*))?/g,function(a,b,c,e){d[b]=e}),this.queryString=d,this.path=a.replace(/\?.*/g,""),this.isInternalUrl=0===a.indexOf("~/"),this}function ViewDefinition(){}function SystemViewDefinition(a){this.node=a,this.argument=a,this.url=SystemViewDefinition.DEFAULT_URL,this.handle=a.getHandle(),this.label=a.getLabel(),this.image=a.getImageProfile().getDefaultImage(),this.toolTip=a.getToolTip()}function HostedViewDefinition(a){if(this.position=DockBinding.MAIN,this.perspective=null,this.entityToken=null,this.label=null,this.image=null,a)for(var b in a){if(!this[b]&&null!=this.prop)throw"Property not recognized: "+b;this[b]=a[b],this.url&&(this.url=Resolver.resolve(this.url))}}function DialogViewDefinition(a){if(this.handler=null,this.position=Dialog.MODAL,this.label=null,this.image=null,this.width=null,this.height=null,a)for(var b in a){if(!this[b]&&null!=this.prop)throw"Property not recognized: "+b;if(this[b]=a[b],this.url&&(this.url=Resolver.resolve(this.url)),this.handler&&!Interfaces.isImplemented(IDialogResponseHandler,this.handler))throw"IDialogResponseHandler not implemented"}}function Binding(){this.logger=SystemLogger.getLogger("binding"),this.key=null,this.bindingElement=null,this.bindingDocument=null,this.bindingWindow=null,this.shadowTree=null,this.actionListeners=null,this.contextMenuBinding=null,this.isRegistered=!1,this.isAttached=!1,this.isInitialized=!1,this.isDisposed=!1,this.isDraggable=!1,this.dragger=null,this.memberDependencies=null,this.dependentBindings=null,this.propertyMethodMap=null,this.isBlockingActions=!1,this.isVisible=!0,this.boxObject=null,this.dragType=null,this.dragAccept=null,this.dragReject=!1,this.acceptor=null,this.isLazy=!1,this._persist=null,this.isBindingBuild=!1,this._hasActivationAwareness=!1,this.isFlexSuspended=!1,this.crawlerFilters=null,this._subscriptions=null}function DataBinding(){return this.logger=SystemLogger.getLogger("DataBinding"),this._name=null,this.isDirty=!1,this.isFocusable=!0,this.isFocused=!1,this.error=null,this}function RootBinding(){return this.logger=SystemLogger.getLogger("RootBinding"),this.isActivationAware=!1,this.isActivated=!1,this._activationawares=null,this}function StyleBinding(){return this.logger=SystemLogger.getLogger("StyleBinding"),this.style=null,this.href=null,this}function FlexBoxBinding(){return this.logger=SystemLogger.getLogger("FlexBoxBinding"),this.isFlexSuspended=!1,this.isFlexible=!0,this.isFit=!0,this}function ScrollBoxBinding(){this.logger=SystemLogger.getLogger("ScrollBoxBinding")}function LabelBinding(){return this.logger=SystemLogger.getLogger("LabelBinding"),this.hasImage=!1,this.hasLabel=!1,this.isFlipped=!1,this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID]),this}function TextBinding(){return this.logger=SystemLogger.getLogger("TextBinding"),this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID]),this}function BroadcasterSetBinding(){this.logger=SystemLogger.getLogger("BroadcasterSetBinding")}function BroadcasterBinding(){this.logger=SystemLogger.getLogger("BroadcasterBinding"),this._observers=null}function ButtonBinding(){this.logger=SystemLogger.getLogger("ButtonBinding"),this.isCheckButton=!1,this.isRadioButton=!1,this.isComboButton=!1,this.isCheckBox=!1,this.isActive=!1,this.isChecked=!1,this.isDisabled=!1,this.isFocusable=!1,this._isFocusableButton=!1,this.isFocused=!1,this.isDefault=!1,this.popupBinding=null,this.labelBinding=null,this.image=null,this.imageHover=null,this.imageActive=null,this.imageDisabled=null,this.imageProfile=null,this._stateManager=null,this.response=null,this.popupBindingTargetElement=null,this.commandAction=ButtonBinding.ACTION_COMMAND,this.isFlipped=!1,this.isDirty=!1,this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID,FitnessCrawler.ID])}function ButtonStateManager(a){return this.logger=SystemLogger.getLogger("ButtonStateManager"),this.binding=a,this.imageProfile=a.imageProfile,this.assignDOMEvents(!0),this}function ClickButtonBinding(){this.logger=SystemLogger.getLogger("ClickButtonBinding")}function RadioButtonBinding(){return this.logger=SystemLogger.getLogger("RadioButtonBinding"),this.isRadioButton=!0,this}function CheckButtonBinding(){this.logger=SystemLogger.getLogger("CheckButtonBinding"),this.isCheckButton=!0,this.isCheckBox=!0}function ViewButtonBinding(){return this}function ControlGroupBinding(){return this.logger=SystemLogger.getLogger("ControlGroupBinding"),this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID]),this}function ControlBinding(){this.logger=SystemLogger.getLogger("ControlBinding"),this.controlType=null,this.commandAction=ControlBinding.ACTION_COMMAND,this.containingControlBoxBinding=null,this.isVisible=!0,this.isGhostable=!1,this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID])}function ControlBoxBinding(){this.logger=SystemLogger.getLogger("ControlBoxBinding"),this.isNormalized=!0,this.isMaximized=!1,this.isMinimized=!1}function MenuContainerBinding(){this.logger=SystemLogger.getLogger("MenuContainerBinding"),this._isOpen=!1,this._openElement=null,this.menuContainerBinding=null,this.menuPopupBinding=null}function MenuBarBinding(){return this.logger=SystemLogger.getLogger("MenuBarBinding"),this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID]),this}function MenuBinding(){this.logger=SystemLogger.getLogger("MenuBinding"),this.labelBinding=null,this.isFocused=!1}function MenuBodyBinding(){this.logger=SystemLogger.getLogger("MenuBodyBinding"),this._containingPopupBinding=null,this._focused=null,this._lastFocused=null,this._showSubMenuTimeout=null,this.arrowKey=null,this.isDirty=!0,this._hasImageLayout=!1,this._hasCheckBoxLayout=!1}function MenuGroupBinding(){this.logger=SystemLogger.getLogger("MenuGroupBinding"),this.isVisible=!0}function MenuItemBinding(){this.logger=SystemLogger.getLogger("MenuItemBinding"),this.type=null,this.oncommand=null,this.isDisabled=!1,this.labelBinding=null,this.image=null,this.imageHover=null,this.imageActive=null,this.imageDisabled=null,this.imageProfile=null,this.isMenuContainer=!1,this.hasAction=!0,this.isTypeSet=!1,this.isChecked=!1,this.isFocused=!1,this._containingMenuBodyBinding=null}function PopupSetBinding(){return this.logger=SystemLogger.getLogger("PopupSetBinding"),this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID]),this}function PopupBinding(){return this.logger=SystemLogger.getLogger("PopupBinding"),this._bodyBinding=null,this.position=null,this.isVisible=!1,this.onshow=null,this.onhide=null,this.geometry=null,this._menuItems=null,this._menuGroups=null,this._menuItemCount=0,this.type=PopupBinding.TYPE_NORMAL,this._isOverflow=!1,this.hasImages=!0,this.isManaged=!1,this}function PopupBodyBinding(){this.logger=SystemLogger.getLogger("PopupBodyBinding")}function MenuPopupBinding(){return this.logger=SystemLogger.getLogger("MenuPopupBinding"),this}function DialogBinding(){return this.logger=SystemLogger.getLogger("DialogBinding"),this.isFlexible=!1,this._head=null,this._body=null,this._cover=null,this._titlebar=null,this._border=null,this.startPoint=null,this.geometry=null,this.isActive=!1,this.isActivatable=!1,this.isVisible=!1,this._isResizable=!0,this.isDialogResizable=!0,this.isModal=!1,this.mode=null,this.controlBindings={},this._index=null,this._hasTransitions=!1,this}function DialogHeadBinding(){this.logger=SystemLogger.getLogger("DialogHeadBinding")}function DialogBodyBinding(){this.logger=SystemLogger.getLogger("DialogBodyBinding"),this.panelBinding=null,this.isVisible=!0,this._dialogBinding=null}function DialogSetBinding(){this.logger=SystemLogger.getLogger("DialogSetBinding")}function DialogBorderBinding(){this.logger=SystemLogger.getLogger("DialogBorderBinding"),this.isDraggable=!0,this._type=null}function DialogCoverBinding(){this.logger=SystemLogger.getLogger("DialogCoverBinding"),this._dialogBinding=null}function DialogTitleBarBinding(){this.logger=SystemLogger.getLogger("DialogTitleBarBinding"),this.bodyBinding=null,this.labelBinding=null,this._controlGroupBinding=null,this.isDraggable=!0}function DialogTitleBarBodyBinding(){this.logger=SystemLogger.getLogger("DialogTitleBarBodyBinding")}function DialogControlBinding(){this.logger=SystemLogger.getLogger("DialogControlBinding"),this.isGhostable=!0}function DialogTitleBarPopupBinding(){this.logger=SystemLogger.getLogger("DialogTitleBarPopupBinding")}function WindowBindingHighlightNodeCrawler(){return this._keywords=null,this._map=new Map,this._textnodes=null,this._construct(),this}function WindowBinding(){return this.logger=SystemLogger.getLogger("WindowBinding"),this._target=null,this._parameterMap=null,this._pageBinding=null,this._isReloading=!1,this._onloadHandler=null,this._unloadHandler=null,this._hasLoadActionFired=!1,this._native=!1,this}function PreviewWindowBinding(){return this.logger=SystemLogger.getLogger("PreviewWindowBinding"),this._postBackList=null,this._postBackURL=null,this._coverBinding=null,this._windowBinding=null,this._errorBinding=null,this._hasFullStop=!1,this._isReturning=!1,this._loadhandler=null,this._timeout=null,this}function RadioGroupBinding(){return this.logger=SystemLogger.getLogger("RadioGroupBinding"),this._checkedRadioBinding=null,this._radioButtonBindings=null,this._isUpToDate=!1,this}function DataBindingMap(a){this._map=a?a:{},this.type=DataBindingMap.TYPE_RESULT}function DataInputBinding(){return this.logger=SystemLogger.getLogger("DataInputBinding"),this.type=null,this.isRequired=!1,this.expression=null,this.isPassword=!1,this._value=null,this._isValid=!0,this._isInvalidBecauseRequired=!1,1==this._isInvalidBecauseMinLength,1==this._isInvalidBecauseMinLength,1==this._isInvalidBecauseMaxLength,this._sessionResult=null,this.isDisabled=!1,this.isReadOnly=!1,this._dirtyinterval=null,this._isAutoSelect=!1,this.minlength=null,this.maxlength=null,this._isAutoPost=!1,this._timeout=null,this._time=1500,this.crawlerFilters=new List([DocumentCrawler.ID,FocusCrawler.ID]),this.spellcheck=!0,this}function TextBoxBinding(){return this.logger=SystemLogger.getLogger("TextBoxBinding"),this._hasWordWrap=!0,this}function EditorTextBoxBinding(){this.logger=SystemLogger.getLogger("EditorTextBoxBinding"),this._hasWordWrap=!1}function IEEditorTextBoxBinding(){this.logger=SystemLogger.getLogger("IEEditorTextBoxBinding")}function MozEditorTextBoxBinding(){return this.logger=SystemLogger.getLogger("MozEditorTextBoxBinding"),this}function SelectorBinding(){this.logger=SystemLogger.getLogger("SelectorBinding"),this.type=null,this._buttonBinding=null,this._popupBinding=null,this._isLocal=!1,this._menuBodyBinding=null,this._selectionValue=null,this._selectionLabel=null,this._searchString="",this.isSearchSelectionEnabled=!0,this.selections=null,this.isDisabled=!1,this.label=null,this.value=null,this.width=null,this.defaultSelection=null,this.image=null,this.imageHover=null,this.imageActive=null,this.imageDisabled=null,this.isDirty=!1,this._isUpToDate=!1,this._hasKeyboard=!1,this.BUTTON_IMPLEMENTATION=ClickButtonBinding,this.MENUITEM_IMPLEMENTATION=MenuItemBinding,this._isImageLayout=!0,this.isRequired=!1,this._isValid=!0,this.crawlerFilters=new List([DocumentCrawler.ID,FocusCrawler.ID])}function SimpleSelectorBinding(){return this.logger=SystemLogger.getLogger("SimpleSelectorBinding"),this._select=null,this.isRequired=!1,this._isValid=!0,this._cachewidth=0,this}function SelectorBindingSelection(a,b,c,d,e){this._init(a,b,c,d,e)}function DataInputSelectorBinding(){this.logger=SystemLogger.getLogger("DataInputSelectorBinding"),this._buttonBinding=null,this._popupBinding=null,this._menuBodyBinding=null,this._selectionValue=null,this.isDirty=!1,this._hasKeyboard=!1,this._isUpToDate=!1,this._selectedItemBinding=null,this.crawlerFilters=new List([DocumentCrawler.ID,FocusCrawler.ID]),this.value=null}function DataInputDialogBinding(){this.logger=SystemLogger.getLogger("DataInputDialogBinding"),this._handle=null,this._dialogButtonBinding=null,this._isButtonClicked=!1}function TreeSelectorDialogBinding(){this.logger=SystemLogger.getLogger("TreeSelectorDialogBinding"),this.labelBinding=null}function UrlInputDialogBinding(){this.logger=SystemLogger.getLogger("UrlInputDialogBinding"),this.editButtonBinding=null,this.labelBinding=null}function DataInputButtonBinding(){this.logger=SystemLogger.getLogger("DataInputButtonBinding"),this._dialogButtonBinding=null}function DataDialogBinding(){this.logger=SystemLogger.getLogger("DataDialogBinding"),this._buttonBinding=null,this._handler=null,this._map=null,this._dialogViewHandle=null,this._hasKeyboard=!1,this._hasFocus=!1,this.isRequired=!1,this._isValid=!0}function PostBackDataDialogBinding(){return this.input=null,this}function ViewDefinitionPostBackDataDialogBinding(){return this.logger=SystemLogger.getLogger("ViewDefinitionPostBackDataDialogBinding"),this}function NullPostBackDataDialogBinding(){return this.logger=SystemLogger.getLogger("NullPostBackDataDialogBinding"),this._datathing=null,this._selector=null,this.isFocusable=!1,this}function NullPostBackDataDialogSelectorBinding(){return this.logger=SystemLogger.getLogger("NullPostBackDataDialogSelectorBinding"),this.master=null,this}function MultiSelectorBinding(){this.logger=SystemLogger.getLogger("MultiSelectorBinding"),this.isEditable=!0,this.isSelectable=!1,this._dataDialogBinding=null,this.selections=null,this._selectionMap=null,this._display=MultiSelectorBinding.DISPLAY_SELECTED,this._lastSelectedElement=null,this.crawlerFilters=new List([DocumentCrawler.ID,FocusCrawler.ID])}function HierarchicalSelectorBinding(){this.logger=SystemLogger.getLogger("HierarchicalSelectorBinding"),this.crawlerFilters=new List([DocumentCrawler.ID,FocusCrawler.ID]),this.autoSelectChildren=!1,this.autoSelectParents=!0,this.isRequired=!1,this.hasCounter=!1}function HTMLDataDialogBinding(){this.logger=SystemLogger.getLogger("HTMLDataDialogBinding")}function MultiSelectorDataDialogBinding(){return this.logger=SystemLogger.getLogger("MultiSelectorDataDialogBinding"),this._dialogViewHandle="Composite.Management.MultiSelectorDialog",this.isFocusable=!1,this.selections=null,this}function LazyBindingSetBinding(){this.logger=SystemLogger.getLogger("LazyBindingSetBinding")}function LazyBindingBinding(){this.logger=SystemLogger.getLogger("LazyBindingBinding"),this.isFocusable=!1,this._isLazy=!1}function EditorDataBinding(){return this.logger=SystemLogger.getLogger("EditorDataBinding"),this.isFocusable=!1,this._url=WindowBinding.DEFAULT_URL,this.isDirty=!1,this}function FunctionEditorDataBinding(){return this.logger=SystemLogger.getLogger("FunctionEditorDataBinding"),this._url="${root}/content/misc/editors/functioncalleditor/functioncalleditor.aspx?StateProvider=${stateprovider}&Handle=${handle}",this.hasBasic=!1,this}function ParameterEditorDataBinding(){return this.logger=SystemLogger.getLogger("ParameterEditorDataBinding"),this._url="${root}/controls/FormsControls/FormUiControlTemplates/DeveloperTools/FunctionParameterEditor.aspx?StateProvider=${stateprovider}&handle=${handle}",this}function FilePickerBinding(){return this.logger=SystemLogger.getLogger("FilePickerBinding"),this.isReadOnly=!0,this._isValid=!0,this}function RequestBinding(){return this.logger=SystemLogger.getLogger("RequestBinding"),this}function FieldGroupBinding(){this.logger=SystemLogger.getLogger("FieldGroupBinding")}function FieldBinding(){return this.logger=SystemLogger.getLogger("FieldBinding"),this.bindingRelation=null,this}function FieldsBinding(){return this.logger=SystemLogger.getLogger("FieldsBinding"),this._invalidCount=0,this._invalidFieldLabels=null,this.crawlerFilters=new List([FlexBoxCrawler.ID,FitnessCrawler.ID]),this}function FieldDescBinding(){return this.logger=SystemLogger.getLogger("FieldDescBinding"),this}function FieldDataBinding(){return this.logger=SystemLogger.getLogger("FieldDataBinding"),this}function FieldHelpBinding(){return this.logger=SystemLogger.getLogger("FieldHelpBinding"),this}function ResolverContainerBinding(){return this.logger=SystemLogger.getLogger("ResolverContainerBinding"),this}function RadioDataGroupBinding(){this.logger=SystemLogger.getLogger("RadioDataGroupBinding"),this._name=null,this.isDirty=!1,this._hasFocus=!1,this.isFocusable=!0,this.isFocused=!1}function RadioDataBinding(){return this.logger=SystemLogger.getLogger("RadioDataBinding"),this.isRadioButton=!1,this.isChecked=!1,this._result=null,this.bindingRelate=null,this}function CheckBoxBinding(){this.logger=SystemLogger.getLogger("CheckBoxBinding"),this._buttonBinding=null,this._name=null,this.isDirty=!1,this.isChecked=!1,this._result=null,this.isFocusable=!0,this.isFocused=!1}function CheckBoxGroupBinding(){this.logger=SystemLogger.getLogger("CheckBoxGroupBinding"),this.isRequired=!1,this.isValid=!0}function BalloonSetBinding(){this.logger=SystemLogger.getLogger("BalloonSetBinding")}function BalloonBinding(){return this.logger=SystemLogger.getLogger("BalloonBinding"),this._snapTargetBinding=null,this._environmentBinding=null,this}function ErrorBinding(){return this.logger=SystemLogger.getLogger("ErrorBinding"),this}function FocusBinding(){return this.logger=SystemLogger.getLogger("FocusManangerBinding"),this._focusableList=null,this._isUpToDate=!1,this._isFocusManager=!0,this.isStrongFocusManager=!0,this._cachedFocus=null,this.isFlexible=!1,this}function TabsButtonBinding(){this.logger=SystemLogger.getLogger("TabsButtonBinding"),this.hiddenTabBindings=null,this.menuItemBindings=null,this.containingTabBoxBinding=null,this.selectedTabBinding=null,this.isVisible=!1,this.snapshotWindowWidth=null}function TabBoxBinding(){return this.logger=SystemLogger.getLogger("TabBoxBinding"),this._tabBoxPairs={},this._selectedTabElement=null,this._selectedTabBinding=null,this._tabsElement=null,this._tabPanelsElement=null,this._attachedMemberCount=0,this._isMembersAttached=!1,this.isEqualSize=!1,this._nodename_tab="tab",this._nodename_tabs="tabs",this._nodename_tabpanel="tabpanel",this._nodename_tabpanels="tabpanels",this._impl_tab=TabBinding,this._impl_tabs=TabsBinding,this._impl_tabpanel=TabPanelBinding,this._impl_tabpanels=TabPanelsBinding,this.updateType=null,this._hasBastardUpdates=!1,this}function TabsBinding(){return this.logger=SystemLogger.getLogger("TabsBinding"),this.containingTabBoxBinding=null,this.tabsButtonBinding=null,this._cachedOffsetWidth=parseInt(0),this.isManaging=!1,this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID]),this}function TabBinding(){return this.logger=SystemLogger.getLogger("TabBinding"),this.tabboxkey=null,this.isSelected=!1,this.labelBinding=null,this.containingTabBoxBinding=null,this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID]),this}function TabPanelsBinding(){this.logger=SystemLogger.getLogger("TabPanelsBinding"),this.containingTabBoxBinding=null,this._lastKnownDimension=null}function TabPanelBinding(){return this.logger=SystemLogger.getLogger("TabPanelBinding"),this.tabboxkey=null,this.isVisible=!1,this._focusedBinding=null,this}function SplitBoxBinding(){return this.logger=SystemLogger.getLogger("SplitBoxBinding"),this._orient=SplitBoxBinding.ORIENT_HORIZONTAL,this.isLayoutInitialized=!1,this._isFirstLayout=!0,this}function SplitPanelBinding(){return this.logger=SystemLogger.getLogger("SplitPanelBinding"),this._containingSplitBoxBinding=null,this.isCollapsed=!1,this.isFixed=!1,this.isVisible=!0,this._fixedSpan=null,this.isFlexible=!0,this}function SplitterBinding(){return this.logger=SystemLogger.getLogger("SplitterBinding"),this.isDraggable=!0,this.isDragging=!1,this.isCollapsed=!1,this.isDisabled=!0,this._containingSplitBoxBinding=null,this._collapseDirection=SplitterBinding.COLLAPSE_AFTER,this.offset=null,this}function DecksBinding(){this.logger=SystemLogger.getLogger("DecksBinding"),this._selectedDeckBinding=null,this._lastKnownDimension=null}function DeckBinding(){return this.logger=SystemLogger.getLogger("DeckBinding"),this.isSelected=!1,this.isVisible=!1,this.containingDecksBinding=null,this}function ToolBarBinding(){return this.logger=SystemLogger.getLogger("ToolBarBinding"),this.hasImages=!0,this.hasText=!0,this._imageSize=ToolBarBinding.IMAGESIZE_NORMAL,this.type=ToolBarBinding.TYPE_DEFAULT,this._hasDefaultContent=!0,this._toolBarBodyRight=null,this._toolBarBodyLeft=null,this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID,FitnessCrawler.ID]),this._hasDOMContent=!1,this}function ToolBarBodyBinding(){return this.logger=SystemLogger.getLogger("ToolBarBodyBinding"),this.isRightAligned=!1,this}function ToolBarGroupBinding(){this.logger=SystemLogger.getLogger("ToolBarGroupBinding"),this.isDefaultContent=!1}function ToolBarButtonBinding(){this.logger=SystemLogger.getLogger("ToolBarButtonBinding")}function ToolBarLabelBinding(){this.logger=SystemLogger.getLogger("ToolBarLabelBinding")}function DialogToolBarBinding(){return this.logger=SystemLogger.getLogger("DialogToolBarBinding"),this._buttons=null,this._defaultButton=null,this._focusedButton=null,this._isListening=!1,this.crawlerFilters=new List([FlexBoxCrawler.ID]),this}function ComboBoxBinding(){return this.logger=SystemLogger.getLogger("ComboBoxBinding"),this}function ToolBarComboButtonBinding(){return this.logger=SystemLogger.getLogger("ToolBarComboButtonBinding"),this.isComboButton=!0,this.isCheckButton=!0,this.keepState=!0,this.hasPopupItems=!1,this.alignWidth=!1,this}function ToolBoxToolBarButtonBinding(){return this.logger=SystemLogger.getLogger("ToolBoxToolBarButtonBinding"),this._views=new Map,this._lastGeneratedPerspective=null,this}function TreeBinding(){return this.logger=SystemLogger.getLogger("TreeBinding"),this.isFocusable=!0,this.isFocused=!1,this._treeBodyBinding=null,this._positionIndicatorBinding=null,this._treeNodeBuffer=null,this._treeNodeBindings=null,this._focusedTreeNodeBindings=null,this._isFocusable=!0,this._isSelectable=!1,this._selectionProperty=null,this._selectonValue=null,this._selectedTreeNodeBindings=null,this._selectionType=TreeBinding.SELECTIONTYPE_SINGLE,this._actionFilter=null,this._acceptingPosition=null,this._acceptingDimension=null,this._acceptingTreeNodeBinding=null,this._acceptingPositions=null,this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID,FitnessCrawler.ID]),this._hasKeyboard=!1,this._yposition=0,this._openTreeNodesBackupMap=null,this}function TreeBodyBinding(){return this.logger=SystemLogger.getLogger("TreeBodyBinding"),this.containingTreeBinding=null,this}function TreeNodeBinding(){return this.logger=SystemLogger.getLogger("TreeNodeBinding"),this.hasBeenOpened=!1,this.isDisabled=!1,this.isFocused=!1,this.isOpen=!1,this.isPinned=!1,this.isContainer=!1,this.imageProfile=null,this.image=null,
this.imageHover=null,this.imageActive=null,this.imageDisabled=null,this.containingTreeBinding=null,this}function TreeContentBinding(){return this.logger=SystemLogger.getLogger("TreeContentBinding"),this}function TreePositionIndicatorBinding(){this.logger=SystemLogger.getLogger("TreePositionIndicatorBinding"),this._geometry={x:0,y:0}}function TreeCrawler(){return this.mode=TreeCrawler.MODE_GETOPEN,this.id=TreeCrawler.ID,this._construct(),this}function CheckTreeBinding(){return this.logger=SystemLogger.getLogger("CheckTreeBinding"),this}function CheckTreeNodeBinding(){return this.logger=SystemLogger.getLogger("CheckTreeNodeBinding"),this.selectionElement=null,this.selectionValue=null,this.isSelectable=!0,this.isReadOnly=!1,this}function DockTabsButtonBinding(){this.logger=SystemLogger.getLogger("DockTabsButtonBinding")}function DockBinding(){this.logger=SystemLogger.getLogger("DockBinding"),this.isActive=!1,this.isActivatable=!0,this.type=null,this.reference=null,this.isCollapsed=!1,this.isEmpty=!0,this._containingSplitPanelBinding=null,this._viewBindingList=null,this.perspectiveNode=null,this._nodename_tab="docktab",this._nodename_tabs="docktabs",this._nodename_tabpanel="dockpanel",this._nodename_tabpanels="dockpanels",this._impl_tab=DockTabBinding,this._impl_tabs=DockTabsBinding,this._impl_tabpanel=DockPanelBinding,this._impl_tabpanels=DockPanelsBinding}function DockTabsBinding(){this.logger=SystemLogger.getLogger("DockTabsBinding")}function DockTabBinding(){return this.logger=SystemLogger.getLogger("DockTabBinding"),this.perspectiveNode=null,this._controlGroupBinding=null,this._viewBinding=null,this.isDirty=!1,this.isPinned=!1,this.isInitiallyHidden=!0,this._entityToken=null,this._canUpdateTree=!0,this}function DockPanelsBinding(){return this.logger=SystemLogger.getLogger("DockPanelsBinding"),this.isVisible=!0,this}function DockPanelBinding(){return this.logger=SystemLogger.getLogger("DockPanelBinding"),this.viewBinding=null,this}function DockTabPopupBinding(){this.logger=SystemLogger.getLogger("DockTabPopupBinding")}function ViewSetBinding(){return this.logger=SystemLogger.getLogger("ViewSetBinding"),this.crawlerFilters=new List([FlexBoxCrawler.ID,FocusCrawler.ID]),this}function ViewBinding(){return this.logger=SystemLogger.getLogger("ViewBinding"),this._viewDefinition=null,this.isVisible=!1,this._isViewBindingInitialized=!1,this._snapBinding=null,this.isFreeFloating=!1,this.windowBinding=null,this._coverBinding=null,this._isLoaded=!1,this._isFirstShow=!0,this._type=ViewBinding.TYPE_DOCKVIEW,this._pageBinding=null,this._lastknownposition=null,this._lastknowndimension=null,this.isActivated=!1,this}function PageBinding(){this.logger=SystemLogger.getLogger("PageBinding"),this.label=null,this.image=null,this.toolTip=null,this._isPageBindingInitialized=!1,this.pageArgument=null,this.isDialogSubPage=!1,this.isFitAsDialogSubPage=!0,this._initBlockers=null,this._isReadyForInitialize=!1,this.isActivationAware=!1,this.isActivated=!1,this.isNonAjaxPage=!1,this._canPostBack=!0,this._responseResolver=null,this._isUpdating=!1}function DialogPageBinding(){this.logger=SystemLogger.getLogger("DialogPageBinding"),this.response=null,this.result=null,this.width=null,this.height=null,this.minheight=null,this.controls=null,this.isResizable=null,this.isAutoHeightLayoutMode=!1,this.isNonAjaxPage=!0}function DialogPageBodyBinding(){this.logger=SystemLogger.getLogger("DialogPageBodyBinding")}function EditorPageBinding(){this.logger=SystemLogger.getLogger("EditorPageBinding"),this.isDirty=!1,this._tabBoxBinding=null,this._tabBinding=null,this._windowBinding=null,this._isGeneratingPreview=!1,this._isPreviewWindowVisible=!1,this._message=null,this._messages=null,this._messengers=null,this._isWaitingForPreview=!1,this._isPreviewing=!1}function ResponsePageBinding(){this.logger=SystemLogger.getLogger("ResponsePageBinding"),this.responseid=null}function WizardPageBinding(){return this.logger=SystemLogger.getLogger("WizardPageBinding"),this}function MarkupAwarePageBinding(){return this.logger=SystemLogger.getLogger("MarkupAwarePageBinding"),this._isActivated=!1,this._isWaiting=!1,this}function SystemToolBarBinding(){return this.logger=SystemLogger.getLogger("SystemToolBarBinding"),this._currentProfileKey=null,this._actionFolderNames={},this._actionProfile=null,this._moreActionsWidth=0,this._moreActions=null,this._node=null,this._syncHandle=null,this._activePosition=SystemAction.activePositions.NavigatorTree,this._keepBundleState=!1,this}function SystemTreeBinding(){this.logger=SystemLogger.getLogger("SystemTreeBinding"),this.perspectiveNode=null,this._defaultTreeNode=null,this._isActionProfileAware=!0,this._activePosition=SystemAction.activePositions.NavigatorTree,this._actionGroup=null,this._backupfocushandle=null,this._tempSelectedNode=null,this._tempSelectionTimeout=!1,this._entityTokenRegistry=null,this._refreshingTreeNodes=null,this._refreshToken=null,this.isLockedToEditor=!1,this._restorableFocusHandle=null,this._restorableFocusParentHandle=null}function SystemTreePopupBinding(){this.logger=SystemLogger.getLogger("SystemTreePopupBinding"),this._currentProfileKey=null,this._actionProfile=null,this._node=null,this._keepBundleState=!1,this.selectedTreeNodeBinding=null}function SystemTreeNodeBinding(){this.logger=SystemLogger.getLogger("SystemTreeNodeBinding"),this.perspectiveNode=null,this._isForcedOpen=!1,this.node=null,this.autoExpand=!1}function SystemPageBinding(){this.logger=SystemLogger.getLogger("SystemPageBinding"),this.node=null,this._tree=null}function StageContainerBinding(){this.logger=SystemLogger.getLogger("StageContainerBinding")}function StageBinding(){return this.logger=SystemLogger.getLogger("StageBinding"),this._activeViewDefinitions={},this._decksBinding=null,this._explorerBinding=null,this._isStageReady=!1,this._isExplorerReady=!1,this._isDecksReady=!1,this._dockBindings=new Map,this._isShowingStart=!1,this.isActivationAware=!1,this}function StageCrawler(){return this.mode=StageCrawler.MODE_MAXIMIZE,this.id=StageCrawler.ID,this._construct(),this}function StageDialogSetBinding(){this.logger=SystemLogger.getLogger("StageDialogSetBinding"),this._dialogs=new List}function StageDialogBinding(){return this.logger=SystemLogger.getLogger("StageDialogBinding"),this._viewBinding=null,this._contextContainer=null,this._pageBinding=null,this._dialogResponseHandler=null,this._isFirstPage=!0,this}function StageDecksBinding(){this.logger=SystemLogger.getLogger("StageDecksBinding"),this._decks={}}function StageDeckBinding(){this.logger=SystemLogger.getLogger("StageDeckBinding"),this.handle=null,this.path=null,this._isRefreshRequired=!1,this.perspectiveNode=null,this.isReady=!1,this.isDefaultStageDeck=!0,this._isStageDeckBindingInitialized=!1,this._dockBindings=null,this._dockBindingCount=0,this.windowBinding=null,this.isSubPanelMaximized=!1,this.definition=null}function StageDeckRootBinding(){this.logger=SystemLogger.getLogger("StageDeckRootBinding")}function StageSplitBoxBinding(){return this.logger=SystemLogger.getLogger("StageSplitBoxBinding"),this.isMaximizePrepared=!1,this.isMaximizedForReal=null,this.isMinimizedForReal=null,this}function StageSplitPanelBinding(){this.logger=SystemLogger.getLogger("StageSplitPanelBinding"),this.isMaximizePrepared=!1,this.isMaximizedForReal=null,this.isMinimizedForReal=null,this._isInvisibilized=!1,this.isActive=!0,this.isFixed=!1}function StageSplitterBinding(){this.logger=SystemLogger.getLogger("StageSplitterBinding"),this._wasHidden=null}function StageSplitterBodyBinding(){this.logger=SystemLogger.getLogger("StageSplitterBodyBinding"),this._orient=null}function StageBoxAbstraction(){this.isMaximizePrepared=!1,this.isMaximizedForReal=null,this.isMinimizedForReal=null,this.isHiddenForReal=null}function StageBoxHandlerAbstraction(){this.isSubPanelMaximized=!1}function StageMenuBarBinding(){this.logger=SystemLogger.getLogger("StageMenuBarBinding"),this._rootNode=null}function StageViewMenuItemBinding(){this.logger=SystemLogger.getLogger("StageViewMenuItemBinding"),this._handle=null}function StageStatusBarBinding(){this.logger=SystemLogger.getLogger("StageStatusBarBinding"),this._label=null}function ExplorerBinding(){return this.logger=SystemLogger.getLogger("ExplorerBinding"),this._menuBinding=null,this}function ExplorerMenuBinding(){this.logger=SystemLogger.getLogger("ExplorerMenuBinding"),this._buttons=new Map,this._list=new List,this._index=-1,this._group=null,this._selectedHandle=null,this._selectedTag=null}function ExplorerToolBarBinding(){this.logger=SystemLogger.getLogger("ExplorerToolBarBinding"),this._hasDefaultContent=!1}function ExplorerToolBarButtonBinding(){this.logger=SystemLogger.getLogger("ExplorerToolBarButtonBinding"),this.isRadioButton=!0,this.explorerToolBarButtonType=null,this.node=null}function ExplorerPopupBinding(){this.logger=SystemLogger.getLogger("ExplorerPopupBinding")}function EditorBinding(){this.logger=SystemLogger.getLogger("EditorBinding"),this.action_initialized=null,this.url_default=null,this._popupBinding=null,this._startContent=null,this._explorerBookmark=null,this.isDirty=!1,this.isDialogMode=!1,this.isFocusable=!0,this.isFocused=!1,this._isActivated=!1,this._Binding=null,this._url=null,this.isBlockingActions=!0,this._isFinalized=!1,this._bookmark=null,this._checksum=null,this.crawlerFilters=new List([FocusCrawler.ID,FitnessCrawler.ID])}function EditorPopupBinding(){this.logger=SystemLogger.getLogger("EditorPopupBinding"),this._isEditorPopupBindingInitialized=!1,this.editorBinding=null}function EditorClickButtonBinding(){this.logger=SystemLogger.getLogger("EditorClickButtonBinding"),this._editorBinding=null,this.isEditorControlBinding=!0,this.isEditorSimpleControl=!0,this.cmd=null,this.val=null,this.gui=null,this._tinyEngine=null,this._tinyInstance=null,this._tinyTheme=null,this._codePressFrame=null,this._codePressEngine=null}function EditorToolBarButtonBinding(){this.logger=SystemLogger.getLogger("EditorToolBarButtonBinding"),this._editorBinding=null,this._tinyEngine=null,this._tinyInstance=null,this._tinyTheme=null,this.isEditorSimpleControl=!0,this.isEditorControlBinding=!0,this.cmd=null,this.val=null,this.gui=null}function EditorSelectorBinding(){this.logger=SystemLogger.getLogger("EditorSelectorBinding"),this._editorBinding=null,this._tinyEngine=null,this._tinyInstance=null,this._tinyTheme=null,this.BUTTON_IMPLEMENTATION=EditorClickButtonBinding,this.MENUITEM_IMPLEMENTATION=EditorMenuItemBinding,this.isFocusable=!1,this.isEditorControlBinding=!0,this.isSearchSelectionEnabled=!1}function EditorMenuItemBinding(){this.logger=SystemLogger.getLogger("EditorMenuItemBinding"),this.isEditorControlBinding=!0}function VisualEditorBinding(){return this.logger=SystemLogger.getLogger("VisualEditorBinding"),this.action_initialized=VisualEditorBinding.ACTION_INITIALIZED,this.url_default="${root}/content/misc/editors/visualeditor/visualeditor.aspx",this._tinyEngine=null,this._tinyInstance=null,this._tinyTheme=null,this.embedableFieldConfiguration=null,this._xhtml=null,this._previewPageId=null,this._previewTemplateId=null,this._previewPlaceholder=null,this}function VisualEditorPopupBinding(){this.logger=SystemLogger.getLogger("VisualEditorPopupBinding"),this.tinyElement=null,this.tinyEngine=null,this.tinyInstance=null,this.hasSelection=!1}function VisualEditorFormattingConfiguration(a){this._options=VisualEditorFormattingConfiguration._getOptions()}function VisualEditorFieldGroupConfiguration(a){var b=new Map;new List(a).each(function(a){var c=new Map;new List(a.Fields).each(function(a){c.set(a.Name,{xhtml:a.XhtmlRepresentation,xml:a.XhtmlRepresentation})}),b.set(a.GroupName,c)}),this._groups=b}function VisualMultiEditorBinding(){return this.logger=SystemLogger.getLogger("VisualMultiEditorBinding"),this._hasPlaceHolders=!1,this._textareaname=null,this._textareas=null,this._xhtmls=null,this}function VisualMultiTemplateEditorBinding(){return this.logger=SystemLogger.getLogger("VisualMultiTemplateEditorBinding"),this._oldtextareas=null,this._pageId=null,this._templatePreview=null,this}function CodeMirrorEditorPopupBinding(){this.logger=SystemLogger.getLogger("CodeMirrorEditorPopupBinding"),this._editorBinding=null,this._codePressFrame=null,this._codePressEngine=null}function CodeMirrorEditorBinding(){return this.logger=SystemLogger.getLogger("CodeMirrorEditorBinding"),this.action_initialized=CodeMirrorEditorBinding.ACTION_INITIALIZED,this.url_default="${root}/content/misc/editors/codemirroreditor/codemirroreditor.aspx",this._editorWindowBinding=null,this._codemirrorWindow=null,this._codemirrorEditor=null,this._codemirrorWrapperElement=null,this.syntax=new String(CodeMirrorEditorBinding.syntax.TEXT),this._isPlainEditMode=!1,this.isFocusable=!0,this._isEmbedded=!1,this._hasStrictValidation=!1,this._strictSave=!0,this._validator=null,this._startContent="",this}function ProgressBarBinding(){return this.logger=SystemLogger.getLogger("ProgressBarBinding"),this._cover=null,this}function StartMenuItemBinding(){this.logger=SystemLogger.getLogger("StartMenuItemBinding"),this.type=MenuItemBinding.TYPE_CHECKBOX}function KeySetBinding(){return this.logger=SystemLogger.getLogger("KeySetBinding"),this.crawlerFilters=new List([DocumentCrawler.ID,FlexBoxCrawler.ID,FocusCrawler.ID]),this}function CursorBinding(){return this.logger=SystemLogger.getLogger("CursorBinding"),this._labelBinding=null,this._opacity=1,this.isAccepting=!0,this}function CoverBinding(){return this.logger=SystemLogger.getLogger("CoverBinding"),this._isBusy=!0,this._isTransparent=!1,this.lastTouch=null,this._position=null,this}function UncoverBinding(){this.logger=SystemLogger.getLogger("UncoverBinding"),UncoverBinding._bindingInstance=this}function TheatreBinding(){return this._isPlaying=!1,this._isFading=!1,this._canvas=null,this}function SourceCodeViewerBinding(){this.logger=SystemLogger.getLogger("SourceCodeViewerBinding"),this._syntax=null,this._transformer=null}function PersistanceBinding(){return this.logger=SystemLogger.getLogger("PersistanceBinding"),this._resolver=null,this}function LocalizationSelectorBinding(){return this.logger=SystemLogger.getLogger("LocalizationSelectorBinding"),this._token=null,this}function ResponseBinding(){return this.logger=SystemLogger.getLogger("ResponseBinding"),this}function AddressBarBinding(){return this.logger=SystemLogger.getLogger("AddressBarBinding"),this.pathBinding=null,this._stateKey=null,this}function GenericViewBinding(){this.logger=SystemLogger.getLogger("GenericViewBinding"),this.perspectiveNode=null,this.node=null,this._activePosition=SystemAction.activePositions.NavigatorTree,this._actionGroup=null}function PathBinding(){return this.logger=SystemLogger.getLogger("PathBinding"),this}function BrandSnippetBinding(){return this.logger=SystemLogger.getLogger("BrandSnippetBinding"),this}function UserInterfaceMapping(a){this.logger=SystemLogger.getLogger("UserInterfaceMapping"),this.map={};for(var b in a)this.map[b.replace("ui:","")]=a[b],this.map[b]=a[b]}function SOAPMessage(){}function SOAPRequest(a){return this.logger=SystemLogger.getLogger("SOAPRequest"),this.action=a,this}function SOAPRequestResponse(){}function SOAPFault(a,b,c){this._operationName=a,this._operationAddress=b,this._faultString=c}function SOAPEncoder(a,b){this.logger=SystemLogger.getLogger("SOAPEncoder"),this._wsdl=a,this._operation=b,this._namespace=a.getTargetNamespace()}function SOAPDecoder(a,b){this._wsdl=a,this._operation=b,this._resolver=new XPathResolver,this._resolver.setNamespacePrefixResolver({result:a.getTargetNamespace()})}function Schema(a){this.logger=SystemLogger.getLogger("Schema"),this._map=this._parseSchema(a)}function SchemaDefinition(a){this.logger=SystemLogger.getLogger("SchemaDefinition"),this.isRequired=null,this.type=null,this._parse(a)}function SchemaType(){}function SchemaElementType(a,b){this.logger=SystemLogger.getLogger("SchemaElementType"),this._definitions=new List,this._parseListedDefinitions(a,b)}function SchemaComplexType(a,b){this._definitions=new List,this._parseListedDefinitions(a,b),this.isArray=b.getAttribute("name").indexOf("ArrayOf")>-1}function SchemaSimpleType(a,b){this.restrictionType=null,this._parse(a,b)}function WebServiceResolver(a){this.logger=SystemLogger.getLogger("WebServiceResolver"),this._root=this._getDocumentElement(a),this._schema=null,this._root&&(this.setNamespacePrefixResolver({wsdl:Constants.NS_WSDL,soap:Constants.NS_SOAP,s:Constants.NS_SCHEMA}),this._schema=new Schema(this.resolve("wsdl:types/s:schema",this._root))),this._WSDLURL=a}function WebServiceOperation(a,b,c,d){this.name=a,this.address=b,this.encoder=c,this.decoder=d}function WebServiceProxy(){this.logger=SystemLogger.getLogger("WebServiceProxy")}function SelectorButtonBinding(){return this.logger=SystemLogger.getLogger("SelectorButtonBinding"),this.isSingle=!1,this.singleValue=null,this}function SlideInViewBinding(){return this.logger=SystemLogger.getLogger("SlideInViewBinding"),this.responseAction=PageBinding.ACTION_RESPONSE,this}function SlideInButtonBinding(){return this.logger=SystemLogger.getLogger("SlideInButtonBinding"),this}!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.autobahn=a()}}(function(){var define,module,exports;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a,b,c,d){var c=c||1e3,d=d||32,e={keySize:d/4,iterations:c,hasher:f.algo.SHA256},g=f.PBKDF2(a,b,e);return g.toString(f.enc.Base64)}function e(a,b){return f.HmacSHA256(b,a).toString(f.enc.Base64)}var f=a("crypto-js");c.sign=e,c.derive_key=d},{"crypto-js":32}],2:[function(a,b,c){function d(a,b,c){var d=a.defer();return navigator.id.watch({loggedInUser:b,onlogin:function(a){d.resolve(a)},onlogout:function(){a.leave("wamp.close.logout")}}),d.promise.then?d.promise:d}a("when"),a("when/function");c.auth=d},{when:93,"when/function":69}],3:[function(a,b,c){(function(b){a("./polyfill.js");var d=a("../package.json"),e=a("when");"AUTOBAHN_DEBUG"in b&&AUTOBAHN_DEBUG&&(a("when/monitor/console"),"console"in b&&console.log("AutobahnJS debug enabled"));var f=a("./util.js"),g=a("./log.js"),h=a("./session.js"),i=a("./connection.js"),j=a("./configure.js"),k=a("./serializer.js"),l=a("./auth/persona.js"),m=a("./auth/cra.js");c.version=d.version,c.transports=j.transports,c.Connection=i.Connection,c.Session=h.Session,c.Invocation=h.Invocation,c.Event=h.Event,c.Result=h.Result,c.Error=h.Error,c.Subscription=h.Subscription,c.Registration=h.Registration,c.Publication=h.Publication,c.serializer=k,c.auth_persona=l.auth,c.auth_cra=m,c.when=e,c.util=f,c.log=g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../package.json":111,"./auth/cra.js":1,"./auth/persona.js":2,"./configure.js":4,"./connection.js":5,"./log.js":6,"./polyfill.js":7,"./serializer.js":15,"./session.js":16,"./util.js":20,when:93,"when/monitor/console":91}],4:[function(a,b,c){function d(){this._repository={}}d.prototype.register=function(a,b){this._repository[a]=b},d.prototype.isRegistered=function(a){return!!this._repository[a]},d.prototype.get=function(a){if(void 0!==this._repository[a])return this._repository[a];throw"no such transport: "+a},d.prototype.list=function(){var a=[];for(var b in this._repository)a.push(b);return a};var e=new d,f=a("./transport/websocket.js");e.register("websocket",f.Factory);var g=a("./transport/longpoll.js");e.register("longpoll",g.Factory);var h=a("./transport/rawsocket.js");e.register("rawsocket",h.Factory),c.transports=e},{"./transport/longpoll.js":17,"./transport/rawsocket.js":18,"./transport/websocket.js":19}],5:[function(a,b,c){(function(b){var d=a("when"),e=a("./session.js"),f=a("./util.js"),g=a("./log.js"),h=a("./autobahn.js"),i=function(a){var c=this;c._options=a,a&&a.use_es6_promises?"Promise"in b?c._defer=function(){var a={};return a.promise=new Promise(function(b,c){a.resolve=b,a.reject=c}),a}:(g.debug("Warning: ES6 promises requested, but not found! Falling back to whenjs."),c._defer=d.defer):a&&a.use_deferred?c._defer=a.use_deferred:c._defer=d.defer,c._options.transports||(c._options.transports=[{type:"websocket",url:c._options.url}]),c._transport_factories=[],c._init_transport_factories(),c._session=null,c._session_close_reason=null,c._session_close_message=null,void 0!==c._options.retry_if_unreachable?c._retry_if_unreachable=c._options.retry_if_unreachable:c._retry_if_unreachable=!0,c._max_retries="undefined"!=typeof c._options.max_retries?c._options.max_retries:15,c._initial_retry_delay=c._options.initial_retry_delay||1.5,c._max_retry_delay=c._options.max_retry_delay||300,c._retry_delay_growth=c._options.retry_delay_growth||1.5,c._retry_delay_jitter=c._options.retry_delay_jitter||.1,c._connect_successes=0,c._retry=!1,c._retry_count=0,c._retry_delay=c._initial_retry_delay,c._is_retrying=!1,c._retry_timer=null};i.prototype._create_transport=function(){for(var a=0;a<this._transport_factories.length;++a){var b=this._transport_factories[a];g.debug("trying to create WAMP transport of type: "+b.type);try{var c=b.create();if(c)return g.debug("using WAMP transport type: "+b.type),c}catch(a){g.debug("could not create WAMP transport '"+b.type+"': "+a)}}return null},i.prototype._init_transport_factories=function(){var a,b,c,d;f.assert(this._options.transports,"No transport.factory specified"),a=this._options.transports;for(var e=0;e<this._options.transports.length;++e){b=this._options.transports[e],b.url||(b.url=this._options.url),b.serializers||(b.serializers=this._options.serializers),b.protocols||(b.protocols=this._options.protocols),f.assert(b.type,"No transport.type specified"),f.assert("string"==typeof b.type,"transport.type must be a string");try{d=h.transports.get(b.type),d&&(c=new d(b),this._transport_factories.push(c))}catch(a){console.error(a)}}},i.prototype._autoreconnect_reset_timer=function(){var a=this;a._retry_timer&&clearTimeout(a._retry_timer),a._retry_timer=null},i.prototype._autoreconnect_reset=function(){var a=this;a._autoreconnect_reset_timer(),a._retry_count=0,a._retry_delay=a._initial_retry_delay,a._is_retrying=!1},i.prototype._autoreconnect_advance=function(){var a=this;a._retry_delay_jitter&&(a._retry_delay=f.rand_normal(a._retry_delay,a._retry_delay*a._retry_delay_jitter)),a._retry_delay>a._max_retry_delay&&(a._retry_delay=a._max_retry_delay),a._retry_count+=1;var b;return b=a._retry&&(a._max_retries===-1||a._retry_count<=a._max_retries)?{count:a._retry_count,delay:a._retry_delay,will_retry:!0}:{count:null,delay:null,will_retry:!1},a._retry_delay_growth&&(a._retry_delay=a._retry_delay*a._retry_delay_growth),b},i.prototype.open=function(){function a(){if(b._transport=b._create_transport(),b._transport)b._session=new e.Session(b._transport,b._defer,b._options.onchallenge),b._session_close_reason=null,b._session_close_message=null,b._transport.onopen=function(){b._autoreconnect_reset(),b._connect_successes+=1,b._session.join(b._options.realm,b._options.authmethods,b._options.authid)},b._session.onjoin=function(a){if(b.onopen)try{b.onopen(b._session,a)}catch(a){g.debug("Exception raised from app code while firing Connection.onopen()",a)}},b._session.onleave=function(a,c){b._session_close_reason=a,b._session_close_message=c.message||"",b._retry=!1,b._transport.close(1e3)},b._transport.onclose=function(c){b._autoreconnect_reset_timer(),b._transport=null;var d=null;0===b._connect_successes?(d="unreachable",b._retry_if_unreachable||(b._retry=!1)):d=c.wasClean?"closed":"lost";var e=b._autoreconnect_advance();if(b.onclose){var f={reason:b._session_close_reason,message:b._session_close_message,retry_delay:e.delay,retry_count:e.count,will_retry:e.will_retry};try{var h=b.onclose(d,f)}catch(a){g.debug("Exception raised from app code while firing Connection.onclose()",a)}}b._session&&(b._session._id=null,b._session=null,b._session_close_reason=null,b._session_close_message=null),b._retry&&!h&&(e.will_retry?(b._is_retrying=!0,g.debug("retrying in "+e.delay+" s"),b._retry_timer=setTimeout(a,1e3*e.delay)):g.debug("giving up trying to reconnect"))};else if(b._retry=!1,b.onclose){var c={reason:null,message:null,retry_delay:null,retry_count:null,will_retry:!1};b.onclose("unsupported",c)}}var b=this;if(b._transport)throw"connection already open (or opening)";b._autoreconnect_reset(),b._retry=!0,a()},i.prototype.close=function(a,b){var c=this;if(!c._transport&&!c._is_retrying)throw"connection already closed";c._retry=!1,c._session&&c._session.isOpen?c._session.leave(a,b):c._transport&&c._transport.close(1e3)},Object.defineProperty(i.prototype,"defer",{get:function(){return this._defer}}),Object.defineProperty(i.prototype,"session",{get:function(){return this._session}}),Object.defineProperty(i.prototype,"isOpen",{get:function(){return!(!this._session||!this._session.isOpen)}}),Object.defineProperty(i.prototype,"isConnected",{get:function(){return!!this._transport}}),Object.defineProperty(i.prototype,"transport",{get:function(){return this._transport?this._transport:{info:{type:"none",url:null,protocol:null}}}}),Object.defineProperty(i.prototype,"isRetrying",{get:function(){return this._is_retrying}}),c.Connection=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./autobahn.js":3,"./log.js":6,"./session.js":16,"./util.js":20,when:93}],6:[function(a,b,c){(function(a){var b=function(){};"AUTOBAHN_DEBUG"in a&&AUTOBAHN_DEBUG&&"console"in a&&(b=function(){console.log.apply(console,arguments)}),c.debug=b}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(a,b,c){a("./polyfill/object"),a("./polyfill/array"),a("./polyfill/string"),a("./polyfill/function"),a("./polyfill/console"),a("./polyfill/typedarray"),a("./polyfill/json")},{"./polyfill/array":8,"./polyfill/console":9,"./polyfill/function":10,"./polyfill/json":11,"./polyfill/object":12,"./polyfill/string":13,"./polyfill/typedarray":14}],8:[function(a,b,c){"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a){"use strict";var b,c,d,e;if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");if(c=Object(this),b=c.length>>>0,e=0,arguments.length>=2)d=arguments[1];else{for(;e<b&&!e in c;)e++;if(e>=b)throw new TypeError("Reduce of empty array with no initial value");d=c[e++]}for(;e<b;e++)e in c&&(d=a(d,c[e],e,c));return d}),"indexOf"in Array.prototype||(Array.prototype.indexOf=function(a,b){void 0===b&&(b=0),b<0&&(b+=this.length),b<0&&(b=0);for(var c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1}),"lastIndexOf"in Array.prototype||(Array.prototype.lastIndexOf=function(a,b){for(void 0===b&&(b=this.length-1),b<0&&(b+=this.length),b>this.length-1&&(b=this.length-1),b++;b-- >0;)if(b in this&&this[b]===a)return b;return-1}),"forEach"in Array.prototype||(Array.prototype.forEach=function(a,b){for(var c=0,d=this.length;c<d;c++)c in this&&a.call(b,this[c],c,this)}),"map"in Array.prototype||(Array.prototype.map=function(a,b){for(var c=new Array(this.length),d=0,e=this.length;d<e;d++)d in this&&(c[d]=a.call(b,this[d],d,this));return c}),"filter"in Array.prototype||(Array.prototype.filter=function(a,b){for(var c,d=[],e=0,f=this.length;e<f;e++)e in this&&a.call(b,c=this[e],e,this)&&d.push(c);return d}),"every"in Array.prototype||(Array.prototype.every=function(a,b){for(var c=0,d=this.length;c<d;c++)if(c in this&&!a.call(b,this[c],c,this))return!1;return!0}),"some"in Array.prototype||(Array.prototype.some=function(a,b){for(var c=0,d=this.length;c<d;c++)if(c in this&&a.call(b,this[c],c,this))return!0;return!1}),"function"!=typeof Array.prototype.reduceRight&&(Array.prototype.reduceRight=function(a){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var b,c=Object(this),d=c.length>>>0,e=d-1;if(arguments.length>=2)b=arguments[1];else{for(;e>=0&&!e in c;)e--;if(e<0)throw new TypeError("Reduce of empty array with no initial value");b=c[e--]}for(;e>=0;e--)e in c&&(b=a(b,c[e],e,c));return b})},{}],9:[function(a,b,c){(function(a){!function(a){a||(a=window.console={log:function(a,b,c,d,e){},info:function(a,b,c,d,e){},warn:function(a,b,c,d,e){},error:function(a,b,c,d,e){},assert:function(a,b){}}),"object"==typeof a.log&&(a.log=Function.prototype.call.bind(a.log,a),a.info=Function.prototype.call.bind(a.info,a),a.warn=Function.prototype.call.bind(a.warn,a),a.error=Function.prototype.call.bind(a.error,a),a.debug=Function.prototype.call.bind(a.info,a)),"group"in a||(a.group=function(b){a.info("\n--- "+b+" ---\n")}),"groupEnd"in a||(a.groupEnd=function(){a.log("\n")}),"assert"in a||(a.assert=function(a,b){if(!a)try{throw new Error("assertion failed: "+b)}catch(a){setTimeout(function(){throw a},0)}}),"time"in a||function(){var b={};a.time=function(a){b[a]=(new Date).getTime()},a.timeEnd=function(c){var d=(new Date).getTime(),e=c in b?d-b[c]:0;a.info(c+": "+e+"ms")}}()}(a.console)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(a,b,c){Function.prototype.bind||(Function.prototype.bind=function(a){var b=this,c=Array.prototype.slice.call(arguments,1);return function(){return b.apply(a,Array.prototype.concat.apply(c,arguments))}})},{}],11:[function(require,module,exports){"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;c<f;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;c<f;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,c){var d;if(gap="",indent="",
"number"==typeof c)for(d=0;d<c;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),exports.JSON=JSON},{}],12:[function(a,b,c){Object.create||(Object.create=function(){function a(){}return function(b){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return a.prototype=b,new a}}()),Object.keys||(Object.keys=function(){"use strict";var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;g<d;g++)a.call(e,c[g])&&h.push(c[g]);return h}}())},{}],13:[function(a,b,c){"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")})},{}],14:[function(a,b,c){(function(a){"undefined"==typeof a.Uint8Array&&!function(a,b){"use strict";function c(a){switch(typeof a){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";default:return null===a?"null":"object"}}function d(a){return Object.prototype.toString.call(a).replace(/^\[object *|\]$/g,"")}function e(a){return"function"==typeof a}function f(a){if(null===a||a===E)throw TypeError();return Object(a)}function g(a){return a>>0}function h(a){return a>>>0}function i(a){function b(b){Object.defineProperty(a,b,{get:function(){return a._getter(b)},set:function(c){a._setter(b,c)},enumerable:!0,configurable:!1})}if(a.length>F)throw RangeError("Array too large for polyfill");var c;for(c=0;c<a.length;c+=1)b(c)}function j(a,b){var c=32-b;return a<<c>>c}function k(a,b){var c=32-b;return a<<c>>>c}function l(a){return[255&a]}function m(a){return j(a[0],8)}function n(a){return[255&a]}function o(a){return k(a[0],8)}function p(a){return a=N(Number(a)),[a<0?0:a>255?255:255&a]}function q(a){return[a>>8&255,255&a]}function r(a){return j(a[0]<<8|a[1],16)}function s(a){return[a>>8&255,255&a]}function t(a){return k(a[0]<<8|a[1],16)}function u(a){return[a>>24&255,a>>16&255,a>>8&255,255&a]}function v(a){return j(a[0]<<24|a[1]<<16|a[2]<<8|a[3],32)}function w(a){return[a>>24&255,a>>16&255,a>>8&255,255&a]}function x(a){return k(a[0]<<24|a[1]<<16|a[2]<<8|a[3],32)}function y(a,b,c){function d(a){var b=I(a),c=a-b;return c<.5?b:c>.5?b+1:b%2?b+1:b}var e,f,g,h,i,j,k,l=(1<<b-1)-1;for(a!==a?(f=(1<<b)-1,g=M(2,c-1),e=0):a===1/0||a===-(1/0)?(f=(1<<b)-1,g=0,e=a<0?1:0):0===a?(f=0,g=0,e=1/a===-(1/0)?1:0):(e=a<0,a=H(a),a>=M(2,1-l)?(f=L(I(J(a)/G),1023),g=d(a/M(2,f)*M(2,c)),g/M(2,c)>=2&&(f+=1,g=1),f>l?(f=(1<<b)-1,g=0):(f+=l,g-=M(2,c))):(f=0,g=d(a/M(2,1-l-c)))),i=[],h=c;h;h-=1)i.push(g%2?1:0),g=I(g/2);for(h=b;h;h-=1)i.push(f%2?1:0),f=I(f/2);for(i.push(e?1:0),i.reverse(),j=i.join(""),k=[];j.length;)k.push(parseInt(j.substring(0,8),2)),j=j.substring(8);return k}function z(a,b,c){var d,e,f,g,h,i,j,k,l=[];for(d=a.length;d;d-=1)for(f=a[d-1],e=8;e;e-=1)l.push(f%2?1:0),f>>=1;return l.reverse(),g=l.join(""),h=(1<<b-1)-1,i=parseInt(g.substring(0,1),2)?-1:1,j=parseInt(g.substring(1,1+b),2),k=parseInt(g.substring(1+b),2),j===(1<<b)-1?0!==k?NaN:i*(1/0):j>0?i*M(2,j-h)*(1+k/M(2,c)):0!==k?i*M(2,-(h-1))*(k/M(2,c)):i<0?-0:0}function A(a){return z(a,11,52)}function B(a){return y(a,11,52)}function C(a){return z(a,8,23)}function D(a){return y(a,8,23)}var E=void 0,F=1e5,G=Math.LN2,H=Math.abs,I=Math.floor,J=Math.log,K=Math.max,L=Math.min,M=Math.pow,N=Math.round;!function(){var a=Object.defineProperty,b=!function(){try{return Object.defineProperty({},"x",{})}catch(a){return!1}}();a&&!b||(Object.defineProperty=function(b,c,d){if(a)try{return a(b,c,d)}catch(a){}if(b!==Object(b))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in d&&Object.prototype.__defineGetter__.call(b,c,d.get),Object.prototype.__defineSetter__&&"set"in d&&Object.prototype.__defineSetter__.call(b,c,d.set),"value"in d&&(b[c]=d.value),b})}(),function(){function j(a){if(a=g(a),a<0)throw RangeError("ArrayBuffer size is not a small enough positive integer.");Object.defineProperty(this,"byteLength",{value:a}),Object.defineProperty(this,"_bytes",{value:Array(a)});for(var b=0;b<a;b+=1)this._bytes[b]=0}function k(){if(!arguments.length||"object"!=typeof arguments[0])return function(a){if(a=g(a),a<0)throw RangeError("length is not a small enough positive integer.");Object.defineProperty(this,"length",{value:a}),Object.defineProperty(this,"byteLength",{value:a*this.BYTES_PER_ELEMENT}),Object.defineProperty(this,"buffer",{value:new j(this.byteLength)}),Object.defineProperty(this,"byteOffset",{value:0})}.apply(this,arguments);if(arguments.length>=1&&"object"===c(arguments[0])&&arguments[0]instanceof k)return function(a){if(this.constructor!==a.constructor)throw TypeError();var b=a.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new j(b)}),Object.defineProperty(this,"byteLength",{value:b}),Object.defineProperty(this,"byteOffset",{value:0}),Object.defineProperty(this,"length",{value:a.length});for(var c=0;c<this.length;c+=1)this._setter(c,a._getter(c))}.apply(this,arguments);if(arguments.length>=1&&"object"===c(arguments[0])&&!(arguments[0]instanceof k)&&!(arguments[0]instanceof j||"ArrayBuffer"===d(arguments[0])))return function(a){var b=a.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new j(b)}),Object.defineProperty(this,"byteLength",{value:b}),Object.defineProperty(this,"byteOffset",{value:0}),Object.defineProperty(this,"length",{value:a.length});for(var c=0;c<this.length;c+=1){var d=a[c];this._setter(c,Number(d))}}.apply(this,arguments);if(arguments.length>=1&&"object"===c(arguments[0])&&(arguments[0]instanceof j||"ArrayBuffer"===d(arguments[0])))return function(a,b,c){if(b=h(b),b>a.byteLength)throw RangeError("byteOffset out of range");if(b%this.BYTES_PER_ELEMENT)throw RangeError("buffer length minus the byteOffset is not a multiple of the element size.");if(c===E){var d=a.byteLength-b;if(d%this.BYTES_PER_ELEMENT)throw RangeError("length of buffer minus byteOffset not a multiple of the element size");c=d/this.BYTES_PER_ELEMENT}else c=h(c),d=c*this.BYTES_PER_ELEMENT;if(b+d>a.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:a}),Object.defineProperty(this,"byteLength",{value:d}),Object.defineProperty(this,"byteOffset",{value:b}),Object.defineProperty(this,"length",{value:c})}.apply(this,arguments);throw TypeError()}function y(a,b,c){var d=function(){Object.defineProperty(this,"constructor",{value:d}),k.apply(this,arguments),i(this)};"__proto__"in d?d.__proto__=k:(d.from=k.from,d.of=k.of),d.BYTES_PER_ELEMENT=a;var e=function(){};return e.prototype=z,d.prototype=new e,Object.defineProperty(d.prototype,"BYTES_PER_ELEMENT",{value:a}),Object.defineProperty(d.prototype,"_pack",{value:b}),Object.defineProperty(d.prototype,"_unpack",{value:c}),d}a.ArrayBuffer=a.ArrayBuffer||j,Object.defineProperty(k,"from",{value:function(a){return new this(a)}}),Object.defineProperty(k,"of",{value:function(){return new this(arguments)}});var z={};k.prototype=z,Object.defineProperty(k.prototype,"_getter",{value:function(a){if(arguments.length<1)throw SyntaxError("Not enough arguments");if(a=h(a),a>=this.length)return E;var b,c,d=[];for(b=0,c=this.byteOffset+a*this.BYTES_PER_ELEMENT;b<this.BYTES_PER_ELEMENT;b+=1,c+=1)d.push(this.buffer._bytes[c]);return this._unpack(d)}}),Object.defineProperty(k.prototype,"get",{value:k.prototype._getter}),Object.defineProperty(k.prototype,"_setter",{value:function(a,b){if(arguments.length<2)throw SyntaxError("Not enough arguments");if(a=h(a),!(a>=this.length)){var c,d,e=this._pack(b);for(c=0,d=this.byteOffset+a*this.BYTES_PER_ELEMENT;c<this.BYTES_PER_ELEMENT;c+=1,d+=1)this.buffer._bytes[d]=e[c]}}}),Object.defineProperty(k.prototype,"constructor",{value:k}),Object.defineProperty(k.prototype,"copyWithin",{value:function(a,b){var c=arguments[2],d=f(this),e=d.length,i=h(e);i=K(i,0);var j,k=g(a);j=k<0?K(i+k,0):L(k,i);var l,m=g(b);l=m<0?K(i+m,0):L(m,i);var n;n=c===E?i:g(c);var o;o=n<0?K(i+n,0):L(n,i);var p,q=L(o-l,i-j);for(from<j&&j<l+q?(p=-1,l=l+q-1,j=j+q-1):p=1;count>0;)d._setter(j,d._getter(l)),l+=p,j+=p,q-=1;return d}}),Object.defineProperty(k.prototype,"every",{value:function(a){if(this===E||null===this)throw TypeError();var b=Object(this),c=h(b.length);if(!e(a))throw TypeError();for(var d=arguments[1],f=0;f<c;f++)if(!a.call(d,b._getter(f),f,b))return!1;return!0}}),Object.defineProperty(k.prototype,"fill",{value:function(a){var b=arguments[1],c=arguments[2],d=f(this),e=d.length,i=h(e);i=K(i,0);var j,k=g(b);j=k<0?K(i+k,0):L(k,i);var l;l=c===E?i:g(c);var m;for(m=l<0?K(i+l,0):L(l,i);j<m;)d._setter(j,a),j+=1;return d}}),Object.defineProperty(k.prototype,"filter",{value:function(a){if(this===E||null===this)throw TypeError();var b=Object(this),c=h(b.length);if(!e(a))throw TypeError();for(var d=[],f=arguments[1],g=0;g<c;g++){var i=b._getter(g);a.call(f,i,g,b)&&d.push(i)}return new this.constructor(d)}}),Object.defineProperty(k.prototype,"find",{value:function(a){var b=f(this),c=b.length,d=h(c);if(!e(a))throw TypeError();for(var g=arguments.length>1?arguments[1]:E,i=0;i<d;){var j=b._getter(i),k=a.call(g,j,i,b);if(Boolean(k))return j;++i}return E}}),Object.defineProperty(k.prototype,"findIndex",{value:function(a){var b=f(this),c=b.length,d=h(c);if(!e(a))throw TypeError();for(var g=arguments.length>1?arguments[1]:E,i=0;i<d;){var j=b._getter(i),k=a.call(g,j,i,b);if(Boolean(k))return i;++i}return-1}}),Object.defineProperty(k.prototype,"forEach",{value:function(a){if(this===E||null===this)throw TypeError();var b=Object(this),c=h(b.length);if(!e(a))throw TypeError();for(var d=arguments[1],f=0;f<c;f++)a.call(d,b._getter(f),f,b)}}),Object.defineProperty(k.prototype,"indexOf",{value:function(a){if(this===E||null===this)throw TypeError();var b=Object(this),c=h(b.length);if(0===c)return-1;var d,e=0;if(arguments.length>0&&(d=Number(arguments[1]),d!==e?e=0:0!==d&&d!==1/0&&d!==-(1/0)&&(e=(d>0||-1)*I(H(d)))),e>=c)return-1;for(var f=e>=0?e:K(c-H(e),0);f<c;f++)if(b._getter(f)===a)return f;return-1}}),Object.defineProperty(k.prototype,"join",{value:function(a){if(this===E||null===this)throw TypeError();for(var b=Object(this),c=h(b.length),d=Array(c),e=0;e<c;++e)d[e]=b._getter(e);return d.join(a===E?",":a)}}),Object.defineProperty(k.prototype,"lastIndexOf",{value:function(a){if(this===E||null===this)throw TypeError();var b=Object(this),c=h(b.length);if(0===c)return-1;var d=c;arguments.length>1&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(d>0||-1)*I(H(d))));for(var e=d>=0?L(d,c-1):c-H(d);e>=0;e--)if(b._getter(e)===a)return e;return-1}}),Object.defineProperty(k.prototype,"map",{value:function(a){if(this===E||null===this)throw TypeError();var b=Object(this),c=h(b.length);if(!e(a))throw TypeError();var d=[];d.length=c;for(var f=arguments[1],g=0;g<c;g++)d[g]=a.call(f,b._getter(g),g,b);return new this.constructor(d)}}),Object.defineProperty(k.prototype,"reduce",{value:function(a){if(this===E||null===this)throw TypeError();var b=Object(this),c=h(b.length);if(!e(a))throw TypeError();if(0===c&&1===arguments.length)throw TypeError();var d,f=0;for(d=arguments.length>=2?arguments[1]:b._getter(f++);f<c;)d=a.call(E,d,b._getter(f),f,b),f++;return d}}),Object.defineProperty(k.prototype,"reduceRight",{value:function(a){if(this===E||null===this)throw TypeError();var b=Object(this),c=h(b.length);if(!e(a))throw TypeError();if(0===c&&1===arguments.length)throw TypeError();var d,f=c-1;for(d=arguments.length>=2?arguments[1]:b._getter(f--);f>=0;)d=a.call(E,d,b._getter(f),f,b),f--;return d}}),Object.defineProperty(k.prototype,"reverse",{value:function(){if(this===E||null===this)throw TypeError();for(var a=Object(this),b=h(a.length),c=I(b/2),d=0,e=b-1;d<c;++d,--e){var f=a._getter(d);a._setter(d,a._getter(e)),a._setter(e,f)}return a}}),Object.defineProperty(k.prototype,"set",{value:function(a,b){if(arguments.length<1)throw SyntaxError("Not enough arguments");var c,d,e,f,g,i,j,k,l,m;if("object"==typeof arguments[0]&&arguments[0].constructor===this.constructor){if(c=arguments[0],e=h(arguments[1]),e+c.length>this.length)throw RangeError("Offset plus length of array is out of range");if(k=this.byteOffset+e*this.BYTES_PER_ELEMENT,l=c.length*this.BYTES_PER_ELEMENT,c.buffer===this.buffer){for(m=[],g=0,i=c.byteOffset;g<l;g+=1,i+=1)m[g]=c.buffer._bytes[i];for(g=0,j=k;g<l;g+=1,j+=1)this.buffer._bytes[j]=m[g]}else for(g=0,i=c.byteOffset,j=k;g<l;g+=1,i+=1,j+=1)this.buffer._bytes[j]=c.buffer._bytes[i]}else{if("object"!=typeof arguments[0]||"undefined"==typeof arguments[0].length)throw TypeError("Unexpected argument type(s)");if(d=arguments[0],f=h(d.length),e=h(arguments[1]),e+f>this.length)throw RangeError("Offset plus length of array is out of range");for(g=0;g<f;g+=1)i=d[g],this._setter(e+g,Number(i))}}}),Object.defineProperty(k.prototype,"slice",{value:function(a,b){for(var c=f(this),d=c.length,e=h(d),i=g(a),j=i<0?K(e+i,0):L(i,e),k=b===E?e:g(b),l=k<0?K(e+k,0):L(k,e),m=l-j,n=c.constructor,o=new n(m),p=0;j<l;){var q=c._getter(j);o._setter(p,q),++j,++p}return o}}),Object.defineProperty(k.prototype,"some",{value:function(a){if(this===E||null===this)throw TypeError();var b=Object(this),c=h(b.length);if(!e(a))throw TypeError();for(var d=arguments[1],f=0;f<c;f++)if(a.call(d,b._getter(f),f,b))return!0;return!1}}),Object.defineProperty(k.prototype,"sort",{value:function(a){if(this===E||null===this)throw TypeError();for(var b=Object(this),c=h(b.length),d=Array(c),e=0;e<c;++e)d[e]=b._getter(e);for(a?d.sort(a):d.sort(),e=0;e<c;++e)b._setter(e,d[e]);return b}}),Object.defineProperty(k.prototype,"subarray",{value:function(a,b){function c(a,b,c){return a<b?b:a>c?c:a}a=g(a),b=g(b),arguments.length<1&&(a=0),arguments.length<2&&(b=this.length),a<0&&(a=this.length+a),b<0&&(b=this.length+b),a=c(a,0,this.length),b=c(b,0,this.length);var d=b-a;return d<0&&(d=0),new this.constructor(this.buffer,this.byteOffset+a*this.BYTES_PER_ELEMENT,d)}});var F=y(1,l,m),G=y(1,n,o),J=y(1,p,o),M=y(2,q,r),N=y(2,s,t),O=y(4,u,v),P=y(4,w,x),Q=y(4,D,C),R=y(8,B,A);a.Int8Array=b.Int8Array=a.Int8Array||F,a.Uint8Array=b.Uint8Array=a.Uint8Array||G,a.Uint8ClampedArray=b.Uint8ClampedArray=a.Uint8ClampedArray||J,a.Int16Array=b.Int16Array=a.Int16Array||M,a.Uint16Array=b.Uint16Array=a.Uint16Array||N,a.Int32Array=b.Int32Array=a.Int32Array||O,a.Uint32Array=b.Uint32Array=a.Uint32Array||P,a.Float32Array=b.Float32Array=a.Float32Array||Q,a.Float64Array=b.Float64Array=a.Float64Array||R}(),function(){function b(a,b){return e(a.get)?a.get(b):a[b]}function c(a,b,c){if(!(a instanceof ArrayBuffer||"ArrayBuffer"===d(a)))throw TypeError();if(b=h(b),b>a.byteLength)throw RangeError("byteOffset out of range");if(c=c===E?a.byteLength-b:h(c),b+c>a.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:a}),Object.defineProperty(this,"byteLength",{value:c}),Object.defineProperty(this,"byteOffset",{value:b})}function f(c){return function(d,e){if(d=h(d),d+c.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");d+=this.byteOffset;for(var f=new a.Uint8Array(this.buffer,d,c.BYTES_PER_ELEMENT),g=[],j=0;j<c.BYTES_PER_ELEMENT;j+=1)g.push(b(f,j));return Boolean(e)===Boolean(i)&&g.reverse(),b(new c(new a.Uint8Array(g).buffer),0)}}function g(c){return function(d,e,f){if(d=h(d),d+c.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");var g,j,k=new c([e]),l=new a.Uint8Array(k.buffer),m=[];for(g=0;g<c.BYTES_PER_ELEMENT;g+=1)m.push(b(l,g));Boolean(f)===Boolean(i)&&m.reverse(),j=new Uint8Array(this.buffer,d,c.BYTES_PER_ELEMENT),j.set(m)}}var i=function(){var c=new a.Uint16Array([4660]),d=new a.Uint8Array(c.buffer);return 18===b(d,0)}();Object.defineProperty(c.prototype,"getUint8",{value:f(a.Uint8Array)}),Object.defineProperty(c.prototype,"getInt8",{value:f(a.Int8Array)}),Object.defineProperty(c.prototype,"getUint16",{value:f(a.Uint16Array)}),Object.defineProperty(c.prototype,"getInt16",{value:f(a.Int16Array)}),Object.defineProperty(c.prototype,"getUint32",{value:f(a.Uint32Array)}),Object.defineProperty(c.prototype,"getInt32",{value:f(a.Int32Array)}),Object.defineProperty(c.prototype,"getFloat32",{value:f(a.Float32Array)}),Object.defineProperty(c.prototype,"getFloat64",{value:f(a.Float64Array)}),Object.defineProperty(c.prototype,"setUint8",{value:g(a.Uint8Array)}),Object.defineProperty(c.prototype,"setInt8",{value:g(a.Int8Array)}),Object.defineProperty(c.prototype,"setUint16",{value:g(a.Uint16Array)}),Object.defineProperty(c.prototype,"setInt16",{value:g(a.Int16Array)}),Object.defineProperty(c.prototype,"setUint32",{value:g(a.Uint32Array)}),Object.defineProperty(c.prototype,"setInt32",{value:g(a.Int32Array)}),Object.defineProperty(c.prototype,"setFloat32",{value:g(a.Float32Array)}),Object.defineProperty(c.prototype,"setFloat64",{value:g(a.Float64Array)}),a.DataView=a.DataView||c}()}(c,window),"window"in a&&("Uint8ClampedArray"in window||(window.Uint8ClampedArray=a.Uint8Array))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(a,b,c){function d(a,b){this.replacer=a,this.reviver=b,this.SERIALIZER_ID="json",this.BINARY=!1}function e(){this.SERIALIZER_ID="msgpack",this.BINARY=!0,this.codec=f.createCodec()}d.prototype.serialize=function(a){return JSON.stringify(a,this.replacer)},d.prototype.unserialize=function(a){return JSON.parse(a,this.reviver)},c.JSONSerializer=d;try{var f=a("msgpack-lite"),g=a("msgpack-lite/lib/write-type").type,h=a("msgpack-lite/lib/write-token").token,i=g.number;g.number=function(a,b){return Number.isInteger(b)&&b>2147483648&&b<=9007199254740991?h[207](a,b):i(a,b)},e.prototype.serialize=function(a){return f.encode(a,{codec:this.codec})},e.prototype.unserialize=function(a){return f.decode(a,{codec:this.codec})},e.prototype.registerExtType=function(a,b,c,d){c&&b&&this.codec.addExtPacker(a,b,c),d&&this.codec.addExtUnpacker(a,d)},c.MsgpackSerializer=e}catch(a){c.MsgpackSerializer=null}},{"msgpack-lite":58,"msgpack-lite/lib/write-token":61,"msgpack-lite/lib/write-type":62}],16:[function(a,b,c){(function(b){function d(){return Math.floor(9007199254740992*Math.random())}var e=(a("when"),a("when/function")),f=a("./log.js"),g=a("./util.js");Date.now=Date.now||function(){return+new Date};var h={caller:{features:{caller_identification:!0,progressive_call_results:!0}},callee:{features:{caller_identification:!0,pattern_based_registration:!0,shared_registration:!0,progressive_call_results:!0,registration_revocation:!0}},publisher:{features:{publisher_identification:!0,subscriber_blackwhite_listing:!0,publisher_exclusion:!0}},subscriber:{features:{publisher_identification:!0,pattern_based_subscription:!0,subscription_revocation:!0}}},i=function(a,b,c,d,e){var f=this;f.procedure=a,f.progress=b,f.caller=c,f.caller_authid=d,f.caller_authrole=e},j=function(a,b,c,d,e){var f=this;f.publication=a,f.topic=b,f.publisher=c,f.publisher_authid=d,f.publisher_authrole=e},k=function(a,b){var c=this;c.args=a||[],c.kwargs=b||{}},l=function(a,b,c){var d=this;d.error=a,d.args=b||[],d.kwargs=c||{}},m=function(a,b,c,d,e){var f=this;f.topic=a,f.handler=b,f.options=c||{},f.session=d,f.id=e,f.active=!0,f._on_unsubscribe=d._defer(),f._on_unsubscribe.promise.then?f.on_unsubscribe=f._on_unsubscribe.promise:f.on_unsubscribe=f._on_unsubscribe};m.prototype.unsubscribe=function(){var a=this;return a.session.unsubscribe(a)};var n=function(a,b,c,d,e){var f=this;f.procedure=a,f.endpoint=b,f.options=c||{},f.session=d,f.id=e,f.active=!0,f._on_unregister=d._defer(),f._on_unregister.promise.then?f.on_unregister=f._on_unregister.promise:f.on_unregister=f._on_unregister};n.prototype.unregister=function(){var a=this;return a.session.unregister(a)};var o=function(a){var b=this;b.id=a},p={HELLO:1,WELCOME:2,ABORT:3,CHALLENGE:4,AUTHENTICATE:5,GOODBYE:6,HEARTBEAT:7,ERROR:8,PUBLISH:16,PUBLISHED:17,SUBSCRIBE:32,SUBSCRIBED:33,UNSUBSCRIBE:34,UNSUBSCRIBED:35,EVENT:36,CALL:48,CANCEL:49,RESULT:50,REGISTER:64,REGISTERED:65,UNREGISTER:66,UNREGISTERED:67,INVOCATION:68,INTERRUPT:69,YIELD:70},q=function(a,c,d){var g=this;g._socket=a,g._defer=c,g._onchallenge=d,g._id=null,g._realm=null,g._features=null,g._goodbye_sent=!1,g._transport_is_closing=!1,g._publish_reqs={},g._subscribe_reqs={},g._unsubscribe_reqs={},g._call_reqs={},g._register_reqs={},g._unregister_reqs={},g._subscriptions={},g._registrations={},g._invocations={},g._prefixes={},g._caller_disclose_me=!1,g._publisher_disclose_me=!1,g._send_wamp=function(a){f.debug(a),g._socket.send(a)},g._protocol_violation=function(a){f.debug("failing transport due to protocol violation: "+a),g._socket.close(1002,"protocol violation: "+a)},g._MESSAGE_MAP={},g._MESSAGE_MAP[p.ERROR]={},g._process_SUBSCRIBED=function(a){var b=a[1],c=a[2];if(b in g._subscribe_reqs){var d=g._subscribe_reqs[b],e=d[0],f=d[1],h=d[2],i=d[3];c in g._subscriptions||(g._subscriptions[c]=[]);var j=new m(f,h,i,g,c);g._subscriptions[c].push(j),e.resolve(j),delete g._subscribe_reqs[b]}else g._protocol_violation("SUBSCRIBED received for non-pending request ID "+b)},g._MESSAGE_MAP[p.SUBSCRIBED]=g._process_SUBSCRIBED,g._process_SUBSCRIBE_ERROR=function(a){var b=a[2];if(b in g._subscribe_reqs){var c=(a[3],new l(a[4],a[5],a[6])),d=g._subscribe_reqs[b],e=d[0];e.reject(c),delete g._subscribe_reqs[b]}else g._protocol_violation("SUBSCRIBE-ERROR received for non-pending request ID "+b)},g._MESSAGE_MAP[p.ERROR][p.SUBSCRIBE]=g._process_SUBSCRIBE_ERROR,g._process_UNSUBSCRIBED=function(a){var b=a[1];if(b in g._unsubscribe_reqs){var c=g._unsubscribe_reqs[b],d=c[0],e=c[1];if(e in g._subscriptions){for(var f=g._subscriptions[e],h=0;h<f.length;++h)f[h].active=!1,f[h].on_unsubscribe.resolve();delete g._subscriptions[e]}d.resolve(!0),delete g._unsubscribe_reqs[b]}else if(0===b){var i=a[2],e=i.subscription,j=i.reason;if(e in g._subscriptions){for(var f=g._subscriptions[e],h=0;h<f.length;++h)f[h].active=!1,f[h]._on_unsubscribe.resolve(j);delete g._subscriptions[e]}else g._protocol_violation("non-voluntary UNSUBSCRIBED received for non-existing subscription ID "+e)}else g._protocol_violation("UNSUBSCRIBED received for non-pending request ID "+b)},g._MESSAGE_MAP[p.UNSUBSCRIBED]=g._process_UNSUBSCRIBED,g._process_UNSUBSCRIBE_ERROR=function(a){var b=a[2];if(b in g._unsubscribe_reqs){var c=(a[3],new l(a[4],a[5],a[6])),d=g._unsubscribe_reqs[b],e=d[0];d[1];e.reject(c),delete g._unsubscribe_reqs[b]}else g._protocol_violation("UNSUBSCRIBE-ERROR received for non-pending request ID "+b)},g._MESSAGE_MAP[p.ERROR][p.UNSUBSCRIBE]=g._process_UNSUBSCRIBE_ERROR,g._process_PUBLISHED=function(a){var b=a[1],c=a[2];if(b in g._publish_reqs){var d=g._publish_reqs[b],e=d[0],f=(d[1],new o(c));e.resolve(f),delete g._publish_reqs[b]}else g._protocol_violation("PUBLISHED received for non-pending request ID "+b)},g._MESSAGE_MAP[p.PUBLISHED]=g._process_PUBLISHED,g._process_PUBLISH_ERROR=function(a){var b=a[2];if(b in g._publish_reqs){var c=(a[3],new l(a[4],a[5],a[6])),d=g._publish_reqs[b],e=d[0];d[1];e.reject(c),delete g._publish_reqs[b]}else g._protocol_violation("PUBLISH-ERROR received for non-pending request ID "+b)},g._MESSAGE_MAP[p.ERROR][p.PUBLISH]=g._process_PUBLISH_ERROR,g._process_EVENT=function(a){var b=a[1];if(b in g._subscriptions)for(var c=a[2],d=a[3],e=a[4]||[],h=a[5]||{},i=g._subscriptions[b],k=new j(c,d.topic||i[0].topic,d.publisher,d.publisher_authid,d.publisher_authrole),l=0;l<i.length;++l)try{i[l].handler(e,h,k)}catch(a){f.debug("Exception raised in event handler",a)}else g._protocol_violation("EVENT received for non-subscribed subscription ID "+b)},g._MESSAGE_MAP[p.EVENT]=g._process_EVENT,g._process_REGISTERED=function(a){var b=a[1],c=a[2];if(b in g._register_reqs){var d=g._register_reqs[b],e=d[0],f=d[1],h=d[2],i=d[3],j=new n(f,h,i,g,c);g._registrations[c]=j,e.resolve(j),delete g._register_reqs[b]}else g._protocol_violation("REGISTERED received for non-pending request ID "+b)},g._MESSAGE_MAP[p.REGISTERED]=g._process_REGISTERED,g._process_REGISTER_ERROR=function(a){var b=a[2];if(b in g._register_reqs){var c=(a[3],new l(a[4],a[5],a[6])),d=g._register_reqs[b],e=d[0];e.reject(c),delete g._register_reqs[b]}else g._protocol_violation("REGISTER-ERROR received for non-pending request ID "+b)},g._MESSAGE_MAP[p.ERROR][p.REGISTER]=g._process_REGISTER_ERROR,g._process_UNREGISTERED=function(a){var b=a[1];if(b in g._unregister_reqs){var c=g._unregister_reqs[b],d=c[0],e=c[1];e.id in g._registrations&&delete g._registrations[e.id],e.active=!1,d.resolve(),delete g._unregister_reqs[b]}else if(0===b){var f=a[2],h=f.registration,i=f.reason;if(h in g._registrations){var e=g._registrations[h];e.active=!1,e._on_unregister.resolve(i),delete g._registrations[h]}else g._protocol_violation("non-voluntary UNREGISTERED received for non-existing registration ID "+h)}else g._protocol_violation("UNREGISTERED received for non-pending request ID "+b)},g._MESSAGE_MAP[p.UNREGISTERED]=g._process_UNREGISTERED,g._process_UNREGISTER_ERROR=function(a){var b=a[2];if(b in g._unregister_reqs){var c=(a[3],new l(a[4],a[5],a[6])),d=g._unregister_reqs[b],e=d[0];d[1];e.reject(c),delete g._unregister_reqs[b]}else g._protocol_violation("UNREGISTER-ERROR received for non-pending request ID "+b)},g._MESSAGE_MAP[p.ERROR][p.UNREGISTER]=g._process_UNREGISTER_ERROR,g._process_RESULT=function(a){var b=a[1];if(b in g._call_reqs){var c=a[2],d=a[3]||[],e=a[4]||{},f=null;d.length>1||Object.keys(e).length>0?f=new k(d,e):d.length>0&&(f=d[0]);var h=g._call_reqs[b],i=h[0],j=h[1];c.progress?j&&j.receive_progress&&i.notify(f):(i.resolve(f),delete g._call_reqs[b])}else g._protocol_violation("CALL-RESULT received for non-pending request ID "+b)},g._MESSAGE_MAP[p.RESULT]=g._process_RESULT,g._process_CALL_ERROR=function(a){var b=a[2];if(b in g._call_reqs){var c=(a[3],new l(a[4],a[5],a[6])),d=g._call_reqs[b],e=d[0];d[1];e.reject(c),delete g._call_reqs[b]}else g._protocol_violation("CALL-ERROR received for non-pending request ID "+b)},g._MESSAGE_MAP[p.ERROR][p.CALL]=g._process_CALL_ERROR,g._process_INVOCATION=function(a){var b=a[1],c=a[2],d=a[3];if(c in g._registrations){var f=g._registrations[c],h=a[4]||[],j=a[5]||{},m=null;d.receive_progress&&(m=function(a,c){var d=[p.YIELD,b,{progress:!0}];a=a||[],c=c||{};var e=Object.keys(c).length;(a.length||e)&&(d.push(a),e&&d.push(c)),g._send_wamp(d)});var n=new i(d.procedure||f.procedure,m,d.caller,d.caller_authid,d.caller_authrole);e.call(f.endpoint,h,j,n).then(function(a){var c=[p.YIELD,b,{}];if(a instanceof k){var d=Object.keys(a.kwargs).length;(a.args.length||d)&&(c.push(a.args),d&&c.push(a.kwargs))}else c.push([a]);g._send_wamp(c)},function(a){var c=[p.ERROR,p.INVOCATION,b,{}];if(a instanceof l){c.push(a.error);var d=Object.keys(a.kwargs).length;(a.args.length||d)&&(c.push(a.args),d&&c.push(a.kwargs))}else c.push("wamp.error.runtime_error"),c.push([a]);g._send_wamp(c)})}else g._protocol_violation("INVOCATION received for non-registered registration ID "+b)},g._MESSAGE_MAP[p.INVOCATION]=g._process_INVOCATION,g._socket.onmessage=function(a){var b=a[0];if(g._id)if(b===p.GOODBYE){if(!g._goodbye_sent){var c=[p.GOODBYE,{},"wamp.error.goodbye_and_out"];g._send_wamp(c)}g._id=null,g._realm=null,g._features=null;var d=a[1],i=a[2];g.onleave&&g.onleave(i,d)}else if(b===p.ERROR){var j=a[1];j in g._MESSAGE_MAP[p.ERROR]?g._MESSAGE_MAP[b][j](a):g._protocol_violation("unexpected ERROR message with request_type "+j)}else b in g._MESSAGE_MAP?g._MESSAGE_MAP[b](a):g._protocol_violation("unexpected message type "+b);else if(b===p.WELCOME){g._id=a[1];var k=a[2];if(g._features={},k.roles.broker&&(g._features.subscriber={},g._features.publisher={},k.roles.broker.features)){for(var l in h.publisher.features)g._features.publisher[l]=h.publisher.features[l]&&k.roles.broker.features[l];for(var l in h.subscriber.features)g._features.subscriber[l]=h.subscriber.features[l]&&k.roles.broker.features[l]}if(k.roles.dealer&&(g._features.caller={},g._features.callee={},k.roles.dealer.features)){for(var l in h.caller.features)g._features.caller[l]=h.caller.features[l]&&k.roles.dealer.features[l];for(var l in h.callee.features)g._features.callee[l]=h.callee.features[l]&&k.roles.dealer.features[l]}g.onjoin&&g.onjoin(a[2])}else if(b===p.ABORT){var d=a[1],i=a[2];g.onleave&&g.onleave(i,d)}else if(b===p.CHALLENGE)if(g._onchallenge){var m=a[1],n=a[2];e.call(g._onchallenge,g,m,n).then(function(a){var b=[p.AUTHENTICATE,a,{}];g._send_wamp(b)},function(a){f.debug("onchallenge() raised:",a);var b=[p.ABORT,{message:"sorry, I cannot authenticate (onchallenge handler raised an exception)"},"wamp.error.cannot_authenticate"];g._send_wamp(b),g._socket.close(1e3)})}else{f.debug("received WAMP challenge, but no onchallenge() handler set");var a=[p.ABORT,{message:"sorry, I cannot authenticate (no onchallenge handler set)"},"wamp.error.cannot_authenticate"];g._send_wamp(a),g._socket.close(1e3)}else g._protocol_violation("unexpected message type "+b)},"performance"in b&&"now"in performance?g._created=performance.now():g._created=Date.now()};Object.defineProperty(q.prototype,"defer",{get:function(){return this._defer}}),Object.defineProperty(q.prototype,"id",{get:function(){return this._id}}),Object.defineProperty(q.prototype,"realm",{get:function(){return this._realm}}),Object.defineProperty(q.prototype,"isOpen",{get:function(){return null!==this.id}}),Object.defineProperty(q.prototype,"features",{get:function(){return this._features}}),Object.defineProperty(q.prototype,"caller_disclose_me",{get:function(){return this._caller_disclose_me},set:function(a){this._caller_disclose_me=a}}),Object.defineProperty(q.prototype,"publisher_disclose_me",{get:function(){return this._publisher_disclose_me},set:function(a){this._publisher_disclose_me=a}}),Object.defineProperty(q.prototype,"subscriptions",{get:function(){for(var a=Object.keys(this._subscriptions),b=[],c=0;c<a.length;++c)b.push(this._subscriptions[a[c]]);return b}}),Object.defineProperty(q.prototype,"registrations",{get:function(){for(var a=Object.keys(this._registrations),b=[],c=0;c<a.length;++c)b.push(this._registrations[a[c]]);return b}}),q.prototype.log=function(){var a=this;if("console"in b){var c=null;if(a._id&&a._created){var d=null;d="performance"in b&&"now"in performance?performance.now()-a._created:Date.now()-a._created,c="WAMP session "+a._id+" on '"+a._realm+"' at "+Math.round(1e3*d)/1e3+" ms"}else c="WAMP session";if("group"in console){console.group(c);for(var e=0;e<arguments.length;e+=1)console.log(arguments[e]);console.groupEnd()}else{for(var f=[c+": "],e=0;e<arguments.length;e+=1)f.push(arguments[e]);console.log.apply(console,f)}}},q.prototype.join=function(a,b,c){g.assert("string"==typeof a,"Session.join: <realm> must be a string"),g.assert(!b||Array.isArray(b),"Session.join: <authmethods> must be an array []"),g.assert(!c||"string"==typeof c,"Session.join: <authid> must be a string");
var d=this;if(d.isOpen)throw"session already open";d._goodbye_sent=!1,d._realm=a;var e={};e.roles=h,b&&(e.authmethods=b),c&&(e.authid=c);var f=[p.HELLO,a,e];d._send_wamp(f)},q.prototype.leave=function(a,b){g.assert(!a||"string"==typeof a,"Session.leave: <reason> must be a string"),g.assert(!b||"string"==typeof b,"Session.leave: <message> must be a string");var c=this;if(!c.isOpen)throw"session not open";a||(a="wamp.close.normal");var d={};b&&(d.message=b);var e=[p.GOODBYE,d,a];c._send_wamp(e),c._goodbye_sent=!0},q.prototype.call=function(a,b,c,e){g.assert("string"==typeof a,"Session.call: <procedure> must be a string"),g.assert(!b||Array.isArray(b),"Session.call: <args> must be an array []"),g.assert(!c||c instanceof Object,"Session.call: <kwargs> must be an object {}"),g.assert(!e||e instanceof Object,"Session.call: <options> must be an object {}");var f=this;if(!f.isOpen)throw"session not open";e=e||{},void 0===e.disclose_me&&f._caller_disclose_me&&(e.disclose_me=!0);var h=f._defer(),i=d();f._call_reqs[i]=[h,e];var j=[p.CALL,i,e,f.resolve(a)];return b?(j.push(b),c&&j.push(c)):c&&(j.push([]),j.push(c)),f._send_wamp(j),h.promise.then?h.promise:h},q.prototype.publish=function(a,b,c,e){g.assert("string"==typeof a,"Session.publish: <topic> must be a string"),g.assert(!b||Array.isArray(b),"Session.publish: <args> must be an array []"),g.assert(!c||c instanceof Object,"Session.publish: <kwargs> must be an object {}"),g.assert(!e||e instanceof Object,"Session.publish: <options> must be an object {}");var f=this;if(!f.isOpen)throw"session not open";e=e||{},void 0===e.disclose_me&&f._publisher_disclose_me&&(e.disclose_me=!0);var h=null,i=d();e.acknowledge&&(h=f._defer(),f._publish_reqs[i]=[h,e]);var j=[p.PUBLISH,i,e,f.resolve(a)];if(b?(j.push(b),c&&j.push(c)):c&&(j.push([]),j.push(c)),f._send_wamp(j),h)return h.promise.then?h.promise:h},q.prototype.subscribe=function(a,b,c){g.assert("string"==typeof a,"Session.subscribe: <topic> must be a string"),g.assert("function"==typeof b,"Session.subscribe: <handler> must be a function"),g.assert(!c||c instanceof Object,"Session.subscribe: <options> must be an object {}");var e=this;if(!e.isOpen)throw"session not open";var f=d(),h=e._defer();e._subscribe_reqs[f]=[h,a,b,c];var i=[p.SUBSCRIBE,f];return c?i.push(c):i.push({}),i.push(e.resolve(a)),e._send_wamp(i),h.promise.then?h.promise:h},q.prototype.register=function(a,b,c){g.assert("string"==typeof a,"Session.register: <procedure> must be a string"),g.assert("function"==typeof b,"Session.register: <endpoint> must be a function"),g.assert(!c||c instanceof Object,"Session.register: <options> must be an object {}");var e=this;if(!e.isOpen)throw"session not open";var f=d(),h=e._defer();e._register_reqs[f]=[h,a,b,c];var i=[p.REGISTER,f];return c?i.push(c):i.push({}),i.push(e.resolve(a)),e._send_wamp(i),h.promise.then?h.promise:h},q.prototype.unsubscribe=function(a){g.assert(a instanceof m,"Session.unsubscribe: <subscription> must be an instance of class autobahn.Subscription");var b=this;if(!b.isOpen)throw"session not open";if(!(a.active&&a.id in b._subscriptions))throw"subscription not active";var c=b._subscriptions[a.id],e=c.indexOf(a);if(e===-1)throw"subscription not active";c.splice(e,1),a.active=!1;var f=b._defer();if(c.length)f.resolve(!1);else{var h=d();b._unsubscribe_reqs[h]=[f,a.id];var i=[p.UNSUBSCRIBE,h,a.id];b._send_wamp(i)}return f.promise.then?f.promise:f},q.prototype.unregister=function(a){g.assert(a instanceof n,"Session.unregister: <registration> must be an instance of class autobahn.Registration");var b=this;if(!b.isOpen)throw"session not open";if(!(a.active&&a.id in b._registrations))throw"registration not active";var c=d(),e=b._defer();b._unregister_reqs[c]=[e,a];var f=[p.UNREGISTER,c,a.id];return b._send_wamp(f),e.promise.then?e.promise:e},q.prototype.prefix=function(a,b){g.assert("string"==typeof a,"Session.prefix: <prefix> must be a string"),g.assert(!b||"string"==typeof b,"Session.prefix: <uri> must be a string or falsy");var c=this;b?c._prefixes[a]=b:a in c._prefixes&&delete c._prefixes[a]},q.prototype.resolve=function(a){g.assert("string"==typeof a,"Session.resolve: <curie> must be a string");var b=this,c=a.indexOf(":");if(c>=0){var d=a.substring(0,c);if(d in b._prefixes)return b._prefixes[d]+"."+a.substring(c+1);throw"cannot resolve CURIE prefix '"+d+"'"}return a},c.Session=q,c.Invocation=i,c.Event=j,c.Result=k,c.Error=l,c.Subscription=m,c.Registration=n,c.Publication=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./log.js":6,"./util.js":20,when:93,"when/function":69}],17:[function(a,b,c){function d(a){var b=this;e.assert(void 0!==a.url,"options.url missing"),e.assert("string"==typeof a.url,"options.url must be a string"),b._options=a}var e=a("../util.js"),f=a("../log.js");a("when");d.prototype.type="longpoll",d.prototype.create=function(){var a=this;f.debug("longpoll.Factory.create");var b={};return b.protocol=void 0,b.send=void 0,b.close=void 0,b.onmessage=function(){},b.onopen=function(){},b.onclose=function(){},b.info={type:"longpoll",url:null,protocol:"wamp.2.json"},b._run=function(){var c=null,d=!1,g=0,h=0,i={protocols:["wamp.2.json"]},j=a._options.request_timeout||12e3;e.http_post(a._options.url+"/open",JSON.stringify(i),j).then(function(i){function k(){h+=1,f.debug("longpoll.Transport: polling for message ..."),e.http_post(l+"/receive",null,j).then(function(a){if(a){var c=JSON.parse(a);f.debug("longpoll.Transport: message received",c),b.onmessage(c)}d||k()},function(a){f.debug("longpoll.Transport: could not receive message",a.code,a.text),d=!0;var c={code:1001,reason:"transport receive failure (HTTP/POST status "+a.code+" - '"+a.text+"')",wasClean:!1};b.onclose(c)})}c=JSON.parse(i);var l=a._options.url+"/"+c.transport;b.info.url=l,f.debug("longpoll.Transport: open",c),b.close=function(a,c){if(d)throw"transport is already closing";d=!0,e.http_post(l+"/close",null,j).then(function(){f.debug("longpoll.Transport: transport closed");var a={code:1e3,reason:"transport closed",wasClean:!0};b.onclose(a)},function(a){f.debug("longpoll.Transport: could not close transport",a.code,a.text)})},b.send=function(a){if(d)throw"transport is closing or closed already";g+=1,f.debug("longpoll.Transport: sending message ...",a);var c=JSON.stringify(a);e.http_post(l+"/send",c,j).then(function(){f.debug("longpoll.Transport: message sent")},function(a){f.debug("longpoll.Transport: could not send message",a.code,a.text),d=!0;var c={code:1001,reason:"transport send failure (HTTP/POST status "+a.code+" - '"+a.text+"')",wasClean:!1};b.onclose(c)})},k(),b.onopen()},function(a){f.debug("longpoll.Transport: could not open transport",a.code,a.text),d=!0;var c={code:1001,reason:"transport open failure (HTTP/POST status "+a.code+" - '"+a.text+"')",wasClean:!1};b.onclose(c)})},b._run(),b},c.Factory=d},{"../log.js":6,"../util.js":20,when:93}],18:[function(a,b,c){(function(b,d){function e(a){var b=this;a.protocols?g.assert(Array.isArray(a.protocols),"options.protocols must be an array"):a.protocols=["wamp.2.json"],a.rawsocket_max_len_exp=a.rawsocket_max_len_exp||24,b._options=a}function f(a,b){this._options={_peer_serializer:null,_peer_max_len_exp:0},this._options=g.defaults(this._options,b,this.DEFAULT_OPTIONS),g.assert(this._options.serializer in this.SERIALIZERS,"Unsupported serializer: "+this._options.serializer),g.assert(this._options.max_len_exp>=9&&this._options.max_len_exp<=36,"Message length out of bounds [9, 36]: "+this._options.max_len_exp),g.assert(!this._options.autoping||Number.isInteger(this._options.autoping)&&this._options.autoping>=0,"Autoping interval must be positive"),g.assert(!this._options.ping_timeout||Number.isInteger(this._options.ping_timeout)&&this._options.ping_timeout>=0,"Ping timeout duration must be positive"),g.assert(!this._options.packet_timeout||Number.isInteger(this._options.packet_timeout)&&this._options.packet_timeout>=0,"Packet timeout duration must be positive"),g.assert(!this._options.autoping||!this._options.ping_timeout||this._options.autoping>this._options.ping_timeout,"Autoping interval ("+this._options.autoping+") must be lower than ping timeout ("+this._options.ping_timeout+")"),this._ping_timeout=null,this._ping_payload=null,this._ping_interval=null,this._status=this.STATUS.UNINITIATED,this._stream=a,this._emitter=new i,this._buffer=new d(4),this._bufferLen=0,this._msgLen=0;var c=this;this._stream.on("data",function(a){c._read(a)}),this._stream.on("connect",function(){c._handshake()});var e=["close","drain","end","error","timeout"];e.forEach(function(a){c._stream.on(a,function(b){c._emitter.emit(a,b)})})}var g=a("../util.js"),h=a("../log.js"),i=a("events").EventEmitter;e.prototype.type="rawsocket",e.prototype.create=function(){var c=this,d={};if(d.protocol=void 0,d.send=void 0,d.close=void 0,d.onmessage=function(){},d.onopen=function(){},d.onclose=function(){},d.info={type:"rawsocket",url:null,protocol:"wamp.2.json"},!b.process||!b.process.versions.node)throw"No RawSocket support in browser";return!function(){var b,e,g=a("net");if(c._options.path)connectionOptions={path:c._options.path,allowHalfOpen:!0};else{if(!c._options.port)throw"You must specify a host/port combination or a unix socket path to connect to";connectionOptions={port:c._options.port||8e3,host:c._options.host||"localhost",allowHalfOpen:!0}}b=g.connect(connectionOptions),e=new f(b,{serializer:"json",max_len_exp:c._options.rawsocket_max_len_exp}),e.on("connect",function(a){h.debug("RawSocket transport negociated"),d.onopen(a)}),e.on("data",function(a){h.debug("RawSocket transport received",a),d.onmessage(a)}),e.on("close",function(a){h.debug("RawSocket transport closed"),d.onclose({code:999,reason:"",wasClean:!a})}),e.on("error",function(a){h.debug("RawSocket transport error",a)}),d.close=function(a,b){h.debug("RawSocket transport closing",a,b),e.close()},d.send=function(a){h.debug("RawSocket transport sending",a),e.write(a)}}(),d},f.prototype._MAGIC_BYTE=127,f.prototype.SERIALIZERS={json:1},f.prototype.STATUS={CLOSED:-1,UNINITIATED:0,NEGOCIATING:1,NEGOCIATED:2,RXHEAD:3,RXDATA:4,RXPING:5,RXPONG:6},f.prototype.ERRORS={0:"illegal (must not be used)",1:"serializer unsupported",2:"maximum message length unacceptable",3:"use of reserved bits (unsupported feature)",4:"maximum connection count reached"},f.prototype.MSGTYPES={WAMP:0,PING:1,PONG:2},f.prototype.DEFAULT_OPTIONS={fail_on_ping_timeout:!0,strict_pong:!0,ping_timeout:2e3,autoping:0,max_len_exp:24,serializer:"json",packet_timeout:2e3},f.prototype.close=function(){return this._status=this.STATUS.CLOSED,this._stream.end(),this.STATUS.CLOSED},f.prototype.write=function(a,b,c){b=void 0===b?0:b,b===this.MSGTYPES.WAMP&&(a=JSON.stringify(a));var e=d.byteLength(a,"utf8");if(e>Math.pow(2,this._options._peer_max_len_exp))return void this._emitter.emit("error",new j("Frame too big"));var f=new d(e+4);f.writeUInt8(b,0),f.writeUIntBE(e,1,3),f.write(a,4),this._stream.write(f,c)},f.prototype.ping=function(a){if(a=a||255,Number.isInteger(a))for(var b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&~\"#'{([-|`_\\^@)]=},?;.:/!*$<>",c=Math.max(1,a),d=0;d<c;d++)a+=b.charAt(Math.random()*b.length|0);return this._ping_payload=a,this.write(a,this.MSGTYPES.PING,this._setupPingTimeout.bind(this))},f.prototype._setupPingTimeout=function(){this._options.ping_timeout&&(this._ping_timeout=setTimeout(this._onPingTimeout.bind(this),this._options.ping_timeout))},f.prototype._clearPingTimeout=function(){this._ping_timeout&&(clearTimeout(this._ping_timeout),this._ping_timeout=null)},f.prototype._setupAutoPing=function(){this._clearAutoPing(),this._options.autoping&&(this._autoping_interval=setInterval(this.ping.bind(this),this._options.autoping))},f.prototype._clearAutoPing=function(){this._autoping_interval&&(clearInterval(this._autoping_interval),this._autoping_interval=null)},f.prototype._onPingTimeout=function(){this._emitter.emit("error",new j("PING timeout")),this._options.fail_on_ping_timeout&&this.close()},f.prototype._read=function(a){var b,c;switch(this._status){case this.STATUS.CLOSED:case this.STATUS.UNINITIATED:this._emitter.emit("error",j("Unexpected packet"));break;case this.STATUS.NEGOCIATING:b=this._handleHandshake,c=4;break;case this.STATUS.NEGOCIATED:case this.STATUS.RXHEAD:this._status=this.STATUS.RXHEAD,b=this._handleHeaderPacket,c=4;break;case this.STATUS.RXDATA:b=this._handleDataPacket,c=this._msgLen;break;case this.STATUS.RXPING:b=this._handlePingPacket,c=this._msgLen;break;case this.STATUS.RXPONG:b=this._handlePongPacket,c=this._msgLen}var d=this._splitBytes(a,c);d&&(this._status=b.call(this,d[0]),d[1].length>0&&this._read(d[1]))},f.prototype._handshake=function(){if(this._status!==this.STATUS.UNINITIATED)throw"Handshake packet already sent";var a=new d(4);a.writeUInt8(this._MAGIC_BYTE,0),a.writeUInt8(this._options.max_len_exp-9<<4|this.SERIALIZERS[this._options.serializer],1),a.writeUInt8(0,2),a.writeUInt8(0,3),this._stream.write(a),this._status=this.STATUS.NEGOCIATING},f.prototype._splitBytes=function(a,b){if(b!==this._buffer.length&&(this._buffer=new d(b),this._bufferLen=0),a.copy(this._buffer,this._bufferLen),this._bufferLen+a.length<b)return this._bufferLen+=a.length,null;var c=this._buffer.slice(),e=a.slice(b-this._bufferLen);return this._bufferLen=0,[c,e]},f.prototype._handleHandshake=function(a){if(a[0]!==this._MAGIC_BYTE)return this._emitter.emit("error",new j("Invalid magic byte. Expected 0x"+this._MAGIC_BYTE.toString(16)+", got 0x"+a[0].toString(16))),this.close();if(0===(15&a[1])){var b=a[1]>>4;return this._emitter.emit("error",new j("Peer failed handshake: "+(this.ERRORS[b]||"0x"+b.toString(16)))),this.close()}return this._options._peer_max_len_exp=(a[1]>>4)+9,this._options._peer_serializer=15&a[1],this._options._peer_serializer!==this.SERIALIZERS.json?(this._emitter.emit("error",new j("Unsupported serializer: 0x"+this._options._peer_serializer.toString(16))),this.close()):(this._emitter.emit("connect"),this._setupAutoPing(),this.STATUS.NEGOCIATED)},f.prototype._handleHeaderPacket=function(a){var b=15&a[0];switch(this._msgLen=a.readUIntBE(1,3),b){case this.MSGTYPES.WAMP:return this.STATUS.RXDATA;case this.MSGTYPES.PING:return this.STATUS.RXPING;case this.MSGTYPES.PONG:return this.STATUS.RXPONG;default:return this._emitter.emit("error",new j("Invalid frame type: 0x"+b.toString(16))),this.close()}},f.prototype._handleDataPacket=function(a){var b;try{b=JSON.parse(a.toString("utf8"))}catch(a){return this._emitter.emit("error",new j("Invalid JSON frame")),this.STATUS.RXHEAD}return this._emitter.emit("data",b),this.STATUS.RXHEAD},f.prototype._handlePingPacket=function(a){return this.write(a.toString("utf8"),this.MSGTYPES.PONG),this.STATUS.RXHEAD},f.prototype._handlePongPacket=function(a){return this._clearPingTimeout(),this._options.strict_pong&&this._ping_payload!==a.toString("utf8")?(this._emitter.emit("error",new j("PONG response payload doesn't match PING.")),this.close()):this.STATUS.RXHEAD},f.prototype.on=function(a,b){return this._emitter.on(a,b)},f.prototype.once=function(a,b){return this._emitter.once(a,b)},f.prototype.removeListener=function(a,b){return this._emitter.removeListener(a,b)};var j=c.ProtocolError=function(a){Error.apply(this,Array.prototype.splice.call(arguments)),Error.captureStackTrace(this,this.constructor),this.message=a,this.name="ProtocolError"};j.prototype=Object.create(Error.prototype),c.Factory=e,c.Protocol=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer)},{"../log.js":6,"../util.js":20,buffer:128,events:324,net:112}],19:[function(a,b,c){(function(b){function d(a){var b=this;e.assert(void 0!==a.url,"options.url missing"),e.assert("string"==typeof a.url,"options.url must be a string"),a.serializers?e.assert(Array.isArray(a.serializers),"options.serializers must be an array"):(a.serializers=[new g.JSONSerializer],g.MsgpackSerializer&&a.serializers.push(new g.MsgpackSerializer)),a.protocols?e.assert(Array.isArray(a.protocols),"options.protocols must be an array"):(a.protocols=[],a.serializers.forEach(function(b){a.protocols.push("wamp.2."+b.SERIALIZER_ID)})),b._options=a}var e=a("../util.js"),f=a("../log.js"),g=a("../serializer.js");d.prototype.type="websocket",d.prototype.create=function(){var c=this,d={};return d.protocol=void 0,d.serializer=void 0,d.send=void 0,d.close=void 0,d.onmessage=function(){},d.onopen=function(){},d.onclose=function(){},d.info={type:"websocket",url:c._options.url,protocol:null},b.process&&b.process.versions.node?!function(){var b,e,f=a("ws");c._options.protocols?(e=c._options.protocols,Array.isArray(e)&&(e=e.join(",")),b=new f(c._options.url,{protocol:e})):b=new f(c._options.url),d.send=function(a){var c=d.serializer.serialize(a);b.send(c,{binary:d.serializer.BINARY})},d.close=function(a,c){b.close()},b.on("open",function(){var a=b.protocol.split(".")[2];for(var e in c._options.serializers){var f=c._options.serializers[e];if(f.SERIALIZER_ID==a){d.serializer=f;break}}d.info.protocol=b.protocol,d.onopen()}),b.on("message",function(a,b){var c=d.serializer.unserialize(a);d.onmessage(c)}),b.on("close",function(a,b){var c={code:a,reason:b,wasClean:1e3===a};d.onclose(c)}),b.on("error",function(a){var b={code:1006,reason:"",wasClean:!1};d.onclose(b)})}():!function(){var a;if("WebSocket"in b)a=c._options.protocols?new b.WebSocket(c._options.url,c._options.protocols):new b.WebSocket(c._options.url),a.binaryType="arraybuffer";else{if(!("MozWebSocket"in b))throw"browser does not support WebSocket or WebSocket in Web workers";a=c._options.protocols?new b.MozWebSocket(c._options.url,c._options.protocols):new b.MozWebSocket(c._options.url)}a.onmessage=function(a){f.debug("WebSocket transport receive",a.data);var b=d.serializer.unserialize(a.data);d.onmessage(b)},a.onopen=function(){var b=a.protocol.split(".")[2];for(var e in c._options.serializers){var f=c._options.serializers[e];if(f.SERIALIZER_ID==b){d.serializer=f;break}}d.info.protocol=a.protocol,d.onopen()},a.onclose=function(a){var b={code:a.code,reason:a.message,wasClean:a.wasClean};d.onclose(b)},d.send=function(b){var c=d.serializer.serialize(b);f.debug("WebSocket transport send",c),a.send(c)},d.close=function(b,c){a.close(b,c)}}(),d},c.Factory=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../log.js":6,"../serializer.js":15,"../util.js":20,ws:94}],20:[function(a,b,c){(function(b){var d=a("./log.js"),e=a("when"),f=function(a,b){var c,d,e;do c=2*Math.random()-1,d=2*Math.random()-1,e=c*c+d*d;while(e>=1||0==e);var f=Math.sqrt(-2*Math.log(e)/e);return(a||0)+c*f*(b||1)},g=function(a,c){if(!a)throw g.useDebugger||"AUTOBAHN_DEBUG"in b&&AUTOBAHN_DEBUG,new Error(c||"Assertion failed!")},h=function(a,b,c){d.debug("new http_post request",a,b,c);var f=e.defer(),g=new XMLHttpRequest;return g.onreadystatechange=function(){if(4===g.readyState){var a=1223===g.status?204:g.status;if(200===a&&f.resolve(g.responseText),204===a)f.resolve();else{var b=null;try{b=g.statusText}catch(a){}f.reject({code:a,text:b})}}},g.open("POST",a,!0),g.setRequestHeader("Content-type","application/json; charset=utf-8"),c>0&&(g.timeout=c,g.ontimeout=function(){f.reject({code:501,text:"request timeout"})}),b?g.send(b):g.send(),f.promise.then?f.promise:f},i=function(){if(0===arguments.length)return{};var a=arguments[0],b=!1,c=arguments.length;"boolean"==typeof arguments[c-1]&&(b=arguments[c-1],c-=1);for(var d=(function(c){var d=f[c];c in a?b&&"object"==typeof d&&"object"==typeof a[c]&&i(a[c],d):a[c]=d}),e=1;e<c;e++){var f=arguments[e];if(f){if("object"!=typeof f)throw new Error("Expected argument at index "+e+" to be an object");Object.keys(f).forEach(d)}}return a};c.rand_normal=f,c.assert=g,c.http_post=h,c.defaults=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./log.js":6,when:93}],21:[function(a,b,c){"use strict";b.exports.BufferUtil={merge:function(a,b){for(var c=0,d=0,e=b.length;c<e;++c){var f=b[c];f.copy(a,d),d+=f.length}},mask:function(a,b,c,d,e){for(var f,g=b.readUInt32LE(0,!0),h=0;h<e-3;h+=4)f=g^a.readUInt32LE(h,!0),f<0&&(f=4294967296+f),c.writeUInt32LE(f,d+h,!0);switch(e%4){case 3:c[d+h+2]=a[h+2]^b[2];case 2:c[d+h+1]=a[h+1]^b[1];case 1:c[d+h]=a[h]^b[0]}},unmask:function(a,b){for(var c,d=b.readUInt32LE(0,!0),e=a.length,f=0;f<e-3;f+=4)c=d^a.readUInt32LE(f,!0),c<0&&(c=4294967296+c),a.writeUInt32LE(c,f,!0);switch(e%4){case 3:a[f+2]=a[f+2]^b[2];case 2:a[f+1]=a[f+1]^b[1];case 1:a[f]=a[f]^b[0]}}}},{}],22:[function(a,b,c){"use strict";try{b.exports=a("bindings")("bufferutil")}catch(c){b.exports=a("./fallback")}},{"./fallback":21,bindings:23}],23:[function(a,b,c){(function(d,e){function f(b){"string"==typeof b?b={bindings:b}:b||(b={}),b.__proto__=l,b.module_root||(b.module_root=c.getRoot(c.getFileName())),".node"!=h.extname(b.bindings)&&(b.bindings+=".node");for(var d,e,f,g=[],j=0,k=b.try.length;j<k;j++){d=i.apply(null,b.try[j].map(function(a){return b[a]||a})),g.push(d);try{return e=b.path?a.resolve(d):a(d),b.path||(e.path=d),e}catch(a){if(!/not find/i.test(a.message))throw a}}throw f=new Error("Could not locate the bindings file. Tried:\n"+g.map(function(a){return b.arrow+a}).join("\n")),f.tries=g,f}var g=a("fs"),h=a("path"),i=h.join,j=h.dirname,k=g.existsSync||h.existsSync,l={arrow:d.env.NODE_BINDINGS_ARROW||" → ",compiled:d.env.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:d.platform,arch:d.arch,version:d.versions.node,bindings:"bindings.node",try:[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"]]};b.exports=c=f,c.getFileName=function(a){var b,c=Error.prepareStackTrace,d=Error.stackTraceLimit,f={};return Error.stackTraceLimit=10,Error.prepareStackTrace=function(c,d){for(var f=0,g=d.length;f<g;f++)if(b=d[f].getFileName(),b!==e){if(!a)return;if(b!==a)return}},Error.captureStackTrace(f),f.stack,Error.prepareStackTrace=c,Error.stackTraceLimit=d,b},c.getRoot=function(a){for(var b,c=j(a);;){if("."===c&&(c=d.cwd()),k(i(c,"package.json"))||k(i(c,"node_modules")))return c;if(b===c)throw new Error('Could not find module root given file: "'+a+'". Do you have a `package.json` file? ');b=c,c=i(c,"..")}}}).call(this,a("_process"),"/package/node_modules/bufferutil/node_modules/bindings/bindings.js")},{_process:329,fs:112,path:328}],24:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./enc-base64"),a("./md5"),a("./evpkdf"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return function(){var b=a,c=b.lib,d=c.BlockCipher,e=b.algo,f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[];!function(){for(var a=[],b=0;b<256;b++)b<128?a[b]=b<<1:a[b]=b<<1^283;for(var c=0,d=0,b=0;b<256;b++){var e=d^d<<1^d<<2^d<<3^d<<4;e=e>>>8^255&e^99,f[c]=e,g[e]=c;var p=a[c],q=a[p],r=a[q],s=257*a[e]^16843008*e;h[c]=s<<24|s>>>8,i[c]=s<<16|s>>>16,j[c]=s<<8|s>>>24,k[c]=s;var s=16843009*r^65537*q^257*p^16843008*c;l[e]=s<<24|s>>>8,m[e]=s<<16|s>>>16,n[e]=s<<8|s>>>24,o[e]=s,c?(c=p^a[a[a[r^p]]],d^=a[a[d]]):c=d=1}}();var p=[0,1,2,4,8,16,32,64,128,27,54],q=e.AES=d.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,d=this._nRounds=c+6,e=4*(d+1),g=this._keySchedule=[],h=0;h<e;h++)if(h<c)g[h]=b[h];else{var i=g[h-1];h%c?c>6&&h%c==4&&(i=f[i>>>24]<<24|f[i>>>16&255]<<16|f[i>>>8&255]<<8|f[255&i]):(i=i<<8|i>>>24,i=f[i>>>24]<<24|f[i>>>16&255]<<16|f[i>>>8&255]<<8|f[255&i],i^=p[h/c|0]<<24),g[h]=g[h-c]^i}for(var j=this._invKeySchedule=[],k=0;k<e;k++){var h=e-k;if(k%4)var i=g[h];else var i=g[h-4];k<4||h<=4?j[k]=i:j[k]=l[f[i>>>24]]^m[f[i>>>16&255]]^n[f[i>>>8&255]]^o[f[255&i]]}},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,h,i,j,k,f)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,l,m,n,o,g);var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;o<i;o++){var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],s=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++];j=p,k=q,l=r,m=s}var p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],s=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++];a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=s},keySize:8});b.AES=d._createHelper(q)}(),a.AES})},{"./cipher-core":25,"./core":26,"./enc-base64":27,"./evpkdf":29,"./md5":34}],25:[function(a,b,c){!function(d,e){"object"==typeof c?b.exports=c=e(a("./core")):"function"==typeof define&&define.amd?define(["./core"],e):e(d.CryptoJS)}(this,function(a){a.lib.Cipher||function(b){var c=a,d=c.lib,e=d.Base,f=d.WordArray,g=d.BufferedBlockAlgorithm,h=c.enc,i=(h.Utf8,h.Base64),j=c.algo,k=j.EvpKDF,l=d.Cipher=g.extend({cfg:e.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){g.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){a&&this._append(a);var b=this._doFinalize();return b},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function a(a){return"string"==typeof a?x:u}return function(b){return{encrypt:function(c,d,e){return a(d).encrypt(b,c,d,e)},decrypt:function(c,d,e){return a(d).decrypt(b,c,d,e)}}}}()}),m=(d.StreamCipher=l.extend({_doFinalize:function(){var a=this._process(!0);return a},blockSize:1}),c.mode={}),n=d.BlockCipherMode=e.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}}),o=m.CBC=function(){function a(a,c,d){var e=this._iv;if(e){var f=e;this._iv=b}else var f=this._prevBlock;for(var g=0;g<d;g++)a[c+g]^=f[g]}var c=n.extend();return c.Encryptor=c.extend({processBlock:function(b,c){var d=this._cipher,e=d.blockSize;a.call(this,b,c,e),d.encryptBlock(b,c),this._prevBlock=b.slice(c,c+e)}}),c.Decryptor=c.extend({processBlock:function(b,c){var d=this._cipher,e=d.blockSize,f=b.slice(c,c+e);d.decryptBlock(b,c),a.call(this,b,c,e),this._prevBlock=f}}),c}(),p=c.pad={},q=p.Pkcs7={pad:function(a,b){for(var c=4*b,d=c-a.sigBytes%c,e=d<<24|d<<16|d<<8|d,g=[],h=0;h<d;h+=4)g.push(e);var i=f.create(g,d);a.concat(i)},unpad:function(a){var b=255&a.words[a.sigBytes-1>>>2];a.sigBytes-=b}},r=(d.BlockCipher=l.extend({cfg:l.cfg.extend({mode:o,padding:q}),reset:function(){l.reset.call(this);var a=this.cfg,b=a.iv,c=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var d=c.createEncryptor;else{var d=c.createDecryptor;this._minBufferSize=1}this._mode=d.call(c,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else{var b=this._process(!0);a.unpad(b)}return b},blockSize:4}),d.CipherParams=e.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}})),s=c.format={},t=s.OpenSSL={stringify:function(a){var b=a.ciphertext,c=a.salt;if(c)var d=f.create([1398893684,1701076831]).concat(c).concat(b);else var d=b;return d.toString(i)},parse:function(a){var b=i.parse(a),c=b.words;if(1398893684==c[0]&&1701076831==c[1]){var d=f.create(c.slice(2,4));c.splice(0,4),b.sigBytes-=16}return r.create({ciphertext:b,salt:d})}},u=d.SerializableCipher=e.extend({cfg:e.extend({format:t}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d),f=e.finalize(b),g=e.cfg;return r.create({ciphertext:f,key:c,iv:g.iv,algorithm:a,mode:g.mode,padding:g.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){d=this.cfg.extend(d),b=this._parse(b,d.format);var e=a.createDecryptor(c,d).finalize(b.ciphertext);return e},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),v=c.kdf={},w=v.OpenSSL={execute:function(a,b,c,d){d||(d=f.random(8));var e=k.create({keySize:b+c}).compute(a,d),g=f.create(e.words.slice(b),4*c);return e.sigBytes=4*b,r.create({key:e,iv:g,salt:d})}},x=d.PasswordBasedCipher=u.extend({cfg:u.cfg.extend({kdf:w}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=d.kdf.execute(c,a.keySize,a.ivSize);d.iv=e.iv;var f=u.encrypt.call(this,a,b,e.key,d);return f.mixIn(e),f},decrypt:function(a,b,c,d){d=this.cfg.extend(d),b=this._parse(b,d.format);var e=d.kdf.execute(c,a.keySize,a.ivSize,b.salt);d.iv=e.iv;var f=u.decrypt.call(this,a,b,e.key,d);return f}})}()})},{"./core":26}],26:[function(a,b,c){!function(a,d){"object"==typeof c?b.exports=c=d():"function"==typeof define&&define.amd?define([],d):a.CryptoJS=d()}(this,function(){var a=a||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;return b&&c.mixIn(b),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[],c!=b?this.sigBytes=c:this.sigBytes=4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,e=a.sigBytes;if(this.clamp(),d%4)for(var f=0;f<e;f++){var g=c[f>>>2]>>>24-f%4*8&255;b[d+f>>>2]|=g<<24-(d+f)%4*8}else for(var f=0;f<e;f+=4)b[d+f>>>2]=c[f>>>2];return this.sigBytes+=e,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-c%4*8,b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c,d=[],e=function(b){var b=b,c=987654321,d=4294967295;return function(){c=36969*(65535&c)+(c>>16)&d,b=18e3*(65535&b)+(b>>16)&d;var e=(c<<16)+b&d;return e/=4294967296,e+=.5,e*(a.random()>.5?1:-1)}},g=0;g<b;g+=4){var h=e(4294967296*(c||a.random()));c=987654071*h(),d.push(4294967296*h()|0)}return new f.init(d,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push((f>>>4).toString(16)),d.push((15&f).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new f.init(c,b/2)}},i=g.Latin1={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push(String.fromCharCode(f))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new f.init(c,b)}},j=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(i.stringify(a)))}catch(a){throw new Error("Malformed UTF-8 data")}},parse:function(a){return i.parse(unescape(encodeURIComponent(a)))}},k=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=j.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},
_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=4*g,i=e/h;i=b?a.ceil(i):a.max((0|i)-this._minBufferSize,0);var j=i*g,k=a.min(4*j,e);if(j){for(var l=0;l<j;l+=g)this._doProcessBlock(d,l);var m=d.splice(0,j);c.sigBytes-=k}return new f.init(m,k)},clone:function(){var a=e.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),l=(d.Hasher=k.extend({cfg:e.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){a&&this._append(a);var b=this._doFinalize();return b},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new l.HMAC.init(a,c).finalize(b)}}}),c.algo={});return c}(Math);return a})},{}],27:[function(a,b,c){!function(d,e){"object"==typeof c?b.exports=c=e(a("./core")):"function"==typeof define&&define.amd?define(["./core"],e):e(d.CryptoJS)}(this,function(a){return function(){var b=a,c=b.lib,d=c.WordArray,e=b.enc;e.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp();for(var e=[],f=0;f<c;f+=3)for(var g=b[f>>>2]>>>24-f%4*8&255,h=b[f+1>>>2]>>>24-(f+1)%4*8&255,i=b[f+2>>>2]>>>24-(f+2)%4*8&255,j=g<<16|h<<8|i,k=0;k<4&&f+.75*k<c;k++)e.push(d.charAt(j>>>6*(3-k)&63));var l=d.charAt(64);if(l)for(;e.length%4;)e.push(l);return e.join("")},parse:function(a){var b=a.length,c=this._map,e=c.charAt(64);if(e){var f=a.indexOf(e);f!=-1&&(b=f)}for(var g=[],h=0,i=0;i<b;i++)if(i%4){var j=c.indexOf(a.charAt(i-1))<<i%4*2,k=c.indexOf(a.charAt(i))>>>6-i%4*2,l=j|k;g[h>>>2]|=l<<24-h%4*8,h++}return d.create(g,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),a.enc.Base64})},{"./core":26}],28:[function(a,b,c){!function(d,e){"object"==typeof c?b.exports=c=e(a("./core")):"function"==typeof define&&define.amd?define(["./core"],e):e(d.CryptoJS)}(this,function(a){return function(){function b(a){return a<<8&4278255360|a>>>8&16711935}var c=a,d=c.lib,e=d.WordArray,f=c.enc;f.Utf16=f.Utf16BE={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e+=2){var f=b[e>>>2]>>>16-e%4*8&65535;d.push(String.fromCharCode(f))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>1]|=a.charCodeAt(d)<<16-d%2*16;return e.create(c,2*b)}};f.Utf16LE={stringify:function(a){for(var c=a.words,d=a.sigBytes,e=[],f=0;f<d;f+=2){var g=b(c[f>>>2]>>>16-f%4*8&65535);e.push(String.fromCharCode(g))}return e.join("")},parse:function(a){for(var c=a.length,d=[],f=0;f<c;f++)d[f>>>1]|=b(a.charCodeAt(f)<<16-f%2*16);return e.create(d,2*c)}}}(),a.enc.Utf16})},{"./core":26}],29:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./sha1"),a("./hmac")):"function"==typeof define&&define.amd?define(["./core","./sha1","./hmac"],e):e(d.CryptoJS)}(this,function(a){return function(){var b=a,c=b.lib,d=c.Base,e=c.WordArray,f=b.algo,g=f.MD5,h=f.EvpKDF=d.extend({cfg:d.extend({keySize:4,hasher:g,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,d=c.hasher.create(),f=e.create(),g=f.words,h=c.keySize,i=c.iterations;g.length<h;){j&&d.update(j);var j=d.update(a).finalize(b);d.reset();for(var k=1;k<i;k++)j=d.finalize(j),d.reset();f.concat(j)}return f.sigBytes=4*h,f}});b.EvpKDF=function(a,b,c){return h.create(c).compute(a,b)}}(),a.EvpKDF})},{"./core":26,"./hmac":31,"./sha1":50}],30:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return function(b){var c=a,d=c.lib,e=d.CipherParams,f=c.enc,g=f.Hex,h=c.format;h.Hex={stringify:function(a){return a.ciphertext.toString(g)},parse:function(a){var b=g.parse(a);return e.create({ciphertext:b})}}}(),a.format.Hex})},{"./cipher-core":25,"./core":26}],31:[function(a,b,c){!function(d,e){"object"==typeof c?b.exports=c=e(a("./core")):"function"==typeof define&&define.amd?define(["./core"],e):e(d.CryptoJS)}(this,function(a){!function(){var b=a,c=b.lib,d=c.Base,e=b.enc,f=e.Utf8,g=b.algo;g.HMAC=d.extend({init:function(a,b){a=this._hasher=new a.init,"string"==typeof b&&(b=f.parse(b));var c=a.blockSize,d=4*c;b.sigBytes>d&&(b=a.finalize(b)),b.clamp();for(var e=this._oKey=b.clone(),g=this._iKey=b.clone(),h=e.words,i=g.words,j=0;j<c;j++)h[j]^=1549556828,i[j]^=909522486;e.sigBytes=g.sigBytes=d,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher,c=b.finalize(a);b.reset();var d=b.finalize(this._oKey.clone().concat(c));return d}})}()})},{"./core":26}],32:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./x64-core"),a("./lib-typedarrays"),a("./enc-utf16"),a("./enc-base64"),a("./md5"),a("./sha1"),a("./sha256"),a("./sha224"),a("./sha512"),a("./sha384"),a("./sha3"),a("./ripemd160"),a("./hmac"),a("./pbkdf2"),a("./evpkdf"),a("./cipher-core"),a("./mode-cfb"),a("./mode-ctr"),a("./mode-ctr-gladman"),a("./mode-ofb"),a("./mode-ecb"),a("./pad-ansix923"),a("./pad-iso10126"),a("./pad-iso97971"),a("./pad-zeropadding"),a("./pad-nopadding"),a("./format-hex"),a("./aes"),a("./tripledes"),a("./rc4"),a("./rabbit"),a("./rabbit-legacy")):"function"==typeof define&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy"],e):d.CryptoJS=e(d.CryptoJS)}(this,function(a){return a})},{"./aes":24,"./cipher-core":25,"./core":26,"./enc-base64":27,"./enc-utf16":28,"./evpkdf":29,"./format-hex":30,"./hmac":31,"./lib-typedarrays":33,"./md5":34,"./mode-cfb":35,"./mode-ctr":37,"./mode-ctr-gladman":36,"./mode-ecb":38,"./mode-ofb":39,"./pad-ansix923":40,"./pad-iso10126":41,"./pad-iso97971":42,"./pad-nopadding":43,"./pad-zeropadding":44,"./pbkdf2":45,"./rabbit":47,"./rabbit-legacy":46,"./rc4":48,"./ripemd160":49,"./sha1":50,"./sha224":51,"./sha256":52,"./sha3":53,"./sha384":54,"./sha512":55,"./tripledes":56,"./x64-core":57}],33:[function(a,b,c){!function(d,e){"object"==typeof c?b.exports=c=e(a("./core")):"function"==typeof define&&define.amd?define(["./core"],e):e(d.CryptoJS)}(this,function(a){return function(){if("function"==typeof ArrayBuffer){var b=a,c=b.lib,d=c.WordArray,e=d.init,f=d.init=function(a){if(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),(a instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&a instanceof Uint8ClampedArray||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array)&&(a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength)),a instanceof Uint8Array){for(var b=a.byteLength,c=[],d=0;d<b;d++)c[d>>>2]|=a[d]<<24-d%4*8;e.call(this,c,b)}else e.apply(this,arguments)};f.prototype=d}}(),a.lib.WordArray})},{"./core":26}],34:[function(a,b,c){!function(d,e){"object"==typeof c?b.exports=c=e(a("./core")):"function"==typeof define&&define.amd?define(["./core"],e):e(d.CryptoJS)}(this,function(a){return function(b){function c(a,b,c,d,e,f,g){var h=a+(b&c|~b&d)+e+g;return(h<<f|h>>>32-f)+b}function d(a,b,c,d,e,f,g){var h=a+(b&d|c&~d)+e+g;return(h<<f|h>>>32-f)+b}function e(a,b,c,d,e,f,g){var h=a+(b^c^d)+e+g;return(h<<f|h>>>32-f)+b}function f(a,b,c,d,e,f,g){var h=a+(c^(b|~d))+e+g;return(h<<f|h>>>32-f)+b}var g=a,h=g.lib,i=h.WordArray,j=h.Hasher,k=g.algo,l=[];!function(){for(var a=0;a<64;a++)l[a]=4294967296*b.abs(b.sin(a+1))|0}();var m=k.MD5=j.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,b){for(var g=0;g<16;g++){var h=b+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var j=this._hash.words,k=a[b+0],m=a[b+1],n=a[b+2],o=a[b+3],p=a[b+4],q=a[b+5],r=a[b+6],s=a[b+7],t=a[b+8],u=a[b+9],v=a[b+10],w=a[b+11],x=a[b+12],y=a[b+13],z=a[b+14],A=a[b+15],B=j[0],C=j[1],D=j[2],E=j[3];B=c(B,C,D,E,k,7,l[0]),E=c(E,B,C,D,m,12,l[1]),D=c(D,E,B,C,n,17,l[2]),C=c(C,D,E,B,o,22,l[3]),B=c(B,C,D,E,p,7,l[4]),E=c(E,B,C,D,q,12,l[5]),D=c(D,E,B,C,r,17,l[6]),C=c(C,D,E,B,s,22,l[7]),B=c(B,C,D,E,t,7,l[8]),E=c(E,B,C,D,u,12,l[9]),D=c(D,E,B,C,v,17,l[10]),C=c(C,D,E,B,w,22,l[11]),B=c(B,C,D,E,x,7,l[12]),E=c(E,B,C,D,y,12,l[13]),D=c(D,E,B,C,z,17,l[14]),C=c(C,D,E,B,A,22,l[15]),B=d(B,C,D,E,m,5,l[16]),E=d(E,B,C,D,r,9,l[17]),D=d(D,E,B,C,w,14,l[18]),C=d(C,D,E,B,k,20,l[19]),B=d(B,C,D,E,q,5,l[20]),E=d(E,B,C,D,v,9,l[21]),D=d(D,E,B,C,A,14,l[22]),C=d(C,D,E,B,p,20,l[23]),B=d(B,C,D,E,u,5,l[24]),E=d(E,B,C,D,z,9,l[25]),D=d(D,E,B,C,o,14,l[26]),C=d(C,D,E,B,t,20,l[27]),B=d(B,C,D,E,y,5,l[28]),E=d(E,B,C,D,n,9,l[29]),D=d(D,E,B,C,s,14,l[30]),C=d(C,D,E,B,x,20,l[31]),B=e(B,C,D,E,q,4,l[32]),E=e(E,B,C,D,t,11,l[33]),D=e(D,E,B,C,w,16,l[34]),C=e(C,D,E,B,z,23,l[35]),B=e(B,C,D,E,m,4,l[36]),E=e(E,B,C,D,p,11,l[37]),D=e(D,E,B,C,s,16,l[38]),C=e(C,D,E,B,v,23,l[39]),B=e(B,C,D,E,y,4,l[40]),E=e(E,B,C,D,k,11,l[41]),D=e(D,E,B,C,o,16,l[42]),C=e(C,D,E,B,r,23,l[43]),B=e(B,C,D,E,u,4,l[44]),E=e(E,B,C,D,x,11,l[45]),D=e(D,E,B,C,A,16,l[46]),C=e(C,D,E,B,n,23,l[47]),B=f(B,C,D,E,k,6,l[48]),E=f(E,B,C,D,s,10,l[49]),D=f(D,E,B,C,z,15,l[50]),C=f(C,D,E,B,q,21,l[51]),B=f(B,C,D,E,x,6,l[52]),E=f(E,B,C,D,o,10,l[53]),D=f(D,E,B,C,v,15,l[54]),C=f(C,D,E,B,m,21,l[55]),B=f(B,C,D,E,t,6,l[56]),E=f(E,B,C,D,A,10,l[57]),D=f(D,E,B,C,r,15,l[58]),C=f(C,D,E,B,y,21,l[59]),B=f(B,C,D,E,p,6,l[60]),E=f(E,B,C,D,w,10,l[61]),D=f(D,E,B,C,n,15,l[62]),C=f(C,D,E,B,u,21,l[63]),j[0]=j[0]+B|0,j[1]=j[1]+C|0,j[2]=j[2]+D|0,j[3]=j[3]+E|0},_doFinalize:function(){var a=this._data,c=a.words,d=8*this._nDataBytes,e=8*a.sigBytes;c[e>>>5]|=128<<24-e%32;var f=b.floor(d/4294967296),g=d;c[(e+64>>>9<<4)+15]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[(e+64>>>9<<4)+14]=16711935&(g<<8|g>>>24)|4278255360&(g<<24|g>>>8),a.sigBytes=4*(c.length+1),this._process();for(var h=this._hash,i=h.words,j=0;j<4;j++){var k=i[j];i[j]=16711935&(k<<8|k>>>24)|4278255360&(k<<24|k>>>8)}return h},clone:function(){var a=j.clone.call(this);return a._hash=this._hash.clone(),a}});g.MD5=j._createHelper(m),g.HmacMD5=j._createHmacHelper(m)}(Math),a.MD5})},{"./core":26}],35:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return a.mode.CFB=function(){function b(a,b,c,d){var e=this._iv;if(e){var f=e.slice(0);this._iv=void 0}else var f=this._prevBlock;d.encryptBlock(f,0);for(var g=0;g<c;g++)a[b+g]^=f[g]}var c=a.lib.BlockCipherMode.extend();return c.Encryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize;b.call(this,a,c,e,d),this._prevBlock=a.slice(c,c+e)}}),c.Decryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize,f=a.slice(c,c+e);b.call(this,a,c,e,d),this._prevBlock=f}}),c}(),a.mode.CFB})},{"./cipher-core":25,"./core":26}],36:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return a.mode.CTRGladman=function(){function b(a){if(255===(a>>24&255)){var b=a>>16&255,c=a>>8&255,d=255&a;255===b?(b=0,255===c?(c=0,255===d?d=0:++d):++c):++b,a=0,a+=b<<16,a+=c<<8,a+=d}else a+=1<<24;return a}function c(a){return 0===(a[0]=b(a[0]))&&(a[1]=b(a[1])),a}var d=a.lib.BlockCipherMode.extend(),e=d.Encryptor=d.extend({processBlock:function(a,b){var d=this._cipher,e=d.blockSize,f=this._iv,g=this._counter;f&&(g=this._counter=f.slice(0),this._iv=void 0),c(g);var h=g.slice(0);d.encryptBlock(h,0);for(var i=0;i<e;i++)a[b+i]^=h[i]}});return d.Decryptor=e,d}(),a.mode.CTRGladman})},{"./cipher-core":25,"./core":26}],37:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return a.mode.CTR=function(){var b=a.lib.BlockCipherMode.extend(),c=b.Encryptor=b.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=this._iv,f=this._counter;e&&(f=this._counter=e.slice(0),this._iv=void 0);var g=f.slice(0);c.encryptBlock(g,0),f[d-1]=f[d-1]+1|0;for(var h=0;h<d;h++)a[b+h]^=g[h]}});return b.Decryptor=c,b}(),a.mode.CTR})},{"./cipher-core":25,"./core":26}],38:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return a.mode.ECB=function(){var b=a.lib.BlockCipherMode.extend();return b.Encryptor=b.extend({processBlock:function(a,b){this._cipher.encryptBlock(a,b)}}),b.Decryptor=b.extend({processBlock:function(a,b){this._cipher.decryptBlock(a,b)}}),b}(),a.mode.ECB})},{"./cipher-core":25,"./core":26}],39:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return a.mode.OFB=function(){var b=a.lib.BlockCipherMode.extend(),c=b.Encryptor=b.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=this._iv,f=this._keystream;e&&(f=this._keystream=e.slice(0),this._iv=void 0),c.encryptBlock(f,0);for(var g=0;g<d;g++)a[b+g]^=f[g]}});return b.Decryptor=c,b}(),a.mode.OFB})},{"./cipher-core":25,"./core":26}],40:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return a.pad.AnsiX923={pad:function(a,b){var c=a.sigBytes,d=4*b,e=d-c%d,f=c+e-1;a.clamp(),a.words[f>>>2]|=e<<24-f%4*8,a.sigBytes+=e},unpad:function(a){var b=255&a.words[a.sigBytes-1>>>2];a.sigBytes-=b}},a.pad.Ansix923})},{"./cipher-core":25,"./core":26}],41:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return a.pad.Iso10126={pad:function(b,c){var d=4*c,e=d-b.sigBytes%d;b.concat(a.lib.WordArray.random(e-1)).concat(a.lib.WordArray.create([e<<24],1))},unpad:function(a){var b=255&a.words[a.sigBytes-1>>>2];a.sigBytes-=b}},a.pad.Iso10126})},{"./cipher-core":25,"./core":26}],42:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return a.pad.Iso97971={pad:function(b,c){b.concat(a.lib.WordArray.create([2147483648],1)),a.pad.ZeroPadding.pad(b,c)},unpad:function(b){a.pad.ZeroPadding.unpad(b),b.sigBytes--}},a.pad.Iso97971})},{"./cipher-core":25,"./core":26}],43:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return a.pad.NoPadding={pad:function(){},unpad:function(){}},a.pad.NoPadding})},{"./cipher-core":25,"./core":26}],44:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return a.pad.ZeroPadding={pad:function(a,b){var c=4*b;a.clamp(),a.sigBytes+=c-(a.sigBytes%c||c)},unpad:function(a){for(var b=a.words,c=a.sigBytes-1;!(b[c>>>2]>>>24-c%4*8&255);)c--;a.sigBytes=c+1}},a.pad.ZeroPadding})},{"./cipher-core":25,"./core":26}],45:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./sha1"),a("./hmac")):"function"==typeof define&&define.amd?define(["./core","./sha1","./hmac"],e):e(d.CryptoJS)}(this,function(a){return function(){var b=a,c=b.lib,d=c.Base,e=c.WordArray,f=b.algo,g=f.SHA1,h=f.HMAC,i=f.PBKDF2=d.extend({cfg:d.extend({keySize:4,hasher:g,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,d=h.create(c.hasher,a),f=e.create(),g=e.create([1]),i=f.words,j=g.words,k=c.keySize,l=c.iterations;i.length<k;){var m=d.update(b).finalize(g);d.reset();for(var n=m.words,o=n.length,p=m,q=1;q<l;q++){p=d.finalize(p),d.reset();for(var r=p.words,s=0;s<o;s++)n[s]^=r[s]}f.concat(m),j[0]++}return f.sigBytes=4*k,f}});b.PBKDF2=function(a,b,c){return i.create(c).compute(a,b)}}(),a.PBKDF2})},{"./core":26,"./hmac":31,"./sha1":50}],46:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./enc-base64"),a("./md5"),a("./evpkdf"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return function(){function b(){for(var a=this._X,b=this._C,c=0;c<8;c++)h[c]=b[c];b[0]=b[0]+1295307597+this._b|0,b[1]=b[1]+3545052371+(b[0]>>>0<h[0]>>>0?1:0)|0,b[2]=b[2]+886263092+(b[1]>>>0<h[1]>>>0?1:0)|0,b[3]=b[3]+1295307597+(b[2]>>>0<h[2]>>>0?1:0)|0,b[4]=b[4]+3545052371+(b[3]>>>0<h[3]>>>0?1:0)|0,b[5]=b[5]+886263092+(b[4]>>>0<h[4]>>>0?1:0)|0,b[6]=b[6]+1295307597+(b[5]>>>0<h[5]>>>0?1:0)|0,b[7]=b[7]+3545052371+(b[6]>>>0<h[6]>>>0?1:0)|0,this._b=b[7]>>>0<h[7]>>>0?1:0;for(var c=0;c<8;c++){var d=a[c]+b[c],e=65535&d,f=d>>>16,g=((e*e>>>17)+e*f>>>15)+f*f,j=((4294901760&d)*d|0)+((65535&d)*d|0);i[c]=g^j}a[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,a[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,a[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,a[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,a[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,a[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,a[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,a[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}var c=a,d=c.lib,e=d.StreamCipher,f=c.algo,g=[],h=[],i=[],j=f.RabbitLegacy=e.extend({_doReset:function(){var a=this._key.words,c=this.cfg.iv,d=this._X=[a[0],a[3]<<16|a[2]>>>16,a[1],a[0]<<16|a[3]>>>16,a[2],a[1]<<16|a[0]>>>16,a[3],a[2]<<16|a[1]>>>16],e=this._C=[a[2]<<16|a[2]>>>16,4294901760&a[0]|65535&a[1],a[3]<<16|a[3]>>>16,4294901760&a[1]|65535&a[2],a[0]<<16|a[0]>>>16,4294901760&a[2]|65535&a[3],a[1]<<16|a[1]>>>16,4294901760&a[3]|65535&a[0]];this._b=0;for(var f=0;f<4;f++)b.call(this);for(var f=0;f<8;f++)e[f]^=d[f+4&7];if(c){var g=c.words,h=g[0],i=g[1],j=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),k=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),l=j>>>16|4294901760&k,m=k<<16|65535&j;e[0]^=j,e[1]^=l,e[2]^=k,e[3]^=m,e[4]^=j,e[5]^=l,e[6]^=k,e[7]^=m;for(var f=0;f<4;f++)b.call(this)}},_doProcessBlock:function(a,c){var d=this._X;b.call(this),g[0]=d[0]^d[5]>>>16^d[3]<<16,g[1]=d[2]^d[7]>>>16^d[5]<<16,g[2]=d[4]^d[1]>>>16^d[7]<<16,g[3]=d[6]^d[3]>>>16^d[1]<<16;for(var e=0;e<4;e++)g[e]=16711935&(g[e]<<8|g[e]>>>24)|4278255360&(g[e]<<24|g[e]>>>8),a[c+e]^=g[e]},blockSize:4,ivSize:2});c.RabbitLegacy=e._createHelper(j)}(),a.RabbitLegacy})},{"./cipher-core":25,"./core":26,"./enc-base64":27,"./evpkdf":29,"./md5":34}],47:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./enc-base64"),a("./md5"),a("./evpkdf"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return function(){function b(){for(var a=this._X,b=this._C,c=0;c<8;c++)h[c]=b[c];b[0]=b[0]+1295307597+this._b|0,b[1]=b[1]+3545052371+(b[0]>>>0<h[0]>>>0?1:0)|0,b[2]=b[2]+886263092+(b[1]>>>0<h[1]>>>0?1:0)|0,b[3]=b[3]+1295307597+(b[2]>>>0<h[2]>>>0?1:0)|0,b[4]=b[4]+3545052371+(b[3]>>>0<h[3]>>>0?1:0)|0,b[5]=b[5]+886263092+(b[4]>>>0<h[4]>>>0?1:0)|0,b[6]=b[6]+1295307597+(b[5]>>>0<h[5]>>>0?1:0)|0,b[7]=b[7]+3545052371+(b[6]>>>0<h[6]>>>0?1:0)|0,this._b=b[7]>>>0<h[7]>>>0?1:0;for(var c=0;c<8;c++){var d=a[c]+b[c],e=65535&d,f=d>>>16,g=((e*e>>>17)+e*f>>>15)+f*f,j=((4294901760&d)*d|0)+((65535&d)*d|0);i[c]=g^j}a[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,a[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,a[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,a[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,a[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,a[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,a[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,a[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}var c=a,d=c.lib,e=d.StreamCipher,f=c.algo,g=[],h=[],i=[],j=f.Rabbit=e.extend({_doReset:function(){for(var a=this._key.words,c=this.cfg.iv,d=0;d<4;d++)a[d]=16711935&(a[d]<<8|a[d]>>>24)|4278255360&(a[d]<<24|a[d]>>>8);var e=this._X=[a[0],a[3]<<16|a[2]>>>16,a[1],a[0]<<16|a[3]>>>16,a[2],a[1]<<16|a[0]>>>16,a[3],a[2]<<16|a[1]>>>16],f=this._C=[a[2]<<16|a[2]>>>16,4294901760&a[0]|65535&a[1],a[3]<<16|a[3]>>>16,4294901760&a[1]|65535&a[2],a[0]<<16|a[0]>>>16,4294901760&a[2]|65535&a[3],a[1]<<16|a[1]>>>16,4294901760&a[3]|65535&a[0]];this._b=0;for(var d=0;d<4;d++)b.call(this);for(var d=0;d<8;d++)f[d]^=e[d+4&7];if(c){var g=c.words,h=g[0],i=g[1],j=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),k=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),l=j>>>16|4294901760&k,m=k<<16|65535&j;f[0]^=j,f[1]^=l,f[2]^=k,f[3]^=m,f[4]^=j,f[5]^=l,f[6]^=k,f[7]^=m;for(var d=0;d<4;d++)b.call(this)}},_doProcessBlock:function(a,c){var d=this._X;b.call(this),g[0]=d[0]^d[5]>>>16^d[3]<<16,g[1]=d[2]^d[7]>>>16^d[5]<<16,g[2]=d[4]^d[1]>>>16^d[7]<<16,g[3]=d[6]^d[3]>>>16^d[1]<<16;for(var e=0;e<4;e++)g[e]=16711935&(g[e]<<8|g[e]>>>24)|4278255360&(g[e]<<24|g[e]>>>8),a[c+e]^=g[e]},blockSize:4,ivSize:2});c.Rabbit=e._createHelper(j)}(),a.Rabbit})},{"./cipher-core":25,"./core":26,"./enc-base64":27,"./evpkdf":29,"./md5":34}],48:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./enc-base64"),a("./md5"),a("./evpkdf"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return function(){function b(){for(var a=this._S,b=this._i,c=this._j,d=0,e=0;e<4;e++){b=(b+1)%256,c=(c+a[b])%256;var f=a[b];a[b]=a[c],a[c]=f,d|=a[(a[b]+a[c])%256]<<24-8*e}return this._i=b,this._j=c,d}var c=a,d=c.lib,e=d.StreamCipher,f=c.algo,g=f.RC4=e.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes,d=this._S=[],e=0;e<256;e++)d[e]=e;for(var e=0,f=0;e<256;e++){var g=e%c,h=b[g>>>2]>>>24-g%4*8&255;f=(f+d[e]+h)%256;var i=d[e];d[e]=d[f],d[f]=i}this._i=this._j=0},_doProcessBlock:function(a,c){a[c]^=b.call(this)},keySize:8,ivSize:0});c.RC4=e._createHelper(g);var h=f.RC4Drop=g.extend({cfg:g.cfg.extend({drop:192}),_doReset:function(){g._doReset.call(this);for(var a=this.cfg.drop;a>0;a--)b.call(this)}});c.RC4Drop=e._createHelper(h)}(),a.RC4})},{"./cipher-core":25,"./core":26,"./enc-base64":27,"./evpkdf":29,"./md5":34}],49:[function(a,b,c){!function(d,e){"object"==typeof c?b.exports=c=e(a("./core")):"function"==typeof define&&define.amd?define(["./core"],e):e(d.CryptoJS)}(this,function(a){return function(b){function c(a,b,c){return a^b^c}function d(a,b,c){return a&b|~a&c}function e(a,b,c){return(a|~b)^c}function f(a,b,c){return a&c|b&~c}function g(a,b,c){return a^(b|~c)}function h(a,b){return a<<b|a>>>32-b}var i=a,j=i.lib,k=j.WordArray,l=j.Hasher,m=i.algo,n=k.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),o=k.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),p=k.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),q=k.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),r=k.create([0,1518500249,1859775393,2400959708,2840853838]),s=k.create([1352829926,1548603684,1836072691,2053994217,0]),t=m.RIPEMD160=l.extend({_doReset:function(){this._hash=k.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var i=0;i<16;i++){var j=b+i,k=a[j];a[j]=16711935&(k<<8|k>>>24)|4278255360&(k<<24|k>>>8)}var l,m,t,u,v,w,x,y,z,A,B=this._hash.words,C=r.words,D=s.words,E=n.words,F=o.words,G=p.words,H=q.words;w=l=B[0],x=m=B[1],y=t=B[2],z=u=B[3],A=v=B[4];for(var I,i=0;i<80;i+=1)I=l+a[b+E[i]]|0,I+=i<16?c(m,t,u)+C[0]:i<32?d(m,t,u)+C[1]:i<48?e(m,t,u)+C[2]:i<64?f(m,t,u)+C[3]:g(m,t,u)+C[4],I|=0,I=h(I,G[i]),I=I+v|0,l=v,v=u,u=h(t,10),t=m,m=I,I=w+a[b+F[i]]|0,I+=i<16?g(x,y,z)+D[0]:i<32?f(x,y,z)+D[1]:i<48?e(x,y,z)+D[2]:i<64?d(x,y,z)+D[3]:c(x,y,z)+D[4],I|=0,I=h(I,H[i]),I=I+A|0,w=A,A=z,z=h(y,10),y=x,x=I;I=B[1]+t+z|0,B[1]=B[2]+u+A|0,B[2]=B[3]+v+w|0,B[3]=B[4]+l+x|0,B[4]=B[0]+m+y|0,B[0]=I},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),a.sigBytes=4*(b.length+1),this._process();for(var e=this._hash,f=e.words,g=0;g<5;g++){var h=f[g];f[g]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}return e},clone:function(){var a=l.clone.call(this);return a._hash=this._hash.clone(),a}});i.RIPEMD160=l._createHelper(t),i.HmacRIPEMD160=l._createHmacHelper(t)}(Math),a.RIPEMD160})},{"./core":26}],50:[function(a,b,c){!function(d,e){"object"==typeof c?b.exports=c=e(a("./core")):"function"==typeof define&&define.amd?define(["./core"],e):e(d.CryptoJS)}(this,function(a){return function(){var b=a,c=b.lib,d=c.WordArray,e=c.Hasher,f=b.algo,g=[],h=f.SHA1=e.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],h=c[3],i=c[4],j=0;j<80;j++){if(j<16)g[j]=0|a[b+j];else{var k=g[j-3]^g[j-8]^g[j-14]^g[j-16];g[j]=k<<1|k>>>31}var l=(d<<5|d>>>27)+i+g[j];l+=j<20?(e&f|~e&h)+1518500249:j<40?(e^f^h)+1859775393:j<60?(e&f|e&h|f&h)-1894007588:(e^f^h)-899497514,i=h,h=f,f=e<<30|e>>>2,e=d,d=l}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296),b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});b.SHA1=e._createHelper(h),b.HmacSHA1=e._createHmacHelper(h)}(),a.SHA1})},{"./core":26}],51:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./sha256")):"function"==typeof define&&define.amd?define(["./core","./sha256"],e):e(d.CryptoJS)}(this,function(a){return function(){var b=a,c=b.lib,d=c.WordArray,e=b.algo,f=e.SHA256,g=e.SHA224=f.extend({_doReset:function(){this._hash=new d.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var a=f._doFinalize.call(this);return a.sigBytes-=4,a}});b.SHA224=f._createHelper(g),b.HmacSHA224=f._createHmacHelper(g)}(),a.SHA224})},{"./core":26,"./sha256":52}],52:[function(a,b,c){!function(d,e){"object"==typeof c?b.exports=c=e(a("./core")):"function"==typeof define&&define.amd?define(["./core"],e):e(d.CryptoJS)}(this,function(a){return function(b){var c=a,d=c.lib,e=d.WordArray,f=d.Hasher,g=c.algo,h=[],i=[];!function(){function a(a){for(var c=b.sqrt(a),d=2;d<=c;d++)if(!(a%d))return!1;return!0}function c(a){return 4294967296*(a-(0|a))|0}for(var d=2,e=0;e<64;)a(d)&&(e<8&&(h[e]=c(b.pow(d,.5))),i[e]=c(b.pow(d,1/3)),e++),d++}();var j=[],k=g.SHA256=f.extend({_doReset:function(){this._hash=new e.init(h.slice(0))},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],k=c[5],l=c[6],m=c[7],n=0;n<64;n++){if(n<16)j[n]=0|a[b+n];else{var o=j[n-15],p=(o<<25|o>>>7)^(o<<14|o>>>18)^o>>>3,q=j[n-2],r=(q<<15|q>>>17)^(q<<13|q>>>19)^q>>>10;j[n]=p+j[n-7]+r+j[n-16]}var s=h&k^~h&l,t=d&e^d&f^e&f,u=(d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22),v=(h<<26|h>>>6)^(h<<21|h>>>11)^(h<<7|h>>>25),w=m+v+s+i[n]+j[n],x=u+t;m=l,l=k,k=h,h=g+w|0,g=f,f=e,e=d,d=w+x|0}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+g|0,c[4]=c[4]+h|0,c[5]=c[5]+k|0,c[6]=c[6]+l|0,c[7]=c[7]+m|0},_doFinalize:function(){var a=this._data,c=a.words,d=8*this._nDataBytes,e=8*a.sigBytes;return c[e>>>5]|=128<<24-e%32,c[(e+64>>>9<<4)+14]=b.floor(d/4294967296),c[(e+64>>>9<<4)+15]=d,a.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=f.clone.call(this);return a._hash=this._hash.clone(),a}});c.SHA256=f._createHelper(k),c.HmacSHA256=f._createHmacHelper(k)}(Math),a.SHA256})},{"./core":26}],53:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./x64-core")):"function"==typeof define&&define.amd?define(["./core","./x64-core"],e):e(d.CryptoJS)}(this,function(a){return function(b){var c=a,d=c.lib,e=d.WordArray,f=d.Hasher,g=c.x64,h=g.Word,i=c.algo,j=[],k=[],l=[];!function(){for(var a=1,b=0,c=0;c<24;c++){j[a+5*b]=(c+1)*(c+2)/2%64;var d=b%5,e=(2*a+3*b)%5;a=d,b=e}for(var a=0;a<5;a++)for(var b=0;b<5;b++)k[a+5*b]=b+(2*a+3*b)%5*5;for(var f=1,g=0;g<24;g++){for(var i=0,m=0,n=0;n<7;n++){if(1&f){var o=(1<<n)-1;o<32?m^=1<<o:i^=1<<o-32}128&f?f=f<<1^113:f<<=1}l[g]=h.create(i,m)}}();var m=[];!function(){for(var a=0;a<25;a++)m[a]=h.create()}();var n=i.SHA3=f.extend({cfg:f.cfg.extend({outputLength:512}),_doReset:function(){for(var a=this._state=[],b=0;b<25;b++)a[b]=new h.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(a,b){for(var c=this._state,d=this.blockSize/2,e=0;e<d;e++){var f=a[b+2*e],g=a[b+2*e+1];f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),g=16711935&(g<<8|g>>>24)|4278255360&(g<<24|g>>>8);var h=c[e];h.high^=g,h.low^=f}for(var i=0;i<24;i++){for(var n=0;n<5;n++){for(var o=0,p=0,q=0;q<5;q++){var h=c[n+5*q];o^=h.high,p^=h.low}var r=m[n];r.high=o,r.low=p}for(var n=0;n<5;n++)for(var s=m[(n+4)%5],t=m[(n+1)%5],u=t.high,v=t.low,o=s.high^(u<<1|v>>>31),p=s.low^(v<<1|u>>>31),q=0;q<5;q++){var h=c[n+5*q];h.high^=o,h.low^=p}for(var w=1;w<25;w++){var h=c[w],x=h.high,y=h.low,z=j[w];if(z<32)var o=x<<z|y>>>32-z,p=y<<z|x>>>32-z;else var o=y<<z-32|x>>>64-z,p=x<<z-32|y>>>64-z;var A=m[k[w]];A.high=o,A.low=p}var B=m[0],C=c[0];B.high=C.high,B.low=C.low;for(var n=0;n<5;n++)for(var q=0;q<5;q++){var w=n+5*q,h=c[w],D=m[w],E=m[(n+1)%5+5*q],F=m[(n+2)%5+5*q];h.high=D.high^~E.high&F.high,h.low=D.low^~E.low&F.low}var h=c[0],G=l[i];h.high^=G.high,h.low^=G.low}},_doFinalize:function(){var a=this._data,c=a.words,d=(8*this._nDataBytes,8*a.sigBytes),f=32*this.blockSize;c[d>>>5]|=1<<24-d%32,c[(b.ceil((d+1)/f)*f>>>5)-1]|=128,a.sigBytes=4*c.length,this._process();for(var g=this._state,h=this.cfg.outputLength/8,i=h/8,j=[],k=0;k<i;k++){var l=g[k],m=l.high,n=l.low;m=16711935&(m<<8|m>>>24)|4278255360&(m<<24|m>>>8),n=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),j.push(n),j.push(m)}return new e.init(j,h)},clone:function(){for(var a=f.clone.call(this),b=a._state=this._state.slice(0),c=0;c<25;c++)b[c]=b[c].clone();return a}});c.SHA3=f._createHelper(n),c.HmacSHA3=f._createHmacHelper(n)}(Math),a.SHA3})},{"./core":26,"./x64-core":57}],54:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./x64-core"),a("./sha512")):"function"==typeof define&&define.amd?define(["./core","./x64-core","./sha512"],e):e(d.CryptoJS)}(this,function(a){return function(){var b=a,c=b.x64,d=c.Word,e=c.WordArray,f=b.algo,g=f.SHA512,h=f.SHA384=g.extend({_doReset:function(){this._hash=new e.init([new d.init(3418070365,3238371032),new d.init(1654270250,914150663),new d.init(2438529370,812702999),new d.init(355462360,4144912697),new d.init(1731405415,4290775857),new d.init(2394180231,1750603025),new d.init(3675008525,1694076839),new d.init(1203062813,3204075428)]);
},_doFinalize:function(){var a=g._doFinalize.call(this);return a.sigBytes-=16,a}});b.SHA384=g._createHelper(h),b.HmacSHA384=g._createHmacHelper(h)}(),a.SHA384})},{"./core":26,"./sha512":55,"./x64-core":57}],55:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./x64-core")):"function"==typeof define&&define.amd?define(["./core","./x64-core"],e):e(d.CryptoJS)}(this,function(a){return function(){function b(){return g.create.apply(g,arguments)}var c=a,d=c.lib,e=d.Hasher,f=c.x64,g=f.Word,h=f.WordArray,i=c.algo,j=[b(1116352408,3609767458),b(1899447441,602891725),b(3049323471,3964484399),b(3921009573,2173295548),b(961987163,4081628472),b(1508970993,3053834265),b(2453635748,2937671579),b(2870763221,3664609560),b(3624381080,2734883394),b(310598401,1164996542),b(607225278,1323610764),b(1426881987,3590304994),b(1925078388,4068182383),b(2162078206,991336113),b(2614888103,633803317),b(3248222580,3479774868),b(3835390401,2666613458),b(4022224774,944711139),b(264347078,2341262773),b(604807628,2007800933),b(770255983,1495990901),b(1249150122,1856431235),b(1555081692,3175218132),b(1996064986,2198950837),b(2554220882,3999719339),b(2821834349,766784016),b(2952996808,2566594879),b(3210313671,3203337956),b(3336571891,1034457026),b(3584528711,2466948901),b(113926993,3758326383),b(338241895,168717936),b(666307205,1188179964),b(773529912,1546045734),b(1294757372,1522805485),b(1396182291,2643833823),b(1695183700,2343527390),b(1986661051,1014477480),b(2177026350,1206759142),b(2456956037,344077627),b(2730485921,1290863460),b(2820302411,3158454273),b(3259730800,3505952657),b(3345764771,106217008),b(3516065817,3606008344),b(3600352804,1432725776),b(4094571909,1467031594),b(275423344,851169720),b(430227734,3100823752),b(506948616,1363258195),b(659060556,3750685593),b(883997877,3785050280),b(958139571,3318307427),b(1322822218,3812723403),b(1537002063,2003034995),b(1747873779,3602036899),b(1955562222,1575990012),b(2024104815,1125592928),b(2227730452,2716904306),b(2361852424,442776044),b(2428436474,593698344),b(2756734187,3733110249),b(3204031479,2999351573),b(3329325298,3815920427),b(3391569614,3928383900),b(3515267271,566280711),b(3940187606,3454069534),b(4118630271,4000239992),b(116418474,1914138554),b(174292421,2731055270),b(289380356,3203993006),b(460393269,320620315),b(685471733,587496836),b(852142971,1086792851),b(1017036298,365543100),b(1126000580,2618297676),b(1288033470,3409855158),b(1501505948,4234509866),b(1607167915,987167468),b(1816402316,1246189591)],k=[];!function(){for(var a=0;a<80;a++)k[a]=b()}();var l=i.SHA512=e.extend({_doReset:function(){this._hash=new h.init([new g.init(1779033703,4089235720),new g.init(3144134277,2227873595),new g.init(1013904242,4271175723),new g.init(2773480762,1595750129),new g.init(1359893119,2917565137),new g.init(2600822924,725511199),new g.init(528734635,4215389547),new g.init(1541459225,327033209)])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],l=c[6],m=c[7],n=d.high,o=d.low,p=e.high,q=e.low,r=f.high,s=f.low,t=g.high,u=g.low,v=h.high,w=h.low,x=i.high,y=i.low,z=l.high,A=l.low,B=m.high,C=m.low,D=n,E=o,F=p,G=q,H=r,I=s,J=t,K=u,L=v,M=w,N=x,O=y,P=z,Q=A,R=B,S=C,T=0;T<80;T++){var U=k[T];if(T<16)var V=U.high=0|a[b+2*T],W=U.low=0|a[b+2*T+1];else{var X=k[T-15],Y=X.high,Z=X.low,$=(Y>>>1|Z<<31)^(Y>>>8|Z<<24)^Y>>>7,_=(Z>>>1|Y<<31)^(Z>>>8|Y<<24)^(Z>>>7|Y<<25),aa=k[T-2],ba=aa.high,ca=aa.low,da=(ba>>>19|ca<<13)^(ba<<3|ca>>>29)^ba>>>6,ea=(ca>>>19|ba<<13)^(ca<<3|ba>>>29)^(ca>>>6|ba<<26),fa=k[T-7],ga=fa.high,ha=fa.low,ia=k[T-16],ja=ia.high,ka=ia.low,W=_+ha,V=$+ga+(W>>>0<_>>>0?1:0),W=W+ea,V=V+da+(W>>>0<ea>>>0?1:0),W=W+ka,V=V+ja+(W>>>0<ka>>>0?1:0);U.high=V,U.low=W}var la=L&N^~L&P,ma=M&O^~M&Q,na=D&F^D&H^F&H,oa=E&G^E&I^G&I,pa=(D>>>28|E<<4)^(D<<30|E>>>2)^(D<<25|E>>>7),qa=(E>>>28|D<<4)^(E<<30|D>>>2)^(E<<25|D>>>7),ra=(L>>>14|M<<18)^(L>>>18|M<<14)^(L<<23|M>>>9),sa=(M>>>14|L<<18)^(M>>>18|L<<14)^(M<<23|L>>>9),ta=j[T],ua=ta.high,va=ta.low,wa=S+sa,xa=R+ra+(wa>>>0<S>>>0?1:0),wa=wa+ma,xa=xa+la+(wa>>>0<ma>>>0?1:0),wa=wa+va,xa=xa+ua+(wa>>>0<va>>>0?1:0),wa=wa+W,xa=xa+V+(wa>>>0<W>>>0?1:0),ya=qa+oa,za=pa+na+(ya>>>0<qa>>>0?1:0);R=P,S=Q,P=N,Q=O,N=L,O=M,M=K+wa|0,L=J+xa+(M>>>0<K>>>0?1:0)|0,J=H,K=I,H=F,I=G,F=D,G=E,E=wa+ya|0,D=xa+za+(E>>>0<wa>>>0?1:0)|0}o=d.low=o+E,d.high=n+D+(o>>>0<E>>>0?1:0),q=e.low=q+G,e.high=p+F+(q>>>0<G>>>0?1:0),s=f.low=s+I,f.high=r+H+(s>>>0<I>>>0?1:0),u=g.low=u+K,g.high=t+J+(u>>>0<K>>>0?1:0),w=h.low=w+M,h.high=v+L+(w>>>0<M>>>0?1:0),y=i.low=y+O,i.high=x+N+(y>>>0<O>>>0?1:0),A=l.low=A+Q,l.high=z+P+(A>>>0<Q>>>0?1:0),C=m.low=C+S,m.high=B+R+(C>>>0<S>>>0?1:0)},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;b[d>>>5]|=128<<24-d%32,b[(d+128>>>10<<5)+30]=Math.floor(c/4294967296),b[(d+128>>>10<<5)+31]=c,a.sigBytes=4*b.length,this._process();var e=this._hash.toX32();return e},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a},blockSize:32});c.SHA512=e._createHelper(l),c.HmacSHA512=e._createHmacHelper(l)}(),a.SHA512})},{"./core":26,"./x64-core":57}],56:[function(a,b,c){!function(d,e,f){"object"==typeof c?b.exports=c=e(a("./core"),a("./enc-base64"),a("./md5"),a("./evpkdf"),a("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(d.CryptoJS)}(this,function(a){return function(){function b(a,b){var c=(this._lBlock>>>a^this._rBlock)&b;this._rBlock^=c,this._lBlock^=c<<a}function c(a,b){var c=(this._rBlock>>>a^this._lBlock)&b;this._lBlock^=c,this._rBlock^=c<<a}var d=a,e=d.lib,f=e.WordArray,g=e.BlockCipher,h=d.algo,i=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],j=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],k=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],m=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],n=h.DES=g.extend({_doReset:function(){for(var a=this._key,b=a.words,c=[],d=0;d<56;d++){var e=i[d]-1;c[d]=b[e>>>5]>>>31-e%32&1}for(var f=this._subKeys=[],g=0;g<16;g++){for(var h=f[g]=[],l=k[g],d=0;d<24;d++)h[d/6|0]|=c[(j[d]-1+l)%28]<<31-d%6,h[4+(d/6|0)]|=c[28+(j[d+24]-1+l)%28]<<31-d%6;h[0]=h[0]<<1|h[0]>>>31;for(var d=1;d<7;d++)h[d]=h[d]>>>4*(d-1)+3;h[7]=h[7]<<5|h[7]>>>27}for(var m=this._invSubKeys=[],d=0;d<16;d++)m[d]=f[15-d]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._subKeys)},decryptBlock:function(a,b){this._doCryptBlock(a,b,this._invSubKeys)},_doCryptBlock:function(a,d,e){this._lBlock=a[d],this._rBlock=a[d+1],b.call(this,4,252645135),b.call(this,16,65535),c.call(this,2,858993459),c.call(this,8,16711935),b.call(this,1,1431655765);for(var f=0;f<16;f++){for(var g=e[f],h=this._lBlock,i=this._rBlock,j=0,k=0;k<8;k++)j|=l[k][((i^g[k])&m[k])>>>0];this._lBlock=i,this._rBlock=h^j}var n=this._lBlock;this._lBlock=this._rBlock,this._rBlock=n,b.call(this,1,1431655765),c.call(this,8,16711935),c.call(this,2,858993459),b.call(this,16,65535),b.call(this,4,252645135),a[d]=this._lBlock,a[d+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});d.DES=g._createHelper(n);var o=h.TripleDES=g.extend({_doReset:function(){var a=this._key,b=a.words;this._des1=n.createEncryptor(f.create(b.slice(0,2))),this._des2=n.createEncryptor(f.create(b.slice(2,4))),this._des3=n.createEncryptor(f.create(b.slice(4,6)))},encryptBlock:function(a,b){this._des1.encryptBlock(a,b),this._des2.decryptBlock(a,b),this._des3.encryptBlock(a,b)},decryptBlock:function(a,b){this._des3.decryptBlock(a,b),this._des2.encryptBlock(a,b),this._des1.decryptBlock(a,b)},keySize:6,ivSize:2,blockSize:2});d.TripleDES=g._createHelper(o)}(),a.TripleDES})},{"./cipher-core":25,"./core":26,"./enc-base64":27,"./evpkdf":29,"./md5":34}],57:[function(a,b,c){!function(d,e){"object"==typeof c?b.exports=c=e(a("./core")):"function"==typeof define&&define.amd?define(["./core"],e):e(d.CryptoJS)}(this,function(a){return function(b){var c=a,d=c.lib,e=d.Base,f=d.WordArray,g=c.x64={};g.Word=e.extend({init:function(a,b){this.high=a,this.low=b}}),g.WordArray=e.extend({init:function(a,c){a=this.words=a||[],c!=b?this.sigBytes=c:this.sigBytes=8*a.length},toX32:function(){for(var a=this.words,b=a.length,c=[],d=0;d<b;d++){var e=a[d];c.push(e.high),c.push(e.low)}return f.create(c,this.sigBytes)},clone:function(){for(var a=e.clone.call(this),b=a.words=this.words.slice(0),c=b.length,d=0;d<c;d++)b[d]=b[d].clone();return a}})}(),a})},{"./core":26}],58:[function(a,b,c){b.exports=msgpack},{}],59:[function(a,b,c){function d(a,b){for(var c=this,d=b||0,e=a.length,f=0;f<e;f++){var g=a.charCodeAt(f);g<128?c[d++]=g:g<2048?(c[d++]=192|g>>6,c[d++]=128|63&g):(c[d++]=224|g>>12,c[d++]=128|g>>6&63,c[d++]=128|63&g)}return d-b}function e(a,b){var c=this,d=a-0||0;b||(b=c.length);var e=b-a;e>m&&(e=m);for(var f=[];d<b;){for(var g=new Array(e),h=0;h<e&&d<b;){var i=c[d++];i=i<128?i:i<224?(63&i)<<6|63&c[d++]:(63&i)<<12|(63&c[d++])<<6|63&c[d++],g[h++]=i}h<e&&(g=g.slice(0,h)),f.push(String.fromCharCode.apply("",g))}return f.length>1?f.join(""):f.length?f.shift():""}function f(a){var b=0;return Array.prototype.forEach.call(a,function(a){var c=a.charCodeAt(0);b+=c<128?1:c<2048?2:3}),b}function g(a,b,c,d){var e;c||(c=0),d||0===d||(d=this.length),b||(b=0);var f=d-c;if(a===this&&c<b&&b<d)for(e=f-1;e>=0;e--)a[e+b]=this[e+c];else for(e=0;e<f;e++)a[e+b]=this[e+c];return f}function h(a,b){new k(this,b,a)}function i(a,b){new l(this,b,a)}var j=a("int64-buffer"),k=j.Uint64BE,l=j.Int64BE,m=8192;c.writeString=d,c.readString=e,c.byteLength=f,c.copy=g,c.writeUint64BE=h,c.writeInt64BE=i},{"int64-buffer":64}],60:[function(a,b,c){function d(a,b){return this instanceof d?(this.buffer=a,void(this.type=b)):new d(a,b)}c.ExtBuffer=d},{}],61:[function(a,b,c){(function(b){function d(a){return n||a&&a.safe?f():e()}function e(){var a=l.slice();return a[196]=g(196),a[197]=h(197),a[198]=i(198),a[199]=g(199),a[200]=h(200),a[201]=i(201),a[202]=j(202,4,b.prototype.writeFloatBE,!0),a[203]=j(203,8,b.prototype.writeDoubleBE,!0),a[204]=g(204),a[205]=h(205),a[206]=i(206),a[207]=j(207,8,k.writeUint64BE),a[208]=g(208),a[209]=h(209),a[210]=i(210),a[211]=j(211,8,k.writeUint64BE),a[217]=g(217),a[218]=h(218),a[219]=i(219),a[220]=h(220),a[221]=i(221),a[222]=h(222),a[223]=i(223),a}function f(){var a=l.slice();return a[196]=j(196,1,b.prototype.writeUInt8),a[197]=j(197,2,b.prototype.writeUInt16BE),a[198]=j(198,4,b.prototype.writeUInt32BE),a[199]=j(199,1,b.prototype.writeUInt8),a[200]=j(200,2,b.prototype.writeUInt16BE),a[201]=j(201,4,b.prototype.writeUInt32BE),a[202]=j(202,4,b.prototype.writeFloatBE),a[203]=j(203,8,b.prototype.writeDoubleBE),a[204]=j(204,1,b.prototype.writeUInt8),a[205]=j(205,2,b.prototype.writeUInt16BE),a[206]=j(206,4,b.prototype.writeUInt32BE),a[207]=j(207,8,k.writeUint64BE),a[208]=j(208,1,b.prototype.writeInt8),a[209]=j(209,2,b.prototype.writeInt16BE),a[210]=j(210,4,b.prototype.writeInt32BE),a[211]=j(211,8,k.writeUint64BE),a[217]=j(217,1,b.prototype.writeUInt8),a[218]=j(218,2,b.prototype.writeUInt16BE),a[219]=j(219,4,b.prototype.writeUInt32BE),a[220]=j(220,2,b.prototype.writeUInt16BE),a[221]=j(221,4,b.prototype.writeUInt32BE),a[222]=j(222,2,b.prototype.writeUInt16BE),a[223]=j(223,4,b.prototype.writeUInt32BE),a}function g(a){return function(b,c){b.reserve(2);var d=b.buffer,e=b.offset;d[e++]=a,d[e++]=c,b.offset=e}}function h(a){return function(b,c){b.reserve(3);var d=b.buffer,e=b.offset;d[e++]=a,d[e++]=c>>>8,d[e++]=c,b.offset=e}}function i(a){return function(b,c){b.reserve(5);var d=b.buffer,e=b.offset;d[e++]=a,d[e++]=c>>>24,d[e++]=c>>>16,d[e++]=c>>>8,d[e++]=c,b.offset=e}}function j(a,b,c,d){return function(e,f){e.reserve(b+1),e.buffer[e.offset++]=a,c.call(e.buffer,f,e.offset,d),e.offset+=b}}var k=a("./buffer-lite"),l=a("./write-uint8").uint8,m="TYPED_ARRAY_SUPPORT"in b,n=m&&!b.TYPED_ARRAY_SUPPORT;c.getWriteToken=d}).call(this,a("buffer").Buffer)},{"./buffer-lite":59,"./write-uint8":63,buffer:128}],62:[function(a,b,c){(function(b){function d(a){function c(a,b){var c=b?195:194;y[c](a,b)}function d(a,b){var c,d=0|b;return b!==d?(c=203,void y[c](a,b)):(c=-32<=d&&d<=127?255&d:0<=d?d<=255?204:d<=65535?205:206:-128<=d?208:-32768<=d?209:210,void y[c](a,d))}function g(a,b){var c=207;y[c](a,b.toArray())}function n(a,b){var c=211;y[c](a,b.toArray())}function p(a,b){var c=b.length,d=5+3*c;a.reserve(d);var f=c<32?1:c<=255?2:c<=65535?3:5,g=a.offset+f;c=j.writeString.call(a.buffer,b,g);var h=c<32?1:c<=255?2:c<=65535?3:5;f!==h&&e(a,g,c,h-f);var i=1===h?160+c:h<=3?215+h:219;y[i](a,c),a.offset+=c}function q(a,c){if(null===c)return r(a,c);if(b.isBuffer(c))return t(a,c);if(f(c))return s(a,c);if(h.isUint64BE(c))return g(a,c);if(i.isInt64BE(c))return n(a,c);var d=a.codec.getExtPacker(c);return d&&(c=d(c)),c instanceof m?u(a,c):void v(a,c)}function r(a,b){var c=192;y[c](a,b)}function s(a,b){var c=b.length,d=c<16?144+c:c<=65535?220:221;y[d](a,c);for(var e=a.codec.encode,f=0;f<c;f++)e(a,b[f])}function t(a,b){var c=b.length,d=c<255?196:c<=65535?197:198;y[d](a,c),a.send(b)}function u(a,b){var c=b.buffer,d=c.length,e=o[d]||(d<255?199:d<=65535?200:201);y[e](a,d),l[b.type](a),a.send(c)}function v(a,b){var c=Object.keys(b),d=c.length,e=d<16?128+d:d<=65535?222:223;y[e](a,d);var f=a.codec.encode;c.forEach(function(c){f(a,c),f(a,b[c])})}function w(a,b){var c=b.length,d=5+3*c;a.reserve(d);var f=c<32?1:c<=65535?3:5,g=a.offset+f;c=j.writeString.call(a.buffer,b,g);var h=c<32?1:c<=65535?3:5;f!==h&&e(a,g,c,h-f);var i=c<32?160+c:c<=65535?218:219;y[i](a,c),a.offset+=c}function x(a,c){if(!b.isBuffer(c))return q(a,c);var d=c.length,e=d<32?160+d:d<=65535?218:219;y[e](a,d),a.send(c)}var y=k.getWriteToken(a),z={boolean:c,function:r,number:d,object:q,string:p,symbol:r,undefined:r};return a&&a.useraw&&(z.object=x,z.string=w),z}function e(a,b,c,d){var e=b+d,f=b+c;n?j.copy.call(a.buffer,a.buffer,e,b,f):a.buffer.copy(a.buffer,e,b,f)}var f=a("isarray"),g=a("int64-buffer"),h=g.Uint64BE,i=g.Int64BE,j=a("./buffer-lite"),k=a("./write-token"),l=a("./write-uint8").uint8,m=a("./ext-buffer").ExtBuffer,n="TYPED_ARRAY_SUPPORT"in b,o=[];o[1]=212,o[2]=213,o[4]=214,o[8]=215,o[16]=216,c.getWriteType=d}).call(this,a("buffer").Buffer)},{"./buffer-lite":59,"./ext-buffer":60,"./write-token":61,"./write-uint8":63,buffer:128,"int64-buffer":64,isarray:65}],63:[function(a,b,c){function d(a){return function(b){b.reserve(1),b.buffer[b.offset++]=a}}for(var e=c.uint8=new Array(256),f=0;f<=255;f++)e[f]=d(f)},{}],64:[function(a,b,c){(function(a){var b,d;!function(c){function e(a,b,c,d,e){if(w&&x&&(b instanceof x&&(b=new w(b)),d instanceof x&&(d=new w(d))),!(b||c||d||p))return void(a.buffer=j(y,0));if(!f(b,c)){var i=p||Array;e=c,d=b,c=0,b=new i(8)}a.buffer=b,a.offset=c|=0,"undefined"!=typeof d&&("string"==typeof d?h(b,c,d,e||10):f(d,e)?g(b,c,d,e):"number"==typeof e?(l(b,c,d),l(b,c+4,e)):d>0?m(b,c,d):d<0?n(b,c,d):g(b,c,y,0))}function f(a,b){var c=a&&a.length;return b|=0,c&&b+8<=c&&"string"!=typeof a[b]}function g(a,b,c,d){b|=0,d|=0;for(var e=0;e<8;e++)a[b++]=255&c[d++]}function h(a,b,c,d){var e=0,f=c.length,g=0,h=0;"-"===c[0]&&e++;for(var i=e;e<f;){var j=parseInt(c[e++],d);if(!(j>=0))break;h=h*d+j,g=g*d+Math.floor(h/A),h%=A}i&&(g=~g,h?h=A-h:g++),l(a,b,g),l(a,b+4,h)}function i(a,b,c,d){var e="",f=k(a,b),g=k(a,b+4),h=d&&2147483648&f;for(h&&(f=~f,g=A-g),c=c||10;;){var i=f%c*A+g;if(f=Math.floor(f/c),g=Math.floor(i/c),e=(i%c).toString(c)+e,!f&&!g)break}return h&&(e="-"+e),e}function j(a,b){return Array.prototype.slice.call(a,b,b+8)}function k(a,b){return a[b++]*B+(a[b++]<<16)+(a[b++]<<8)+a[b]}function l(a,b,c){a[b+3]=255&c,c>>=8,a[b+2]=255&c,c>>=8,a[b+1]=255&c,c>>=8,a[b]=255&c}function m(a,b,c){for(var d=b+7;d>=b;d--)a[d]=255&c,c/=256}function n(a,b,c){c++;for(var d=b+7;d>=b;d--)a[d]=255&-c^255,c/=256}function o(a){return!!a&&"[object Array]"==Object.prototype.toString.call(a)}var p,q=c.Uint64BE=b=function(a,c,d,f){return this instanceof b?e(this,a,c,d,f):new b(a,c,d,f)},r=c.Int64BE=d=function(a,b,c,f){return this instanceof d?e(this,a,b,c,f):new d(a,b,c,f)},s=q.prototype,t=r.prototype,u="undefined",v=u!==typeof a&&a,w=u!==typeof Uint8Array&&Uint8Array,x=u!==typeof ArrayBuffer&&ArrayBuffer,y=[0,0,0,0,0,0,0,0],z=Array.isArray||o,A=4294967296,B=16777216;s.buffer=t.buffer=void 0,s.offset=t.offset=0,s._isUint64BE=t._isInt64BE=!0,q.isUint64BE=function(a){return!(!a||!a._isUint64BE)},r.isInt64BE=function(a){return!(!a||!a._isInt64BE)},s.toNumber=function(){var a=this.buffer,b=this.offset,c=k(a,b),d=k(a,b+4);return c?c*A+d:d},t.toNumber=function(){var a=this.buffer,b=this.offset,c=0|k(a,b),d=k(a,b+4);return c?c*A+d:d},s.toArray=t.toArray=function(a){var b=this.buffer,c=this.offset;return p=null,a!==!1&&0===c&&8===b.length&&z(b)?b:j(b,c)},v&&(s.toBuffer=t.toBuffer=function(b){var c=this.buffer,d=this.offset;if(p=v,b!==!1&&0===d&&8===c.length&&a.isBuffer(c))return c;var e=new v(8);return g(e,0,c,d),e}),w&&(s.toArrayBuffer=t.toArrayBuffer=function(a){var b=this.buffer,c=this.offset,d=b.buffer;if(p=w,a!==!1&&0===c&&d instanceof x&&8===d.byteLength)return d;var e=new w(8);return g(e,0,b,c),e.buffer}),t.toString=function(a){return i(this.buffer,this.offset,a,!0)},s.toString=function(a){return i(this.buffer,this.offset,a,!1)},s.toJSON=s.toNumber,t.toJSON=t.toNumber}("object"==typeof c&&"string"!=typeof c.nodeName?c:this||{})}).call(this,a("buffer").Buffer)},{buffer:128}],65:[function(a,b,c){var d={}.toString;b.exports=Array.isArray||function(a){return"[object Array]"==d.call(a)}},{}],66:[function(a,b,c){"use strict";b.exports.Validation={isValidUTF8:function(a){return!0}}},{}],67:[function(a,b,c){"use strict";try{b.exports=a("bindings")("validation")}catch(c){b.exports=a("./fallback")}},{"./fallback":66,bindings:68}],68:[function(a,b,c){(function(d,e){function f(b){"string"==typeof b?b={bindings:b}:b||(b={}),b.__proto__=l,b.module_root||(b.module_root=c.getRoot(c.getFileName())),".node"!=h.extname(b.bindings)&&(b.bindings+=".node");for(var d,e,f,g=[],j=0,k=b.try.length;j<k;j++){d=i.apply(null,b.try[j].map(function(a){return b[a]||a})),g.push(d);try{return e=b.path?a.resolve(d):a(d),b.path||(e.path=d),e}catch(a){if(!/not find/i.test(a.message))throw a}}throw f=new Error("Could not locate the bindings file. Tried:\n"+g.map(function(a){return b.arrow+a}).join("\n")),f.tries=g,f}var g=a("fs"),h=a("path"),i=h.join,j=h.dirname,k=g.existsSync||h.existsSync,l={arrow:d.env.NODE_BINDINGS_ARROW||" → ",compiled:d.env.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:d.platform,arch:d.arch,version:d.versions.node,bindings:"bindings.node",try:[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"]]};b.exports=c=f,c.getFileName=function(a){var b,c=Error.prepareStackTrace,d=Error.stackTraceLimit,f={};return Error.stackTraceLimit=10,Error.prepareStackTrace=function(c,d){for(var f=0,g=d.length;f<g;f++)if(b=d[f].getFileName(),b!==e){if(!a)return;if(b!==a)return}},Error.captureStackTrace(f),f.stack,Error.prepareStackTrace=c,Error.stackTraceLimit=d,b},c.getRoot=function(a){for(var b,c=j(a);;){if("."===c&&(c=d.cwd()),k(i(c,"package.json"))||k(i(c,"node_modules")))return c;if(b===c)throw new Error('Could not find module root given file: "'+a+'". Do you have a `package.json` file? ');b=c,c=i(c,"..")}}}).call(this,a("_process"),"/package/node_modules/utf-8-validate/node_modules/bindings/bindings.js")},{_process:329,fs:112,path:328}],69:[function(a,b,c){!function(a){a(function(a){function b(a,b){return i(a,this,null==b?[]:j.call(b))}function c(a){var b=arguments.length>1?j.call(arguments,1):[];return function(){return i(a,this,b.concat(j.call(arguments)))}}function d(a,b,d){return h(c,b,d,a)}function e(a){var b=j.call(arguments,1);return function(){var c=this,d=j.call(arguments),e=g.apply(c,[a].concat(d));return f.reduce(b,function(a,b){return b.call(c,a)},e)}}var f=a("./when"),g=f.try,h=a("./lib/liftAll"),i=a("./lib/apply")(f.Promise),j=Array.prototype.slice;return{lift:c,liftAll:d,call:g,apply:b,compose:e}})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})},{"./lib/apply":73,"./lib/liftAll":85,"./when":93}],70:[function(a,b,c){!function(a){"use strict";a(function(a){var b=a("./makePromise"),c=a("./Scheduler"),d=a("./env").asap;return b({scheduler:new c(d)})})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})},{"./Scheduler":71,"./env":83,"./makePromise":86}],71:[function(a,b,c){!function(a){"use strict";a(function(){function a(a){this._async=a,this._running=!1,this._queue=this,this._queueLen=0,this._afterQueue={},this._afterQueueLen=0;var b=this;this.drain=function(){b._drain()}}return a.prototype.enqueue=function(a){this._queue[this._queueLen++]=a,this.run()},a.prototype.afterQueue=function(a){this._afterQueue[this._afterQueueLen++]=a,this.run()},a.prototype.run=function(){this._running||(this._running=!0,this._async(this.drain))},a.prototype._drain=function(){for(var a=0;a<this._queueLen;++a)this._queue[a].run(),this._queue[a]=void 0;for(this._queueLen=0,this._running=!1,a=0;a<this._afterQueueLen;++a)this._afterQueue[a].run(),this._afterQueue[a]=void 0;this._afterQueueLen=0},a})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],72:[function(a,b,c){!function(a){"use strict";a(function(){function a(b){Error.call(this),this.message=b,this.name=a.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,a)}return a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],73:[function(a,b,c){!function(a){"use strict";a(function(){function a(a,c){function d(b,d,f){var g=a._defer(),h=f.length,i=new Array(h);return e({f:b,thisArg:d,args:f,params:i,i:h-1,call:c},g._handler),g}function e(b,d){if(b.i<0)return c(b.f,b.thisArg,b.params,d);var e=a._handler(b.args[b.i]);e.fold(f,b,void 0,d)}function f(a,b,c){a.params[a.i]=b,a.i-=1,e(a,c)}return arguments.length<2&&(c=b),d}function b(a,b,c,d){try{d.resolve(a.apply(b,c))}catch(a){d.reject(a)}}return a.tryCatchResolve=b,a})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],74:[function(a,b,c){!function(a){"use strict";a(function(a){var b=a("../state"),c=a("../apply");return function(a){function d(b){function c(a){k=null,this.resolve(a)}function d(a){this.resolved||(k.push(a),0===--j&&this.reject(k))}for(var e,f,g=a._defer(),h=g._handler,i=b.length>>>0,j=i,k=[],l=0;l<i;++l)if(f=b[l],void 0!==f||l in b){if(e=a._handler(f),e.state()>0){h.become(e),a._visitRemaining(b,l,e);break}e.visit(h,c,d)}else--j;return 0===j&&h.reject(new RangeError("any(): array must not be empty")),g}function e(b,c){function d(a){this.resolved||(k.push(a),0===--n&&(l=null,this.resolve(k)))}function e(a){this.resolved||(l.push(a),0===--f&&(k=null,this.reject(l)))}var f,g,h,i=a._defer(),j=i._handler,k=[],l=[],m=b.length>>>0,n=0;for(h=0;h<m;++h)g=b[h],(void 0!==g||h in b)&&++n;for(c=Math.max(c,0),f=n-c+1,n=Math.min(c,n),c>n?j.reject(new RangeError("some(): array must contain at least "+c+" item(s), but had "+n)):0===n&&j.resolve(k),h=0;h<m;++h)g=b[h],(void 0!==g||h in b)&&a._handler(g).visit(j,d,e,j.notify);return i}function f(b,c){return a._traverse(c,b)}function g(b,c){var d=s.call(b);return a._traverse(c,d).then(function(a){return h(d,a)})}function h(b,c){for(var d=c.length,e=new Array(d),f=0,g=0;f<d;++f)c[f]&&(e[g++]=a._handler(b[f]).value);return e.length=g,e}function i(a){return p(a.map(j))}function j(c){var d=a._handler(c);return 0===d.state()?o(c).then(b.fulfilled,b.rejected):(d._unreport(),b.inspect(d))}function k(a,b){return arguments.length>2?q.call(a,m(b),arguments[2]):q.call(a,m(b))}function l(a,b){return arguments.length>2?r.call(a,m(b),arguments[2]):r.call(a,m(b))}function m(a){return function(b,c,d){return n(a,void 0,[b,c,d])}}var n=c(a),o=a.resolve,p=a.all,q=Array.prototype.reduce,r=Array.prototype.reduceRight,s=Array.prototype.slice;return a.any=d,a.some=e,a.settle=i,a.map=f,a.filter=g,a.reduce=k,a.reduceRight=l,a.prototype.spread=function(a){return this.then(p).then(function(b){return a.apply(this,b);
})},a}})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})},{"../apply":73,"../state":87}],75:[function(a,b,c){!function(a){"use strict";a(function(){function a(){throw new TypeError("catch predicate must be a function")}function b(a,b){return c(b)?a instanceof b:b(a)}function c(a){return a===Error||null!=a&&a.prototype instanceof Error}function d(a){return("object"==typeof a||"function"==typeof a)&&null!==a}function e(a){return a}return function(c){function f(a,c){return function(d){return b(d,c)?a.call(this,d):j(d)}}function g(a,b,c,e){var f=a.call(b);return d(f)?h(f,c,e):c(e)}function h(a,b,c){return i(a).then(function(){return b(c)})}var i=c.resolve,j=c.reject,k=c.prototype.catch;return c.prototype.done=function(a,b){this._handler.visit(this._handler.receiver,a,b)},c.prototype.catch=c.prototype.otherwise=function(b){return arguments.length<2?k.call(this,b):"function"!=typeof b?this.ensure(a):k.call(this,f(arguments[1],b))},c.prototype.finally=c.prototype.ensure=function(a){return"function"!=typeof a?this:this.then(function(b){return g(a,this,e,b)},function(b){return g(a,this,j,b)})},c.prototype.else=c.prototype.orElse=function(a){return this.then(void 0,function(){return a})},c.prototype.yield=function(a){return this.then(function(){return a})},c.prototype.tap=function(a){return this.then(a).yield(this)},c}})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],76:[function(a,b,c){!function(a){"use strict";a(function(){return function(a){return a.prototype.fold=function(b,c){var d=this._beget();return this._handler.fold(function(c,d,e){a._handler(c).fold(function(a,c,d){d.resolve(b.call(this,c,a))},d,this,e)},c,d._handler.receiver,d._handler),d},a}})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],77:[function(a,b,c){!function(a){"use strict";a(function(a){var b=a("../state").inspect;return function(a){return a.prototype.inspect=function(){return b(a._handler(this))},a}})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})},{"../state":87}],78:[function(a,b,c){!function(a){"use strict";a(function(){return function(a){function b(a,b,d,e){return c(function(b){return[b,a(b)]},b,d,e)}function c(a,b,e,f){function g(f,g){return d(e(f)).then(function(){return c(a,b,e,g)})}return d(f).then(function(c){return d(b(c)).then(function(b){return b?c:d(a(c)).spread(g)})})}var d=a.resolve;return a.iterate=b,a.unfold=c,a}})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],79:[function(a,b,c){!function(a){"use strict";a(function(){return function(a){return a.prototype.progress=function(a){return this.then(void 0,void 0,a)},a}})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],80:[function(a,b,c){!function(a){"use strict";a(function(a){function b(a,b,d,e){return c.setTimer(function(){a(d,e,b)},b)}var c=a("../env"),d=a("../TimeoutError");return function(a){function e(a,c,d){b(f,a,c,d)}function f(a,b){b.resolve(a)}function g(a,b,c){var e="undefined"==typeof a?new d("timed out after "+c+"ms"):a;b.reject(e)}return a.prototype.delay=function(a){var b=this._beget();return this._handler.fold(e,a,void 0,b._handler),b},a.prototype.timeout=function(a,d){var e=this._beget(),f=e._handler,h=b(g,a,d,e._handler);return this._handler.visit(f,function(a){c.clearTimer(h),this.resolve(a)},function(a){c.clearTimer(h),this.reject(a)},f.notify),e},a}})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})},{"../TimeoutError":72,"../env":83}],81:[function(a,b,c){!function(a){"use strict";a(function(a){function b(a){throw a}function c(){}var d=a("../env").setTimer,e=a("../format");return function(a){function f(a){a.handled||(n.push(a),k("Potentially unhandled rejection ["+a.id+"] "+e.formatError(a.value)))}function g(a){var b=n.indexOf(a);b>=0&&(n.splice(b,1),l("Handled previous rejection ["+a.id+"] "+e.formatObject(a.value)))}function h(a,b){m.push(a,b),null===o&&(o=d(i,0))}function i(){for(o=null;m.length>0;)m.shift()(m.shift())}var j,k=c,l=c;"undefined"!=typeof console&&(j=console,k="undefined"!=typeof j.error?function(a){j.error(a)}:function(a){j.log(a)},l="undefined"!=typeof j.info?function(a){j.info(a)}:function(a){j.log(a)}),a.onPotentiallyUnhandledRejection=function(a){h(f,a)},a.onPotentiallyUnhandledRejectionHandled=function(a){h(g,a)},a.onFatalRejection=function(a){h(b,a.value)};var m=[],n=[],o=null;return a}})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})},{"../env":83,"../format":84}],82:[function(a,b,c){!function(a){"use strict";a(function(){return function(a){return a.prototype.with=a.prototype.withThis=function(a){var b=this._beget(),c=b._handler;return c.receiver=a,this._handler.chain(c,a),b},a}})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],83:[function(a,b,c){(function(c){!function(a){"use strict";a(function(a){function b(){return"undefined"!=typeof c&&"[object process]"===Object.prototype.toString.call(c)}function d(){return"function"==typeof MutationObserver&&MutationObserver||"function"==typeof WebKitMutationObserver&&WebKitMutationObserver}function e(a){function b(){var a=c;c=void 0,a()}var c,d=document.createTextNode(""),e=new a(b);e.observe(d,{characterData:!0});var f=0;return function(a){c=a,d.data=f^=1}}var f,g="undefined"!=typeof setTimeout&&setTimeout,h=function(a,b){return setTimeout(a,b)},i=function(a){return clearTimeout(a)},j=function(a){return g(a,0)};if(b())j=function(a){return c.nextTick(a)};else if(f=d())j=e(f);else if(!g){var k=a,l=k("vertx");h=function(a,b){return l.setTimer(b,a)},i=l.cancelTimer,j=l.runOnLoop||l.runOnContext}return{setTimer:h,clearTimer:i,asap:j}})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})}).call(this,a("_process"))},{_process:329}],84:[function(a,b,c){!function(a){"use strict";a(function(){function a(a){var c="object"==typeof a&&null!==a&&(a.stack||a.message)?a.stack||a.message:b(a);return a instanceof Error?c:c+" (WARNING: non-Error used)"}function b(a){var b=String(a);return"[object Object]"===b&&"undefined"!=typeof JSON&&(b=c(a,b)),b}function c(a,b){try{return JSON.stringify(a)}catch(a){return b}}return{formatError:a,formatObject:b,tryStringify:c}})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],85:[function(a,b,c){!function(a){"use strict";a(function(){function a(a,b,c){return a[c]=b,a}function b(a){return"function"==typeof a?a.bind():Object.create(a)}return function(c,d,e,f){return"undefined"==typeof d&&(d=a),Object.keys(f).reduce(function(a,b){var e=f[b];return"function"==typeof e?d(a,c(e),b):a},"undefined"==typeof e?b(f):e)}})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],86:[function(a,b,c){(function(a){!function(b){"use strict";b(function(){return function(b){function c(a,b){this._handler=a===u?b:d(a)}function d(a){function b(a){e.resolve(a)}function c(a){e.reject(a)}function d(a){e.notify(a)}var e=new w;try{a(b,c,d)}catch(a){c(a)}return e}function e(a){return J(a)?a:new c(u,new x(r(a)))}function f(a){return new c(u,new x(new A(a)))}function g(){return aa}function h(){return new c(u,new w)}function i(a,b){var c=new w(a.receiver,a.join().context);return new b(u,c)}function j(a){return l(T,null,a)}function k(a,b){return l(O,a,b)}function l(a,b,d){function e(c,e,g){g.resolved||m(d,f,c,a(b,e,c),g)}function f(a,b,c){k[a]=b,0===--j&&c.become(new z(k))}for(var g,h="function"==typeof b?e:f,i=new w,j=d.length>>>0,k=new Array(j),l=0;l<d.length&&!i.resolved;++l)g=d[l],void 0!==g||l in d?m(d,h,l,g,i):--j;return 0===j&&i.become(new z(k)),new c(u,i)}function m(a,b,c,d,e){if(K(d)){var f=s(d),g=f.state();0===g?f.fold(b,c,void 0,e):g>0?b(c,f.value,e):(e.become(f),n(a,c+1,f))}else b(c,d,e)}function n(a,b,c){for(var d=b;d<a.length;++d)o(r(a[d]),c)}function o(a,b){if(a!==b){var c=a.state();0===c?a.visit(a,void 0,a._unreport):c<0&&a._unreport()}}function p(a){return"object"!=typeof a||null===a?f(new TypeError("non-iterable passed to race()")):0===a.length?g():1===a.length?e(a[0]):q(a)}function q(a){var b,d,e,f=new w;for(b=0;b<a.length;++b)if(d=a[b],void 0!==d||b in a){if(e=r(d),0!==e.state()){f.become(e),n(a,b+1,e);break}e.visit(f,f.resolve,f.reject)}return new c(u,f)}function r(a){return J(a)?a._handler.join():K(a)?t(a):new z(a)}function s(a){return J(a)?a._handler.join():t(a)}function t(a){try{var b=a.then;return"function"==typeof b?new y(b,a):new z(a)}catch(a){return new A(a)}}function u(){}function v(){}function w(a,b){c.createContext(this,b),this.consumers=void 0,this.receiver=a,this.handler=void 0,this.resolved=!1}function x(a){this.handler=a}function y(a,b){w.call(this),W.enqueue(new G(a,b,this))}function z(a){c.createContext(this),this.value=a}function A(a){c.createContext(this),this.id=++$,this.value=a,this.handled=!1,this.reported=!1,this._report()}function B(a,b){this.rejection=a,this.context=b}function C(a){this.rejection=a}function D(){return new A(new TypeError("Promise cycle"))}function E(a,b){this.continuation=a,this.handler=b}function F(a,b){this.handler=b,this.value=a}function G(a,b,c){this._then=a,this.thenable=b,this.resolver=c}function H(a,b,c,d,e){try{a.call(b,c,d,e)}catch(a){d(a)}}function I(a,b,c,d){this.f=a,this.z=b,this.c=c,this.to=d,this.resolver=Z,this.receiver=this}function J(a){return a instanceof c}function K(a){return("object"==typeof a||"function"==typeof a)&&null!==a}function L(a,b,d,e){return"function"!=typeof a?e.become(b):(c.enterContext(b),P(a,b.value,d,e),void c.exitContext())}function M(a,b,d,e,f){return"function"!=typeof a?f.become(d):(c.enterContext(d),Q(a,b,d.value,e,f),void c.exitContext())}function N(a,b,d,e,f){return"function"!=typeof a?f.notify(b):(c.enterContext(d),R(a,b,e,f),void c.exitContext())}function O(a,b,c){try{return a(b,c)}catch(a){return f(a)}}function P(a,b,c,d){try{d.become(r(a.call(c,b)))}catch(a){d.become(new A(a))}}function Q(a,b,c,d,e){try{a.call(d,b,c,e)}catch(a){e.become(new A(a))}}function R(a,b,c,d){try{d.notify(a.call(c,b))}catch(a){d.notify(a)}}function S(a,b){b.prototype=Y(a.prototype),b.prototype.constructor=b}function T(a,b){return b}function U(){}function V(){return"undefined"!=typeof a&&null!==a&&"function"==typeof a.emit?function(b,c){return"unhandledRejection"===b?a.emit(b,c.value,c):a.emit(b,c)}:"undefined"!=typeof self&&"function"==typeof CustomEvent?function(a,b,c){var d=!1;try{var e=new c("unhandledRejection");d=e instanceof c}catch(a){}return d?function(a,d){var e=new c(a,{detail:{reason:d.value,key:d},bubbles:!1,cancelable:!0});return!b.dispatchEvent(e)}:a}(U,self,CustomEvent):U}var W=b.scheduler,X=V(),Y=Object.create||function(a){function b(){}return b.prototype=a,new b};c.resolve=e,c.reject=f,c.never=g,c._defer=h,c._handler=r,c.prototype.then=function(a,b,c){var d=this._handler,e=d.join().state();if("function"!=typeof a&&e>0||"function"!=typeof b&&e<0)return new this.constructor(u,d);var f=this._beget(),g=f._handler;return d.chain(g,d.receiver,a,b,c),f},c.prototype.catch=function(a){return this.then(void 0,a)},c.prototype._beget=function(){return i(this._handler,this.constructor)},c.all=j,c.race=p,c._traverse=k,c._visitRemaining=n,u.prototype.when=u.prototype.become=u.prototype.notify=u.prototype.fail=u.prototype._unreport=u.prototype._report=U,u.prototype._state=0,u.prototype.state=function(){return this._state},u.prototype.join=function(){for(var a=this;void 0!==a.handler;)a=a.handler;return a},u.prototype.chain=function(a,b,c,d,e){this.when({resolver:a,receiver:b,fulfilled:c,rejected:d,progress:e})},u.prototype.visit=function(a,b,c,d){this.chain(Z,a,b,c,d)},u.prototype.fold=function(a,b,c,d){this.when(new I(a,b,c,d))},S(u,v),v.prototype.become=function(a){a.fail()};var Z=new v;S(u,w),w.prototype._state=0,w.prototype.resolve=function(a){this.become(r(a))},w.prototype.reject=function(a){this.resolved||this.become(new A(a))},w.prototype.join=function(){if(!this.resolved)return this;for(var a=this;void 0!==a.handler;)if(a=a.handler,a===this)return this.handler=D();return a},w.prototype.run=function(){var a=this.consumers,b=this.handler;this.handler=this.handler.join(),this.consumers=void 0;for(var c=0;c<a.length;++c)b.when(a[c])},w.prototype.become=function(a){this.resolved||(this.resolved=!0,this.handler=a,void 0!==this.consumers&&W.enqueue(this),void 0!==this.context&&a._report(this.context))},w.prototype.when=function(a){this.resolved?W.enqueue(new E(a,this.handler)):void 0===this.consumers?this.consumers=[a]:this.consumers.push(a)},w.prototype.notify=function(a){this.resolved||W.enqueue(new F(a,this))},w.prototype.fail=function(a){var b="undefined"==typeof a?this.context:a;this.resolved&&this.handler.join().fail(b)},w.prototype._report=function(a){this.resolved&&this.handler.join()._report(a)},w.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()},S(u,x),x.prototype.when=function(a){W.enqueue(new E(a,this))},x.prototype._report=function(a){this.join()._report(a)},x.prototype._unreport=function(){this.join()._unreport()},S(w,y),S(u,z),z.prototype._state=1,z.prototype.fold=function(a,b,c,d){M(a,b,this,c,d)},z.prototype.when=function(a){L(a.fulfilled,this,a.receiver,a.resolver)};var $=0;S(u,A),A.prototype._state=-1,A.prototype.fold=function(a,b,c,d){d.become(this)},A.prototype.when=function(a){"function"==typeof a.rejected&&this._unreport(),L(a.rejected,this,a.receiver,a.resolver)},A.prototype._report=function(a){W.afterQueue(new B(this,a))},A.prototype._unreport=function(){this.handled||(this.handled=!0,W.afterQueue(new C(this)))},A.prototype.fail=function(a){this.reported=!0,X("unhandledRejection",this),c.onFatalRejection(this,void 0===a?this.context:a)},B.prototype.run=function(){this.rejection.handled||this.rejection.reported||(this.rejection.reported=!0,X("unhandledRejection",this.rejection)||c.onPotentiallyUnhandledRejection(this.rejection,this.context))},C.prototype.run=function(){this.rejection.reported&&(X("rejectionHandled",this.rejection)||c.onPotentiallyUnhandledRejectionHandled(this.rejection))},c.createContext=c.enterContext=c.exitContext=c.onPotentiallyUnhandledRejection=c.onPotentiallyUnhandledRejectionHandled=c.onFatalRejection=U;var _=new u,aa=new c(u,_);return E.prototype.run=function(){this.handler.join().when(this.continuation)},F.prototype.run=function(){var a=this.handler.consumers;if(void 0!==a)for(var b,c=0;c<a.length;++c)b=a[c],N(b.progress,this.value,this.handler,b.receiver,b.resolver)},G.prototype.run=function(){function a(a){d.resolve(a)}function b(a){d.reject(a)}function c(a){d.notify(a)}var d=this.resolver;H(this._then,this.thenable,a,b,c)},I.prototype.fulfilled=function(a){this.f.call(this.c,this.z,a,this.to)},I.prototype.rejected=function(a){this.to.reject(a)},I.prototype.progress=function(a){this.to.notify(a)},c}})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})}).call(this,a("_process"))},{_process:329}],87:[function(a,b,c){!function(a){"use strict";a(function(){function a(){return{state:"pending"}}function b(a){return{state:"rejected",reason:a}}function c(a){return{state:"fulfilled",value:a}}function d(d){var e=d.state();return 0===e?a():e>0?c(d.value):b(d.value)}return{pending:a,fulfilled:c,rejected:b,inspect:d}})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],88:[function(a,b,c){!function(a){"use strict";a(function(a){var b=a("./monitor/PromiseMonitor"),c=a("./monitor/ConsoleReporter"),d=new b(new c);return function(a){return d.monitor(a)}})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})},{"./monitor/ConsoleReporter":89,"./monitor/PromiseMonitor":90}],89:[function(a,b,c){!function(a){"use strict";a(function(a){function b(){this._previouslyReported=!1}function c(){var a,b,c,e;if("undefined"==typeof console)a=b=d;else{var f=console;"function"==typeof f.error&&"function"==typeof f.dir?(b=function(a){f.error(a)},a=function(a){f.log(a)},"function"==typeof f.groupCollapsed&&(c=function(a){f.groupCollapsed(a)},e=function(){f.groupEnd()})):a=b="undefined"!=typeof f.log&&"undefined"!=typeof JSON?function(a){if("string"!=typeof a)try{a=JSON.stringify(a)}catch(a){}f.log(a)}:d}return{msg:a,warn:b,groupStart:c||b,groupEnd:e||d}}function d(){}var e=a("./error"),f="[promises] Unhandled rejections: ",g="[promises] All previously unhandled rejections have now been handled";return b.prototype=c(),b.prototype.log=function(a){if(0===a.length)return void(this._previouslyReported&&(this._previouslyReported=!1,this.msg(g)));this._previouslyReported=!0,this.groupStart(f+a.length);try{this._log(a)}finally{this.groupEnd()}},b.prototype._log=function(a){for(var b=0;b<a.length;++b)this.warn(e.format(a[b]))},b})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})},{"./error":92}],90:[function(a,b,c){!function(a){"use strict";a(function(a){function b(a){this.logDelay=0,this.stackFilter=g,this.stackJumpSeparator=f,this.filterDuplicateFrames=!0,this._reporter=a,"function"==typeof a.configurePromiseMonitor&&a.configurePromiseMonitor(this),this._traces=[],this._traceTask=0;var b=this;this._doLogTraces=function(){b._logTraces()}}function c(a,b,c){b.length>1&&(b[0]=c,a.push.apply(a,b))}function d(a,b){return b.filter(function(b){return!a.test(b)})}function e(a){return!a.handler.handled}var f="from execution context:",g=/[\s\(\/\\](node|module|timers)\.js:|when([\/\\]{1,2}(lib|monitor|es6-shim)[\/\\]{1,2}|\.js)|(new\sPromise)\b|(\b(PromiseMonitor|ConsoleReporter|Scheduler|RunHandlerTask|ProgressTask|Promise|.*Handler)\.[\w_]\w\w+\b)|\b(tryCatch\w+|getHandler\w*)\b/i,h=a("../lib/env").setTimer,i=a("./error"),j=[];return b.prototype.monitor=function(a){var b=this;return a.createContext=function(a,c){a.context=b.createContext(a,c)},a.enterContext=function(a){j.push(a.context)},a.exitContext=function(){j.pop()},a.onPotentiallyUnhandledRejection=function(a,c){return b.addTrace(a,c)},a.onPotentiallyUnhandledRejectionHandled=function(a){return b.removeTrace(a)},a.onFatalRejection=function(a,c){return b.fatal(a,c)},this},b.prototype.createContext=function(a,b){var c={parent:b||j[j.length-1],stack:void 0};return i.captureStack(c,a.constructor),c},b.prototype.addTrace=function(a,b){var c,d;for(d=this._traces.length-1;d>=0&&(c=this._traces[d],c.handler!==a);--d);d>=0?c.extraContext=b:this._traces.push({handler:a,extraContext:b}),this.logTraces()},b.prototype.removeTrace=function(){this.logTraces()},b.prototype.fatal=function(a,b){var c=new Error;c.stack=this._createLongTrace(a.value,a.context,b).join("\n"),h(function(){throw c},0)},b.prototype.logTraces=function(){this._traceTask||(this._traceTask=h(this._doLogTraces,this.logDelay))},b.prototype._logTraces=function(){this._traceTask=void 0,this._traces=this._traces.filter(e),this._reporter.log(this.formatTraces(this._traces))},b.prototype.formatTraces=function(a){return a.map(function(a){return this._createLongTrace(a.handler.value,a.handler.context,a.extraContext)},this)},b.prototype._createLongTrace=function(a,b,c){var e=i.parse(a)||[String(a)+" (WARNING: non-Error used)"];return e=d(this.stackFilter,e,0),this._appendContext(e,b),this._appendContext(e,c),this.filterDuplicateFrames?this._removeDuplicates(e):e},b.prototype._removeDuplicates=function(a){var b={},c=this.stackJumpSeparator,d=0;return a.reduceRight(function(a,e,f){return 0===f?a.unshift(e):e===c?d>0&&(a.unshift(e),d=0):b[e]||(b[e]=!0,a.unshift(e),++d),a},[])},b.prototype._appendContext=function(a,b){a.push.apply(a,this._createTrace(b))},b.prototype._createTrace=function(a){for(var b,e=[];a;)b=i.parse(a),b&&(b=d(this.stackFilter,b),c(e,b,this.stackJumpSeparator)),a=a.parent;return e},b})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})},{"../lib/env":83,"./error":92}],91:[function(a,b,c){!function(a){"use strict";a(function(a){var b=a("../monitor"),c=a("../when").Promise;return b(c)})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})},{"../monitor":88,"../when":93}],92:[function(a,b,c){!function(a){"use strict";a(function(){function a(a){try{throw new Error}catch(b){a.stack=b.stack}}function b(a){a.stack=(new Error).stack}function c(a){return e(a)}function d(a){var b=new Error;return b.stack=c(a),b}function e(a){for(var b=!1,c="",d=0;d<a.length;++d)b?c+="\n"+a[d]:(c+=a[d],b=!0);return c}var f,g,h;return Error.captureStackTrace?(f=function(a){return a&&a.stack&&a.stack.split("\n")},h=c,g=Error.captureStackTrace):(f=function(a){var b=a&&a.stack&&a.stack.split("\n");return b&&a.message&&b.unshift(a.message),b},function(){var e=new Error;"string"!=typeof e.stack?(h=c,g=a):(h=d,g=b)}()),{parse:f,format:h,captureStack:g}})}("function"==typeof define&&define.amd?define:function(a){b.exports=a()})},{}],93:[function(a,b,c){!function(a){"use strict";a(function(a){function b(a,b,c,d){var e=x.resolve(a);return arguments.length<2?e:e.then(b,c,d)}function c(a){return new x(a)}function d(a){return function(){for(var b=0,c=arguments.length,d=new Array(c);b<c;++b)d[b]=arguments[b];return y(a,this,d)}}function e(a){for(var b=0,c=arguments.length-1,d=new Array(c);b<c;++b)d[b]=arguments[b+1];return y(a,this,d)}function f(){return new g}function g(){function a(a){d._handler.resolve(a)}function b(a){d._handler.reject(a)}function c(a){d._handler.notify(a)}var d=x._defer();this.promise=d,this.resolve=a,this.reject=b,this.notify=c,this.resolver={resolve:a,reject:b,notify:c}}function h(a){return a&&"function"==typeof a.then}function i(){return x.all(arguments)}function j(a){return b(a,x.all)}function k(a){return b(a,x.settle)}function l(a,c){return b(a,function(a){return x.map(a,c)})}function m(a,c){return b(a,function(a){return x.filter(a,c)})}var n=a("./lib/decorators/timed"),o=a("./lib/decorators/array"),p=a("./lib/decorators/flow"),q=a("./lib/decorators/fold"),r=a("./lib/decorators/inspect"),s=a("./lib/decorators/iterate"),t=a("./lib/decorators/progress"),u=a("./lib/decorators/with"),v=a("./lib/decorators/unhandledRejection"),w=a("./lib/TimeoutError"),x=[o,p,q,s,t,r,u,n,v].reduce(function(a,b){return b(a)},a("./lib/Promise")),y=a("./lib/apply")(x);return b.promise=c,b.resolve=x.resolve,b.reject=x.reject,b.lift=d,b.try=e,b.attempt=e,b.iterate=x.iterate,b.unfold=x.unfold,b.join=i,b.all=j,b.settle=k,b.any=d(x.any),b.some=d(x.some),b.race=d(x.race),b.map=l,b.filter=m,b.reduce=d(x.reduce),b.reduceRight=d(x.reduceRight),b.isPromiseLike=h,b.Promise=x,b.defer=f,b.TimeoutError=w,b})}("function"==typeof define&&define.amd?define:function(c){b.exports=c(a)})},{"./lib/Promise":70,"./lib/TimeoutError":72,"./lib/apply":73,"./lib/decorators/array":74,"./lib/decorators/flow":75,"./lib/decorators/fold":76,"./lib/decorators/inspect":77,"./lib/decorators/iterate":78,"./lib/decorators/progress":79,"./lib/decorators/timed":80,"./lib/decorators/unhandledRejection":81,"./lib/decorators/with":82}],94:[function(a,b,c){"use strict";var d=b.exports=a("./lib/WebSocket");d.Server=a("./lib/WebSocketServer"),d.Sender=a("./lib/Sender"),d.Receiver=a("./lib/Receiver"),d.createServer=function(a,b){var c=new d.Server(a);return"function"==typeof b&&c.on("connection",b),c},d.connect=d.createConnection=function(a,b){var c=new d(a);return"function"==typeof b&&c.on("open",b),c}},{"./lib/Receiver":102,"./lib/Sender":104,"./lib/WebSocket":107,"./lib/WebSocketServer":108}],95:[function(a,b,c){(function(c){function d(a,b,e){if(this instanceof d==!1)throw new TypeError("Classes can't be function-called");"function"==typeof a?(e=b,b=a,a=0):"undefined"==typeof a&&(a=0),this._growStrategy=(b||function(a,b){return a.used+b}).bind(null,this),this._shrinkStrategy=(e||function(b){return a}).bind(null,this),this._buffer=a?new c(a):null,this._offset=0,this._used=0,this._changeFactor=0,this.__defineGetter__("size",function(){return null==this._buffer?0:this._buffer.length}),this.__defineGetter__("used",function(){return this._used})}a("util");d.prototype.get=function(a){if(null==this._buffer||this._offset+a>this._buffer.length){var b=new c(this._growStrategy(a));this._buffer=b,this._offset=0}this._used+=a;var d=this._buffer.slice(this._offset,this._offset+a);return this._offset+=a,d},d.prototype.reset=function(a){var b=this._shrinkStrategy();b<this.size&&(this._changeFactor-=1),(a||this._changeFactor<-2)&&(this._changeFactor=0,this._buffer=b?new c(b):null),this._offset=0,this._used=0},b.exports=d}).call(this,a("buffer").Buffer)},{buffer:128,util:359}],96:[function(a,b,c){b.exports.BufferUtil={merge:function(a,b){for(var c=0,d=0,e=b.length;d<e;++d){var f=b[d];f.copy(a,c),c+=f.length}},mask:function(a,b,c,d,e){for(var f=b.readUInt32LE(0,!0),g=0;g<e-3;g+=4){var h=f^a.readUInt32LE(g,!0);h<0&&(h=4294967296+h),c.writeUInt32LE(h,d+g,!0)}switch(e%4){case 3:c[d+g+2]=a[g+2]^b[2];case 2:c[d+g+1]=a[g+1]^b[1];case 1:c[d+g]=a[g]^b[0];case 0:}},unmask:function(a,b){for(var c=b.readUInt32LE(0,!0),d=a.length,e=0;e<d-3;e+=4){var f=c^a.readUInt32LE(e,!0);f<0&&(f=4294967296+f),a.writeUInt32LE(f,e,!0)}switch(d%4){case 3:a[e+2]=a[e+2]^b[2];case 2:a[e+1]=a[e+1]^b[1];case 1:a[e]=a[e]^b[0];case 0:}}}},{}],97:[function(a,b,c){"use strict";try{b.exports=a("bufferutil")}catch(c){b.exports=a("./BufferUtil.fallback")}},{"./BufferUtil.fallback":96,bufferutil:22}],98:[function(a,b,c){b.exports={isValidErrorCode:function(a){return a>=1e3&&a<=1011&&1004!=a&&1005!=a&&1006!=a||a>=3e3&&a<=4999},1e3:"normal",1001:"going away",1002:"protocol error",1003:"unsupported data",1004:"reserved",1005:"reserved for extensions",1006:"reserved for extensions",1007:"inconsistent or invalid data",1008:"policy violation",1009:"message too big",1010:"extension handshake missing",1011:"an unexpected condition prevented the request from being fulfilled"}},{}],99:[function(a,b,c){function d(a){a=a||"";var b={};return a.split(",").forEach(function(a){var c=a.split(";"),d=c.shift().trim(),e=b[d]=b[d]||[],f={};c.forEach(function(a){var b=a.trim().split("="),c=b[0],d=b[1];"undefined"==typeof d?d=!0:('"'===d[0]&&(d=d.slice(1)),'"'===d[d.length-1]&&(d=d.slice(0,d.length-1))),(f[c]=f[c]||[]).push(d)}),e.push(f)}),b}function e(a){return Object.keys(a).map(function(b){var c=a[b];return f.isArray(c)||(c=[c]),c.map(function(a){return[b].concat(Object.keys(a).map(function(b){var c=a[b];return f.isArray(c)||(c=[c]),c.map(function(a){return a===!0?b:b+"="+a}).join("; ")})).join("; ")}).join(", ")}).join(", ")}var f=a("util");c.parse=d,c.format=e},{util:359}],100:[function(a,b,c){(function(c){function d(a,b){if(this instanceof d==!1)throw new TypeError("Classes can't be function-called");this._options=a||{},this._isServer=!!b,this._inflate=null,this._deflate=null,this.params=null}var e=a("zlib"),f=[8,9,10,11,12,13,14,15],g=15,h=8;d.extensionName="permessage-deflate",d.prototype.offer=function(){var a={};return this._options.serverNoContextTakeover&&(a.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(a.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(a.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?a.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(a.client_max_window_bits=!0),a},d.prototype.accept=function(a){a=this.normalizeParams(a);var b;return b=this._isServer?this.acceptAsServer(a):this.acceptAsClient(a),this.params=b,b},d.prototype.cleanup=function(){this._inflate&&(this._inflate.writeInProgress?this._inflate.pendingClose=!0:(this._inflate.close&&this._inflate.close(),this._inflate=null)),this._deflate&&(this._deflate.writeInProgress?this._deflate.pendingClose=!0:(this._deflate.close&&this._deflate.close(),this._deflate=null))},d.prototype.acceptAsServer=function(a){var b={},c=a.some(function(a){if(b={},(this._options.serverNoContextTakeover!==!1||!a.server_no_context_takeover)&&(this._options.serverMaxWindowBits!==!1||!a.server_max_window_bits)&&!("number"==typeof this._options.serverMaxWindowBits&&"number"==typeof a.server_max_window_bits&&this._options.serverMaxWindowBits>a.server_max_window_bits)&&("number"!=typeof this._options.clientMaxWindowBits||a.client_max_window_bits))return(this._options.serverNoContextTakeover||a.server_no_context_takeover)&&(b.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(b.client_no_context_takeover=!0),this._options.clientNoContextTakeover!==!1&&a.client_no_context_takeover&&(b.client_no_context_takeover=!0),"number"==typeof this._options.serverMaxWindowBits?b.server_max_window_bits=this._options.serverMaxWindowBits:"number"==typeof a.server_max_window_bits&&(b.server_max_window_bits=a.server_max_window_bits),"number"==typeof this._options.clientMaxWindowBits?b.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits!==!1&&"number"==typeof a.client_max_window_bits&&(b.client_max_window_bits=a.client_max_window_bits),!0},this);if(!c)throw new Error("Doesn't support the offered configuration");return b},d.prototype.acceptAsClient=function(a){var b=a[0];if(null!=this._options.clientNoContextTakeover&&this._options.clientNoContextTakeover===!1&&b.client_no_context_takeover)throw new Error('Invalid value for "client_no_context_takeover"');if(null!=this._options.clientMaxWindowBits){if(this._options.clientMaxWindowBits===!1&&b.client_max_window_bits)throw new Error('Invalid value for "client_max_window_bits"');if("number"==typeof this._options.clientMaxWindowBits&&(!b.client_max_window_bits||b.client_max_window_bits>this._options.clientMaxWindowBits))throw new Error('Invalid value for "client_max_window_bits"')}return b},d.prototype.normalizeParams=function(a){return a.map(function(a){return Object.keys(a).forEach(function(b){var c=a[b];if(c.length>1)throw new Error("Multiple extension parameters for "+b);switch(c=c[0],b){case"server_no_context_takeover":case"client_no_context_takeover":if(c!==!0)throw new Error("invalid extension parameter value for "+b+" ("+c+")");a[b]=!0;break;case"server_max_window_bits":case"client_max_window_bits":if("string"==typeof c&&(c=parseInt(c,10),!~f.indexOf(c)))throw new Error("invalid extension parameter value for "+b+" ("+c+")");if(!this._isServer&&c===!0)throw new Error("Missing extension parameter value for "+b);a[b]=c;break;default:throw new Error("Not defined extension parameter ("+b+")")}},this),a},this)},d.prototype.decompress=function(a,b,d){function f(a){i(),d(a)}function h(a){m.push(a)}function i(){l._inflate&&(l._inflate.removeListener("error",f),l._inflate.removeListener("data",h),l._inflate.writeInProgress=!1,(b&&l.params[j+"_no_context_takeover"]||l._inflate.pendingClose)&&(l._inflate.close&&l._inflate.close(),l._inflate=null))}var j=this._isServer?"client":"server";if(!this._inflate){var k=this.params[j+"_max_window_bits"];this._inflate=e.createInflateRaw({windowBits:"number"==typeof k?k:g})}this._inflate.writeInProgress=!0;var l=this,m=[];this._inflate.on("error",f).on("data",h),this._inflate.write(a),b&&this._inflate.write(new c([0,0,255,255])),this._inflate.flush(function(){i(),d(null,c.concat(m))})},d.prototype.compress=function(a,b,d){function f(a){j(),d(a)}function i(a){n.push(a)}function j(){m._deflate&&(m._deflate.removeListener("error",f),m._deflate.removeListener("data",i),m._deflate.writeInProgress=!1,(b&&m.params[k+"_no_context_takeover"]||m._deflate.pendingClose)&&(m._deflate.close&&m._deflate.close(),m._deflate=null))}var k=this._isServer?"server":"client";if(!this._deflate){var l=this.params[k+"_max_window_bits"];this._deflate=e.createDeflateRaw({flush:e.Z_SYNC_FLUSH,windowBits:"number"==typeof l?l:g,memLevel:this._options.memLevel||h})}this._deflate.writeInProgress=!0;var m=this,n=[];this._deflate.on("error",f).on("data",i),this._deflate.write(a),this._deflate.flush(function(){j();var a=c.concat(n);b&&(a=a.slice(0,a.length-4)),d(null,a)})},b.exports=d}).call(this,a("buffer").Buffer)},{buffer:128,zlib:127}],101:[function(a,b,c){(function(c){function d(){if(this instanceof d==!1)throw new TypeError("Classes can't be function-called");this.state=f,this.buffers=[],this.messageEnd=-1,this.spanLength=0,this.dead=!1,this.onerror=function(){},
this.ontext=function(){},this.onbinary=function(){},this.onclose=function(){},this.onping=function(){},this.onpong=function(){}}function e(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c]===b)return c;return-1}var f=(a("util"),0),g=1,h=2,i=3;b.exports=d,d.prototype.add=function(a){function b(){if(c.state===f){if(2==a.length&&255==a[0]&&0==a[1])return c.reset(),void c.onclose();if(128===a[0])c.messageEnd=0,c.state=h,a=a.slice(1);else{if(0!==a[0])return void c.error("payload must start with 0x00 byte",!0);a=a.slice(1),c.state=g}}if(c.state===h){for(var b=0;b<a.length&&128&a[b];)c.messageEnd=128*c.messageEnd+(127&a[b]),++b;b<a.length&&(c.messageEnd=128*c.messageEnd+(127&a[b]),c.state=i,++b),b>0&&(a=a.slice(b))}if(c.state===i){var d=c.messageEnd-c.spanLength;return a.length>=d?(c.buffers.push(a),c.spanLength+=d,c.messageEnd=d,c.parse()):(c.buffers.push(a),void(c.spanLength+=a.length))}return c.buffers.push(a),(c.messageEnd=e(a,255))!=-1?(c.spanLength+=c.messageEnd,c.parse()):void(c.spanLength+=a.length)}for(var c=this;a;)a=b()},d.prototype.cleanup=function(){this.dead=!0,this.state=f,this.buffers=[]},d.prototype.parse=function(){for(var a=new c(this.spanLength),b=0,d=0,e=this.buffers.length;d<e-1;++d){var f=this.buffers[d];f.copy(a,b),b+=f.length}var h=this.buffers[this.buffers.length-1];this.messageEnd>0&&h.copy(a,b,0,this.messageEnd),this.state!==g&&--this.messageEnd;var i=null;return this.messageEnd<h.length-1&&(i=h.slice(this.messageEnd+1)),this.reset(),this.ontext(a.toString("utf8")),i},d.prototype.error=function(a,b){return this.reset(),this.onerror(a,b),this},d.prototype.reset=function(a){this.dead||(this.state=f,this.buffers=[],this.messageEnd=-1,this.spanLength=0)}}).call(this,a("buffer").Buffer)},{buffer:128,util:359}],102:[function(a,b,c){(function(c){function d(a){if(this instanceof d==!1)throw new TypeError("Classes can't be function-called");var b=-1;this.fragmentedBufferPool=new k(1024,function(a,b){return a.used+b},function(a){return b=b>=0?Math.ceil((b+a.used)/2):a.used});var e=-1;this.unfragmentedBufferPool=new k(1024,function(a,b){return a.used+b},function(a){return e=e>=0?Math.ceil((e+a.used)/2):a.used}),this.extensions=a||{},this.state={activeFragmentedOperation:null,lastFragment:!1,masked:!1,opcode:0,fragmentedOperation:!1},this.overflow=[],this.headerBuffer=new c(10),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.currentMessage=[],this.messageHandlers=[],this.expectHeader(2,this.processPacket),this.dead=!1,this.processing=!1,this.onerror=function(){},this.ontext=function(){},this.onbinary=function(){},this.onclose=function(){},this.onping=function(){},this.onpong=function(){}}function e(a){return(this[a]<<8)+this[a+1]}function f(a){return(this[a]<<24)+(this[a+1]<<16)+(this[a+2]<<8)+this[a+3]}function g(a,b,c,d){switch(a){default:b.copy(c,d,0,a);break;case 16:c[d+15]=b[15];case 15:c[d+14]=b[14];case 14:c[d+13]=b[13];case 13:c[d+12]=b[12];case 12:c[d+11]=b[11];case 11:c[d+10]=b[10];case 10:c[d+9]=b[9];case 9:c[d+8]=b[8];case 8:c[d+7]=b[7];case 7:c[d+6]=b[6];case 6:c[d+5]=b[5];case 5:c[d+4]=b[4];case 4:c[d+3]=b[3];case 3:c[d+2]=b[2];case 2:c[d+1]=b[1];case 1:c[d]=b[0]}}function h(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var i=(a("util"),a("./Validation").Validation),j=a("./ErrorCodes"),k=a("./BufferPool"),l=a("./BufferUtil").BufferUtil,m=a("./PerMessageDeflate");b.exports=d,d.prototype.add=function(a){var b=a.length;if(0!=b){if(null==this.expectBuffer)return void this.overflow.push(a);var c=Math.min(b,this.expectBuffer.length-this.expectOffset);for(g(c,a,this.expectBuffer,this.expectOffset),this.expectOffset+=c,c<b&&this.overflow.push(a.slice(c));this.expectBuffer&&this.expectOffset==this.expectBuffer.length;){var d=this.expectBuffer;this.expectBuffer=null,this.expectOffset=0,this.expectHandler.call(this,d)}}},d.prototype.cleanup=function(){this.dead=!0,this.overflow=null,this.headerBuffer=null,this.expectBuffer=null,this.expectHandler=null,this.unfragmentedBufferPool=null,this.fragmentedBufferPool=null,this.state=null,this.currentMessage=null,this.onerror=null,this.ontext=null,this.onbinary=null,this.onclose=null,this.onping=null,this.onpong=null},d.prototype.expectHeader=function(a,b){if(0==a)return void b(null);this.expectBuffer=this.headerBuffer.slice(this.expectOffset,this.expectOffset+a),this.expectHandler=b;for(var c=a;c>0&&this.overflow.length>0;){var d=this.overflow.pop();c<d.length&&this.overflow.push(d.slice(c));var e=Math.min(d.length,c);g(e,d,this.expectBuffer,this.expectOffset),this.expectOffset+=e,c-=e}},d.prototype.expectData=function(a,b){if(0==a)return void b(null);this.expectBuffer=this.allocateFromPool(a,this.state.fragmentedOperation),this.expectHandler=b;for(var c=a;c>0&&this.overflow.length>0;){var d=this.overflow.pop();c<d.length&&this.overflow.push(d.slice(c));var e=Math.min(d.length,c);g(e,d,this.expectBuffer,this.expectOffset),this.expectOffset+=e,c-=e}},d.prototype.allocateFromPool=function(a,b){return(b?this.fragmentedBufferPool:this.unfragmentedBufferPool).get(a)},d.prototype.processPacket=function(a){if(this.extensions[m.extensionName]){if(0!=(48&a[0]))return void this.error("reserved fields (2, 3) must be empty",1002)}else if(0!=(112&a[0]))return void this.error("reserved fields must be empty",1002);this.state.lastFragment=128==(128&a[0]),this.state.masked=128==(128&a[1]);var b=64==(64&a[0]),c=15&a[0];if(0===c){if(b)return void this.error("continuation frame cannot have the Per-message Compressed bits",1002);if(this.state.fragmentedOperation=!0,this.state.opcode=this.state.activeFragmentedOperation,1!=this.state.opcode&&2!=this.state.opcode)return void this.error("continuation frame cannot follow current opcode",1002)}else{if(c<3&&null!=this.state.activeFragmentedOperation)return void this.error("data frames after the initial data frame must have opcode 0",1002);if(c>=8&&b)return void this.error("control frames cannot have the Per-message Compressed bits",1002);this.state.compressed=b,this.state.opcode=c,this.state.lastFragment===!1?(this.state.fragmentedOperation=!0,this.state.activeFragmentedOperation=c):this.state.fragmentedOperation=!1}var d=n[this.state.opcode];"undefined"==typeof d?this.error("no handler for opcode "+this.state.opcode,1002):d.start.call(this,a)},d.prototype.endPacket=function(){this.state.fragmentedOperation?this.state.lastFragment&&this.fragmentedBufferPool.reset(!0):this.unfragmentedBufferPool.reset(!0),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.state.lastFragment&&this.state.opcode===this.state.activeFragmentedOperation&&(this.state.activeFragmentedOperation=null),this.state.lastFragment=!1,this.state.opcode=null!=this.state.activeFragmentedOperation?this.state.activeFragmentedOperation:0,this.state.masked=!1,this.expectHeader(2,this.processPacket)},d.prototype.reset=function(){this.dead||(this.state={activeFragmentedOperation:null,lastFragment:!1,masked:!1,opcode:0,fragmentedOperation:!1},this.fragmentedBufferPool.reset(!0),this.unfragmentedBufferPool.reset(!0),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.overflow=[],this.currentMessage=[],this.messageHandlers=[])},d.prototype.unmask=function(a,b,c){return null!=a&&null!=b&&l.unmask(b,a),c?b:null!=b?b.toString("utf8"):""},d.prototype.concatBuffers=function(a){for(var b=0,d=0,e=a.length;d<e;++d)b+=a[d].length;var f=new c(b);return l.merge(f,a),f},d.prototype.error=function(a,b){return this.reset(),this.onerror(a,b),this},d.prototype.flush=function(){if(!this.processing&&!this.dead){var a=this.messageHandlers.shift();if(a){this.processing=!0;var b=this;a(function(){b.processing=!1,b.flush()})}}},d.prototype.applyExtensions=function(a,b,c,d){var e=this;c?this.extensions[m.extensionName].decompress(a,b,function(a,b){if(!e.dead)return a?void d(new Error("invalid compressed data")):void d(null,b)}):d(null,a)};var n={1:{start:function(a){var b=this,c=127&a[1];c<126?n[1].getData.call(b,c):126==c?b.expectHeader(2,function(a){n[1].getData.call(b,e.call(a,0))}):127==c&&b.expectHeader(8,function(a){return 0!=f.call(a,0)?void b.error("packets with length spanning more than 32 bit is currently not supported",1008):void n[1].getData.call(b,f.call(a,4))})},getData:function(a){var b=this;b.state.masked?b.expectHeader(4,function(c){var d=c;b.expectData(a,function(a){n[1].finish.call(b,d,a)})}):b.expectData(a,function(a){n[1].finish.call(b,null,a)})},finish:function(a,b){var d=this,e=this.unmask(a,b,!0)||new c(0),f=h(this.state);this.messageHandlers.push(function(a){d.applyExtensions(e,f.lastFragment,f.compressed,function(b,c){if(b)return d.error(b.message,1007);if(null!=c&&d.currentMessage.push(c),f.lastFragment){var e=d.concatBuffers(d.currentMessage);if(d.currentMessage=[],!i.isValidUTF8(e))return void d.error("invalid utf8 sequence",1007);d.ontext(e.toString("utf8"),{masked:f.masked,buffer:e})}a()})}),this.flush(),this.endPacket()}},2:{start:function(a){var b=this,c=127&a[1];c<126?n[2].getData.call(b,c):126==c?b.expectHeader(2,function(a){n[2].getData.call(b,e.call(a,0))}):127==c&&b.expectHeader(8,function(a){return 0!=f.call(a,0)?void b.error("packets with length spanning more than 32 bit is currently not supported",1008):void n[2].getData.call(b,f.call(a,4,!0))})},getData:function(a){var b=this;b.state.masked?b.expectHeader(4,function(c){var d=c;b.expectData(a,function(a){n[2].finish.call(b,d,a)})}):b.expectData(a,function(a){n[2].finish.call(b,null,a)})},finish:function(a,b){var d=this,e=this.unmask(a,b,!0)||new c(0),f=h(this.state);this.messageHandlers.push(function(a){d.applyExtensions(e,f.lastFragment,f.compressed,function(b,c){if(b)return d.error(b.message,1007);if(null!=c&&d.currentMessage.push(c),f.lastFragment){var e=d.concatBuffers(d.currentMessage);d.currentMessage=[],d.onbinary(e,{masked:f.masked,buffer:e})}a()})}),this.flush(),this.endPacket()}},8:{start:function(a){var b=this;if(0==b.state.lastFragment)return void b.error("fragmented close is not supported",1002);var c=127&a[1];c<126?n[8].getData.call(b,c):b.error("control frames cannot have more than 125 bytes of data",1002)},getData:function(a){var b=this;b.state.masked?b.expectHeader(4,function(c){var d=c;b.expectData(a,function(a){n[8].finish.call(b,d,a)})}):b.expectData(a,function(a){n[8].finish.call(b,null,a)})},finish:function(a,b){var c=this;b=c.unmask(a,b,!0);var d=h(this.state);this.messageHandlers.push(function(){if(b&&1==b.length)return void c.error("close packets with data must be at least two bytes long",1002);var a=b&&b.length>1?e.call(b,0):1e3;if(!j.isValidErrorCode(a))return void c.error("invalid error code",1002);var f="";if(b&&b.length>2){var g=b.slice(2);if(!i.isValidUTF8(g))return void c.error("invalid utf8 sequence",1007);f=g.toString("utf8")}c.onclose(a,f,{masked:d.masked}),c.reset()}),this.flush()}},9:{start:function(a){var b=this;if(0==b.state.lastFragment)return void b.error("fragmented ping is not supported",1002);var c=127&a[1];c<126?n[9].getData.call(b,c):b.error("control frames cannot have more than 125 bytes of data",1002)},getData:function(a){var b=this;b.state.masked?b.expectHeader(4,function(c){var d=c;b.expectData(a,function(a){n[9].finish.call(b,d,a)})}):b.expectData(a,function(a){n[9].finish.call(b,null,a)})},finish:function(a,b){var c=this;b=this.unmask(a,b,!0);var d=h(this.state);this.messageHandlers.push(function(a){c.onping(b,{masked:d.masked,binary:!0}),a()}),this.flush(),this.endPacket()}},10:{start:function(a){var b=this;if(0==b.state.lastFragment)return void b.error("fragmented pong is not supported",1002);var c=127&a[1];c<126?n[10].getData.call(b,c):b.error("control frames cannot have more than 125 bytes of data",1002)},getData:function(a){var b=this;this.state.masked?this.expectHeader(4,function(c){var d=c;b.expectData(a,function(a){n[10].finish.call(b,d,a)})}):this.expectData(a,function(a){n[10].finish.call(b,null,a)})},finish:function(a,b){var c=this;b=c.unmask(a,b,!0);var d=h(this.state);this.messageHandlers.push(function(a){c.onpong(b,{masked:d.masked,binary:!0}),a()}),this.flush(),this.endPacket()}}}}).call(this,a("buffer").Buffer)},{"./BufferPool":95,"./BufferUtil":97,"./ErrorCodes":98,"./PerMessageDeflate":100,"./Validation":106,buffer:128,util:359}],103:[function(a,b,c){(function(c){function d(a){if(this instanceof d==!1)throw new TypeError("Classes can't be function-called");e.EventEmitter.call(this),this.socket=a,this.continuationFrame=!1,this.isClosed=!1}var e=a("events"),f=a("util");e.EventEmitter;b.exports=d,f.inherits(d,e.EventEmitter),d.prototype.send=function(a,b,d){if(!this.isClosed){var e="string"==typeof a,f=e?c.byteLength(a):a.length,g=f>127?2:1,h=0==this.continuationFrame,i=!b||!("undefined"!=typeof b.fin&&!b.fin),j=new c((h?b&&b.binary?1+g:1:0)+f+(!i||b&&b.binary?0:1)),k=h?1:0;h&&(b&&b.binary?(j.write("","binary"),g>1&&j.write(String.fromCharCode(128+f/128),k++,"binary"),j.write(String.fromCharCode(127&f),k++,"binary")):j.write("\0","binary")),e?j.write(a,k,"utf8"):a.copy(j,k,0),i?(b&&b.binary||j.write("ÿ",k+f,"binary"),this.continuationFrame=!1):this.continuationFrame=!0;try{this.socket.write(j,"binary",d)}catch(a){this.error(a.toString())}}},d.prototype.close=function(a,b,d,e){if(!this.isClosed){this.isClosed=!0;try{this.continuationFrame&&this.socket.write(new c([255],"binary")),this.socket.write(new c([255,0]),"binary",e)}catch(a){this.error(a.toString())}}},d.prototype.ping=function(a,b){},d.prototype.pong=function(a,b){},d.prototype.error=function(a){return this.emit("error",a),this}}).call(this,a("buffer").Buffer)},{buffer:128,events:324,util:359}],104:[function(a,b,c){(function(c){function d(a,b){if(this instanceof d==!1)throw new TypeError("Classes can't be function-called");i.EventEmitter.call(this),this._socket=a,this.extensions=b||{},this.firstFragment=!0,this.compress=!1,this.messageHandlers=[],this.processing=!1}function e(a,b){this[b]=(65280&a)>>8,this[b+1]=255&a}function f(a,b){this[b]=(4278190080&a)>>24,this[b+1]=(16711680&a)>>16,this[b+2]=(65280&a)>>8,this[b+3]=255&a}function g(a){for(var b=new Uint8Array(a.buffer||a),d=a.byteLength||a.length,e=a.byteOffset||0,f=new c(d),g=0;g<d;++g)f[g]=b[e+g];return f}function h(){return new c([~~(255*Math.random()),~~(255*Math.random()),~~(255*Math.random()),~~(255*Math.random())])}var i=a("events"),j=a("util"),k=(i.EventEmitter,a("./ErrorCodes")),l=a("./BufferUtil").BufferUtil,m=a("./PerMessageDeflate");j.inherits(d,i.EventEmitter),d.prototype.close=function(a,b,d,f){if("undefined"!=typeof a&&("number"!=typeof a||!k.isValidErrorCode(a)))throw new Error("first argument must be a valid error code number");a=a||1e3;var g=new c(2+(b?c.byteLength(b):0));e.call(g,a,0),g.length>2&&g.write(b,2);var h=this;this.messageHandlers.push(function(a){h.frameAndSend(8,g,!0,d),a(),"function"==typeof f&&f()}),this.flush()},d.prototype.ping=function(a,b){var c=b&&b.mask,d=this;this.messageHandlers.push(function(b){d.frameAndSend(9,a||"",!0,c),b()}),this.flush()},d.prototype.pong=function(a,b){var c=b&&b.mask,d=this;this.messageHandlers.push(function(b){d.frameAndSend(10,a||"",!0,c),b()}),this.flush()},d.prototype.send=function(a,b,c){var d=!b||b.fin!==!1,e=b&&b.mask,f=b&&b.compress,g=b&&b.binary?2:1;this.firstFragment===!1?(g=0,f=!1):(this.firstFragment=!1,this.compress=f),d&&(this.firstFragment=!0);var h=this.compress,i=this;this.messageHandlers.push(function(b){i.applyExtensions(a,d,h,function(a,h){return a?void("function"==typeof c?c(a):i.emit("error",a)):(i.frameAndSend(g,h,d,e,f,c),void b())})}),this.flush()},d.prototype.frameAndSend=function(a,b,d,i,j,k){var m=!1;if(b){c.isBuffer(b)||(m=!0,!b||"undefined"==typeof b.byteLength&&"undefined"==typeof b.buffer?("number"==typeof b&&(b=b.toString()),b=new c(b)):b=g(b));var n=b.length,o=i?6:2,p=n;n>=65536?(o+=8,p=127):n>125&&(o+=2,p=126);var q=n<32768||i&&!m,r=q?n+o:o,s=new c(r);switch(s[0]=d?128|a:a,j&&(s[0]|=64),p){case 126:e.call(s,n,2);break;case 127:f.call(s,0,2),f.call(s,n,6)}if(i){s[1]=128|p;var t=this._randomMask||(this._randomMask=h());if(s[o-4]=t[0],s[o-3]=t[1],s[o-2]=t[2],s[o-1]=t[3],q){l.mask(b,t,s,o,n);try{this._socket.write(s,"binary",k)}catch(a){"function"==typeof k?k(a):this.emit("error",a)}}else{l.mask(b,t,b,0,n);try{this._socket.write(s,"binary"),this._socket.write(b,"binary",k)}catch(a){"function"==typeof k?k(a):this.emit("error",a)}}}else if(s[1]=p,q){b.copy(s,o);try{this._socket.write(s,"binary",k)}catch(a){"function"==typeof k?k(a):this.emit("error",a)}}else try{this._socket.write(s,"binary"),this._socket.write(b,"binary",k)}catch(a){"function"==typeof k?k(a):this.emit("error",a)}}else try{this._socket.write(new c([a|(d?128:0),0|(i?128:0)].concat(i?[0,0,0,0]:[])),"binary",k)}catch(a){"function"==typeof k?k(a):this.emit("error",a)}},d.prototype.flush=function(){if(!this.processing){var a=this.messageHandlers.shift();if(a){this.processing=!0;var b=this;a(function(){b.processing=!1,b.flush()})}}},d.prototype.applyExtensions=function(a,b,c,d){c&&a?((a.buffer||a)instanceof ArrayBuffer&&(a=g(a)),this.extensions[m.extensionName].compress(a,b,d)):d(null,a)},b.exports=d}).call(this,a("buffer").Buffer)},{"./BufferUtil":97,"./ErrorCodes":98,"./PerMessageDeflate":100,buffer:128,events:324,util:359}],105:[function(a,b,c){b.exports.Validation={isValidUTF8:function(a){return!0}}},{}],106:[function(a,b,c){"use strict";try{b.exports=a("utf-8-validate")}catch(c){b.exports=a("./Validation.fallback")}},{"./Validation.fallback":105,"utf-8-validate":67}],107:[function(a,b,c){(function(c,d){"use strict";function e(a,b,c){return this instanceof e==!1?new e(a,b,c):(E.call(this),b&&!Array.isArray(b)&&"object"==typeof b&&(c=b,b=null),"string"==typeof b&&(b=[b]),Array.isArray(b)||(b=[]),this._socket=null,this._ultron=null,this._closeReceived=!1,this.bytesReceived=0,this.readyState=null,this.supports={},this.extensions={},void(Array.isArray(a)?j.apply(this,a.concat(c)):k.apply(this,[a,b,c])))}function f(a,b,c){this.type="message",this.data=a,this.target=c,this.binary=b}function g(a,b,c){this.type="close",this.wasClean="undefined"==typeof a||1e3===a,this.code=a,this.reason=b,this.target=c}function h(a){this.type="open",this.target=a}function i(a,b,c){var d=b;return b&&(a&&443!=c||!a&&80!=c)&&(d=d+":"+c),d}function j(a,b,c,d){d=new x({protocolVersion:F,protocol:null,extensions:{}}).merge(d),this.protocol=d.value.protocol,this.protocolVersion=d.value.protocolVersion,this.extensions=d.value.extensions,this.supports.binary="hixie-76"!==this.protocolVersion,this.upgradeReq=a,this.readyState=e.CONNECTING,this._isServer=!0,"hixie-76"===d.value.protocolVersion?l.call(this,B,A,b,c):l.call(this,z,y,b,c)}function k(a,b,c){if(c=new x({origin:null,protocolVersion:F,host:null,headers:null,protocol:b.join(","),agent:null,pfx:null,key:null,passphrase:null,cert:null,ca:null,ciphers:null,rejectUnauthorized:null,perMessageDeflate:!0,localAddress:null}).merge(c),8!==c.value.protocolVersion&&13!==c.value.protocolVersion)throw new Error("unsupported protocol version");var f=q.parse(a),g="ws+unix:"===f.protocol;if(!f.host&&!g)throw new Error("invalid url");var h,j="wss:"===f.protocol||"https:"===f.protocol,k=j?t:s,m=f.port||(j?443:80),n=f.auth,o={};c.value.perMessageDeflate&&(h=new D(typeof c.value.perMessageDeflate!==!0?c.value.perMessageDeflate:{},!1),o[D.extensionName]=h.offer()),this._isServer=!1,this.url=a,this.protocolVersion=c.value.protocolVersion,this.supports.binary="hixie-76"!==this.protocolVersion;var r=new d(c.value.protocolVersion+"-"+Date.now()).toString("base64"),v=u.createHash("sha1");v.update(r+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");var w=v.digest("base64"),A=c.value.agent,B=i(j,f.hostname,m),E={port:m,host:f.hostname,headers:{Connection:"Upgrade",Upgrade:"websocket",Host:B,"Sec-WebSocket-Version":c.value.protocolVersion,"Sec-WebSocket-Key":r}};if(n&&(E.headers.Authorization="Basic "+new d(n).toString("base64")),c.value.protocol&&(E.headers["Sec-WebSocket-Protocol"]=c.value.protocol),c.value.host&&(E.headers.Host=c.value.host),c.value.headers)for(var G in c.value.headers)c.value.headers.hasOwnProperty(G)&&(E.headers[G]=c.value.headers[G]);Object.keys(o).length&&(E.headers["Sec-WebSocket-Extensions"]=C.format(o)),(c.isDefinedAndNonNull("pfx")||c.isDefinedAndNonNull("key")||c.isDefinedAndNonNull("passphrase")||c.isDefinedAndNonNull("cert")||c.isDefinedAndNonNull("ca")||c.isDefinedAndNonNull("ciphers")||c.isDefinedAndNonNull("rejectUnauthorized"))&&(c.isDefinedAndNonNull("pfx")&&(E.pfx=c.value.pfx),c.isDefinedAndNonNull("key")&&(E.key=c.value.key),c.isDefinedAndNonNull("passphrase")&&(E.passphrase=c.value.passphrase),c.isDefinedAndNonNull("cert")&&(E.cert=c.value.cert),c.isDefinedAndNonNull("ca")&&(E.ca=c.value.ca),c.isDefinedAndNonNull("ciphers")&&(E.ciphers=c.value.ciphers),c.isDefinedAndNonNull("rejectUnauthorized")&&(E.rejectUnauthorized=c.value.rejectUnauthorized),A||(A=new k.Agent(E))),E.path=f.path||"/",A&&(E.agent=A),g&&(E.socketPath=f.pathname),c.value.localAddress&&(E.localAddress=c.value.localAddress),c.value.origin&&(c.value.protocolVersion<13?E.headers["Sec-WebSocket-Origin"]=c.value.origin:E.headers.Origin=c.value.origin);var H=this,I=k.request(E);I.on("error",function(a){H.emit("error",a),p.call(H,a)}),I.once("response",function(a){var b;H.emit("unexpected-response",I,a)||(b=new Error("unexpected server response ("+a.statusCode+")"),I.abort(),H.emit("error",b)),p.call(H,b)}),I.once("upgrade",function(a,b,d){if(H.readyState===e.CLOSED)return H.emit("close"),H.removeAllListeners(),void b.end();var f=a.headers["sec-websocket-accept"];if("undefined"==typeof f||f!==w)return H.emit("error","invalid server key"),H.removeAllListeners(),void b.end();var g=a.headers["sec-websocket-protocol"],i=(c.value.protocol||"").split(/, */),j=null;if(!c.value.protocol&&g?j="server sent a subprotocol even though none requested":c.value.protocol&&!g?j="server sent no subprotocol even though requested":g&&i.indexOf(g)===-1&&(j="server responded with an invalid protocol"),j)return H.emit("error",j),H.removeAllListeners(),void b.end();g&&(H.protocol=g);var k=C.parse(a.headers["sec-websocket-extensions"]);if(h&&k[D.extensionName]){try{h.accept(k[D.extensionName])}catch(a){return H.emit("error","invalid extension parameter"),H.removeAllListeners(),void b.end()}H.extensions[D.extensionName]=h}l.call(H,z,y,b,d),I.removeAllListeners(),I=null,A=null}),I.end(),this.readyState=e.CONNECTING}function l(a,b,d,f){function g(a){j||k.readyState===e.CLOSED||(j=!0,d.removeListener("data",g),i.on("data",h),f&&f.length>0&&(h(f),f=null),a&&h(a))}function h(a){k.bytesReceived+=a.length,k._receiver.add(a)}var i=this._ultron=new w(d),j=!1,k=this;d.setTimeout(0),d.setNoDelay(!0),this._receiver=new a(this.extensions),this._socket=d,i.on("end",p.bind(this)),i.on("close",p.bind(this)),i.on("error",p.bind(this)),i.on("data",g),c.nextTick(g),k._receiver.ontext=function(a,b){b=b||{},k.emit("message",a,b)},k._receiver.onbinary=function(a,b){b=b||{},b.binary=!0,k.emit("message",a,b)},k._receiver.onping=function(a,b){b=b||{},k.pong(a,{mask:!k._isServer,binary:b.binary===!0},!0),k.emit("ping",a,b)},k._receiver.onpong=function(a,b){k.emit("pong",a,b||{})},k._receiver.onclose=function(a,b,c){c=c||{},k._closeReceived=!0,k.close(a,b)},k._receiver.onerror=function(a,b){k.close("undefined"!=typeof b?b:1002,""),k.emit("error",a,b)},this._sender=new b(d,this.extensions),this._sender.on("error",function(a){k.close(1002,""),k.emit("error",a)}),this.readyState=e.OPEN,this.emit("open")}function m(a){a._queue=a._queue||[]}function n(a){var b=a._queue;if("undefined"!=typeof b){delete a._queue;for(var c=0,d=b.length;c<d;++c)b[c]()}}function o(a,b,c,d){b.on("data",function(b){return a.readyState!==e.OPEN?void("function"==typeof d?d(new Error("not opened")):(delete a._queue,a.emit("error",new Error("not opened")))):(c.fin=!1,void a._sender.send(b,c))}),b.on("end",function(){return a.readyState!==e.OPEN?void("function"==typeof d?d(new Error("not opened")):(delete a._queue,a.emit("error",new Error("not opened")))):(c.fin=!0,a._sender.send(null,c),void("function"==typeof d&&d(null)))})}function p(a){if(this.readyState!==e.CLOSED){var b=this.readyState!==e.CONNECTING;if(this.readyState=e.CLOSED,clearTimeout(this._closeTimer),this._closeTimer=null,b&&(!a&&this._closeReceived||(this._closeCode=1006),this.emit("close",this._closeCode||1e3,this._closeMessage||"")),this._socket){this._ultron&&this._ultron.destroy(),this._socket.on("error",function(){try{this.destroy()}catch(a){}});try{a?this._socket.destroy():this._socket.end()}catch(a){}this._socket=null,this._ultron=null}this._sender&&(this._sender.removeAllListeners(),this._sender=null),this._receiver&&(this._receiver.cleanup(),this._receiver=null),this.extensions[D.extensionName]&&this.extensions[D.extensionName].cleanup(),this.extensions=null,this.removeAllListeners(),this.on("error",function(){}),delete this._queue}}var q=a("url"),r=a("util"),s=a("http"),t=a("https"),u=a("crypto"),v=a("stream"),w=a("ultron"),x=a("options"),y=a("./Sender"),z=a("./Receiver"),A=a("./Sender.hixie"),B=a("./Receiver.hixie"),C=a("./Extensions"),D=a("./PerMessageDeflate"),E=a("events").EventEmitter,F=13,G=3e4;r.inherits(e,E),["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(a,b){e.prototype[a]=e[a]=b}),e.prototype.close=function(a,b){if(this.readyState!==e.CLOSED){if(this.readyState===e.CONNECTING)return void(this.readyState=e.CLOSED);if(this.readyState===e.CLOSING)return void(this._closeReceived&&this._isServer&&this.terminate());var c=this;try{this.readyState=e.CLOSING,this._closeCode=a,this._closeMessage=b;var d=!this._isServer;this._sender.close(a,b,d,function(a){a&&c.emit("error",a),c._closeReceived&&c._isServer?c.terminate():(clearTimeout(c._closeTimer),c._closeTimer=setTimeout(p.bind(c,!0),G))})}catch(a){this.emit("error",a)}}},e.prototype.pause=function(){if(this.readyState!==e.OPEN)throw new Error("not opened");return this._socket.pause()},e.prototype.ping=function(a,b,c){if(this.readyState!==e.OPEN){if(c===!0)return;throw new Error("not opened")}b=b||{},"undefined"==typeof b.mask&&(b.mask=!this._isServer),this._sender.ping(a,b)},e.prototype.pong=function(a,b,c){if(this.readyState!==e.OPEN){if(c===!0)return;throw new Error("not opened")}b=b||{},"undefined"==typeof b.mask&&(b.mask=!this._isServer),this._sender.pong(a,b)},e.prototype.resume=function(){if(this.readyState!==e.OPEN)throw new Error("not opened");return this._socket.resume()},e.prototype.send=function(a,b,f){if("function"==typeof b&&(f=b,b={}),this.readyState!==e.OPEN){if("function"!=typeof f)throw new Error("not opened");return void f(new Error("not opened"))}if(a||(a=""),this._queue){var g=this;return void this._queue.push(function(){g.send(a,b,f)})}b=b||{},b.fin=!0,"undefined"==typeof b.binary&&(b.binary=a instanceof ArrayBuffer||a instanceof d||a instanceof Uint8Array||a instanceof Uint16Array||a instanceof Uint32Array||a instanceof Int8Array||a instanceof Int16Array||a instanceof Int32Array||a instanceof Float32Array||a instanceof Float64Array),"undefined"==typeof b.mask&&(b.mask=!this._isServer),"undefined"==typeof b.compress&&(b.compress=!0),this.extensions[D.extensionName]||(b.compress=!1);var h="function"==typeof v.Readable?v.Readable:v.Stream;if(a instanceof h){m(this);var g=this;o(this,a,b,function(a){c.nextTick(function(){n(g)}),"function"==typeof f&&f(a)})}else this._sender.send(a,b,f)},e.prototype.stream=function(a,b){function d(g,h){try{if(f.readyState!==e.OPEN)throw new Error("not opened");a.fin=h===!0,f._sender.send(g,a),h?n(f):c.nextTick(b.bind(null,null,d))}catch(a){"function"==typeof b?b(a):(delete f._queue,f.emit("error",a))}}"function"==typeof a&&(b=a,a={});var f=this;if("function"!=typeof b)throw new Error("callback must be provided");if(this.readyState!==e.OPEN){if("function"!=typeof b)throw new Error("not opened");return void b(new Error("not opened"))}return this._queue?void this._queue.push(function(){f.stream(a,b)}):(a=a||{},"undefined"==typeof a.mask&&(a.mask=!this._isServer),"undefined"==typeof a.compress&&(a.compress=!0),this.extensions[D.extensionName]||(a.compress=!1),m(this),void c.nextTick(b.bind(null,null,d)))},e.prototype.terminate=function(){if(this.readyState!==e.CLOSED)if(this._socket){this.readyState=e.CLOSING;try{this._socket.end()}catch(a){return void p.call(this,!0)}this._closeTimer&&clearTimeout(this._closeTimer),this._closeTimer=setTimeout(p.bind(this,!0),G)}else this.readyState===e.CONNECTING&&p.call(this,!0)},Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){var a=0;return this._socket&&(a=this._socket.bufferSize||0),a}}),["open","error","close","message"].forEach(function(a){Object.defineProperty(e.prototype,"on"+a,{get:function(){var b=this.listeners(a)[0];return b?b._listener?b._listener:b:void 0},set:function(b){this.removeAllListeners(a),this.addEventListener(a,b)}})}),e.prototype.addEventListener=function(a,b){function c(a,c){b.call(j,new f(a,!!c.binary,j))}function d(a,c){b.call(j,new g(a,c,j))}function e(a){a.type="error",a.target=j,b.call(j,a)}function i(){b.call(j,new h(j))}var j=this;"function"==typeof b&&("message"===a?(c._listener=b,this.on(a,c)):"close"===a?(d._listener=b,this.on(a,d)):"error"===a?(e._listener=b,this.on(a,e)):"open"===a?(i._listener=b,this.on(a,i)):this.on(a,b))},b.exports=e,b.exports.buildHostHeader=i}).call(this,a("_process"),a("buffer").Buffer)},{"./Extensions":99,"./PerMessageDeflate":100,"./Receiver":102,"./Receiver.hixie":101,"./Sender":104,"./Sender.hixie":103,_process:329,buffer:128,crypto:132,events:324,http:349,https:325,options:109,stream:348,ultron:110,url:356,util:359}],108:[function(a,b,c){(function(c){function d(a,b){if(this instanceof d==!1)return new d(a,b);if(j.EventEmitter.call(this),a=new m({host:"0.0.0.0",port:null,server:null,verifyClient:null,handleProtocols:null,path:null,noServer:!1,disableHixie:!1,clientTracking:!0,perMessageDeflate:!0}).merge(a),!a.isDefinedAndNonNull("port")&&!a.isDefinedAndNonNull("server")&&!a.value.noServer)throw new TypeError("`port` or a `server` must be provided");var e=this;if(a.isDefinedAndNonNull("port"))this._server=k.createServer(function(a,b){var c=k.STATUS_CODES[426];b.writeHead(426,{"Content-Length":c.length,"Content-Type":"text/plain"}),b.end(c)}),this._server.allowHalfOpen=!1,this._server.listen(a.value.port,a.value.host,b),this._closeServer=function(){e._server&&e._server.close()};else if(a.value.server&&(this._server=a.value.server,a.value.path)){if(this._server._webSocketPaths&&a.value.server._webSocketPaths[a.value.path])throw new Error("two instances of WebSocketServer cannot listen on the same http server path");"object"!=typeof this._server._webSocketPaths&&(this._server._webSocketPaths={}),this._server._webSocketPaths[a.value.path]=1}this._server&&this._server.once("listening",function(){e.emit("listening")}),"undefined"!=typeof this._server&&(this._server.on("error",function(a){e.emit("error",a)}),this._server.on("upgrade",function(a,b,d){var f=new c(d.length);d.copy(f),e.handleUpgrade(a,b,f,function(b){e.emit("connection"+a.url,b),e.emit("connection",b)})})),this.options=a.value,this.path=a.value.path,this.clients=[]}function e(a,b,c,d){var e=function(){try{b.destroy()}catch(a){}};if(b.on("error",e),!a.headers["sec-websocket-key"])return void h(b,400,"Bad Request");var f=parseInt(a.headers["sec-websocket-version"]);if([8,13].indexOf(f)===-1)return void h(b,400,"Bad Request");var i=a.headers["sec-websocket-protocol"],j=f<13?a.headers["sec-websocket-origin"]:a.headers.origin,m=o.parse(a.headers["sec-websocket-extensions"]),p=this,q=function(i){var j=a.headers["sec-websocket-key"],k=l.createHash("sha1");k.update(j+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11"),j=k.digest("base64");var q=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade","Sec-WebSocket-Accept: "+j];"undefined"!=typeof i&&q.push("Sec-WebSocket-Protocol: "+i);var r={};try{r=g.call(p,m)}catch(a){return void h(b,400,"Bad Request")}if(Object.keys(r).length){var s={};Object.keys(r).forEach(function(a){s[a]=[r[a].params]}),q.push("Sec-WebSocket-Extensions: "+o.format(s))}p.emit("headers",q),
b.setTimeout(0),b.setNoDelay(!0);try{b.write(q.concat("","").join("\r\n"))}catch(a){try{b.destroy()}catch(a){}return}var t=new n([a,b,c],{protocolVersion:f,protocol:i,extensions:r});p.options.clientTracking&&(p.clients.push(t),t.on("close",function(){var a=p.clients.indexOf(t);a!=-1&&p.clients.splice(a,1)})),b.removeListener("error",e),d(t)},r=function(){if("function"==typeof p.options.handleProtocols){var a=(i||"").split(/, */),c=!1;p.options.handleProtocols(a,function(a,d){c=!0,a?q(d):h(b,401,"Unauthorized")});return void(c||h(b,501,"Could not process protocols"))}"undefined"!=typeof i?q(i.split(/, */)[0]):q()};if("function"==typeof this.options.verifyClient){var s={origin:j,secure:"undefined"!=typeof a.connection.authorized||"undefined"!=typeof a.connection.encrypted,req:a};if(2==this.options.verifyClient.length)return void this.options.verifyClient(s,function(a,c,d){"undefined"==typeof c&&(c=401),"undefined"==typeof d&&(d=k.STATUS_CODES[c]),a?r():h(b,c,d)});if(!this.options.verifyClient(s))return void h(b,401,"Unauthorized")}r()}function f(a,b,d,e){var f=function(){try{b.destroy()}catch(a){}};if(b.on("error",f),this.options.disableHixie)return void h(b,401,"Hixie support disabled");if(!a.headers["sec-websocket-key2"])return void h(b,400,"Bad Request");var g=a.headers.origin,i=this,j=function(){var j;j=a.headers["x-forwarded-host"]?a.headers["x-forwarded-host"]:a.headers.host;var k=("https"===a.headers["x-forwarded-proto"]||b.encrypted?"wss":"ws")+"://"+j+a.url,m=a.headers["sec-websocket-protocol"],o=function(d,j){var o=a.headers["sec-websocket-key1"],p=a.headers["sec-websocket-key2"],q=l.createHash("md5");[o,p].forEach(function(a){var c=parseInt(a.replace(/[^\d]/g,"")),d=a.replace(/[^ ]/g,"").length;return 0===d||c%d!==0?void h(b,400,"Bad Request"):(c/=d,void q.update(String.fromCharCode(c>>24&255,c>>16&255,c>>8&255,255&c)))}),q.update(d.toString("binary"));var r=["HTTP/1.1 101 Switching Protocols","Upgrade: WebSocket","Connection: Upgrade","Sec-WebSocket-Location: "+k];"undefined"!=typeof m&&r.push("Sec-WebSocket-Protocol: "+m),"undefined"!=typeof g&&r.push("Sec-WebSocket-Origin: "+g),b.setTimeout(0),b.setNoDelay(!0);try{var s=new c(r.concat("","").join("\r\n")),t=new c(q.digest("binary"),"binary"),u=new c(s.length+t.length);s.copy(u,0),t.copy(u,s.length),b.write(u,"binary",function(c){if(!c){var d=new n([a,b,j],{protocolVersion:"hixie-76",protocol:m});i.options.clientTracking&&(i.clients.push(d),d.on("close",function(){var a=i.clients.indexOf(d);a!=-1&&i.clients.splice(a,1)})),b.removeListener("error",f),e(d)}})}catch(a){try{b.destroy()}catch(a){}return}},p=8;if(d&&d.length>=p){var q=d.slice(0,p),r=d.length>p?d.slice(p):null;o.call(i,q,r)}else{var q=new c(p);d.copy(q,0);var s=d.length,r=null,t=function(a){var c=Math.min(a.length,p-s);0!==c&&(a.copy(q,s,0,c),s+=c,s==p&&(b.removeListener("data",t),c<a.length&&(r=a.slice(c)),o.call(i,q,r)))};b.on("data",t)}};if("function"==typeof this.options.verifyClient){var m={origin:g,secure:"undefined"!=typeof a.connection.authorized||"undefined"!=typeof a.connection.encrypted,req:a};if(2==this.options.verifyClient.length){var i=this;return void this.options.verifyClient(m,function(a,c,d){"undefined"==typeof c&&(c=401),"undefined"==typeof d&&(d=k.STATUS_CODES[c]),a?j.apply(i):h(b,c,d)})}if(!this.options.verifyClient(m))return void h(b,401,"Unauthorized")}j()}function g(a){var b={},c=this.options.perMessageDeflate;if(c&&a[p.extensionName]){var d=new p(c!==!0?c:{},!0);d.accept(a[p.extensionName]),b[p.extensionName]=d}return b}function h(a,b,c){try{var d=["HTTP/1.1 "+b+" "+c,"Content-type: text/html"];a.write(d.concat("","").join("\r\n"))}catch(a){}finally{try{a.destroy()}catch(a){}}}var i=a("util"),j=a("events"),k=a("http"),l=a("crypto"),m=a("options"),n=a("./WebSocket"),o=a("./Extensions"),p=a("./PerMessageDeflate"),q=(a("tls"),a("url"));i.inherits(d,j.EventEmitter),d.prototype.close=function(a){var b=null;try{for(var c=0,d=this.clients.length;c<d;++c)this.clients[c].terminate()}catch(a){b=a}this.path&&this._server._webSocketPaths&&(delete this._server._webSocketPaths[this.path],0==Object.keys(this._server._webSocketPaths).length&&delete this._server._webSocketPaths);try{"undefined"!=typeof this._closeServer&&this._closeServer()}finally{delete this._server}if(a)a(b);else if(b)throw b},d.prototype.handleUpgrade=function(a,b,c,d){if(this.options.path){var g=q.parse(a.url);if(g&&g.pathname!==this.options.path)return}return"undefined"==typeof a.headers.upgrade||"websocket"!==a.headers.upgrade.toLowerCase()?void h(b,400,"Bad Request"):void(a.headers["sec-websocket-key1"]?f.apply(this,arguments):e.apply(this,arguments))},b.exports=d}).call(this,a("buffer").Buffer)},{"./Extensions":99,"./PerMessageDeflate":100,"./WebSocket":107,buffer:128,crypto:132,events:324,http:349,options:109,tls:112,url:356,util:359}],109:[function(a,b,c){function d(a){var b={},c=this.value={};Object.keys(a).forEach(function(d){b[d]=a[d],Object.defineProperty(c,d,{get:function(){return b[d]},configurable:!1,enumerable:!0})}),this.reset=function(){return Object.keys(a).forEach(function(c){b[c]=a[c]}),this},this.merge=function(a,c){if(a=a||{},"[object Array]"===Object.prototype.toString.call(c)){for(var d=[],e=0,f=c.length;e<f;++e){var g=c[e];g in a||d.push(g)}if(d.length>0)throw d.length>1?new Error("options "+d.slice(0,d.length-1).join(", ")+" and "+d[d.length-1]+" must be defined"):new Error("option "+d[0]+" must be defined")}return Object.keys(a).forEach(function(c){c in b&&(b[c]=a[c])}),this},this.copy=function(b){var d={};return Object.keys(a).forEach(function(a){b.indexOf(a)!==-1&&(d[a]=c[a])}),d},this.read=function(a,b){if("function"==typeof b){var c=this;e.readFile(a,function(a,d){if(a)return b(a);var e=JSON.parse(d);c.merge(e),b()})}else{var d=JSON.parse(e.readFileSync(a));this.merge(d)}return this},this.isDefined=function(a){return"undefined"!=typeof c[a]},this.isDefinedAndNonNull=function(a){return"undefined"!=typeof c[a]&&null!==c[a]},Object.freeze(c),Object.freeze(this)}var e=a("fs");b.exports=d},{fs:112}],110:[function(a,b,c){"use strict";function d(a){return this instanceof d?(this.id=f++,void(this.ee=a)):new d(a)}var e=Object.prototype.hasOwnProperty,f=0;d.prototype.on=function(a,b,c){return b.__ultron=this.id,this.ee.on(a,b,c),this},d.prototype.once=function(a,b,c){return b.__ultron=this.id,this.ee.once(a,b,c),this},d.prototype.remove=function(){var a,b=arguments;if(1===b.length&&"string"==typeof b[0])b=b[0].split(/[, ]+/);else if(!b.length){b=[];for(a in this.ee._events)e.call(this.ee._events,a)&&b.push(a)}for(var c=0;c<b.length;c++)for(var d=this.ee.listeners(b[c]),f=0;f<d.length;f++){if(a=d[f],a.listener){if(a.listener.__ultron!==this.id)continue;delete a.listener.__ultron}else{if(a.__ultron!==this.id)continue;delete a.__ultron}this.ee.removeListener(b[c],a)}return this},d.prototype.destroy=function(){return!!this.ee&&(this.remove(),this.ee=null,!0)},b.exports=d},{}],111:[function(a,b,c){b.exports={name:"autobahn",version:"0.10.1",description:"An implementation of The Web Application Messaging Protocol (WAMP).",main:"index.js",browser:{"lib/transport/rawsocket.js":!1,"msgpack-lite":"msgpack-lite/global"},scripts:{test:"nodeunit test/test.js"},dependencies:{bufferutil:">= 1.2.1","crypto-js":">= 3.1.5","utf-8-validate":">= 1.2.1",when:">= 3.7.3",ws:">= 0.8.0","msgpack-lite":">= 0.1.17"},devDependencies:{browserify:">= 11.0.1",nodeunit:">= 0.9.1"},repository:{type:"git",url:"git://github.com/crossbario/autobahn-js.git"},keywords:["WAMP","WebSocket","RPC","PubSub"],author:"Tavendo GmbH",license:"MIT"}},{}],112:[function(a,b,c){},{}],113:[function(a,b,c){function d(a,b){return n.isUndefined(b)?""+b:n.isNumber(b)&&!isFinite(b)?b.toString():n.isFunction(b)||n.isRegExp(b)?b.toString():b}function e(a,b){return n.isString(a)?a.length<b?a:a.slice(0,b):a}function f(a){return e(JSON.stringify(a.actual,d),128)+" "+a.operator+" "+e(JSON.stringify(a.expected,d),128)}function g(a,b,c,d,e){throw new q.AssertionError({message:c,actual:a,expected:b,operator:d,stackStartFunction:e})}function h(a,b){a||g(a,!0,b,"==",q.ok)}function i(a,b){if(a===b)return!0;if(n.isBuffer(a)&&n.isBuffer(b)){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return n.isDate(a)&&n.isDate(b)?a.getTime()===b.getTime():n.isRegExp(a)&&n.isRegExp(b)?a.source===b.source&&a.global===b.global&&a.multiline===b.multiline&&a.lastIndex===b.lastIndex&&a.ignoreCase===b.ignoreCase:n.isObject(a)||n.isObject(b)?k(a,b):a==b}function j(a){return"[object Arguments]"==Object.prototype.toString.call(a)}function k(a,b){if(n.isNullOrUndefined(a)||n.isNullOrUndefined(b))return!1;if(a.prototype!==b.prototype)return!1;if(n.isPrimitive(a)||n.isPrimitive(b))return a===b;var c=j(a),d=j(b);if(c&&!d||!c&&d)return!1;if(c)return a=o.call(a),b=o.call(b),i(a,b);var e,f,g=r(a),h=r(b);if(g.length!=h.length)return!1;for(g.sort(),h.sort(),f=g.length-1;f>=0;f--)if(g[f]!=h[f])return!1;for(f=g.length-1;f>=0;f--)if(e=g[f],!i(a[e],b[e]))return!1;return!0}function l(a,b){return!(!a||!b)&&("[object RegExp]"==Object.prototype.toString.call(b)?b.test(a):a instanceof b||b.call({},a)===!0)}function m(a,b,c,d){var e;n.isString(c)&&(d=c,c=null);try{b()}catch(a){e=a}if(d=(c&&c.name?" ("+c.name+").":".")+(d?" "+d:"."),a&&!e&&g(e,c,"Missing expected exception"+d),!a&&l(e,c)&&g(e,c,"Got unwanted exception"+d),a&&e&&c&&!l(e,c)||!a&&e)throw e}var n=a("util/"),o=Array.prototype.slice,p=Object.prototype.hasOwnProperty,q=b.exports=h;q.AssertionError=function(a){this.name="AssertionError",this.actual=a.actual,this.expected=a.expected,this.operator=a.operator,a.message?(this.message=a.message,this.generatedMessage=!1):(this.message=f(this),this.generatedMessage=!0);var b=a.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,b);else{var c=new Error;if(c.stack){var d=c.stack,e=b.name,h=d.indexOf("\n"+e);if(h>=0){var i=d.indexOf("\n",h+1);d=d.substring(i+1)}this.stack=d}}},n.inherits(q.AssertionError,Error),q.fail=g,q.ok=h,q.equal=function(a,b,c){a!=b&&g(a,b,c,"==",q.equal)},q.notEqual=function(a,b,c){a==b&&g(a,b,c,"!=",q.notEqual)},q.deepEqual=function(a,b,c){i(a,b)||g(a,b,c,"deepEqual",q.deepEqual)},q.notDeepEqual=function(a,b,c){i(a,b)&&g(a,b,c,"notDeepEqual",q.notDeepEqual)},q.strictEqual=function(a,b,c){a!==b&&g(a,b,c,"===",q.strictEqual)},q.notStrictEqual=function(a,b,c){a===b&&g(a,b,c,"!==",q.notStrictEqual)},q.throws=function(a,b,c){m.apply(this,[!0].concat(o.call(arguments)))},q.doesNotThrow=function(a,b){m.apply(this,[!1].concat(o.call(arguments)))},q.ifError=function(a){if(a)throw a};var r=Object.keys||function(a){var b=[];for(var c in a)p.call(a,c)&&b.push(c);return b}},{"util/":359}],114:[function(a,b,c){arguments[4][112][0].apply(c,arguments)},{dup:112}],115:[function(a,b,c){"use strict";var d="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;c.assign=function(a){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var c=b.shift();if(c){if("object"!=typeof c)throw new TypeError(c+"must be non-object");for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}}return a},c.shrinkBuf=function(a,b){return a.length===b?a:a.subarray?a.subarray(0,b):(a.length=b,a)};var e={arraySet:function(a,b,c,d,e){if(b.subarray&&a.subarray)return void a.set(b.subarray(c,c+d),e);for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){var b,c,d,e,f,g;for(d=0,b=0,c=a.length;b<c;b++)d+=a[b].length;for(g=new Uint8Array(d),e=0,b=0,c=a.length;b<c;b++)f=a[b],g.set(f,e),e+=f.length;return g}},f={arraySet:function(a,b,c,d,e){for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){return[].concat.apply([],a)}};c.setTyped=function(a){a?(c.Buf8=Uint8Array,c.Buf16=Uint16Array,c.Buf32=Int32Array,c.assign(c,e)):(c.Buf8=Array,c.Buf16=Array,c.Buf32=Array,c.assign(c,f))},c.setTyped(d)},{}],116:[function(a,b,c){"use strict";function d(a,b,c,d){for(var e=65535&a|0,f=a>>>16&65535|0,g=0;0!==c;){g=c>2e3?2e3:c,c-=g;do e=e+b[d++]|0,f=f+e|0;while(--g);e%=65521,f%=65521}return e|f<<16|0}b.exports=d},{}],117:[function(a,b,c){b.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],118:[function(a,b,c){"use strict";function d(){for(var a,b=[],c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;b[c]=a}return b}function e(a,b,c,d){var e=f,g=d+c;a^=-1;for(var h=d;h<g;h++)a=a>>>8^e[255&(a^b[h])];return a^-1}var f=d();b.exports=e},{}],119:[function(a,b,c){"use strict";function d(a,b){return a.msg=G[b],b}function e(a){return(a<<1)-(a>4?9:0)}function f(a){for(var b=a.length;--b>=0;)a[b]=0}function g(a){var b=a.state,c=b.pending;c>a.avail_out&&(c=a.avail_out),0!==c&&(C.arraySet(a.output,b.pending_buf,b.pending_out,c,a.next_out),a.next_out+=c,b.pending_out+=c,a.total_out+=c,a.avail_out-=c,b.pending-=c,0===b.pending&&(b.pending_out=0))}function h(a,b){D._tr_flush_block(a,a.block_start>=0?a.block_start:-1,a.strstart-a.block_start,b),a.block_start=a.strstart,g(a.strm)}function i(a,b){a.pending_buf[a.pending++]=b}function j(a,b){a.pending_buf[a.pending++]=b>>>8&255,a.pending_buf[a.pending++]=255&b}function k(a,b,c,d){var e=a.avail_in;return e>d&&(e=d),0===e?0:(a.avail_in-=e,C.arraySet(b,a.input,a.next_in,e,c),1===a.state.wrap?a.adler=E(a.adler,b,e,c):2===a.state.wrap&&(a.adler=F(a.adler,b,e,c)),a.next_in+=e,a.total_in+=e,e)}function l(a,b){var c,d,e=a.max_chain_length,f=a.strstart,g=a.prev_length,h=a.nice_match,i=a.strstart>a.w_size-ja?a.strstart-(a.w_size-ja):0,j=a.window,k=a.w_mask,l=a.prev,m=a.strstart+ia,n=j[f+g-1],o=j[f+g];a.prev_length>=a.good_match&&(e>>=2),h>a.lookahead&&(h=a.lookahead);do if(c=b,j[c+g]===o&&j[c+g-1]===n&&j[c]===j[f]&&j[++c]===j[f+1]){f+=2,c++;do;while(j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&f<m);if(d=ia-(m-f),f=m-ia,d>g){if(a.match_start=b,g=d,d>=h)break;n=j[f+g-1],o=j[f+g]}}while((b=l[b&k])>i&&0!==--e);return g<=a.lookahead?g:a.lookahead}function m(a){var b,c,d,e,f,g=a.w_size;do{if(e=a.window_size-a.lookahead-a.strstart,a.strstart>=g+(g-ja)){C.arraySet(a.window,a.window,g,g,0),a.match_start-=g,a.strstart-=g,a.block_start-=g,c=a.hash_size,b=c;do d=a.head[--b],a.head[b]=d>=g?d-g:0;while(--c);c=g,b=c;do d=a.prev[--b],a.prev[b]=d>=g?d-g:0;while(--c);e+=g}if(0===a.strm.avail_in)break;if(c=k(a.strm,a.window,a.strstart+a.lookahead,e),a.lookahead+=c,a.lookahead+a.insert>=ha)for(f=a.strstart-a.insert,a.ins_h=a.window[f],a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+ha-1])&a.hash_mask,a.prev[f&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=f,f++,a.insert--,!(a.lookahead+a.insert<ha)););}while(a.lookahead<ja&&0!==a.strm.avail_in)}function n(a,b){var c=65535;for(c>a.pending_buf_size-5&&(c=a.pending_buf_size-5);;){if(a.lookahead<=1){if(m(a),0===a.lookahead&&b===H)return sa;if(0===a.lookahead)break}a.strstart+=a.lookahead,a.lookahead=0;var d=a.block_start+c;if((0===a.strstart||a.strstart>=d)&&(a.lookahead=a.strstart-d,a.strstart=d,h(a,!1),0===a.strm.avail_out))return sa;if(a.strstart-a.block_start>=a.w_size-ja&&(h(a,!1),0===a.strm.avail_out))return sa}return a.insert=0,b===K?(h(a,!0),0===a.strm.avail_out?ua:va):a.strstart>a.block_start&&(h(a,!1),0===a.strm.avail_out)?sa:sa}function o(a,b){for(var c,d;;){if(a.lookahead<ja){if(m(a),a.lookahead<ja&&b===H)return sa;if(0===a.lookahead)break}if(c=0,a.lookahead>=ha&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ha-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),0!==c&&a.strstart-c<=a.w_size-ja&&(a.match_length=l(a,c)),a.match_length>=ha)if(d=D._tr_tally(a,a.strstart-a.match_start,a.match_length-ha),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=ha){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ha-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(0!==--a.match_length);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else d=D._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(d&&(h(a,!1),0===a.strm.avail_out))return sa}return a.insert=a.strstart<ha-1?a.strstart:ha-1,b===K?(h(a,!0),0===a.strm.avail_out?ua:va):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sa:ta}function p(a,b){for(var c,d,e;;){if(a.lookahead<ja){if(m(a),a.lookahead<ja&&b===H)return sa;if(0===a.lookahead)break}if(c=0,a.lookahead>=ha&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ha-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=ha-1,0!==c&&a.prev_length<a.max_lazy_match&&a.strstart-c<=a.w_size-ja&&(a.match_length=l(a,c),a.match_length<=5&&(a.strategy===S||a.match_length===ha&&a.strstart-a.match_start>4096)&&(a.match_length=ha-1)),a.prev_length>=ha&&a.match_length<=a.prev_length){e=a.strstart+a.lookahead-ha,d=D._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-ha),a.lookahead-=a.prev_length-1,a.prev_length-=2;do++a.strstart<=e&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ha-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(0!==--a.prev_length);if(a.match_available=0,a.match_length=ha-1,a.strstart++,d&&(h(a,!1),0===a.strm.avail_out))return sa}else if(a.match_available){if(d=D._tr_tally(a,0,a.window[a.strstart-1]),d&&h(a,!1),a.strstart++,a.lookahead--,0===a.strm.avail_out)return sa}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(d=D._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<ha-1?a.strstart:ha-1,b===K?(h(a,!0),0===a.strm.avail_out?ua:va):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sa:ta}function q(a,b){for(var c,d,e,f,g=a.window;;){if(a.lookahead<=ia){if(m(a),a.lookahead<=ia&&b===H)return sa;if(0===a.lookahead)break}if(a.match_length=0,a.lookahead>=ha&&a.strstart>0&&(e=a.strstart-1,d=g[e],d===g[++e]&&d===g[++e]&&d===g[++e])){f=a.strstart+ia;do;while(d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&e<f);a.match_length=ia-(f-e),a.match_length>a.lookahead&&(a.match_length=a.lookahead)}if(a.match_length>=ha?(c=D._tr_tally(a,1,a.match_length-ha),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(c=D._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++),c&&(h(a,!1),0===a.strm.avail_out))return sa}return a.insert=0,b===K?(h(a,!0),0===a.strm.avail_out?ua:va):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sa:ta}function r(a,b){for(var c;;){if(0===a.lookahead&&(m(a),0===a.lookahead)){if(b===H)return sa;break}if(a.match_length=0,c=D._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++,c&&(h(a,!1),0===a.strm.avail_out))return sa}return a.insert=0,b===K?(h(a,!0),0===a.strm.avail_out?ua:va):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sa:ta}function s(a){a.window_size=2*a.w_size,f(a.head),a.max_lazy_match=B[a.level].max_lazy,a.good_match=B[a.level].good_length,a.nice_match=B[a.level].nice_length,a.max_chain_length=B[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=ha-1,a.match_available=0,a.ins_h=0}function t(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new C.Buf16(2*fa),this.dyn_dtree=new C.Buf16(2*(2*da+1)),this.bl_tree=new C.Buf16(2*(2*ea+1)),f(this.dyn_ltree),f(this.dyn_dtree),f(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new C.Buf16(ga+1),this.heap=new C.Buf16(2*ca+1),f(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new C.Buf16(2*ca+1),f(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function u(a){var b;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=X,b=a.state,b.pending=0,b.pending_out=0,b.wrap<0&&(b.wrap=-b.wrap),b.status=b.wrap?la:qa,a.adler=2===b.wrap?0:1,b.last_flush=H,D._tr_init(b),M):d(a,O)}function v(a){var b=u(a);return b===M&&s(a.state),b}function w(a,b){return a&&a.state?2!==a.state.wrap?O:(a.state.gzhead=b,M):O}function x(a,b,c,e,f,g){if(!a)return O;var h=1;if(b===R&&(b=6),e<0?(h=0,e=-e):e>15&&(h=2,e-=16),f<1||f>Z||c!==Y||e<8||e>15||b<0||b>9||g<0||g>V)return d(a,O);8===e&&(e=9);var i=new t;return a.state=i,i.strm=a,i.wrap=h,i.gzhead=null,i.w_bits=e,i.w_size=1<<i.w_bits,i.w_mask=i.w_size-1,i.hash_bits=f+7,i.hash_size=1<<i.hash_bits,i.hash_mask=i.hash_size-1,i.hash_shift=~~((i.hash_bits+ha-1)/ha),i.window=new C.Buf8(2*i.w_size),i.head=new C.Buf16(i.hash_size),i.prev=new C.Buf16(i.w_size),i.lit_bufsize=1<<f+6,i.pending_buf_size=4*i.lit_bufsize,i.pending_buf=new C.Buf8(i.pending_buf_size),i.d_buf=i.lit_bufsize>>1,i.l_buf=3*i.lit_bufsize,i.level=b,i.strategy=g,i.method=c,v(a)}function y(a,b){return x(a,b,Y,$,_,W)}function z(a,b){var c,h,k,l;if(!a||!a.state||b>L||b<0)return a?d(a,O):O;if(h=a.state,!a.output||!a.input&&0!==a.avail_in||h.status===ra&&b!==K)return d(a,0===a.avail_out?Q:O);if(h.strm=a,c=h.last_flush,h.last_flush=b,h.status===la)if(2===h.wrap)a.adler=0,i(h,31),i(h,139),i(h,8),h.gzhead?(i(h,(h.gzhead.text?1:0)+(h.gzhead.hcrc?2:0)+(h.gzhead.extra?4:0)+(h.gzhead.name?8:0)+(h.gzhead.comment?16:0)),i(h,255&h.gzhead.time),i(h,h.gzhead.time>>8&255),i(h,h.gzhead.time>>16&255),i(h,h.gzhead.time>>24&255),i(h,9===h.level?2:h.strategy>=T||h.level<2?4:0),i(h,255&h.gzhead.os),h.gzhead.extra&&h.gzhead.extra.length&&(i(h,255&h.gzhead.extra.length),i(h,h.gzhead.extra.length>>8&255)),h.gzhead.hcrc&&(a.adler=F(a.adler,h.pending_buf,h.pending,0)),h.gzindex=0,h.status=ma):(i(h,0),i(h,0),i(h,0),i(h,0),i(h,0),i(h,9===h.level?2:h.strategy>=T||h.level<2?4:0),i(h,wa),h.status=qa);else{var m=Y+(h.w_bits-8<<4)<<8,n=-1;n=h.strategy>=T||h.level<2?0:h.level<6?1:6===h.level?2:3,m|=n<<6,0!==h.strstart&&(m|=ka),m+=31-m%31,h.status=qa,j(h,m),0!==h.strstart&&(j(h,a.adler>>>16),j(h,65535&a.adler)),a.adler=1}if(h.status===ma)if(h.gzhead.extra){for(k=h.pending;h.gzindex<(65535&h.gzhead.extra.length)&&(h.pending!==h.pending_buf_size||(h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending!==h.pending_buf_size));)i(h,255&h.gzhead.extra[h.gzindex]),h.gzindex++;h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),h.gzindex===h.gzhead.extra.length&&(h.gzindex=0,h.status=na)}else h.status=na;if(h.status===na)if(h.gzhead.name){k=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending===h.pending_buf_size)){l=1;break}l=h.gzindex<h.gzhead.name.length?255&h.gzhead.name.charCodeAt(h.gzindex++):0,i(h,l)}while(0!==l);h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),0===l&&(h.gzindex=0,h.status=oa)}else h.status=oa;if(h.status===oa)if(h.gzhead.comment){k=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending===h.pending_buf_size)){l=1;break}l=h.gzindex<h.gzhead.comment.length?255&h.gzhead.comment.charCodeAt(h.gzindex++):0,i(h,l)}while(0!==l);h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),0===l&&(h.status=pa)}else h.status=pa;if(h.status===pa&&(h.gzhead.hcrc?(h.pending+2>h.pending_buf_size&&g(a),h.pending+2<=h.pending_buf_size&&(i(h,255&a.adler),i(h,a.adler>>8&255),a.adler=0,h.status=qa)):h.status=qa),0!==h.pending){if(g(a),0===a.avail_out)return h.last_flush=-1,M}else if(0===a.avail_in&&e(b)<=e(c)&&b!==K)return d(a,Q);if(h.status===ra&&0!==a.avail_in)return d(a,Q);if(0!==a.avail_in||0!==h.lookahead||b!==H&&h.status!==ra){var o=h.strategy===T?r(h,b):h.strategy===U?q(h,b):B[h.level].func(h,b);if(o!==ua&&o!==va||(h.status=ra),o===sa||o===ua)return 0===a.avail_out&&(h.last_flush=-1),M;if(o===ta&&(b===I?D._tr_align(h):b!==L&&(D._tr_stored_block(h,0,0,!1),b===J&&(f(h.head),0===h.lookahead&&(h.strstart=0,h.block_start=0,h.insert=0))),g(a),0===a.avail_out))return h.last_flush=-1,M}return b!==K?M:h.wrap<=0?N:(2===h.wrap?(i(h,255&a.adler),i(h,a.adler>>8&255),i(h,a.adler>>16&255),i(h,a.adler>>24&255),i(h,255&a.total_in),i(h,a.total_in>>8&255),i(h,a.total_in>>16&255),i(h,a.total_in>>24&255)):(j(h,a.adler>>>16),j(h,65535&a.adler)),g(a),h.wrap>0&&(h.wrap=-h.wrap),0!==h.pending?M:N)}function A(a){var b;return a&&a.state?(b=a.state.status,b!==la&&b!==ma&&b!==na&&b!==oa&&b!==pa&&b!==qa&&b!==ra?d(a,O):(a.state=null,b===qa?d(a,P):M)):O}var B,C=a("../utils/common"),D=a("./trees"),E=a("./adler32"),F=a("./crc32"),G=a("./messages"),H=0,I=1,J=3,K=4,L=5,M=0,N=1,O=-2,P=-3,Q=-5,R=-1,S=1,T=2,U=3,V=4,W=0,X=2,Y=8,Z=9,$=15,_=8,aa=29,ba=256,ca=ba+1+aa,da=30,ea=19,fa=2*ca+1,ga=15,ha=3,ia=258,ja=ia+ha+1,ka=32,la=42,ma=69,na=73,oa=91,pa=103,qa=113,ra=666,sa=1,ta=2,ua=3,va=4,wa=3,xa=function(a,b,c,d,e){this.good_length=a,this.max_lazy=b,this.nice_length=c,this.max_chain=d,this.func=e};B=[new xa(0,0,0,0,n),new xa(4,4,8,4,o),new xa(4,5,16,8,o),new xa(4,6,32,32,o),new xa(4,4,16,16,p),new xa(8,16,32,32,p),new xa(8,16,128,128,p),new xa(8,32,128,256,p),new xa(32,128,258,1024,p),new xa(32,258,258,4096,p)],c.deflateInit=y,c.deflateInit2=x,c.deflateReset=v,c.deflateResetKeep=u,c.deflateSetHeader=w,c.deflate=z,c.deflateEnd=A,c.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":115,"./adler32":116,"./crc32":118,"./messages":123,"./trees":124}],120:[function(a,b,c){"use strict";var d=30,e=12;b.exports=function(a,b){var c,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;c=a.state,f=a.next_in,B=a.input,g=f+(a.avail_in-5),h=a.next_out,C=a.output,i=h-(b-a.avail_out),j=h+(a.avail_out-257),k=c.dmax,l=c.wsize,m=c.whave,n=c.wnext,o=c.window,p=c.hold,q=c.bits,r=c.lencode,s=c.distcode,t=(1<<c.lenbits)-1,u=(1<<c.distbits)-1;a:do{q<15&&(p+=B[f++]<<q,q+=8,p+=B[f++]<<q,q+=8),v=r[p&t];b:for(;;){if(w=v>>>24,p>>>=w,q-=w,w=v>>>16&255,0===w)C[h++]=65535&v;else{if(!(16&w)){if(0===(64&w)){v=r[(65535&v)+(p&(1<<w)-1)];continue b}if(32&w){c.mode=e;break a}a.msg="invalid literal/length code",c.mode=d;break a}x=65535&v,w&=15,w&&(q<w&&(p+=B[f++]<<q,q+=8),x+=p&(1<<w)-1,p>>>=w,q-=w),q<15&&(p+=B[f++]<<q,q+=8,p+=B[f++]<<q,q+=8),v=s[p&u];c:for(;;){if(w=v>>>24,p>>>=w,q-=w,w=v>>>16&255,!(16&w)){if(0===(64&w)){v=s[(65535&v)+(p&(1<<w)-1)];continue c}a.msg="invalid distance code",c.mode=d;break a}if(y=65535&v,w&=15,q<w&&(p+=B[f++]<<q,q+=8,q<w&&(p+=B[f++]<<q,q+=8)),y+=p&(1<<w)-1,y>k){a.msg="invalid distance too far back",c.mode=d;break a}if(p>>>=w,q-=w,w=h-i,y>w){if(w=y-w,w>m&&c.sane){a.msg="invalid distance too far back",c.mode=d;break a}if(z=0,A=o,0===n){if(z+=l-w,w<x){x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}}else if(n<w){if(z+=l+n-w,w-=n,w<x){x-=w;do C[h++]=o[z++];while(--w);if(z=0,n<x){w=n,x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}}}else if(z+=n-w,w<x){x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}for(;x>2;)C[h++]=A[z++],C[h++]=A[z++],C[h++]=A[z++],x-=3;x&&(C[h++]=A[z++],x>1&&(C[h++]=A[z++]))}else{z=h-y;do C[h++]=C[z++],C[h++]=C[z++],C[h++]=C[z++],x-=3;while(x>2);x&&(C[h++]=C[z++],x>1&&(C[h++]=C[z++]))}break}}break}}while(f<g&&h<j);x=q>>3,f-=x,q-=x<<3,p&=(1<<q)-1,a.next_in=f,a.next_out=h,a.avail_in=f<g?5+(g-f):5-(f-g),a.avail_out=h<j?257+(j-h):257-(h-j),c.hold=p,c.bits=q}},{}],121:[function(a,b,c){"use strict";function d(a){return(a>>>24&255)+(a>>>8&65280)+((65280&a)<<8)+((255&a)<<24)}function e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(a){var b;return a&&a.state?(b=a.state,a.total_in=a.total_out=b.total=0,a.msg="",b.wrap&&(a.adler=1&b.wrap),b.mode=K,b.last=0,b.havedict=0,b.dmax=32768,b.head=null,b.hold=0,b.bits=0,b.lencode=b.lendyn=new r.Buf32(oa),b.distcode=b.distdyn=new r.Buf32(pa),b.sane=1,b.back=-1,C):F}function g(a){var b;return a&&a.state?(b=a.state,b.wsize=0,b.whave=0,b.wnext=0,f(a)):F}function h(a,b){var c,d;return a&&a.state?(d=a.state,b<0?(c=0,b=-b):(c=(b>>4)+1,b<48&&(b&=15)),b&&(b<8||b>15)?F:(null!==d.window&&d.wbits!==b&&(d.window=null),d.wrap=c,d.wbits=b,g(a))):F}function i(a,b){var c,d;return a?(d=new e,a.state=d,d.window=null,c=h(a,b),c!==C&&(a.state=null),c):F}function j(a){return i(a,ra)}function k(a){if(sa){var b;for(p=new r.Buf32(512),q=new r.Buf32(32),b=0;b<144;)a.lens[b++]=8;for(;b<256;)a.lens[b++]=9;for(;b<280;)a.lens[b++]=7;for(;b<288;)a.lens[b++]=8;for(v(x,a.lens,0,288,p,0,a.work,{bits:9}),b=0;b<32;)a.lens[b++]=5;v(y,a.lens,0,32,q,0,a.work,{bits:5}),sa=!1}a.lencode=p,a.lenbits=9,a.distcode=q,a.distbits=5}function l(a,b,c,d){var e,f=a.state;return null===f.window&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new r.Buf8(f.wsize)),d>=f.wsize?(r.arraySet(f.window,b,c-f.wsize,f.wsize,0),f.wnext=0,f.whave=f.wsize):(e=f.wsize-f.wnext,e>d&&(e=d),r.arraySet(f.window,b,c-d,e,f.wnext),d-=e,d?(r.arraySet(f.window,b,c-d,d,0),f.wnext=d,f.whave=f.wsize):(f.wnext+=e,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=e))),0}function m(a,b){var c,e,f,g,h,i,j,m,n,o,p,q,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa=0,Ba=new r.Buf8(4),Ca=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return F;c=a.state,c.mode===V&&(c.mode=W),h=a.next_out,f=a.output,j=a.avail_out,g=a.next_in,e=a.input,i=a.avail_in,m=c.hold,n=c.bits,o=i,p=j,xa=C;a:for(;;)switch(c.mode){case K:if(0===c.wrap){c.mode=W;break}for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(2&c.wrap&&35615===m){c.check=0,Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=t(c.check,Ba,2,0),m=0,n=0,c.mode=L;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&m)<<8)+(m>>8))%31){a.msg="incorrect header check",c.mode=la;break}if((15&m)!==J){a.msg="unknown compression method",c.mode=la;break}if(m>>>=4,n-=4,wa=(15&m)+8,0===c.wbits)c.wbits=wa;else if(wa>c.wbits){a.msg="invalid window size",c.mode=la;break}c.dmax=1<<wa,a.adler=c.check=1,c.mode=512&m?T:V,m=0,n=0;break;case L:for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(c.flags=m,(255&c.flags)!==J){a.msg="unknown compression method",c.mode=la;break}if(57344&c.flags){a.msg="unknown header flags set",c.mode=la;break}c.head&&(c.head.text=m>>8&1),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=t(c.check,Ba,2,0)),m=0,n=0,c.mode=M;case M:for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.head&&(c.head.time=m),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,Ba[2]=m>>>16&255,Ba[3]=m>>>24&255,c.check=t(c.check,Ba,4,0)),m=0,n=0,c.mode=N;case N:for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.head&&(c.head.xflags=255&m,c.head.os=m>>8),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=t(c.check,Ba,2,0)),m=0,n=0,c.mode=O;case O:if(1024&c.flags){
for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.length=m,c.head&&(c.head.extra_len=m),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=t(c.check,Ba,2,0)),m=0,n=0}else c.head&&(c.head.extra=null);c.mode=P;case P:if(1024&c.flags&&(q=c.length,q>i&&(q=i),q&&(c.head&&(wa=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Array(c.head.extra_len)),r.arraySet(c.head.extra,e,g,q,wa)),512&c.flags&&(c.check=t(c.check,e,q,g)),i-=q,g+=q,c.length-=q),c.length))break a;c.length=0,c.mode=Q;case Q:if(2048&c.flags){if(0===i)break a;q=0;do wa=e[g+q++],c.head&&wa&&c.length<65536&&(c.head.name+=String.fromCharCode(wa));while(wa&&q<i);if(512&c.flags&&(c.check=t(c.check,e,q,g)),i-=q,g+=q,wa)break a}else c.head&&(c.head.name=null);c.length=0,c.mode=R;case R:if(4096&c.flags){if(0===i)break a;q=0;do wa=e[g+q++],c.head&&wa&&c.length<65536&&(c.head.comment+=String.fromCharCode(wa));while(wa&&q<i);if(512&c.flags&&(c.check=t(c.check,e,q,g)),i-=q,g+=q,wa)break a}else c.head&&(c.head.comment=null);c.mode=S;case S:if(512&c.flags){for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m!==(65535&c.check)){a.msg="header crc mismatch",c.mode=la;break}m=0,n=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),a.adler=c.check=0,c.mode=V;break;case T:for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}a.adler=c.check=d(m),m=0,n=0,c.mode=U;case U:if(0===c.havedict)return a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,E;a.adler=c.check=1,c.mode=V;case V:if(b===A||b===B)break a;case W:if(c.last){m>>>=7&n,n-=7&n,c.mode=ia;break}for(;n<3;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}switch(c.last=1&m,m>>>=1,n-=1,3&m){case 0:c.mode=X;break;case 1:if(k(c),c.mode=ba,b===B){m>>>=2,n-=2;break a}break;case 2:c.mode=$;break;case 3:a.msg="invalid block type",c.mode=la}m>>>=2,n-=2;break;case X:for(m>>>=7&n,n-=7&n;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if((65535&m)!==(m>>>16^65535)){a.msg="invalid stored block lengths",c.mode=la;break}if(c.length=65535&m,m=0,n=0,c.mode=Y,b===B)break a;case Y:c.mode=Z;case Z:if(q=c.length){if(q>i&&(q=i),q>j&&(q=j),0===q)break a;r.arraySet(f,e,g,q,h),i-=q,g+=q,j-=q,h+=q,c.length-=q;break}c.mode=V;break;case $:for(;n<14;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(c.nlen=(31&m)+257,m>>>=5,n-=5,c.ndist=(31&m)+1,m>>>=5,n-=5,c.ncode=(15&m)+4,m>>>=4,n-=4,c.nlen>286||c.ndist>30){a.msg="too many length or distance symbols",c.mode=la;break}c.have=0,c.mode=_;case _:for(;c.have<c.ncode;){for(;n<3;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.lens[Ca[c.have++]]=7&m,m>>>=3,n-=3}for(;c.have<19;)c.lens[Ca[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,ya={bits:c.lenbits},xa=v(w,c.lens,0,19,c.lencode,0,c.work,ya),c.lenbits=ya.bits,xa){a.msg="invalid code lengths set",c.mode=la;break}c.have=0,c.mode=aa;case aa:for(;c.have<c.nlen+c.ndist;){for(;Aa=c.lencode[m&(1<<c.lenbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(sa<16)m>>>=qa,n-=qa,c.lens[c.have++]=sa;else{if(16===sa){for(za=qa+2;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m>>>=qa,n-=qa,0===c.have){a.msg="invalid bit length repeat",c.mode=la;break}wa=c.lens[c.have-1],q=3+(3&m),m>>>=2,n-=2}else if(17===sa){for(za=qa+3;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=qa,n-=qa,wa=0,q=3+(7&m),m>>>=3,n-=3}else{for(za=qa+7;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=qa,n-=qa,wa=0,q=11+(127&m),m>>>=7,n-=7}if(c.have+q>c.nlen+c.ndist){a.msg="invalid bit length repeat",c.mode=la;break}for(;q--;)c.lens[c.have++]=wa}}if(c.mode===la)break;if(0===c.lens[256]){a.msg="invalid code -- missing end-of-block",c.mode=la;break}if(c.lenbits=9,ya={bits:c.lenbits},xa=v(x,c.lens,0,c.nlen,c.lencode,0,c.work,ya),c.lenbits=ya.bits,xa){a.msg="invalid literal/lengths set",c.mode=la;break}if(c.distbits=6,c.distcode=c.distdyn,ya={bits:c.distbits},xa=v(y,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,ya),c.distbits=ya.bits,xa){a.msg="invalid distances set",c.mode=la;break}if(c.mode=ba,b===B)break a;case ba:c.mode=ca;case ca:if(i>=6&&j>=258){a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,u(a,p),h=a.next_out,f=a.output,j=a.avail_out,g=a.next_in,e=a.input,i=a.avail_in,m=c.hold,n=c.bits,c.mode===V&&(c.back=-1);break}for(c.back=0;Aa=c.lencode[m&(1<<c.lenbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(ra&&0===(240&ra)){for(ta=qa,ua=ra,va=sa;Aa=c.lencode[va+((m&(1<<ta+ua)-1)>>ta)],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(ta+qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=ta,n-=ta,c.back+=ta}if(m>>>=qa,n-=qa,c.back+=qa,c.length=sa,0===ra){c.mode=ha;break}if(32&ra){c.back=-1,c.mode=V;break}if(64&ra){a.msg="invalid literal/length code",c.mode=la;break}c.extra=15&ra,c.mode=da;case da:if(c.extra){for(za=c.extra;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.length+=m&(1<<c.extra)-1,m>>>=c.extra,n-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=ea;case ea:for(;Aa=c.distcode[m&(1<<c.distbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(0===(240&ra)){for(ta=qa,ua=ra,va=sa;Aa=c.distcode[va+((m&(1<<ta+ua)-1)>>ta)],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(ta+qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=ta,n-=ta,c.back+=ta}if(m>>>=qa,n-=qa,c.back+=qa,64&ra){a.msg="invalid distance code",c.mode=la;break}c.offset=sa,c.extra=15&ra,c.mode=fa;case fa:if(c.extra){for(za=c.extra;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.offset+=m&(1<<c.extra)-1,m>>>=c.extra,n-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){a.msg="invalid distance too far back",c.mode=la;break}c.mode=ga;case ga:if(0===j)break a;if(q=p-j,c.offset>q){if(q=c.offset-q,q>c.whave&&c.sane){a.msg="invalid distance too far back",c.mode=la;break}q>c.wnext?(q-=c.wnext,oa=c.wsize-q):oa=c.wnext-q,q>c.length&&(q=c.length),pa=c.window}else pa=f,oa=h-c.offset,q=c.length;q>j&&(q=j),j-=q,c.length-=q;do f[h++]=pa[oa++];while(--q);0===c.length&&(c.mode=ca);break;case ha:if(0===j)break a;f[h++]=c.length,j--,c.mode=ca;break;case ia:if(c.wrap){for(;n<32;){if(0===i)break a;i--,m|=e[g++]<<n,n+=8}if(p-=j,a.total_out+=p,c.total+=p,p&&(a.adler=c.check=c.flags?t(c.check,f,p,h-p):s(c.check,f,p,h-p)),p=j,(c.flags?m:d(m))!==c.check){a.msg="incorrect data check",c.mode=la;break}m=0,n=0}c.mode=ja;case ja:if(c.wrap&&c.flags){for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m!==(4294967295&c.total)){a.msg="incorrect length check",c.mode=la;break}m=0,n=0}c.mode=ka;case ka:xa=D;break a;case la:xa=G;break a;case ma:return H;case na:default:return F}return a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,(c.wsize||p!==a.avail_out&&c.mode<la&&(c.mode<ia||b!==z))&&l(a,a.output,a.next_out,p-a.avail_out)?(c.mode=ma,H):(o-=a.avail_in,p-=a.avail_out,a.total_in+=o,a.total_out+=p,c.total+=p,c.wrap&&p&&(a.adler=c.check=c.flags?t(c.check,f,p,a.next_out-p):s(c.check,f,p,a.next_out-p)),a.data_type=c.bits+(c.last?64:0)+(c.mode===V?128:0)+(c.mode===ba||c.mode===Y?256:0),(0===o&&0===p||b===z)&&xa===C&&(xa=I),xa)}function n(a){if(!a||!a.state)return F;var b=a.state;return b.window&&(b.window=null),a.state=null,C}function o(a,b){var c;return a&&a.state?(c=a.state,0===(2&c.wrap)?F:(c.head=b,b.done=!1,C)):F}var p,q,r=a("../utils/common"),s=a("./adler32"),t=a("./crc32"),u=a("./inffast"),v=a("./inftrees"),w=0,x=1,y=2,z=4,A=5,B=6,C=0,D=1,E=2,F=-2,G=-3,H=-4,I=-5,J=8,K=1,L=2,M=3,N=4,O=5,P=6,Q=7,R=8,S=9,T=10,U=11,V=12,W=13,X=14,Y=15,Z=16,$=17,_=18,aa=19,ba=20,ca=21,da=22,ea=23,fa=24,ga=25,ha=26,ia=27,ja=28,ka=29,la=30,ma=31,na=32,oa=852,pa=592,qa=15,ra=qa,sa=!0;c.inflateReset=g,c.inflateReset2=h,c.inflateResetKeep=f,c.inflateInit=j,c.inflateInit2=i,c.inflate=m,c.inflateEnd=n,c.inflateGetHeader=o,c.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":115,"./adler32":116,"./crc32":118,"./inffast":120,"./inftrees":122}],122:[function(a,b,c){"use strict";var d=a("../utils/common"),e=15,f=852,g=592,h=0,i=1,j=2,k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],n=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];b.exports=function(a,b,c,o,p,q,r,s){var t,u,v,w,x,y,z,A,B,C=s.bits,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=null,O=0,P=new d.Buf16(e+1),Q=new d.Buf16(e+1),R=null,S=0;for(D=0;D<=e;D++)P[D]=0;for(E=0;E<o;E++)P[b[c+E]]++;for(H=C,G=e;G>=1&&0===P[G];G--);if(H>G&&(H=G),0===G)return p[q++]=20971520,p[q++]=20971520,s.bits=1,0;for(F=1;F<G&&0===P[F];F++);for(H<F&&(H=F),K=1,D=1;D<=e;D++)if(K<<=1,K-=P[D],K<0)return-1;if(K>0&&(a===h||1!==G))return-1;for(Q[1]=0,D=1;D<e;D++)Q[D+1]=Q[D]+P[D];for(E=0;E<o;E++)0!==b[c+E]&&(r[Q[b[c+E]]++]=E);if(a===h?(N=R=r,y=19):a===i?(N=k,O-=257,R=l,S-=257,y=256):(N=m,R=n,y=-1),M=0,E=0,D=F,x=q,I=H,J=0,v=-1,L=1<<H,w=L-1,a===i&&L>f||a===j&&L>g)return 1;for(var T=0;;){T++,z=D-J,r[E]<y?(A=0,B=r[E]):r[E]>y?(A=R[S+r[E]],B=N[O+r[E]]):(A=96,B=0),t=1<<D-J,u=1<<I,F=u;do u-=t,p[x+(M>>J)+u]=z<<24|A<<16|B|0;while(0!==u);for(t=1<<D-1;M&t;)t>>=1;if(0!==t?(M&=t-1,M+=t):M=0,E++,0===--P[D]){if(D===G)break;D=b[c+r[E]]}if(D>H&&(M&w)!==v){for(0===J&&(J=H),x+=F,I=D-J,K=1<<I;I+J<G&&(K-=P[I+J],!(K<=0));)I++,K<<=1;if(L+=1<<I,a===i&&L>f||a===j&&L>g)return 1;v=M&w,p[v]=H<<24|I<<16|x-q|0}}return 0!==M&&(p[x+M]=D-J<<24|64<<16|0),s.bits=H,0}},{"../utils/common":115}],123:[function(a,b,c){"use strict";b.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],124:[function(a,b,c){"use strict";function d(a){for(var b=a.length;--b>=0;)a[b]=0}function e(a){return a<256?ga[a]:ga[256+(a>>>7)]}function f(a,b){a.pending_buf[a.pending++]=255&b,a.pending_buf[a.pending++]=b>>>8&255}function g(a,b,c){a.bi_valid>V-c?(a.bi_buf|=b<<a.bi_valid&65535,f(a,a.bi_buf),a.bi_buf=b>>V-a.bi_valid,a.bi_valid+=c-V):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=c)}function h(a,b,c){g(a,c[2*b],c[2*b+1])}function i(a,b){var c=0;do c|=1&a,a>>>=1,c<<=1;while(--b>0);return c>>>1}function j(a){16===a.bi_valid?(f(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):a.bi_valid>=8&&(a.pending_buf[a.pending++]=255&a.bi_buf,a.bi_buf>>=8,a.bi_valid-=8)}function k(a,b){var c,d,e,f,g,h,i=b.dyn_tree,j=b.max_code,k=b.stat_desc.static_tree,l=b.stat_desc.has_stree,m=b.stat_desc.extra_bits,n=b.stat_desc.extra_base,o=b.stat_desc.max_length,p=0;for(f=0;f<=U;f++)a.bl_count[f]=0;for(i[2*a.heap[a.heap_max]+1]=0,c=a.heap_max+1;c<T;c++)d=a.heap[c],f=i[2*i[2*d+1]+1]+1,f>o&&(f=o,p++),i[2*d+1]=f,d>j||(a.bl_count[f]++,g=0,d>=n&&(g=m[d-n]),h=i[2*d],a.opt_len+=h*(f+g),l&&(a.static_len+=h*(k[2*d+1]+g)));if(0!==p){do{for(f=o-1;0===a.bl_count[f];)f--;a.bl_count[f]--,a.bl_count[f+1]+=2,a.bl_count[o]--,p-=2}while(p>0);for(f=o;0!==f;f--)for(d=a.bl_count[f];0!==d;)e=a.heap[--c],e>j||(i[2*e+1]!==f&&(a.opt_len+=(f-i[2*e+1])*i[2*e],i[2*e+1]=f),d--)}}function l(a,b,c){var d,e,f=new Array(U+1),g=0;for(d=1;d<=U;d++)f[d]=g=g+c[d-1]<<1;for(e=0;e<=b;e++){var h=a[2*e+1];0!==h&&(a[2*e]=i(f[h]++,h))}}function m(){var a,b,c,d,e,f=new Array(U+1);for(c=0,d=0;d<O-1;d++)for(ia[d]=c,a=0;a<1<<_[d];a++)ha[c++]=d;for(ha[c-1]=d,e=0,d=0;d<16;d++)for(ja[d]=e,a=0;a<1<<aa[d];a++)ga[e++]=d;for(e>>=7;d<R;d++)for(ja[d]=e<<7,a=0;a<1<<aa[d]-7;a++)ga[256+e++]=d;for(b=0;b<=U;b++)f[b]=0;for(a=0;a<=143;)ea[2*a+1]=8,a++,f[8]++;for(;a<=255;)ea[2*a+1]=9,a++,f[9]++;for(;a<=279;)ea[2*a+1]=7,a++,f[7]++;for(;a<=287;)ea[2*a+1]=8,a++,f[8]++;for(l(ea,Q+1,f),a=0;a<R;a++)fa[2*a+1]=5,fa[2*a]=i(a,5);ka=new na(ea,_,P+1,Q,U),la=new na(fa,aa,0,R,U),ma=new na(new Array(0),ba,0,S,W)}function n(a){var b;for(b=0;b<Q;b++)a.dyn_ltree[2*b]=0;for(b=0;b<R;b++)a.dyn_dtree[2*b]=0;for(b=0;b<S;b++)a.bl_tree[2*b]=0;a.dyn_ltree[2*X]=1,a.opt_len=a.static_len=0,a.last_lit=a.matches=0}function o(a){a.bi_valid>8?f(a,a.bi_buf):a.bi_valid>0&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0}function p(a,b,c,d){o(a),d&&(f(a,c),f(a,~c)),E.arraySet(a.pending_buf,a.window,b,c,a.pending),a.pending+=c}function q(a,b,c,d){var e=2*b,f=2*c;return a[e]<a[f]||a[e]===a[f]&&d[b]<=d[c]}function r(a,b,c){for(var d=a.heap[c],e=c<<1;e<=a.heap_len&&(e<a.heap_len&&q(b,a.heap[e+1],a.heap[e],a.depth)&&e++,!q(b,d,a.heap[e],a.depth));)a.heap[c]=a.heap[e],c=e,e<<=1;a.heap[c]=d}function s(a,b,c){var d,f,i,j,k=0;if(0!==a.last_lit)do d=a.pending_buf[a.d_buf+2*k]<<8|a.pending_buf[a.d_buf+2*k+1],f=a.pending_buf[a.l_buf+k],k++,0===d?h(a,f,b):(i=ha[f],h(a,i+P+1,b),j=_[i],0!==j&&(f-=ia[i],g(a,f,j)),d--,i=e(d),h(a,i,c),j=aa[i],0!==j&&(d-=ja[i],g(a,d,j)));while(k<a.last_lit);h(a,X,b)}function t(a,b){var c,d,e,f=b.dyn_tree,g=b.stat_desc.static_tree,h=b.stat_desc.has_stree,i=b.stat_desc.elems,j=-1;for(a.heap_len=0,a.heap_max=T,c=0;c<i;c++)0!==f[2*c]?(a.heap[++a.heap_len]=j=c,a.depth[c]=0):f[2*c+1]=0;for(;a.heap_len<2;)e=a.heap[++a.heap_len]=j<2?++j:0,f[2*e]=1,a.depth[e]=0,a.opt_len--,h&&(a.static_len-=g[2*e+1]);for(b.max_code=j,c=a.heap_len>>1;c>=1;c--)r(a,f,c);e=i;do c=a.heap[1],a.heap[1]=a.heap[a.heap_len--],r(a,f,1),d=a.heap[1],a.heap[--a.heap_max]=c,a.heap[--a.heap_max]=d,f[2*e]=f[2*c]+f[2*d],a.depth[e]=(a.depth[c]>=a.depth[d]?a.depth[c]:a.depth[d])+1,f[2*c+1]=f[2*d+1]=e,a.heap[1]=e++,r(a,f,1);while(a.heap_len>=2);a.heap[--a.heap_max]=a.heap[1],k(a,b),l(f,j,a.bl_count)}function u(a,b,c){var d,e,f=-1,g=b[1],h=0,i=7,j=4;for(0===g&&(i=138,j=3),b[2*(c+1)+1]=65535,d=0;d<=c;d++)e=g,g=b[2*(d+1)+1],++h<i&&e===g||(h<j?a.bl_tree[2*e]+=h:0!==e?(e!==f&&a.bl_tree[2*e]++,a.bl_tree[2*Y]++):h<=10?a.bl_tree[2*Z]++:a.bl_tree[2*$]++,h=0,f=e,0===g?(i=138,j=3):e===g?(i=6,j=3):(i=7,j=4))}function v(a,b,c){var d,e,f=-1,i=b[1],j=0,k=7,l=4;for(0===i&&(k=138,l=3),d=0;d<=c;d++)if(e=i,i=b[2*(d+1)+1],!(++j<k&&e===i)){if(j<l){do h(a,e,a.bl_tree);while(0!==--j)}else 0!==e?(e!==f&&(h(a,e,a.bl_tree),j--),h(a,Y,a.bl_tree),g(a,j-3,2)):j<=10?(h(a,Z,a.bl_tree),g(a,j-3,3)):(h(a,$,a.bl_tree),g(a,j-11,7));j=0,f=e,0===i?(k=138,l=3):e===i?(k=6,l=3):(k=7,l=4)}}function w(a){var b;for(u(a,a.dyn_ltree,a.l_desc.max_code),u(a,a.dyn_dtree,a.d_desc.max_code),t(a,a.bl_desc),b=S-1;b>=3&&0===a.bl_tree[2*ca[b]+1];b--);return a.opt_len+=3*(b+1)+5+5+4,b}function x(a,b,c,d){var e;for(g(a,b-257,5),g(a,c-1,5),g(a,d-4,4),e=0;e<d;e++)g(a,a.bl_tree[2*ca[e]+1],3);v(a,a.dyn_ltree,b-1),v(a,a.dyn_dtree,c-1)}function y(a){var b,c=4093624447;for(b=0;b<=31;b++,c>>>=1)if(1&c&&0!==a.dyn_ltree[2*b])return G;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return H;for(b=32;b<P;b++)if(0!==a.dyn_ltree[2*b])return H;return G}function z(a){pa||(m(),pa=!0),a.l_desc=new oa(a.dyn_ltree,ka),a.d_desc=new oa(a.dyn_dtree,la),a.bl_desc=new oa(a.bl_tree,ma),a.bi_buf=0,a.bi_valid=0,n(a)}function A(a,b,c,d){g(a,(J<<1)+(d?1:0),3),p(a,b,c,!0)}function B(a){g(a,K<<1,3),h(a,X,ea),j(a)}function C(a,b,c,d){var e,f,h=0;a.level>0?(a.strm.data_type===I&&(a.strm.data_type=y(a)),t(a,a.l_desc),t(a,a.d_desc),h=w(a),e=a.opt_len+3+7>>>3,f=a.static_len+3+7>>>3,f<=e&&(e=f)):e=f=c+5,c+4<=e&&b!==-1?A(a,b,c,d):a.strategy===F||f===e?(g(a,(K<<1)+(d?1:0),3),s(a,ea,fa)):(g(a,(L<<1)+(d?1:0),3),x(a,a.l_desc.max_code+1,a.d_desc.max_code+1,h+1),s(a,a.dyn_ltree,a.dyn_dtree)),n(a),d&&o(a)}function D(a,b,c){return a.pending_buf[a.d_buf+2*a.last_lit]=b>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=255&b,a.pending_buf[a.l_buf+a.last_lit]=255&c,a.last_lit++,0===b?a.dyn_ltree[2*c]++:(a.matches++,b--,a.dyn_ltree[2*(ha[c]+P+1)]++,a.dyn_dtree[2*e(b)]++),a.last_lit===a.lit_bufsize-1}var E=a("../utils/common"),F=4,G=0,H=1,I=2,J=0,K=1,L=2,M=3,N=258,O=29,P=256,Q=P+1+O,R=30,S=19,T=2*Q+1,U=15,V=16,W=7,X=256,Y=16,Z=17,$=18,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],aa=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ba=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ca=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],da=512,ea=new Array(2*(Q+2));d(ea);var fa=new Array(2*R);d(fa);var ga=new Array(da);d(ga);var ha=new Array(N-M+1);d(ha);var ia=new Array(O);d(ia);var ja=new Array(R);d(ja);var ka,la,ma,na=function(a,b,c,d,e){this.static_tree=a,this.extra_bits=b,this.extra_base=c,this.elems=d,this.max_length=e,this.has_stree=a&&a.length},oa=function(a,b){this.dyn_tree=a,this.max_code=0,this.stat_desc=b},pa=!1;c._tr_init=z,c._tr_stored_block=A,c._tr_flush_block=C,c._tr_tally=D,c._tr_align=B},{"../utils/common":115}],125:[function(a,b,c){"use strict";function d(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}b.exports=d},{}],126:[function(a,b,c){(function(b,d){function e(a){if(a<c.DEFLATE||a>c.UNZIP)throw new TypeError("Bad argument");this.mode=a,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function f(a,b){for(var c=0;c<a.length;c++)this[b+c]=a[c]}var g=a("pako/lib/zlib/messages"),h=a("pako/lib/zlib/zstream"),i=a("pako/lib/zlib/deflate.js"),j=a("pako/lib/zlib/inflate.js"),k=a("pako/lib/zlib/constants");for(var l in k)c[l]=k[l];c.NONE=0,c.DEFLATE=1,c.INFLATE=2,c.GZIP=3,c.GUNZIP=4,c.DEFLATERAW=5,c.INFLATERAW=6,c.UNZIP=7,e.prototype.init=function(a,b,d,e,f){switch(this.windowBits=a,this.level=b,this.memLevel=d,this.strategy=e,this.mode!==c.GZIP&&this.mode!==c.GUNZIP||(this.windowBits+=16),this.mode===c.UNZIP&&(this.windowBits+=32),this.mode!==c.DEFLATERAW&&this.mode!==c.INFLATERAW||(this.windowBits=-this.windowBits),this.strm=new h,this.mode){case c.DEFLATE:case c.GZIP:case c.DEFLATERAW:var g=i.deflateInit2(this.strm,this.level,c.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case c.INFLATE:case c.GUNZIP:case c.INFLATERAW:case c.UNZIP:var g=j.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}return g!==c.Z_OK?void this._error(g):(this.write_in_progress=!1,void(this.init_done=!0))},e.prototype.params=function(){throw new Error("deflateParams Not supported")},e.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(this.mode===c.NONE)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},e.prototype.write=function(a,c,d,e,f,g,h){this._writeCheck(),this.write_in_progress=!0;var i=this;return b.nextTick(function(){i.write_in_progress=!1;var b=i._write(a,c,d,e,f,g,h);i.callback(b[0],b[1]),i.pending_close&&i.close()}),this},e.prototype.writeSync=function(a,b,c,d,e,f,g){return this._writeCheck(),this._write(a,b,c,d,e,f,g)},e.prototype._write=function(a,b,e,g,h,k,l){if(this.write_in_progress=!0,a!==c.Z_NO_FLUSH&&a!==c.Z_PARTIAL_FLUSH&&a!==c.Z_SYNC_FLUSH&&a!==c.Z_FULL_FLUSH&&a!==c.Z_FINISH&&a!==c.Z_BLOCK)throw new Error("Invalid flush value");null==b&&(b=new d(0),g=0,e=0),h._set?h.set=h._set:h.set=f;var m=this.strm;switch(m.avail_in=g,m.input=b,m.next_in=e,m.avail_out=l,m.output=h,m.next_out=k,this.mode){case c.DEFLATE:case c.GZIP:case c.DEFLATERAW:var n=i.deflate(m,a);break;case c.UNZIP:case c.INFLATE:case c.GUNZIP:case c.INFLATERAW:var n=j.inflate(m,a);break;default:throw new Error("Unknown mode "+this.mode)}return n!==c.Z_STREAM_END&&n!==c.Z_OK&&this._error(n),this.write_in_progress=!1,[m.avail_in,m.avail_out]},e.prototype.close=function(){return this.write_in_progress?void(this.pending_close=!0):(this.pending_close=!1,this.mode===c.DEFLATE||this.mode===c.GZIP||this.mode===c.DEFLATERAW?i.deflateEnd(this.strm):j.inflateEnd(this.strm),void(this.mode=c.NONE))},e.prototype.reset=function(){switch(this.mode){case c.DEFLATE:case c.DEFLATERAW:var a=i.deflateReset(this.strm);break;case c.INFLATE:case c.INFLATERAW:var a=j.inflateReset(this.strm)}a!==c.Z_OK&&this._error(a)},e.prototype._error=function(a){this.onerror(g[a]+": "+this.strm.msg,a),this.write_in_progress=!1,this.pending_close&&this.close()},c.Zlib=e}).call(this,a("_process"),a("buffer").Buffer)},{_process:329,buffer:128,"pako/lib/zlib/constants":117,"pako/lib/zlib/deflate.js":119,"pako/lib/zlib/inflate.js":121,"pako/lib/zlib/messages":123,"pako/lib/zlib/zstream":125}],127:[function(a,b,c){(function(b,d){function e(a,b,c){function e(){for(var b;null!==(b=a.read());)h.push(b),i+=b.length;a.once("readable",e)}function f(b){a.removeListener("end",g),a.removeListener("readable",e),c(b)}function g(){var b=d.concat(h,i);h=[],c(null,b),a.close()}var h=[],i=0;a.on("error",f),a.on("end",g),a.end(b),e()}function f(a,b){if("string"==typeof b&&(b=new d(b)),!d.isBuffer(b))throw new TypeError("Not a string or buffer");var c=p.Z_FINISH;return a._processChunk(b,c)}function g(a){return this instanceof g?void n.call(this,a,p.DEFLATE):new g(a)}function h(a){return this instanceof h?void n.call(this,a,p.INFLATE):new h(a)}function i(a){return this instanceof i?void n.call(this,a,p.GZIP):new i(a)}function j(a){return this instanceof j?void n.call(this,a,p.GUNZIP):new j(a)}function k(a){return this instanceof k?void n.call(this,a,p.DEFLATERAW):new k(a)}function l(a){return this instanceof l?void n.call(this,a,p.INFLATERAW):new l(a)}function m(a){return this instanceof m?void n.call(this,a,p.UNZIP):new m(a)}function n(a,b){if(this._opts=a=a||{},this._chunkSize=a.chunkSize||c.Z_DEFAULT_CHUNK,o.call(this,a),a.flush&&a.flush!==p.Z_NO_FLUSH&&a.flush!==p.Z_PARTIAL_FLUSH&&a.flush!==p.Z_SYNC_FLUSH&&a.flush!==p.Z_FULL_FLUSH&&a.flush!==p.Z_FINISH&&a.flush!==p.Z_BLOCK)throw new Error("Invalid flush flag: "+a.flush);if(this._flushFlag=a.flush||p.Z_NO_FLUSH,a.chunkSize&&(a.chunkSize<c.Z_MIN_CHUNK||a.chunkSize>c.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+a.chunkSize);if(a.windowBits&&(a.windowBits<c.Z_MIN_WINDOWBITS||a.windowBits>c.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+a.windowBits);if(a.level&&(a.level<c.Z_MIN_LEVEL||a.level>c.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+a.level);if(a.memLevel&&(a.memLevel<c.Z_MIN_MEMLEVEL||a.memLevel>c.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+a.memLevel);if(a.strategy&&a.strategy!=c.Z_FILTERED&&a.strategy!=c.Z_HUFFMAN_ONLY&&a.strategy!=c.Z_RLE&&a.strategy!=c.Z_FIXED&&a.strategy!=c.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+a.strategy);if(a.dictionary&&!d.isBuffer(a.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new p.Zlib(b);var e=this;this._hadError=!1,this._binding.onerror=function(a,b){e._binding=null,e._hadError=!0;var d=new Error(a);d.errno=b,d.code=c.codes[b],e.emit("error",d)};var f=c.Z_DEFAULT_COMPRESSION;"number"==typeof a.level&&(f=a.level);var g=c.Z_DEFAULT_STRATEGY;"number"==typeof a.strategy&&(g=a.strategy),this._binding.init(a.windowBits||c.Z_DEFAULT_WINDOWBITS,f,a.memLevel||c.Z_DEFAULT_MEMLEVEL,g,a.dictionary),this._buffer=new d(this._chunkSize),this._offset=0,this._closed=!1,this._level=f,this._strategy=g,this.once("end",this.close)}var o=a("_stream_transform"),p=a("./binding"),q=a("util"),r=a("assert").ok;p.Z_MIN_WINDOWBITS=8,p.Z_MAX_WINDOWBITS=15,p.Z_DEFAULT_WINDOWBITS=15,p.Z_MIN_CHUNK=64,p.Z_MAX_CHUNK=1/0,p.Z_DEFAULT_CHUNK=16384,p.Z_MIN_MEMLEVEL=1,p.Z_MAX_MEMLEVEL=9,p.Z_DEFAULT_MEMLEVEL=8,p.Z_MIN_LEVEL=-1,p.Z_MAX_LEVEL=9,p.Z_DEFAULT_LEVEL=p.Z_DEFAULT_COMPRESSION,Object.keys(p).forEach(function(a){a.match(/^Z/)&&(c[a]=p[a])}),c.codes={Z_OK:p.Z_OK,Z_STREAM_END:p.Z_STREAM_END,Z_NEED_DICT:p.Z_NEED_DICT,Z_ERRNO:p.Z_ERRNO,Z_STREAM_ERROR:p.Z_STREAM_ERROR,Z_DATA_ERROR:p.Z_DATA_ERROR,Z_MEM_ERROR:p.Z_MEM_ERROR,Z_BUF_ERROR:p.Z_BUF_ERROR,Z_VERSION_ERROR:p.Z_VERSION_ERROR},Object.keys(c.codes).forEach(function(a){c.codes[c.codes[a]]=a}),c.Deflate=g,c.Inflate=h,c.Gzip=i,c.Gunzip=j,c.DeflateRaw=k,c.InflateRaw=l,c.Unzip=m,c.createDeflate=function(a){return new g(a)},c.createInflate=function(a){return new h(a)},c.createDeflateRaw=function(a){return new k(a)},c.createInflateRaw=function(a){return new l(a)},c.createGzip=function(a){return new i(a)},c.createGunzip=function(a){return new j(a)},c.createUnzip=function(a){return new m(a)},c.deflate=function(a,b,c){return"function"==typeof b&&(c=b,b={}),e(new g(b),a,c)},c.deflateSync=function(a,b){return f(new g(b),a)},c.gzip=function(a,b,c){return"function"==typeof b&&(c=b,b={}),e(new i(b),a,c)},c.gzipSync=function(a,b){return f(new i(b),a)},c.deflateRaw=function(a,b,c){return"function"==typeof b&&(c=b,b={}),e(new k(b),a,c)},c.deflateRawSync=function(a,b){return f(new k(b),a)},c.unzip=function(a,b,c){return"function"==typeof b&&(c=b,b={}),e(new m(b),a,c)},c.unzipSync=function(a,b){return f(new m(b),a)},c.inflate=function(a,b,c){return"function"==typeof b&&(c=b,b={}),e(new h(b),a,c)},c.inflateSync=function(a,b){return f(new h(b),a)},c.gunzip=function(a,b,c){return"function"==typeof b&&(c=b,b={}),e(new j(b),a,c)},c.gunzipSync=function(a,b){return f(new j(b),a)},c.inflateRaw=function(a,b,c){return"function"==typeof b&&(c=b,b={}),e(new l(b),a,c)},c.inflateRawSync=function(a,b){return f(new l(b),a)},q.inherits(n,o),n.prototype.params=function(a,d,e){if(a<c.Z_MIN_LEVEL||a>c.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+a);if(d!=c.Z_FILTERED&&d!=c.Z_HUFFMAN_ONLY&&d!=c.Z_RLE&&d!=c.Z_FIXED&&d!=c.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+d);if(this._level!==a||this._strategy!==d){var f=this;this.flush(p.Z_SYNC_FLUSH,function(){f._binding.params(a,d),f._hadError||(f._level=a,f._strategy=d,e&&e())})}else b.nextTick(e)},n.prototype.reset=function(){return this._binding.reset()},n.prototype._flush=function(a){this._transform(new d(0),"",a)},n.prototype.flush=function(a,c){var e=this._writableState;if(("function"==typeof a||void 0===a&&!c)&&(c=a,a=p.Z_FULL_FLUSH),e.ended)c&&b.nextTick(c);else if(e.ending)c&&this.once("end",c);else if(e.needDrain){var f=this;this.once("drain",function(){f.flush(c)})}else this._flushFlag=a,this.write(new d(0),"",c)},n.prototype.close=function(a){if(a&&b.nextTick(a),!this._closed){this._closed=!0,this._binding.close();var c=this;b.nextTick(function(){c.emit("close")})}},n.prototype._transform=function(a,b,c){var e,f=this._writableState,g=f.ending||f.ended,h=g&&(!a||f.length===a.length);if(null===!a&&!d.isBuffer(a))return c(new Error("invalid input"));h?e=p.Z_FINISH:(e=this._flushFlag,a.length>=f.length&&(this._flushFlag=this._opts.flush||p.Z_NO_FLUSH));this._processChunk(a,e,c)},n.prototype._processChunk=function(a,b,c){function e(k,n){if(!i._hadError){var o=g-n;if(r(o>=0,"have should not go down"),o>0){var p=i._buffer.slice(i._offset,i._offset+o);i._offset+=o,j?i.push(p):(l.push(p),m+=p.length)}if((0===n||i._offset>=i._chunkSize)&&(g=i._chunkSize,i._offset=0,i._buffer=new d(i._chunkSize)),0===n){if(h+=f-k,f=k,!j)return!0;var q=i._binding.write(b,a,h,f,i._buffer,i._offset,i._chunkSize);return q.callback=e,void(q.buffer=a)}return!!j&&void c()}}var f=a&&a.length,g=this._chunkSize-this._offset,h=0,i=this,j="function"==typeof c;if(!j){var k,l=[],m=0;this.on("error",function(a){k=a});do var n=this._binding.writeSync(b,a,h,f,this._buffer,this._offset,g);while(!this._hadError&&e(n[0],n[1]));if(this._hadError)throw k;var o=d.concat(l,m);return this.close(),o}var p=this._binding.write(b,a,h,f,this._buffer,this._offset,g);p.buffer=a,p.callback=e},q.inherits(g,n),q.inherits(h,n),q.inherits(i,n),q.inherits(j,n),q.inherits(k,n),q.inherits(l,n),q.inherits(m,n)}).call(this,a("_process"),a("buffer").Buffer)},{"./binding":126,_process:329,_stream_transform:346,assert:113,buffer:128,util:359}],128:[function(a,b,c){(function(b){"use strict";function d(){try{var a=new Uint8Array(1);return a.foo=function(){return 42},42===a.foo()&&"function"==typeof a.subarray&&0===a.subarray(1,1).byteLength}catch(a){return!1}}function e(){return g.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(a,b){if(e()<b)throw new RangeError("Invalid typed array length");return g.TYPED_ARRAY_SUPPORT?(a=new Uint8Array(b),a.__proto__=g.prototype):(null===a&&(a=new g(b)),a.length=b),a}function g(a,b,c){if(!(g.TYPED_ARRAY_SUPPORT||this instanceof g))return new g(a,b,c);if("number"==typeof a){if("string"==typeof b)throw new Error("If encoding is specified then the first argument must be a string");return k(this,a)}return h(this,a,b,c)}function h(a,b,c,d){if("number"==typeof b)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&b instanceof ArrayBuffer?n(a,b,c,d):"string"==typeof b?l(a,b,c):o(a,b)}function i(a){if("number"!=typeof a)throw new TypeError('"size" argument must be a number')}function j(a,b,c,d){return i(b),b<=0?f(a,b):void 0!==c?"string"==typeof d?f(a,b).fill(c,d):f(a,b).fill(c):f(a,b)}function k(a,b){if(i(b),a=f(a,b<0?0:0|p(b)),!g.TYPED_ARRAY_SUPPORT)for(var c=0;c<b;c++)a[c]=0;return a}function l(a,b,c){if("string"==typeof c&&""!==c||(c="utf8"),!g.isEncoding(c))throw new TypeError('"encoding" must be a valid string encoding');var d=0|r(b,c);return a=f(a,d),a.write(b,c),a}function m(a,b){var c=0|p(b.length);a=f(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function n(a,b,c,d){if(b.byteLength,c<0||b.byteLength<c)throw new RangeError("'offset' is out of bounds");if(b.byteLength<c+(d||0))throw new RangeError("'length' is out of bounds");return b=void 0===d?new Uint8Array(b,c):new Uint8Array(b,c,d),g.TYPED_ARRAY_SUPPORT?(a=b,a.__proto__=g.prototype):a=m(a,b),a}function o(a,b){if(g.isBuffer(b)){var c=0|p(b.length);return a=f(a,c),0===a.length?a:(b.copy(a,0,0,c),a)}if(b){if("undefined"!=typeof ArrayBuffer&&b.buffer instanceof ArrayBuffer||"length"in b)return"number"!=typeof b.length||X(b.length)?f(a,0):m(a,b);if("Buffer"===b.type&&$(b.data))return m(a,b.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(a){if(a>=e())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+e().toString(16)+" bytes");return 0|a}function q(a){return+a!=a&&(a=0),g.alloc(+a)}function r(a,b){if(g.isBuffer(a))return a.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(a)||a instanceof ArrayBuffer))return a.byteLength;"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":case void 0:return S(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return V(a).length;default:if(d)return S(a).length;b=(""+b).toLowerCase(),d=!0}}function s(a,b,c){var d=!1;if((void 0===b||b<0)&&(b=0),b>this.length)return"";if((void 0===c||c>this.length)&&(c=this.length),c<=0)return"";if(c>>>=0,b>>>=0,c<=b)return"";for(a||(a="utf8");;)switch(a){case"hex":return G(this,b,c);case"utf8":case"utf-8":return C(this,b,c);case"ascii":return E(this,b,c);case"binary":return F(this,b,c);case"base64":return B(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function t(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function u(a,b,c,d){function e(a,b){return 1===f?a[b]:a.readUInt16BE(b*f)}var f=1,g=a.length,h=b.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return-1;f=2,g/=2,h/=2,c/=2}for(var i=-1,j=0;c+j<g;j++)if(e(a,c+j)===e(b,i===-1?0:j-i)){if(i===-1&&(i=j),j-i+1===h)return(c+i)*f}else i!==-1&&(j-=j-i),i=-1;return-1}function v(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;g<d;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))return g;a[c+g]=h}return g}function w(a,b,c,d){return W(S(b,a.length-c),a,c,d)}function x(a,b,c,d){return W(T(b),a,c,d)}function y(a,b,c,d){return x(a,b,c,d)}function z(a,b,c,d){return W(V(b),a,c,d)}function A(a,b,c,d){return W(U(b,a.length-c),a,c,d)}function B(a,b,c){return 0===b&&c===a.length?Y.fromByteArray(a):Y.fromByteArray(a.slice(b,c));
}function C(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;e<c;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(e+h<=c){var i,j,k,l;switch(h){case 1:f<128&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(l<55296||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&l<1114112&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return D(d)}function D(a){var b=a.length;if(b<=_)return String.fromCharCode.apply(String,a);for(var c="",d=0;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=_));return c}function E(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(127&a[e]);return d}function F(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(a[e]);return d}function G(a,b,c){var d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);for(var e="",f=b;f<c;f++)e+=R(a[f]);return e}function H(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function I(a,b,c){if(a%1!==0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function J(a,b,c,d,e,f){if(!g.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(b>e||b<f)throw new RangeError('"value" argument is out of bounds');if(c+d>a.length)throw new RangeError("Index out of range")}function K(a,b,c,d){b<0&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);e<f;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function L(a,b,c,d){b<0&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);e<f;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function M(a,b,c,d,e,f){if(c+d>a.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function N(a,b,c,d,e){return e||M(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(a,b,c,d,23,4),c+4}function O(a,b,c,d,e){return e||M(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(a,b,c,d,52,8),c+8}function P(a){if(a=Q(a).replace(aa,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function Q(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function R(a){return a<16?"0"+a.toString(16):a.toString(16)}function S(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;g<d;g++){if(c=a.charCodeAt(g),c>55295&&c<57344){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(c<1114112))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function T(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function U(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function V(a){return Y.toByteArray(P(a))}function W(a,b,c,d){for(var e=0;e<d&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function X(a){return a!==a}var Y=a("base64-js"),Z=a("ieee754"),$=a("isarray");c.Buffer=g,c.SlowBuffer=q,c.INSPECT_MAX_BYTES=50,g.TYPED_ARRAY_SUPPORT=void 0!==b.TYPED_ARRAY_SUPPORT?b.TYPED_ARRAY_SUPPORT:d(),c.kMaxLength=e(),g.poolSize=8192,g._augment=function(a){return a.__proto__=g.prototype,a},g.from=function(a,b,c){return h(null,a,b,c)},g.TYPED_ARRAY_SUPPORT&&(g.prototype.__proto__=Uint8Array.prototype,g.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&g[Symbol.species]===g&&Object.defineProperty(g,Symbol.species,{value:null,configurable:!0})),g.alloc=function(a,b,c){return j(null,a,b,c)},g.allocUnsafe=function(a){return k(null,a)},g.allocUnsafeSlow=function(a){return k(null,a)},g.isBuffer=function(a){return!(null==a||!a._isBuffer)},g.compare=function(a,b){if(!g.isBuffer(a)||!g.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,e=0,f=Math.min(c,d);e<f;++e)if(a[e]!==b[e]){c=a[e],d=b[e];break}return c<d?-1:d<c?1:0},g.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.concat=function(a,b){if(!$(a))throw new TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return g.alloc(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var d=g.allocUnsafe(b),e=0;for(c=0;c<a.length;c++){var f=a[c];if(!g.isBuffer(f))throw new TypeError('"list" argument must be an Array of Buffers');f.copy(d,e),e+=f.length}return d},g.byteLength=r,g.prototype._isBuffer=!0,g.prototype.swap16=function(){var a=this.length;if(a%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<a;b+=2)t(this,b,b+1);return this},g.prototype.swap32=function(){var a=this.length;if(a%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<a;b+=4)t(this,b,b+3),t(this,b+1,b+2);return this},g.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?C(this,0,a):s.apply(this,arguments)},g.prototype.equals=function(a){if(!g.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a||0===g.compare(this,a)},g.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},g.prototype.compare=function(a,b,c,d,e){if(!g.isBuffer(a))throw new TypeError("Argument must be a Buffer");if(void 0===b&&(b=0),void 0===c&&(c=a?a.length:0),void 0===d&&(d=0),void 0===e&&(e=this.length),b<0||c>a.length||d<0||e>this.length)throw new RangeError("out of range index");if(d>=e&&b>=c)return 0;if(d>=e)return-1;if(b>=c)return 1;if(b>>>=0,c>>>=0,d>>>=0,e>>>=0,this===a)return 0;for(var f=e-d,h=c-b,i=Math.min(f,h),j=this.slice(d,e),k=a.slice(b,c),l=0;l<i;++l)if(j[l]!==k[l]){f=j[l],h=k[l];break}return f<h?-1:h<f?1:0},g.prototype.indexOf=function(a,b,c){if("string"==typeof b?(c=b,b=0):b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b>>=0,0===this.length)return-1;if(b>=this.length)return-1;if(b<0&&(b=Math.max(this.length+b,0)),"string"==typeof a&&(a=g.from(a,c)),g.isBuffer(a))return 0===a.length?-1:u(this,a,b,c);if("number"==typeof a)return g.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):u(this,[a],b,c);throw new TypeError("val must be string, number or Buffer")},g.prototype.includes=function(a,b,c){return this.indexOf(a,b,c)!==-1},g.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else{if(!isFinite(b))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");b|=0,isFinite(c)?(c|=0,void 0===d&&(d="utf8")):(d=c,c=void 0)}var e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(c<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(var f=!1;;)switch(d){case"hex":return v(this,a,b,c);case"utf8":case"utf-8":return w(this,a,b,c);case"ascii":return x(this,a,b,c);case"binary":return y(this,a,b,c);case"base64":return z(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,a,b,c);default:if(f)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _=4096;g.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,a<0?(a+=c,a<0&&(a=0)):a>c&&(a=c),b<0?(b+=c,b<0&&(b=0)):b>c&&(b=c),b<a&&(b=a);var d;if(g.TYPED_ARRAY_SUPPORT)d=this.subarray(a,b),d.__proto__=g.prototype;else{var e=b-a;d=new g(e,void 0);for(var f=0;f<e;f++)d[f]=this[f+a]}return d},g.prototype.readUIntLE=function(a,b,c){a|=0,b|=0,c||I(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},g.prototype.readUIntBE=function(a,b,c){a|=0,b|=0,c||I(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},g.prototype.readUInt8=function(a,b){return b||I(a,1,this.length),this[a]},g.prototype.readUInt16LE=function(a,b){return b||I(a,2,this.length),this[a]|this[a+1]<<8},g.prototype.readUInt16BE=function(a,b){return b||I(a,2,this.length),this[a]<<8|this[a+1]},g.prototype.readUInt32LE=function(a,b){return b||I(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},g.prototype.readUInt32BE=function(a,b){return b||I(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},g.prototype.readIntLE=function(a,b,c){a|=0,b|=0,c||I(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},g.prototype.readIntBE=function(a,b,c){a|=0,b|=0,c||I(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},g.prototype.readInt8=function(a,b){return b||I(a,1,this.length),128&this[a]?(255-this[a]+1)*-1:this[a]},g.prototype.readInt16LE=function(a,b){b||I(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},g.prototype.readInt16BE=function(a,b){b||I(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},g.prototype.readInt32LE=function(a,b){return b||I(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},g.prototype.readInt32BE=function(a,b){return b||I(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},g.prototype.readFloatLE=function(a,b){return b||I(a,4,this.length),Z.read(this,a,!0,23,4)},g.prototype.readFloatBE=function(a,b){return b||I(a,4,this.length),Z.read(this,a,!1,23,4)},g.prototype.readDoubleLE=function(a,b){return b||I(a,8,this.length),Z.read(this,a,!0,52,8)},g.prototype.readDoubleBE=function(a,b){return b||I(a,8,this.length),Z.read(this,a,!1,52,8)},g.prototype.writeUIntLE=function(a,b,c,d){if(a=+a,b|=0,c|=0,!d){var e=Math.pow(2,8*c)-1;J(this,a,b,c,e,0)}var f=1,g=0;for(this[b]=255&a;++g<c&&(f*=256);)this[b+g]=a/f&255;return b+c},g.prototype.writeUIntBE=function(a,b,c,d){if(a=+a,b|=0,c|=0,!d){var e=Math.pow(2,8*c)-1;J(this,a,b,c,e,0)}var f=c-1,g=1;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=a/g&255;return b+c},g.prototype.writeUInt8=function(a,b,c){return a=+a,b|=0,c||J(this,a,b,1,255,0),g.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=255&a,b+1},g.prototype.writeUInt16LE=function(a,b,c){return a=+a,b|=0,c||J(this,a,b,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):K(this,a,b,!0),b+2},g.prototype.writeUInt16BE=function(a,b,c){return a=+a,b|=0,c||J(this,a,b,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):K(this,a,b,!1),b+2},g.prototype.writeUInt32LE=function(a,b,c){return a=+a,b|=0,c||J(this,a,b,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a):L(this,a,b,!0),b+4},g.prototype.writeUInt32BE=function(a,b,c){return a=+a,b|=0,c||J(this,a,b,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):L(this,a,b,!1),b+4},g.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b|=0,!d){var e=Math.pow(2,8*c-1);J(this,a,b,c,e-1,-e)}var f=0,g=1,h=0;for(this[b]=255&a;++f<c&&(g*=256);)a<0&&0===h&&0!==this[b+f-1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},g.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b|=0,!d){var e=Math.pow(2,8*c-1);J(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0;for(this[b+f]=255&a;--f>=0&&(g*=256);)a<0&&0===h&&0!==this[b+f+1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},g.prototype.writeInt8=function(a,b,c){return a=+a,b|=0,c||J(this,a,b,1,127,-128),g.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),a<0&&(a=255+a+1),this[b]=255&a,b+1},g.prototype.writeInt16LE=function(a,b,c){return a=+a,b|=0,c||J(this,a,b,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):K(this,a,b,!0),b+2},g.prototype.writeInt16BE=function(a,b,c){return a=+a,b|=0,c||J(this,a,b,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):K(this,a,b,!1),b+2},g.prototype.writeInt32LE=function(a,b,c){return a=+a,b|=0,c||J(this,a,b,4,2147483647,-2147483648),g.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):L(this,a,b,!0),b+4},g.prototype.writeInt32BE=function(a,b,c){return a=+a,b|=0,c||J(this,a,b,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):L(this,a,b,!1),b+4},g.prototype.writeFloatLE=function(a,b,c){return N(this,a,b,!0,c)},g.prototype.writeFloatBE=function(a,b,c){return N(this,a,b,!1,c)},g.prototype.writeDoubleLE=function(a,b,c){return O(this,a,b,!0,c)},g.prototype.writeDoubleBE=function(a,b,c){return O(this,a,b,!1,c)},g.prototype.copy=function(a,b,c,d){if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&d<c&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("sourceStart out of bounds");if(d<0)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var e,f=d-c;if(this===a&&c<b&&b<d)for(e=f-1;e>=0;e--)a[e+b]=this[e+c];else if(f<1e3||!g.TYPED_ARRAY_SUPPORT)for(e=0;e<f;e++)a[e+b]=this[e+c];else Uint8Array.prototype.set.call(a,this.subarray(c,c+f),b);return f},g.prototype.fill=function(a,b,c,d){if("string"==typeof a){if("string"==typeof b?(d=b,b=0,c=this.length):"string"==typeof c&&(d=c,c=this.length),1===a.length){var e=a.charCodeAt(0);e<256&&(a=e)}if(void 0!==d&&"string"!=typeof d)throw new TypeError("encoding must be a string");if("string"==typeof d&&!g.isEncoding(d))throw new TypeError("Unknown encoding: "+d)}else"number"==typeof a&&(a&=255);if(b<0||this.length<b||this.length<c)throw new RangeError("Out of range index");if(c<=b)return this;b>>>=0,c=void 0===c?this.length:c>>>0,a||(a=0);var f;if("number"==typeof a)for(f=b;f<c;f++)this[f]=a;else{var h=g.isBuffer(a)?a:S(new g(a,d).toString()),i=h.length;for(f=0;f<c-b;f++)this[f+b]=h[f%i]}return this};var aa=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":129,ieee754:130,isarray:131}],129:[function(a,b,c){"use strict";function d(){for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b=0,c=a.length;b<c;++b)i[b]=a[b],j[a.charCodeAt(b)]=b;j["-".charCodeAt(0)]=62,j["_".charCodeAt(0)]=63}function e(a){var b,c,d,e,f,g,h=a.length;if(h%4>0)throw new Error("Invalid string. Length must be a multiple of 4");f="="===a[h-2]?2:"="===a[h-1]?1:0,g=new k(3*h/4-f),d=f>0?h-4:h;var i=0;for(b=0,c=0;b<d;b+=4,c+=3)e=j[a.charCodeAt(b)]<<18|j[a.charCodeAt(b+1)]<<12|j[a.charCodeAt(b+2)]<<6|j[a.charCodeAt(b+3)],g[i++]=e>>16&255,g[i++]=e>>8&255,g[i++]=255&e;return 2===f?(e=j[a.charCodeAt(b)]<<2|j[a.charCodeAt(b+1)]>>4,g[i++]=255&e):1===f&&(e=j[a.charCodeAt(b)]<<10|j[a.charCodeAt(b+1)]<<4|j[a.charCodeAt(b+2)]>>2,g[i++]=e>>8&255,g[i++]=255&e),g}function f(a){return i[a>>18&63]+i[a>>12&63]+i[a>>6&63]+i[63&a]}function g(a,b,c){for(var d,e=[],g=b;g<c;g+=3)d=(a[g]<<16)+(a[g+1]<<8)+a[g+2],e.push(f(d));return e.join("")}function h(a){for(var b,c=a.length,d=c%3,e="",f=[],h=16383,j=0,k=c-d;j<k;j+=h)f.push(g(a,j,j+h>k?k:j+h));return 1===d?(b=a[c-1],e+=i[b>>2],e+=i[b<<4&63],e+="=="):2===d&&(b=(a[c-2]<<8)+a[c-1],e+=i[b>>10],e+=i[b>>4&63],e+=i[b<<2&63],e+="="),f.push(e),f.join("")}c.toByteArray=e,c.fromByteArray=h;var i=[],j=[],k="undefined"!=typeof Uint8Array?Uint8Array:Array;d()},{}],130:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],131:[function(a,b,c){arguments[4][65][0].apply(c,arguments)},{dup:65}],132:[function(a,b,c){"use strict";c.randomBytes=c.rng=c.pseudoRandomBytes=c.prng=a("randombytes"),c.createHash=c.Hash=a("create-hash"),c.createHmac=c.Hmac=a("create-hmac");var d=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(Object.keys(a("browserify-sign/algos")));c.getHashes=function(){return d};var e=a("pbkdf2");c.pbkdf2=e.pbkdf2,c.pbkdf2Sync=e.pbkdf2Sync;var f=a("browserify-cipher");["Cipher","createCipher","Cipheriv","createCipheriv","Decipher","createDecipher","Decipheriv","createDecipheriv","getCiphers","listCiphers"].forEach(function(a){c[a]=f[a]});var g=a("diffie-hellman");["DiffieHellmanGroup","createDiffieHellmanGroup","getDiffieHellman","createDiffieHellman","DiffieHellman"].forEach(function(a){c[a]=g[a]});var h=a("browserify-sign");["createSign","Sign","createVerify","Verify"].forEach(function(a){c[a]=h[a]}),c.createECDH=a("create-ecdh");var i=a("public-encrypt");["publicEncrypt","privateEncrypt","publicDecrypt","privateDecrypt"].forEach(function(a){c[a]=i[a]}),["createCredentials"].forEach(function(a){c[a]=function(){throw new Error(["sorry, "+a+" is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))}})},{"browserify-cipher":133,"browserify-sign":163,"browserify-sign/algos":162,"create-ecdh":230,"create-hash":256,"create-hmac":269,"diffie-hellman":270,pbkdf2:277,"public-encrypt":278,randombytes:323}],133:[function(a,b,c){function d(a,b){var c,d;if(a=a.toLowerCase(),m[a])c=m[a].key,d=m[a].iv;else{if(!l[a])throw new TypeError("invalid suite type");c=8*l[a].key,d=l[a].iv}var e=i(b,!1,c,d);return f(a,e.key,e.iv)}function e(a,b){var c,d;if(a=a.toLowerCase(),m[a])c=m[a].key,d=m[a].iv;else{if(!l[a])throw new TypeError("invalid suite type");c=8*l[a].key,d=l[a].iv}var e=i(b,!1,c,d);return g(a,e.key,e.iv)}function f(a,b,c){if(a=a.toLowerCase(),m[a])return j.createCipheriv(a,b,c);if(l[a])return new k({key:b,iv:c,mode:a});throw new TypeError("invalid suite type")}function g(a,b,c){if(a=a.toLowerCase(),m[a])return j.createDecipheriv(a,b,c);if(l[a])return new k({key:b,iv:c,mode:a,decrypt:!0});throw new TypeError("invalid suite type")}function h(){return Object.keys(l).concat(j.getCiphers())}var i=a("evp_bytestokey"),j=a("browserify-aes/browser"),k=a("browserify-des"),l=a("browserify-des/modes"),m=a("browserify-aes/modes");c.createCipher=c.Cipher=d,c.createCipheriv=c.Cipheriv=f,c.createDecipher=c.Decipher=e,c.createDecipheriv=c.Decipheriv=g,c.listCiphers=c.getCiphers=h},{"browserify-aes/browser":136,"browserify-aes/modes":140,"browserify-des":151,"browserify-des/modes":152,evp_bytestokey:161}],134:[function(a,b,c){(function(a){function b(a){var b,c;return b=a>h||a<0?(c=Math.abs(a)%h,a<0?h-c:c):a}function d(a){for(var b=0;b<a.length;a++)a[b]=0;return!1}function e(){this.SBOX=[],this.INV_SBOX=[],this.SUB_MIX=[[],[],[],[]],this.INV_SUB_MIX=[[],[],[],[]],this.init(),this.RCON=[0,1,2,4,8,16,32,64,128,27,54]}function f(a){for(var b=a.length/4,c=new Array(b),d=-1;++d<b;)c[d]=a.readUInt32BE(4*d);return c}function g(a){this._key=f(a),this._doReset()}var h=Math.pow(2,32);e.prototype.init=function(){var a,b,c,d,e,f,g,h,i,j;for(a=function(){var a,c;for(c=[],b=a=0;a<256;b=++a)b<128?c.push(b<<1):c.push(b<<1^283);return c}(),e=0,i=0,b=j=0;j<256;b=++j)c=i^i<<1^i<<2^i<<3^i<<4,c=c>>>8^255&c^99,this.SBOX[e]=c,this.INV_SBOX[c]=e,f=a[e],g=a[f],h=a[g],d=257*a[c]^16843008*c,this.SUB_MIX[0][e]=d<<24|d>>>8,this.SUB_MIX[1][e]=d<<16|d>>>16,this.SUB_MIX[2][e]=d<<8|d>>>24,this.SUB_MIX[3][e]=d,d=16843009*h^65537*g^257*f^16843008*e,this.INV_SUB_MIX[0][c]=d<<24|d>>>8,this.INV_SUB_MIX[1][c]=d<<16|d>>>16,this.INV_SUB_MIX[2][c]=d<<8|d>>>24,this.INV_SUB_MIX[3][c]=d,0===e?e=i=1:(e=f^a[a[a[h^f]]],i^=a[a[i]]);return!0};var i=new e;g.blockSize=16,g.prototype.blockSize=g.blockSize,g.keySize=32,g.prototype.keySize=g.keySize,g.prototype._doReset=function(){var a,b,c,d,e,f;for(c=this._key,b=c.length,this._nRounds=b+6,e=4*(this._nRounds+1),this._keySchedule=[],d=0;d<e;d++)this._keySchedule[d]=d<b?c[d]:(f=this._keySchedule[d-1],d%b===0?(f=f<<8|f>>>24,f=i.SBOX[f>>>24]<<24|i.SBOX[f>>>16&255]<<16|i.SBOX[f>>>8&255]<<8|i.SBOX[255&f],f^=i.RCON[d/b|0]<<24):b>6&&d%b===4?f=i.SBOX[f>>>24]<<24|i.SBOX[f>>>16&255]<<16|i.SBOX[f>>>8&255]<<8|i.SBOX[255&f]:void 0,this._keySchedule[d-b]^f);for(this._invKeySchedule=[],a=0;a<e;a++)d=e-a,f=this._keySchedule[d-(a%4?0:4)],this._invKeySchedule[a]=a<4||d<=4?f:i.INV_SUB_MIX[0][i.SBOX[f>>>24]]^i.INV_SUB_MIX[1][i.SBOX[f>>>16&255]]^i.INV_SUB_MIX[2][i.SBOX[f>>>8&255]]^i.INV_SUB_MIX[3][i.SBOX[255&f]];return!0},g.prototype.encryptBlock=function(b){b=f(new a(b));var c=this._doCryptBlock(b,this._keySchedule,i.SUB_MIX,i.SBOX),d=new a(16);return d.writeUInt32BE(c[0],0),d.writeUInt32BE(c[1],4),d.writeUInt32BE(c[2],8),d.writeUInt32BE(c[3],12),d},g.prototype.decryptBlock=function(b){b=f(new a(b));var c=[b[3],b[1]];b[1]=c[0],b[3]=c[1];var d=this._doCryptBlock(b,this._invKeySchedule,i.INV_SUB_MIX,i.INV_SBOX),e=new a(16);return e.writeUInt32BE(d[0],0),e.writeUInt32BE(d[3],4),e.writeUInt32BE(d[2],8),e.writeUInt32BE(d[1],12),e},g.prototype.scrub=function(){d(this._keySchedule),d(this._invKeySchedule),d(this._key)},g.prototype._doCryptBlock=function(a,c,d,e){var f,g,h,i,j,k,l,m,n;g=a[0]^c[0],h=a[1]^c[1],i=a[2]^c[2],j=a[3]^c[3],f=4;for(var o=1;o<this._nRounds;o++)k=d[0][g>>>24]^d[1][h>>>16&255]^d[2][i>>>8&255]^d[3][255&j]^c[f++],l=d[0][h>>>24]^d[1][i>>>16&255]^d[2][j>>>8&255]^d[3][255&g]^c[f++],m=d[0][i>>>24]^d[1][j>>>16&255]^d[2][g>>>8&255]^d[3][255&h]^c[f++],n=d[0][j>>>24]^d[1][g>>>16&255]^d[2][h>>>8&255]^d[3][255&i]^c[f++],g=k,h=l,i=m,j=n;return k=(e[g>>>24]<<24|e[h>>>16&255]<<16|e[i>>>8&255]<<8|e[255&j])^c[f++],l=(e[h>>>24]<<24|e[i>>>16&255]<<16|e[j>>>8&255]<<8|e[255&g])^c[f++],m=(e[i>>>24]<<24|e[j>>>16&255]<<16|e[g>>>8&255]<<8|e[255&h])^c[f++],n=(e[j>>>24]<<24|e[g>>>16&255]<<16|e[h>>>8&255]<<8|e[255&i])^c[f++],[b(k),b(l),b(m),b(n)]},c.AES=g}).call(this,a("buffer").Buffer)},{buffer:128}],135:[function(a,b,c){(function(c){function d(a,b,e,h){if(!(this instanceof d))return new d(a,b,e);g.call(this),this._finID=c.concat([e,new c([0,0,0,1])]),e=c.concat([e,new c([0,0,0,2])]),this._cipher=new f.AES(b),this._prev=new c(e.length),this._cache=new c(""),this._secCache=new c(""),this._decrypt=h,this._alen=0,this._len=0,e.copy(this._prev),this._mode=a;var j=new c(4);j.fill(0),this._ghash=new i(this._cipher.encryptBlock(j)),this._authTag=null,this._called=!1}function e(a,b){var c=0;a.length!==b.length&&c++;for(var d=Math.min(a.length,b.length),e=-1;++e<d;)c+=a[e]^b[e];return c}var f=a("./aes"),g=a("cipher-base"),h=a("inherits"),i=a("./ghash"),j=a("buffer-xor");h(d,g),b.exports=d,d.prototype._update=function(a){if(!this._called&&this._alen){var b=16-this._alen%16;b<16&&(b=new c(b),b.fill(0),this._ghash.update(b))}this._called=!0;var d=this._mode.encrypt(this,a);return this._decrypt?this._ghash.update(a):this._ghash.update(d),this._len+=a.length,d},d.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var a=j(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt){if(e(a,this._authTag))throw new Error("Unsupported state or unable to authenticate data")}else this._authTag=a;this._cipher.scrub()},d.prototype.getAuthTag=function(){if(!this._decrypt&&c.isBuffer(this._authTag))return this._authTag;throw new Error("Attempting to get auth tag in unsupported state")},d.prototype.setAuthTag=function(a){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=a},d.prototype.setAAD=function(a){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(a),this._alen+=a.length}}).call(this,a("buffer").Buffer)},{"./aes":134,"./ghash":139,buffer:128,"buffer-xor":148,"cipher-base":149,inherits:326}],136:[function(a,b,c){function d(){return Object.keys(g)}var e=a("./encrypter");c.createCipher=c.Cipher=e.createCipher,c.createCipheriv=c.Cipheriv=e.createCipheriv;var f=a("./decrypter");c.createDecipher=c.Decipher=f.createDecipher,c.createDecipheriv=c.Decipheriv=f.createDecipheriv;var g=a("./modes");c.listCiphers=c.getCiphers=d},{"./decrypter":137,"./encrypter":138,"./modes":140}],137:[function(a,b,c){(function(b){function d(a,c,f){return this instanceof d?(j.call(this),this._cache=new e,this._last=void 0,this._cipher=new i.AES(c),this._prev=new b(f.length),f.copy(this._prev),this._mode=a,void(this._autopadding=!0)):new d(a,c,f)}function e(){return this instanceof e?void(this.cache=new b("")):new e}function f(a){for(var b=a[15],c=-1;++c<b;)if(a[c+(16-b)]!==b)throw new Error("unable to decrypt data");if(16!==b)return a.slice(0,16-b)}function g(a,c,e){var f=l[a.toLowerCase()];if(!f)throw new TypeError("invalid suite type");if("string"==typeof e&&(e=new b(e)),"string"==typeof c&&(c=new b(c)),c.length!==f.key/8)throw new TypeError("invalid key length "+c.length);if(e.length!==f.iv)throw new TypeError("invalid iv length "+e.length);return"stream"===f.type?new m(p[f.mode],c,e,!0):"auth"===f.type?new n(p[f.mode],c,e,!0):new d(p[f.mode],c,e)}function h(a,b){var c=l[a.toLowerCase()];if(!c)throw new TypeError("invalid suite type");var d=o(b,!1,c.key,c.iv);return g(a,d.key,d.iv)}var i=a("./aes"),j=a("cipher-base"),k=a("inherits"),l=a("./modes"),m=a("./streamCipher"),n=a("./authCipher"),o=a("evp_bytestokey");k(d,j),d.prototype._update=function(a){this._cache.add(a);for(var c,d,e=[];c=this._cache.get(this._autopadding);)d=this._mode.decrypt(this,c),e.push(d);return b.concat(e)},d.prototype._final=function(){var a=this._cache.flush();if(this._autopadding)return f(this._mode.decrypt(this,a));if(a)throw new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(a){return this._autopadding=!!a,this},e.prototype.add=function(a){this.cache=b.concat([this.cache,a])},e.prototype.get=function(a){var b;if(a){if(this.cache.length>16)return b=this.cache.slice(0,16),this.cache=this.cache.slice(16),b}else if(this.cache.length>=16)return b=this.cache.slice(0,16),this.cache=this.cache.slice(16),b;return null},e.prototype.flush=function(){if(this.cache.length)return this.cache};var p={ECB:a("./modes/ecb"),CBC:a("./modes/cbc"),CFB:a("./modes/cfb"),CFB8:a("./modes/cfb8"),CFB1:a("./modes/cfb1"),OFB:a("./modes/ofb"),CTR:a("./modes/ctr"),GCM:a("./modes/ctr")};c.createDecipher=h,c.createDecipheriv=g}).call(this,a("buffer").Buffer)},{"./aes":134,"./authCipher":135,"./modes":140,"./modes/cbc":141,"./modes/cfb":142,"./modes/cfb1":143,"./modes/cfb8":144,"./modes/ctr":145,"./modes/ecb":146,"./modes/ofb":147,"./streamCipher":150,buffer:128,"cipher-base":149,evp_bytestokey:161,inherits:326}],138:[function(a,b,c){(function(b){function d(a,c,f){return this instanceof d?(i.call(this),this._cache=new e,this._cipher=new h.AES(c),this._prev=new b(f.length),f.copy(this._prev),this._mode=a,void(this._autopadding=!0)):new d(a,c,f)}function e(){return this instanceof e?void(this.cache=new b("")):new e}function f(a,c,e){var f=k[a.toLowerCase()];if(!f)throw new TypeError("invalid suite type");if("string"==typeof e&&(e=new b(e)),"string"==typeof c&&(c=new b(c)),c.length!==f.key/8)throw new TypeError("invalid key length "+c.length);if(e.length!==f.iv)throw new TypeError("invalid iv length "+e.length);return"stream"===f.type?new m(o[f.mode],c,e):"auth"===f.type?new n(o[f.mode],c,e):new d(o[f.mode],c,e)}function g(a,b){var c=k[a.toLowerCase()];if(!c)throw new TypeError("invalid suite type");var d=l(b,!1,c.key,c.iv);return f(a,d.key,d.iv)}var h=a("./aes"),i=a("cipher-base"),j=a("inherits"),k=a("./modes"),l=a("evp_bytestokey"),m=a("./streamCipher"),n=a("./authCipher");j(d,i),d.prototype._update=function(a){this._cache.add(a);for(var c,d,e=[];c=this._cache.get();)d=this._mode.encrypt(this,c),e.push(d);return b.concat(e)},d.prototype._final=function(){var a=this._cache.flush();if(this._autopadding)return a=this._mode.encrypt(this,a),this._cipher.scrub(),a;if("10101010101010101010101010101010"!==a.toString("hex"))throw this._cipher.scrub(),new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(a){return this._autopadding=!!a,this},e.prototype.add=function(a){this.cache=b.concat([this.cache,a])},e.prototype.get=function(){if(this.cache.length>15){var a=this.cache.slice(0,16);return this.cache=this.cache.slice(16),a}return null},e.prototype.flush=function(){for(var a=16-this.cache.length,c=new b(a),d=-1;++d<a;)c.writeUInt8(a,d);var e=b.concat([this.cache,c]);return e};var o={ECB:a("./modes/ecb"),CBC:a("./modes/cbc"),CFB:a("./modes/cfb"),CFB8:a("./modes/cfb8"),CFB1:a("./modes/cfb1"),OFB:a("./modes/ofb"),CTR:a("./modes/ctr"),GCM:a("./modes/ctr")};c.createCipheriv=f,c.createCipher=g}).call(this,a("buffer").Buffer)},{"./aes":134,"./authCipher":135,"./modes":140,"./modes/cbc":141,"./modes/cfb":142,"./modes/cfb1":143,"./modes/cfb8":144,"./modes/ctr":145,"./modes/ecb":146,"./modes/ofb":147,"./streamCipher":150,buffer:128,"cipher-base":149,evp_bytestokey:161,inherits:326}],139:[function(a,b,c){(function(a){function c(b){this.h=b,this.state=new a(16),this.state.fill(0),this.cache=new a("")}function d(a){return[a.readUInt32BE(0),a.readUInt32BE(4),a.readUInt32BE(8),a.readUInt32BE(12)]}function e(b){b=b.map(f);var c=new a(16);return c.writeUInt32BE(b[0],0),c.writeUInt32BE(b[1],4),c.writeUInt32BE(b[2],8),c.writeUInt32BE(b[3],12),c}function f(a){var b,c;return b=a>i||a<0?(c=Math.abs(a)%i,a<0?i-c:c):a}function g(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}var h=new a(16);h.fill(0),b.exports=c,c.prototype.ghash=function(a){for(var b=-1;++b<a.length;)this.state[b]^=a[b];this._multiply()},c.prototype._multiply=function(){for(var a,b,c,f=d(this.h),h=[0,0,0,0],i=-1;++i<128;){for(b=0!==(this.state[~~(i/8)]&1<<7-i%8),b&&(h=g(h,f)),c=0!==(1&f[3]),a=3;a>0;a--)f[a]=f[a]>>>1|(1&f[a-1])<<31;f[0]=f[0]>>>1,c&&(f[0]=f[0]^225<<24)}this.state=e(h)},c.prototype.update=function(b){this.cache=a.concat([this.cache,b]);for(var c;this.cache.length>=16;)c=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(c)},c.prototype.final=function(b,c){return this.cache.length&&this.ghash(a.concat([this.cache,h],16)),this.ghash(e([0,b,0,c])),this.state};var i=Math.pow(2,32)}).call(this,a("buffer").Buffer)},{buffer:128}],140:[function(a,b,c){c["aes-128-ecb"]={cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},c["aes-192-ecb"]={cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},c["aes-256-ecb"]={cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},c["aes-128-cbc"]={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},c["aes-192-cbc"]={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},c["aes-256-cbc"]={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},c.aes128=c["aes-128-cbc"],c.aes192=c["aes-192-cbc"],c.aes256=c["aes-256-cbc"],c["aes-128-cfb"]={cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},c["aes-192-cfb"]={cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},c["aes-256-cfb"]={cipher:"AES",key:256,
iv:16,mode:"CFB",type:"stream"},c["aes-128-cfb8"]={cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},c["aes-192-cfb8"]={cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},c["aes-256-cfb8"]={cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},c["aes-128-cfb1"]={cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},c["aes-192-cfb1"]={cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},c["aes-256-cfb1"]={cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},c["aes-128-ofb"]={cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},c["aes-192-ofb"]={cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},c["aes-256-ofb"]={cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},c["aes-128-ctr"]={cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},c["aes-192-ctr"]={cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},c["aes-256-ctr"]={cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},c["aes-128-gcm"]={cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},c["aes-192-gcm"]={cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},c["aes-256-gcm"]={cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}},{}],141:[function(a,b,c){var d=a("buffer-xor");c.encrypt=function(a,b){var c=d(b,a._prev);return a._prev=a._cipher.encryptBlock(c),a._prev},c.decrypt=function(a,b){var c=a._prev;a._prev=b;var e=a._cipher.decryptBlock(b);return d(e,c)}},{"buffer-xor":148}],142:[function(a,b,c){(function(b){function d(a,c,d){var f=c.length,g=e(c,a._cache);return a._cache=a._cache.slice(f),a._prev=b.concat([a._prev,d?c:g]),g}var e=a("buffer-xor");c.encrypt=function(a,c,e){for(var f,g=new b("");c.length;){if(0===a._cache.length&&(a._cache=a._cipher.encryptBlock(a._prev),a._prev=new b("")),!(a._cache.length<=c.length)){g=b.concat([g,d(a,c,e)]);break}f=a._cache.length,g=b.concat([g,d(a,c.slice(0,f),e)]),c=c.slice(f)}return g}}).call(this,a("buffer").Buffer)},{buffer:128,"buffer-xor":148}],143:[function(a,b,c){(function(a){function b(a,b,c){for(var e,f,g,h=-1,i=8,j=0;++h<i;)e=a._cipher.encryptBlock(a._prev),f=b&1<<7-h?128:0,g=e[0]^f,j+=(128&g)>>h%8,a._prev=d(a._prev,c?f:g);return j}function d(b,c){var d=b.length,e=-1,f=new a(b.length);for(b=a.concat([b,new a([c])]);++e<d;)f[e]=b[e]<<1|b[e+1]>>7;return f}c.encrypt=function(c,d,e){for(var f=d.length,g=new a(f),h=-1;++h<f;)g[h]=b(c,d[h],e);return g}}).call(this,a("buffer").Buffer)},{buffer:128}],144:[function(a,b,c){(function(a){function b(b,c,d){var e=b._cipher.encryptBlock(b._prev),f=e[0]^c;return b._prev=a.concat([b._prev.slice(1),new a([d?c:f])]),f}c.encrypt=function(c,d,e){for(var f=d.length,g=new a(f),h=-1;++h<f;)g[h]=b(c,d[h],e);return g}}).call(this,a("buffer").Buffer)},{buffer:128}],145:[function(a,b,c){(function(b){function d(a){for(var b,c=a.length;c--;){if(b=a.readUInt8(c),255!==b){b++,a.writeUInt8(b,c);break}a.writeUInt8(0,c)}}function e(a){var b=a._cipher.encryptBlock(a._prev);return d(a._prev),b}var f=a("buffer-xor");c.encrypt=function(a,c){for(;a._cache.length<c.length;)a._cache=b.concat([a._cache,e(a)]);var d=a._cache.slice(0,c.length);return a._cache=a._cache.slice(c.length),f(c,d)}}).call(this,a("buffer").Buffer)},{buffer:128,"buffer-xor":148}],146:[function(a,b,c){c.encrypt=function(a,b){return a._cipher.encryptBlock(b)},c.decrypt=function(a,b){return a._cipher.decryptBlock(b)}},{}],147:[function(a,b,c){(function(b){function d(a){return a._prev=a._cipher.encryptBlock(a._prev),a._prev}var e=a("buffer-xor");c.encrypt=function(a,c){for(;a._cache.length<c.length;)a._cache=b.concat([a._cache,d(a)]);var f=a._cache.slice(0,c.length);return a._cache=a._cache.slice(c.length),e(c,f)}}).call(this,a("buffer").Buffer)},{buffer:128,"buffer-xor":148}],148:[function(a,b,c){(function(a){b.exports=function(b,c){for(var d=Math.min(b.length,c.length),e=new a(d),f=0;f<d;++f)e[f]=b[f]^c[f];return e}}).call(this,a("buffer").Buffer)},{buffer:128}],149:[function(a,b,c){(function(c){function d(a){e.call(this),this.hashMode="string"==typeof a,this.hashMode?this[a]=this._finalOrDigest:this.final=this._finalOrDigest,this._decoder=null,this._encoding=null}var e=a("stream").Transform,f=a("inherits"),g=a("string_decoder").StringDecoder;b.exports=d,f(d,e),d.prototype.update=function(a,b,d){"string"==typeof a&&(a=new c(a,b));var e=this._update(a);return this.hashMode?this:(d&&(e=this._toString(e,d)),e)},d.prototype.setAutoPadding=function(){},d.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},d.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},d.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},d.prototype._transform=function(a,b,c){var d;try{this.hashMode?this._update(a):this.push(this._update(a))}catch(a){d=a}finally{c(d)}},d.prototype._flush=function(a){var b;try{this.push(this._final())}catch(a){b=a}finally{a(b)}},d.prototype._finalOrDigest=function(a){var b=this._final()||new c("");return a&&(b=this._toString(b,a,!0)),b},d.prototype._toString=function(a,b,c){if(this._decoder||(this._decoder=new g(b),this._encoding=b),this._encoding!==b)throw new Error("can't switch encodings");var d=this._decoder.write(a);return c&&(d+=this._decoder.end()),d}}).call(this,a("buffer").Buffer)},{buffer:128,inherits:326,stream:348,string_decoder:355}],150:[function(a,b,c){(function(c){function d(a,b,g,h){return this instanceof d?(f.call(this),this._cipher=new e.AES(b),this._prev=new c(g.length),this._cache=new c(""),this._secCache=new c(""),this._decrypt=h,g.copy(this._prev),void(this._mode=a)):new d(a,b,g)}var e=a("./aes"),f=a("cipher-base"),g=a("inherits");g(d,f),b.exports=d,d.prototype._update=function(a){return this._mode.encrypt(this,a,this._decrypt)},d.prototype._final=function(){this._cipher.scrub()}}).call(this,a("buffer").Buffer)},{"./aes":134,buffer:128,"cipher-base":149,inherits:326}],151:[function(a,b,c){(function(c){function d(a){e.call(this);var b,d=a.mode.toLowerCase(),f=h[d];b=a.decrypt?"decrypt":"encrypt";var g=a.key;"des-ede"!==d&&"des-ede-cbc"!==d||(g=c.concat([g,g.slice(0,8)]));var i=a.iv;this._des=f.create({key:g,iv:i,type:b})}var e=a("cipher-base"),f=a("des.js"),g=a("inherits"),h={"des-ede3-cbc":f.CBC.instantiate(f.EDE),"des-ede3":f.EDE,"des-ede-cbc":f.CBC.instantiate(f.EDE),"des-ede":f.EDE,"des-cbc":f.CBC.instantiate(f.DES),"des-ecb":f.DES};h.des=h["des-cbc"],h.des3=h["des-ede3-cbc"],b.exports=d,g(d,e),d.prototype._update=function(a){return new c(this._des.update(a))},d.prototype._final=function(){return new c(this._des.final())}}).call(this,a("buffer").Buffer)},{buffer:128,"cipher-base":153,"des.js":154,inherits:326}],152:[function(a,b,c){c["des-ecb"]={key:8,iv:0},c["des-cbc"]=c.des={key:8,iv:8},c["des-ede3-cbc"]=c.des3={key:24,iv:8},c["des-ede3"]={key:24,iv:0},c["des-ede-cbc"]={key:16,iv:8},c["des-ede"]={key:16,iv:0}},{}],153:[function(a,b,c){arguments[4][149][0].apply(c,arguments)},{buffer:128,dup:149,inherits:326,stream:348,string_decoder:355}],154:[function(a,b,c){"use strict";c.utils=a("./des/utils"),c.Cipher=a("./des/cipher"),c.DES=a("./des/des"),c.CBC=a("./des/cbc"),c.EDE=a("./des/ede")},{"./des/cbc":155,"./des/cipher":156,"./des/des":157,"./des/ede":158,"./des/utils":159}],155:[function(a,b,c){"use strict";function d(a){f.equal(a.length,8,"Invalid IV length"),this.iv=new Array(8);for(var b=0;b<this.iv.length;b++)this.iv[b]=a[b]}function e(a){function b(b){a.call(this,b),this._cbcInit()}g(b,a);for(var c=Object.keys(h),d=0;d<c.length;d++){var e=c[d];b.prototype[e]=h[e]}return b.create=function(a){return new b(a)},b}var f=a("minimalistic-assert"),g=a("inherits"),h={};c.instantiate=e,h._cbcInit=function(){var a=new d(this.options.iv);this._cbcState=a},h._update=function(a,b,c,d){var e=this._cbcState,f=this.constructor.super_.prototype,g=e.iv;if("encrypt"===this.type){for(var h=0;h<this.blockSize;h++)g[h]^=a[b+h];f._update.call(this,g,0,c,d);for(var h=0;h<this.blockSize;h++)g[h]=c[d+h]}else{f._update.call(this,a,b,c,d);for(var h=0;h<this.blockSize;h++)c[d+h]^=g[h];for(var h=0;h<this.blockSize;h++)g[h]=a[b+h]}}},{inherits:326,"minimalistic-assert":160}],156:[function(a,b,c){"use strict";function d(a){this.options=a,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}var e=a("minimalistic-assert");b.exports=d,d.prototype._init=function(){},d.prototype.update=function(a){return 0===a.length?[]:"decrypt"===this.type?this._updateDecrypt(a):this._updateEncrypt(a)},d.prototype._buffer=function(a,b){for(var c=Math.min(this.buffer.length-this.bufferOff,a.length-b),d=0;d<c;d++)this.buffer[this.bufferOff+d]=a[b+d];return this.bufferOff+=c,c},d.prototype._flushBuffer=function(a,b){return this._update(this.buffer,0,a,b),this.bufferOff=0,this.blockSize},d.prototype._updateEncrypt=function(a){var b=0,c=0,d=(this.bufferOff+a.length)/this.blockSize|0,e=new Array(d*this.blockSize);0!==this.bufferOff&&(b+=this._buffer(a,b),this.bufferOff===this.buffer.length&&(c+=this._flushBuffer(e,c)));for(var f=a.length-(a.length-b)%this.blockSize;b<f;b+=this.blockSize)this._update(a,b,e,c),c+=this.blockSize;for(;b<a.length;b++,this.bufferOff++)this.buffer[this.bufferOff]=a[b];return e},d.prototype._updateDecrypt=function(a){for(var b=0,c=0,d=Math.ceil((this.bufferOff+a.length)/this.blockSize)-1,e=new Array(d*this.blockSize);d>0;d--)b+=this._buffer(a,b),c+=this._flushBuffer(e,c);return b+=this._buffer(a,b),e},d.prototype.final=function(a){var b;a&&(b=this.update(a));var c;return c="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),b?b.concat(c):c},d.prototype._pad=function(a,b){if(0===b)return!1;for(;b<a.length;)a[b++]=0;return!0},d.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var a=new Array(this.blockSize);return this._update(this.buffer,0,a,0),a},d.prototype._unpad=function(a){return a},d.prototype._finalDecrypt=function(){e.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var a=new Array(this.blockSize);return this._flushBuffer(a,0),this._unpad(a)}},{"minimalistic-assert":160}],157:[function(a,b,c){"use strict";function d(){this.tmp=new Array(2),this.keys=null}function e(a){j.call(this,a);var b=new d;this._desState=b,this.deriveKeys(b,a.key)}var f=a("minimalistic-assert"),g=a("inherits"),h=a("../des"),i=h.utils,j=h.Cipher;g(e,j),b.exports=e,e.create=function(a){return new e(a)};var k=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];e.prototype.deriveKeys=function(a,b){a.keys=new Array(32),f.equal(b.length,this.blockSize,"Invalid key length");var c=i.readUInt32BE(b,0),d=i.readUInt32BE(b,4);i.pc1(c,d,a.tmp,0),c=a.tmp[0],d=a.tmp[1];for(var e=0;e<a.keys.length;e+=2){var g=k[e>>>1];c=i.r28shl(c,g),d=i.r28shl(d,g),i.pc2(c,d,a.keys,e)}},e.prototype._update=function(a,b,c,d){var e=this._desState,f=i.readUInt32BE(a,b),g=i.readUInt32BE(a,b+4);i.ip(f,g,e.tmp,0),f=e.tmp[0],g=e.tmp[1],"encrypt"===this.type?this._encrypt(e,f,g,e.tmp,0):this._decrypt(e,f,g,e.tmp,0),f=e.tmp[0],g=e.tmp[1],i.writeUInt32BE(c,f,d),i.writeUInt32BE(c,g,d+4)},e.prototype._pad=function(a,b){for(var c=a.length-b,d=b;d<a.length;d++)a[d]=c;return!0},e.prototype._unpad=function(a){for(var b=a[a.length-1],c=a.length-b;c<a.length;c++)f.equal(a[c],b);return a.slice(0,a.length-b)},e.prototype._encrypt=function(a,b,c,d,e){for(var f=b,g=c,h=0;h<a.keys.length;h+=2){var j=a.keys[h],k=a.keys[h+1];i.expand(g,a.tmp,0),j^=a.tmp[0],k^=a.tmp[1];var l=i.substitute(j,k),m=i.permute(l),n=g;g=(f^m)>>>0,f=n}i.rip(g,f,d,e)},e.prototype._decrypt=function(a,b,c,d,e){for(var f=c,g=b,h=a.keys.length-2;h>=0;h-=2){var j=a.keys[h],k=a.keys[h+1];i.expand(f,a.tmp,0),j^=a.tmp[0],k^=a.tmp[1];var l=i.substitute(j,k),m=i.permute(l),n=f;f=(g^m)>>>0,g=n}i.rip(f,g,d,e)}},{"../des":154,inherits:326,"minimalistic-assert":160}],158:[function(a,b,c){"use strict";function d(a,b){f.equal(b.length,24,"Invalid key length");var c=b.slice(0,8),d=b.slice(8,16),e=b.slice(16,24);"encrypt"===a?this.ciphers=[j.create({type:"encrypt",key:c}),j.create({type:"decrypt",key:d}),j.create({type:"encrypt",key:e})]:this.ciphers=[j.create({type:"decrypt",key:e}),j.create({type:"encrypt",key:d}),j.create({type:"decrypt",key:c})]}function e(a){i.call(this,a);var b=new d(this.type,this.options.key);this._edeState=b}var f=a("minimalistic-assert"),g=a("inherits"),h=a("../des"),i=h.Cipher,j=h.DES;g(e,i),b.exports=e,e.create=function(a){return new e(a)},e.prototype._update=function(a,b,c,d){var e=this._edeState;e.ciphers[0]._update(a,b,c,d),e.ciphers[1]._update(c,d,c,d),e.ciphers[2]._update(c,d,c,d)},e.prototype._pad=j.prototype._pad,e.prototype._unpad=j.prototype._unpad},{"../des":154,inherits:326,"minimalistic-assert":160}],159:[function(a,b,c){"use strict";c.readUInt32BE=function(a,b){var c=a[0+b]<<24|a[1+b]<<16|a[2+b]<<8|a[3+b];return c>>>0},c.writeUInt32BE=function(a,b,c){a[0+c]=b>>>24,a[1+c]=b>>>16&255,a[2+c]=b>>>8&255,a[3+c]=255&b},c.ip=function(a,b,c,d){for(var e=0,f=0,g=6;g>=0;g-=2){for(var h=0;h<=24;h+=8)e<<=1,e|=b>>>h+g&1;for(var h=0;h<=24;h+=8)e<<=1,e|=a>>>h+g&1}for(var g=6;g>=0;g-=2){for(var h=1;h<=25;h+=8)f<<=1,f|=b>>>h+g&1;for(var h=1;h<=25;h+=8)f<<=1,f|=a>>>h+g&1}c[d+0]=e>>>0,c[d+1]=f>>>0},c.rip=function(a,b,c,d){for(var e=0,f=0,g=0;g<4;g++)for(var h=24;h>=0;h-=8)e<<=1,e|=b>>>h+g&1,e<<=1,e|=a>>>h+g&1;for(var g=4;g<8;g++)for(var h=24;h>=0;h-=8)f<<=1,f|=b>>>h+g&1,f<<=1,f|=a>>>h+g&1;c[d+0]=e>>>0,c[d+1]=f>>>0},c.pc1=function(a,b,c,d){for(var e=0,f=0,g=7;g>=5;g--){for(var h=0;h<=24;h+=8)e<<=1,e|=b>>h+g&1;for(var h=0;h<=24;h+=8)e<<=1,e|=a>>h+g&1}for(var h=0;h<=24;h+=8)e<<=1,e|=b>>h+g&1;for(var g=1;g<=3;g++){for(var h=0;h<=24;h+=8)f<<=1,f|=b>>h+g&1;for(var h=0;h<=24;h+=8)f<<=1,f|=a>>h+g&1}for(var h=0;h<=24;h+=8)f<<=1,f|=a>>h+g&1;c[d+0]=e>>>0,c[d+1]=f>>>0},c.r28shl=function(a,b){return a<<b&268435455|a>>>28-b};var d=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];c.pc2=function(a,b,c,e){for(var f=0,g=0,h=d.length>>>1,i=0;i<h;i++)f<<=1,f|=a>>>d[i]&1;for(var i=h;i<d.length;i++)g<<=1,g|=b>>>d[i]&1;c[e+0]=f>>>0,c[e+1]=g>>>0},c.expand=function(a,b,c){var d=0,e=0;d=(1&a)<<5|a>>>27;for(var f=23;f>=15;f-=4)d<<=6,d|=a>>>f&63;for(var f=11;f>=3;f-=4)e|=a>>>f&63,e<<=6;e|=(31&a)<<1|a>>>31,b[c+0]=d>>>0,b[c+1]=e>>>0};var e=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];c.substitute=function(a,b){for(var c=0,d=0;d<4;d++){var f=a>>>18-6*d&63,g=e[64*d+f];c<<=4,c|=g}for(var d=0;d<4;d++){var f=b>>>18-6*d&63,g=e[256+64*d+f];c<<=4,c|=g}return c>>>0};var f=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];c.permute=function(a){for(var b=0,c=0;c<f.length;c++)b<<=1,b|=a>>>f[c]&1;return b>>>0},c.padSplit=function(a,b,c){for(var d=a.toString(2);d.length<b;)d="0"+d;for(var e=[],f=0;f<b;f+=c)e.push(d.slice(f,f+c));return e.join(" ")}},{}],160:[function(a,b,c){function d(a,b){if(!a)throw new Error(b||"Assertion failed")}b.exports=d,d.equal=function(a,b,c){if(a!=b)throw new Error(c||"Assertion failed: "+a+" != "+b)}},{}],161:[function(a,b,c){(function(c){function d(a,b,d,f){c.isBuffer(a)||(a=new c(a,"binary")),b&&!c.isBuffer(b)&&(b=new c(b,"binary")),d/=8,f=f||0;for(var g,h,i=0,j=0,k=new c(d),l=new c(f),m=0,n=[];;){if(m++>0&&n.push(g),n.push(a),b&&n.push(b),g=e(c.concat(n)),n=[],h=0,d>0)for(;;){if(0===d)break;if(h===g.length)break;k[i++]=g[h],d--,h++}if(f>0&&h!==g.length)for(;;){if(0===f)break;if(h===g.length)break;l[j++]=g[h],f--,h++}if(0===d&&0===f)break}for(h=0;h<g.length;h++)g[h]=0;return{key:k,iv:l}}var e=a("create-hash/md5");b.exports=d}).call(this,a("buffer").Buffer)},{buffer:128,"create-hash/md5":258}],162:[function(a,b,c){(function(a){"use strict";c["RSA-SHA224"]=c.sha224WithRSAEncryption={sign:"rsa",hash:"sha224",id:new a("302d300d06096086480165030402040500041c","hex")},c["RSA-SHA256"]=c.sha256WithRSAEncryption={sign:"rsa",hash:"sha256",id:new a("3031300d060960864801650304020105000420","hex")},c["RSA-SHA384"]=c.sha384WithRSAEncryption={sign:"rsa",hash:"sha384",id:new a("3041300d060960864801650304020205000430","hex")},c["RSA-SHA512"]=c.sha512WithRSAEncryption={sign:"rsa",hash:"sha512",id:new a("3051300d060960864801650304020305000440","hex")},c["RSA-SHA1"]={sign:"rsa",hash:"sha1",id:new a("3021300906052b0e03021a05000414","hex")},c["ecdsa-with-SHA1"]={sign:"ecdsa",hash:"sha1",id:new a("","hex")},c.DSA=c["DSA-SHA1"]=c["DSA-SHA"]={sign:"dsa",hash:"sha1",id:new a("","hex")},c["DSA-SHA224"]=c["DSA-WITH-SHA224"]={sign:"dsa",hash:"sha224",id:new a("","hex")},c["DSA-SHA256"]=c["DSA-WITH-SHA256"]={sign:"dsa",hash:"sha256",id:new a("","hex")},c["DSA-SHA384"]=c["DSA-WITH-SHA384"]={sign:"dsa",hash:"sha384",id:new a("","hex")},c["DSA-SHA512"]=c["DSA-WITH-SHA512"]={sign:"dsa",hash:"sha512",id:new a("","hex")},c["DSA-RIPEMD160"]={sign:"dsa",hash:"rmd160",id:new a("","hex")},c["RSA-RIPEMD160"]=c.ripemd160WithRSA={sign:"rsa",hash:"rmd160",id:new a("3021300906052b2403020105000414","hex")},c["RSA-MD5"]=c.md5WithRSAEncryption={sign:"rsa",hash:"md5",id:new a("3020300c06082a864886f70d020505000410","hex")}}).call(this,a("buffer").Buffer)},{buffer:128}],163:[function(a,b,c){(function(c){function d(a){l.Writable.call(this);var b=n[a];if(!b)throw new Error("Unknown message digest");this._hashType=b.hash,this._hash=i(b.hash),this._tag=b.id,this._signType=b.sign}function e(a){l.Writable.call(this);var b=n[a];if(!b)throw new Error("Unknown message digest");this._hash=i(b.hash),this._tag=b.id,this._signType=b.sign}function f(a){return new d(a)}function g(a){return new e(a)}var h=a("./algos"),i=a("create-hash"),j=a("inherits"),k=a("./sign"),l=a("stream"),m=a("./verify"),n={};Object.keys(h).forEach(function(a){n[a]=n[a.toLowerCase()]=h[a]}),j(d,l.Writable),d.prototype._write=function(a,b,c){this._hash.update(a),c()},d.prototype.update=function(a,b){return"string"==typeof a&&(a=new c(a,b)),this._hash.update(a),this},d.prototype.sign=function(a,b){this.end();var d=this._hash.digest(),e=k(c.concat([this._tag,d]),a,this._hashType,this._signType);return b?e.toString(b):e},j(e,l.Writable),e.prototype._write=function(a,b,c){this._hash.update(a),c()},e.prototype.update=function(a,b){return"string"==typeof a&&(a=new c(a,b)),this._hash.update(a),this},e.prototype.verify=function(a,b,d){"string"==typeof b&&(b=new c(b,d)),this.end();var e=this._hash.digest();return m(b,c.concat([this._tag,e]),a,this._signType)},b.exports={Sign:f,Verify:g,createSign:f,createVerify:g}}).call(this,a("buffer").Buffer)},{"./algos":162,"./sign":228,"./verify":229,buffer:128,"create-hash":256,inherits:326,stream:348}],164:[function(a,b,c){"use strict";c["1.3.132.0.10"]="secp256k1",c["1.3.132.0.33"]="p224",c["1.2.840.10045.3.1.1"]="p192",c["1.2.840.10045.3.1.7"]="p256",c["1.3.132.0.34"]="p384",c["1.3.132.0.35"]="p521"},{}],165:[function(a,b,c){!function(b,c){"use strict";function d(a,b){if(!a)throw new Error(b||"Assertion failed")}function e(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}function f(a,b,c){return f.isBN(a)?a:(this.negative=0,this.words=null,this.length=0,this.red=null,void(null!==a&&("le"!==b&&"be"!==b||(c=b,b=10),this._init(a||0,b||10,c||"be"))))}function g(a,b,c){for(var d=0,e=Math.min(a.length,c),f=b;f<e;f++){var g=a.charCodeAt(f)-48;d<<=4,d|=g>=49&&g<=54?g-49+10:g>=17&&g<=22?g-17+10:15&g}return d}function h(a,b,c,d){for(var e=0,f=Math.min(a.length,c),g=b;g<f;g++){var h=a.charCodeAt(g)-48;e*=d,e+=h>=49?h-49+10:h>=17?h-17+10:h}return e}function i(a){for(var b=new Array(a.bitLength()),c=0;c<b.length;c++){var d=c/26|0,e=c%26;b[c]=(a.words[d]&1<<e)>>>e}return b}function j(a,b,c){c.negative=b.negative^a.negative;var d=a.length+b.length|0;c.length=d,d=d-1|0;var e=0|a.words[0],f=0|b.words[0],g=e*f,h=67108863&g,i=g/67108864|0;c.words[0]=h;for(var j=1;j<d;j++){for(var k=i>>>26,l=67108863&i,m=Math.min(j,b.length-1),n=Math.max(0,j-a.length+1);n<=m;n++){var o=j-n|0;e=0|a.words[o],f=0|b.words[n],g=e*f+l,k+=g/67108864|0,l=67108863&g}c.words[j]=0|l,i=0|k}return 0!==i?c.words[j]=0|i:c.length--,c.strip()}function k(a,b,c){c.negative=b.negative^a.negative,c.length=a.length+b.length;for(var d=0,e=0,f=0;f<c.length-1;f++){var g=e;e=0;for(var h=67108863&d,i=Math.min(f,b.length-1),j=Math.max(0,f-a.length+1);j<=i;j++){var k=f-j,l=0|a.words[k],m=0|b.words[j],n=l*m,o=67108863&n;g=g+(n/67108864|0)|0,o=o+h|0,h=67108863&o,g=g+(o>>>26)|0,e+=g>>>26,g&=67108863}c.words[f]=h,d=g,g=e}return 0!==d?c.words[f]=d:c.length--,c.strip()}function l(a,b,c){var d=new m;return d.mulp(a,b,c)}function m(a,b){this.x=a,this.y=b}function n(a,b){this.name=a,this.p=new f(b,16),this.n=this.p.bitLength(),this.k=new f(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function o(){n.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function p(){n.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function q(){n.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function r(){n.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function s(a){if("string"==typeof a){var b=f._prime(a);this.m=b.p,this.prime=b}else d(a.gtn(1),"modulus must be greater than 1"),this.m=a,this.prime=null}function t(a){s.call(this,a),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new f(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof b?b.exports=f:c.BN=f,f.BN=f,f.wordSize=26;var u;try{u=a("buffer").Buffer}catch(a){}f.isBN=function(a){return null!==a&&"object"==typeof a&&"BN"===a.constructor.name&&Array.isArray(a.words)},f.max=function(a,b){return a.cmp(b)>0?a:b},f.min=function(a,b){return a.cmp(b)<0?a:b},f.prototype._init=function(a,b,c){if("number"==typeof a)return this._initNumber(a,b,c);if("object"==typeof a)return this._initArray(a,b,c);"hex"===b&&(b=16),d(b===(0|b)&&b>=2&&b<=36),a=a.toString().replace(/\s+/g,"");var e=0;"-"===a[0]&&e++,16===b?this._parseHex(a,e):this._parseBase(a,b,e),"-"===a[0]&&(this.negative=1),this.strip(),"le"===c&&this._initArray(this.toArray(),b,c)},f.prototype._initNumber=function(a,b,c){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[67108863&a],this.length=1):a<4503599627370496?(this.words=[67108863&a,a/67108864&67108863],this.length=2):(d(a<9007199254740992),this.words=[67108863&a,a/67108864&67108863,1],this.length=3),"le"===c&&this._initArray(this.toArray(),b,c)},f.prototype._initArray=function(a,b,c){if(d("number"==typeof a.length),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var e=0;e<this.length;e++)this.words[e]=0;var f,g,h=0;if("be"===c)for(e=a.length-1,f=0;e>=0;e-=3)g=a[e]|a[e-1]<<8|a[e-2]<<16,this.words[f]|=g<<h&67108863,this.words[f+1]=g>>>26-h&67108863,h+=24,h>=26&&(h-=26,f++);else if("le"===c)for(e=0,f=0;e<a.length;e+=3)g=a[e]|a[e+1]<<8|a[e+2]<<16,this.words[f]|=g<<h&67108863,this.words[f+1]=g>>>26-h&67108863,h+=24,h>=26&&(h-=26,f++);return this.strip()},f.prototype._parseHex=function(a,b){this.length=Math.ceil((a.length-b)/6),this.words=new Array(this.length);for(var c=0;c<this.length;c++)this.words[c]=0;var d,e,f=0;for(c=a.length-6,d=0;c>=b;c-=6)e=g(a,c,c+6),this.words[d]|=e<<f&67108863,this.words[d+1]|=e>>>26-f&4194303,f+=24,f>=26&&(f-=26,d++);c+6!==b&&(e=g(a,b,c+6),this.words[d]|=e<<f&67108863,this.words[d+1]|=e>>>26-f&4194303),this.strip()},f.prototype._parseBase=function(a,b,c){this.words=[0],this.length=1;for(var d=0,e=1;e<=67108863;e*=b)d++;d--,e=e/b|0;for(var f=a.length-c,g=f%d,i=Math.min(f,f-g)+c,j=0,k=c;k<i;k+=d)j=h(a,k,k+d,b),this.imuln(e),this.words[0]+j<67108864?this.words[0]+=j:this._iaddn(j);if(0!==g){var l=1;for(j=h(a,k,a.length,b),k=0;k<g;k++)l*=b;this.imuln(l),this.words[0]+j<67108864?this.words[0]+=j:this._iaddn(j)}},f.prototype.copy=function(a){a.words=new Array(this.length);for(var b=0;b<this.length;b++)a.words[b]=this.words[b];a.length=this.length,a.negative=this.negative,a.red=this.red},f.prototype.clone=function(){var a=new f(null);return this.copy(a),a},f.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},f.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},f.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},f.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var v=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],w=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],x=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];f.prototype.toString=function(a,b){a=a||10,b=0|b||1;var c;if(16===a||"hex"===a){c="";for(var e=0,f=0,g=0;g<this.length;g++){var h=this.words[g],i=(16777215&(h<<e|f)).toString(16);f=h>>>24-e&16777215,c=0!==f||g!==this.length-1?v[6-i.length]+i+c:i+c,e+=2,e>=26&&(e-=26,g--)}for(0!==f&&(c=f.toString(16)+c);c.length%b!==0;)c="0"+c;return 0!==this.negative&&(c="-"+c),c}if(a===(0|a)&&a>=2&&a<=36){var j=w[a],k=x[a];c="";var l=this.clone();for(l.negative=0;!l.isZero();){var m=l.modn(k).toString(a);l=l.idivn(k),c=l.isZero()?m+c:v[j-m.length]+m+c}for(this.isZero()&&(c="0"+c);c.length%b!==0;)c="0"+c;return 0!==this.negative&&(c="-"+c),c}d(!1,"Base should be between 2 and 36")},f.prototype.toNumber=function(){var a=this.words[0];return 2===this.length?a+=67108864*this.words[1]:3===this.length&&1===this.words[2]?a+=4503599627370496+67108864*this.words[1]:this.length>2&&d(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-a:a},f.prototype.toJSON=function(){return this.toString(16)},f.prototype.toBuffer=function(a,b){return d("undefined"!=typeof u),this.toArrayLike(u,a,b)},f.prototype.toArray=function(a,b){return this.toArrayLike(Array,a,b)},f.prototype.toArrayLike=function(a,b,c){var e=this.byteLength(),f=c||Math.max(1,e);d(e<=f,"byte array longer than desired length"),d(f>0,"Requested array length <= 0"),this.strip();var g,h,i="le"===b,j=new a(f),k=this.clone();if(i){for(h=0;!k.isZero();h++)g=k.andln(255),k.iushrn(8),j[h]=g;for(;h<f;h++)j[h]=0}else{for(h=0;h<f-e;h++)j[h]=0;for(h=0;!k.isZero();h++)g=k.andln(255),k.iushrn(8),j[f-h-1]=g}return j},Math.clz32?f.prototype._countBits=function(a){return 32-Math.clz32(a)}:f.prototype._countBits=function(a){var b=a,c=0;return b>=4096&&(c+=13,b>>>=13),b>=64&&(c+=7,b>>>=7),b>=8&&(c+=4,b>>>=4),b>=2&&(c+=2,b>>>=2),c+b},f.prototype._zeroBits=function(a){if(0===a)return 26;var b=a,c=0;return 0===(8191&b)&&(c+=13,b>>>=13),0===(127&b)&&(c+=7,b>>>=7),0===(15&b)&&(c+=4,b>>>=4),0===(3&b)&&(c+=2,b>>>=2),0===(1&b)&&c++,c},f.prototype.bitLength=function(){var a=this.words[this.length-1],b=this._countBits(a);return 26*(this.length-1)+b},f.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,b=0;b<this.length;b++){var c=this._zeroBits(this.words[b]);if(a+=c,26!==c)break}return a},f.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},f.prototype.toTwos=function(a){return 0!==this.negative?this.abs().inotn(a).iaddn(1):this.clone()},f.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},f.prototype.isNeg=function(){return 0!==this.negative},f.prototype.neg=function(){return this.clone().ineg()},f.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},f.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var b=0;b<a.length;b++)this.words[b]=this.words[b]|a.words[b];return this.strip()},f.prototype.ior=function(a){return d(0===(this.negative|a.negative)),this.iuor(a)},f.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},f.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},f.prototype.iuand=function(a){var b;b=this.length>a.length?a:this;for(var c=0;c<b.length;c++)this.words[c]=this.words[c]&a.words[c];return this.length=b.length,this.strip()},f.prototype.iand=function(a){return d(0===(this.negative|a.negative)),this.iuand(a)},f.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},f.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},f.prototype.iuxor=function(a){var b,c;this.length>a.length?(b=this,c=a):(b=a,c=this);for(var d=0;d<c.length;d++)this.words[d]=b.words[d]^c.words[d];if(this!==b)for(;d<b.length;d++)this.words[d]=b.words[d];return this.length=b.length,this.strip()},f.prototype.ixor=function(a){return d(0===(this.negative|a.negative)),this.iuxor(a)},f.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},f.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},f.prototype.inotn=function(a){d("number"==typeof a&&a>=0);var b=0|Math.ceil(a/26),c=a%26;this._expand(b),c>0&&b--;for(var e=0;e<b;e++)this.words[e]=67108863&~this.words[e];return c>0&&(this.words[e]=~this.words[e]&67108863>>26-c),this.strip()},f.prototype.notn=function(a){return this.clone().inotn(a)},f.prototype.setn=function(a,b){d("number"==typeof a&&a>=0);var c=a/26|0,e=a%26;return this._expand(c+1),b?this.words[c]=this.words[c]|1<<e:this.words[c]=this.words[c]&~(1<<e),this.strip()},f.prototype.iadd=function(a){var b;if(0!==this.negative&&0===a.negative)return this.negative=0,b=this.isub(a),this.negative^=1,this._normSign();if(0===this.negative&&0!==a.negative)return a.negative=0,b=this.isub(a),a.negative=1,b._normSign();var c,d;this.length>a.length?(c=this,d=a):(c=a,d=this);for(var e=0,f=0;f<d.length;f++)b=(0|c.words[f])+(0|d.words[f])+e,this.words[f]=67108863&b,e=b>>>26;for(;0!==e&&f<c.length;f++)b=(0|c.words[f])+e,this.words[f]=67108863&b,e=b>>>26;if(this.length=c.length,0!==e)this.words[this.length]=e,this.length++;else if(c!==this)for(;f<c.length;f++)this.words[f]=c.words[f];return this},f.prototype.add=function(a){var b;return 0!==a.negative&&0===this.negative?(a.negative=0,b=this.sub(a),a.negative^=1,b):0===a.negative&&0!==this.negative?(this.negative=0,b=a.sub(this),this.negative=1,b):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},f.prototype.isub=function(a){if(0!==a.negative){
a.negative=0;var b=this.iadd(a);return a.negative=1,b._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var c=this.cmp(a);if(0===c)return this.negative=0,this.length=1,this.words[0]=0,this;var d,e;c>0?(d=this,e=a):(d=a,e=this);for(var f=0,g=0;g<e.length;g++)b=(0|d.words[g])-(0|e.words[g])+f,f=b>>26,this.words[g]=67108863&b;for(;0!==f&&g<d.length;g++)b=(0|d.words[g])+f,f=b>>26,this.words[g]=67108863&b;if(0===f&&g<d.length&&d!==this)for(;g<d.length;g++)this.words[g]=d.words[g];return this.length=Math.max(this.length,g),d!==this&&(this.negative=1),this.strip()},f.prototype.sub=function(a){return this.clone().isub(a)};var y=function(a,b,c){var d,e,f,g=a.words,h=b.words,i=c.words,j=0,k=0|g[0],l=8191&k,m=k>>>13,n=0|g[1],o=8191&n,p=n>>>13,q=0|g[2],r=8191&q,s=q>>>13,t=0|g[3],u=8191&t,v=t>>>13,w=0|g[4],x=8191&w,y=w>>>13,z=0|g[5],A=8191&z,B=z>>>13,C=0|g[6],D=8191&C,E=C>>>13,F=0|g[7],G=8191&F,H=F>>>13,I=0|g[8],J=8191&I,K=I>>>13,L=0|g[9],M=8191&L,N=L>>>13,O=0|h[0],P=8191&O,Q=O>>>13,R=0|h[1],S=8191&R,T=R>>>13,U=0|h[2],V=8191&U,W=U>>>13,X=0|h[3],Y=8191&X,Z=X>>>13,$=0|h[4],_=8191&$,aa=$>>>13,ba=0|h[5],ca=8191&ba,da=ba>>>13,ea=0|h[6],fa=8191&ea,ga=ea>>>13,ha=0|h[7],ia=8191&ha,ja=ha>>>13,ka=0|h[8],la=8191&ka,ma=ka>>>13,na=0|h[9],oa=8191&na,pa=na>>>13;c.negative=a.negative^b.negative,c.length=19,d=Math.imul(l,P),e=Math.imul(l,Q),e+=Math.imul(m,P),f=Math.imul(m,Q);var qa=j+d+((8191&e)<<13);j=f+(e>>>13)+(qa>>>26),qa&=67108863,d=Math.imul(o,P),e=Math.imul(o,Q),e+=Math.imul(p,P),f=Math.imul(p,Q),d+=Math.imul(l,S),e+=Math.imul(l,T),e+=Math.imul(m,S),f+=Math.imul(m,T);var ra=j+d+((8191&e)<<13);j=f+(e>>>13)+(ra>>>26),ra&=67108863,d=Math.imul(r,P),e=Math.imul(r,Q),e+=Math.imul(s,P),f=Math.imul(s,Q),d+=Math.imul(o,S),e+=Math.imul(o,T),e+=Math.imul(p,S),f+=Math.imul(p,T),d+=Math.imul(l,V),e+=Math.imul(l,W),e+=Math.imul(m,V),f+=Math.imul(m,W);var sa=j+d+((8191&e)<<13);j=f+(e>>>13)+(sa>>>26),sa&=67108863,d=Math.imul(u,P),e=Math.imul(u,Q),e+=Math.imul(v,P),f=Math.imul(v,Q),d+=Math.imul(r,S),e+=Math.imul(r,T),e+=Math.imul(s,S),f+=Math.imul(s,T),d+=Math.imul(o,V),e+=Math.imul(o,W),e+=Math.imul(p,V),f+=Math.imul(p,W),d+=Math.imul(l,Y),e+=Math.imul(l,Z),e+=Math.imul(m,Y),f+=Math.imul(m,Z);var ta=j+d+((8191&e)<<13);j=f+(e>>>13)+(ta>>>26),ta&=67108863,d=Math.imul(x,P),e=Math.imul(x,Q),e+=Math.imul(y,P),f=Math.imul(y,Q),d+=Math.imul(u,S),e+=Math.imul(u,T),e+=Math.imul(v,S),f+=Math.imul(v,T),d+=Math.imul(r,V),e+=Math.imul(r,W),e+=Math.imul(s,V),f+=Math.imul(s,W),d+=Math.imul(o,Y),e+=Math.imul(o,Z),e+=Math.imul(p,Y),f+=Math.imul(p,Z),d+=Math.imul(l,_),e+=Math.imul(l,aa),e+=Math.imul(m,_),f+=Math.imul(m,aa);var ua=j+d+((8191&e)<<13);j=f+(e>>>13)+(ua>>>26),ua&=67108863,d=Math.imul(A,P),e=Math.imul(A,Q),e+=Math.imul(B,P),f=Math.imul(B,Q),d+=Math.imul(x,S),e+=Math.imul(x,T),e+=Math.imul(y,S),f+=Math.imul(y,T),d+=Math.imul(u,V),e+=Math.imul(u,W),e+=Math.imul(v,V),f+=Math.imul(v,W),d+=Math.imul(r,Y),e+=Math.imul(r,Z),e+=Math.imul(s,Y),f+=Math.imul(s,Z),d+=Math.imul(o,_),e+=Math.imul(o,aa),e+=Math.imul(p,_),f+=Math.imul(p,aa),d+=Math.imul(l,ca),e+=Math.imul(l,da),e+=Math.imul(m,ca),f+=Math.imul(m,da);var va=j+d+((8191&e)<<13);j=f+(e>>>13)+(va>>>26),va&=67108863,d=Math.imul(D,P),e=Math.imul(D,Q),e+=Math.imul(E,P),f=Math.imul(E,Q),d+=Math.imul(A,S),e+=Math.imul(A,T),e+=Math.imul(B,S),f+=Math.imul(B,T),d+=Math.imul(x,V),e+=Math.imul(x,W),e+=Math.imul(y,V),f+=Math.imul(y,W),d+=Math.imul(u,Y),e+=Math.imul(u,Z),e+=Math.imul(v,Y),f+=Math.imul(v,Z),d+=Math.imul(r,_),e+=Math.imul(r,aa),e+=Math.imul(s,_),f+=Math.imul(s,aa),d+=Math.imul(o,ca),e+=Math.imul(o,da),e+=Math.imul(p,ca),f+=Math.imul(p,da),d+=Math.imul(l,fa),e+=Math.imul(l,ga),e+=Math.imul(m,fa),f+=Math.imul(m,ga);var wa=j+d+((8191&e)<<13);j=f+(e>>>13)+(wa>>>26),wa&=67108863,d=Math.imul(G,P),e=Math.imul(G,Q),e+=Math.imul(H,P),f=Math.imul(H,Q),d+=Math.imul(D,S),e+=Math.imul(D,T),e+=Math.imul(E,S),f+=Math.imul(E,T),d+=Math.imul(A,V),e+=Math.imul(A,W),e+=Math.imul(B,V),f+=Math.imul(B,W),d+=Math.imul(x,Y),e+=Math.imul(x,Z),e+=Math.imul(y,Y),f+=Math.imul(y,Z),d+=Math.imul(u,_),e+=Math.imul(u,aa),e+=Math.imul(v,_),f+=Math.imul(v,aa),d+=Math.imul(r,ca),e+=Math.imul(r,da),e+=Math.imul(s,ca),f+=Math.imul(s,da),d+=Math.imul(o,fa),e+=Math.imul(o,ga),e+=Math.imul(p,fa),f+=Math.imul(p,ga),d+=Math.imul(l,ia),e+=Math.imul(l,ja),e+=Math.imul(m,ia),f+=Math.imul(m,ja);var xa=j+d+((8191&e)<<13);j=f+(e>>>13)+(xa>>>26),xa&=67108863,d=Math.imul(J,P),e=Math.imul(J,Q),e+=Math.imul(K,P),f=Math.imul(K,Q),d+=Math.imul(G,S),e+=Math.imul(G,T),e+=Math.imul(H,S),f+=Math.imul(H,T),d+=Math.imul(D,V),e+=Math.imul(D,W),e+=Math.imul(E,V),f+=Math.imul(E,W),d+=Math.imul(A,Y),e+=Math.imul(A,Z),e+=Math.imul(B,Y),f+=Math.imul(B,Z),d+=Math.imul(x,_),e+=Math.imul(x,aa),e+=Math.imul(y,_),f+=Math.imul(y,aa),d+=Math.imul(u,ca),e+=Math.imul(u,da),e+=Math.imul(v,ca),f+=Math.imul(v,da),d+=Math.imul(r,fa),e+=Math.imul(r,ga),e+=Math.imul(s,fa),f+=Math.imul(s,ga),d+=Math.imul(o,ia),e+=Math.imul(o,ja),e+=Math.imul(p,ia),f+=Math.imul(p,ja),d+=Math.imul(l,la),e+=Math.imul(l,ma),e+=Math.imul(m,la),f+=Math.imul(m,ma);var ya=j+d+((8191&e)<<13);j=f+(e>>>13)+(ya>>>26),ya&=67108863,d=Math.imul(M,P),e=Math.imul(M,Q),e+=Math.imul(N,P),f=Math.imul(N,Q),d+=Math.imul(J,S),e+=Math.imul(J,T),e+=Math.imul(K,S),f+=Math.imul(K,T),d+=Math.imul(G,V),e+=Math.imul(G,W),e+=Math.imul(H,V),f+=Math.imul(H,W),d+=Math.imul(D,Y),e+=Math.imul(D,Z),e+=Math.imul(E,Y),f+=Math.imul(E,Z),d+=Math.imul(A,_),e+=Math.imul(A,aa),e+=Math.imul(B,_),f+=Math.imul(B,aa),d+=Math.imul(x,ca),e+=Math.imul(x,da),e+=Math.imul(y,ca),f+=Math.imul(y,da),d+=Math.imul(u,fa),e+=Math.imul(u,ga),e+=Math.imul(v,fa),f+=Math.imul(v,ga),d+=Math.imul(r,ia),e+=Math.imul(r,ja),e+=Math.imul(s,ia),f+=Math.imul(s,ja),d+=Math.imul(o,la),e+=Math.imul(o,ma),e+=Math.imul(p,la),f+=Math.imul(p,ma),d+=Math.imul(l,oa),e+=Math.imul(l,pa),e+=Math.imul(m,oa),f+=Math.imul(m,pa);var za=j+d+((8191&e)<<13);j=f+(e>>>13)+(za>>>26),za&=67108863,d=Math.imul(M,S),e=Math.imul(M,T),e+=Math.imul(N,S),f=Math.imul(N,T),d+=Math.imul(J,V),e+=Math.imul(J,W),e+=Math.imul(K,V),f+=Math.imul(K,W),d+=Math.imul(G,Y),e+=Math.imul(G,Z),e+=Math.imul(H,Y),f+=Math.imul(H,Z),d+=Math.imul(D,_),e+=Math.imul(D,aa),e+=Math.imul(E,_),f+=Math.imul(E,aa),d+=Math.imul(A,ca),e+=Math.imul(A,da),e+=Math.imul(B,ca),f+=Math.imul(B,da),d+=Math.imul(x,fa),e+=Math.imul(x,ga),e+=Math.imul(y,fa),f+=Math.imul(y,ga),d+=Math.imul(u,ia),e+=Math.imul(u,ja),e+=Math.imul(v,ia),f+=Math.imul(v,ja),d+=Math.imul(r,la),e+=Math.imul(r,ma),e+=Math.imul(s,la),f+=Math.imul(s,ma),d+=Math.imul(o,oa),e+=Math.imul(o,pa),e+=Math.imul(p,oa),f+=Math.imul(p,pa);var Aa=j+d+((8191&e)<<13);j=f+(e>>>13)+(Aa>>>26),Aa&=67108863,d=Math.imul(M,V),e=Math.imul(M,W),e+=Math.imul(N,V),f=Math.imul(N,W),d+=Math.imul(J,Y),e+=Math.imul(J,Z),e+=Math.imul(K,Y),f+=Math.imul(K,Z),d+=Math.imul(G,_),e+=Math.imul(G,aa),e+=Math.imul(H,_),f+=Math.imul(H,aa),d+=Math.imul(D,ca),e+=Math.imul(D,da),e+=Math.imul(E,ca),f+=Math.imul(E,da),d+=Math.imul(A,fa),e+=Math.imul(A,ga),e+=Math.imul(B,fa),f+=Math.imul(B,ga),d+=Math.imul(x,ia),e+=Math.imul(x,ja),e+=Math.imul(y,ia),f+=Math.imul(y,ja),d+=Math.imul(u,la),e+=Math.imul(u,ma),e+=Math.imul(v,la),f+=Math.imul(v,ma),d+=Math.imul(r,oa),e+=Math.imul(r,pa),e+=Math.imul(s,oa),f+=Math.imul(s,pa);var Ba=j+d+((8191&e)<<13);j=f+(e>>>13)+(Ba>>>26),Ba&=67108863,d=Math.imul(M,Y),e=Math.imul(M,Z),e+=Math.imul(N,Y),f=Math.imul(N,Z),d+=Math.imul(J,_),e+=Math.imul(J,aa),e+=Math.imul(K,_),f+=Math.imul(K,aa),d+=Math.imul(G,ca),e+=Math.imul(G,da),e+=Math.imul(H,ca),f+=Math.imul(H,da),d+=Math.imul(D,fa),e+=Math.imul(D,ga),e+=Math.imul(E,fa),f+=Math.imul(E,ga),d+=Math.imul(A,ia),e+=Math.imul(A,ja),e+=Math.imul(B,ia),f+=Math.imul(B,ja),d+=Math.imul(x,la),e+=Math.imul(x,ma),e+=Math.imul(y,la),f+=Math.imul(y,ma),d+=Math.imul(u,oa),e+=Math.imul(u,pa),e+=Math.imul(v,oa),f+=Math.imul(v,pa);var Ca=j+d+((8191&e)<<13);j=f+(e>>>13)+(Ca>>>26),Ca&=67108863,d=Math.imul(M,_),e=Math.imul(M,aa),e+=Math.imul(N,_),f=Math.imul(N,aa),d+=Math.imul(J,ca),e+=Math.imul(J,da),e+=Math.imul(K,ca),f+=Math.imul(K,da),d+=Math.imul(G,fa),e+=Math.imul(G,ga),e+=Math.imul(H,fa),f+=Math.imul(H,ga),d+=Math.imul(D,ia),e+=Math.imul(D,ja),e+=Math.imul(E,ia),f+=Math.imul(E,ja),d+=Math.imul(A,la),e+=Math.imul(A,ma),e+=Math.imul(B,la),f+=Math.imul(B,ma),d+=Math.imul(x,oa),e+=Math.imul(x,pa),e+=Math.imul(y,oa),f+=Math.imul(y,pa);var Da=j+d+((8191&e)<<13);j=f+(e>>>13)+(Da>>>26),Da&=67108863,d=Math.imul(M,ca),e=Math.imul(M,da),e+=Math.imul(N,ca),f=Math.imul(N,da),d+=Math.imul(J,fa),e+=Math.imul(J,ga),e+=Math.imul(K,fa),f+=Math.imul(K,ga),d+=Math.imul(G,ia),e+=Math.imul(G,ja),e+=Math.imul(H,ia),f+=Math.imul(H,ja),d+=Math.imul(D,la),e+=Math.imul(D,ma),e+=Math.imul(E,la),f+=Math.imul(E,ma),d+=Math.imul(A,oa),e+=Math.imul(A,pa),e+=Math.imul(B,oa),f+=Math.imul(B,pa);var Ea=j+d+((8191&e)<<13);j=f+(e>>>13)+(Ea>>>26),Ea&=67108863,d=Math.imul(M,fa),e=Math.imul(M,ga),e+=Math.imul(N,fa),f=Math.imul(N,ga),d+=Math.imul(J,ia),e+=Math.imul(J,ja),e+=Math.imul(K,ia),f+=Math.imul(K,ja),d+=Math.imul(G,la),e+=Math.imul(G,ma),e+=Math.imul(H,la),f+=Math.imul(H,ma),d+=Math.imul(D,oa),e+=Math.imul(D,pa),e+=Math.imul(E,oa),f+=Math.imul(E,pa);var Fa=j+d+((8191&e)<<13);j=f+(e>>>13)+(Fa>>>26),Fa&=67108863,d=Math.imul(M,ia),e=Math.imul(M,ja),e+=Math.imul(N,ia),f=Math.imul(N,ja),d+=Math.imul(J,la),e+=Math.imul(J,ma),e+=Math.imul(K,la),f+=Math.imul(K,ma),d+=Math.imul(G,oa),e+=Math.imul(G,pa),e+=Math.imul(H,oa),f+=Math.imul(H,pa);var Ga=j+d+((8191&e)<<13);j=f+(e>>>13)+(Ga>>>26),Ga&=67108863,d=Math.imul(M,la),e=Math.imul(M,ma),e+=Math.imul(N,la),f=Math.imul(N,ma),d+=Math.imul(J,oa),e+=Math.imul(J,pa),e+=Math.imul(K,oa),f+=Math.imul(K,pa);var Ha=j+d+((8191&e)<<13);j=f+(e>>>13)+(Ha>>>26),Ha&=67108863,d=Math.imul(M,oa),e=Math.imul(M,pa),e+=Math.imul(N,oa),f=Math.imul(N,pa);var Ia=j+d+((8191&e)<<13);return j=f+(e>>>13)+(Ia>>>26),Ia&=67108863,i[0]=qa,i[1]=ra,i[2]=sa,i[3]=ta,i[4]=ua,i[5]=va,i[6]=wa,i[7]=xa,i[8]=ya,i[9]=za,i[10]=Aa,i[11]=Ba,i[12]=Ca,i[13]=Da,i[14]=Ea,i[15]=Fa,i[16]=Ga,i[17]=Ha,i[18]=Ia,0!==j&&(i[19]=j,c.length++),c};Math.imul||(y=j),f.prototype.mulTo=function(a,b){var c,d=this.length+a.length;return c=10===this.length&&10===a.length?y(this,a,b):d<63?j(this,a,b):d<1024?k(this,a,b):l(this,a,b)},m.prototype.makeRBT=function(a){for(var b=new Array(a),c=f.prototype._countBits(a)-1,d=0;d<a;d++)b[d]=this.revBin(d,c,a);return b},m.prototype.revBin=function(a,b,c){if(0===a||a===c-1)return a;for(var d=0,e=0;e<b;e++)d|=(1&a)<<b-e-1,a>>=1;return d},m.prototype.permute=function(a,b,c,d,e,f){for(var g=0;g<f;g++)d[g]=b[a[g]],e[g]=c[a[g]]},m.prototype.transform=function(a,b,c,d,e,f){this.permute(f,a,b,c,d,e);for(var g=1;g<e;g<<=1)for(var h=g<<1,i=Math.cos(2*Math.PI/h),j=Math.sin(2*Math.PI/h),k=0;k<e;k+=h)for(var l=i,m=j,n=0;n<g;n++){var o=c[k+n],p=d[k+n],q=c[k+n+g],r=d[k+n+g],s=l*q-m*r;r=l*r+m*q,q=s,c[k+n]=o+q,d[k+n]=p+r,c[k+n+g]=o-q,d[k+n+g]=p-r,n!==h&&(s=i*l-j*m,m=i*m+j*l,l=s)}},m.prototype.guessLen13b=function(a,b){var c=1|Math.max(b,a),d=1&c,e=0;for(c=c/2|0;c;c>>>=1)e++;return 1<<e+1+d},m.prototype.conjugate=function(a,b,c){if(!(c<=1))for(var d=0;d<c/2;d++){var e=a[d];a[d]=a[c-d-1],a[c-d-1]=e,e=b[d],b[d]=-b[c-d-1],b[c-d-1]=-e}},m.prototype.normalize13b=function(a,b){for(var c=0,d=0;d<b/2;d++){var e=8192*Math.round(a[2*d+1]/b)+Math.round(a[2*d]/b)+c;a[d]=67108863&e,c=e<67108864?0:e/67108864|0}return a},m.prototype.convert13b=function(a,b,c,e){for(var f=0,g=0;g<b;g++)f+=0|a[g],c[2*g]=8191&f,f>>>=13,c[2*g+1]=8191&f,f>>>=13;for(g=2*b;g<e;++g)c[g]=0;d(0===f),d(0===(f&-8192))},m.prototype.stub=function(a){for(var b=new Array(a),c=0;c<a;c++)b[c]=0;return b},m.prototype.mulp=function(a,b,c){var d=2*this.guessLen13b(a.length,b.length),e=this.makeRBT(d),f=this.stub(d),g=new Array(d),h=new Array(d),i=new Array(d),j=new Array(d),k=new Array(d),l=new Array(d),m=c.words;m.length=d,this.convert13b(a.words,a.length,g,d),this.convert13b(b.words,b.length,j,d),this.transform(g,f,h,i,d,e),this.transform(j,f,k,l,d,e);for(var n=0;n<d;n++){var o=h[n]*k[n]-i[n]*l[n];i[n]=h[n]*l[n]+i[n]*k[n],h[n]=o}return this.conjugate(h,i,d),this.transform(h,i,m,f,d,e),this.conjugate(m,f,d),this.normalize13b(m,d),c.negative=a.negative^b.negative,c.length=a.length+b.length,c.strip()},f.prototype.mul=function(a){var b=new f(null);return b.words=new Array(this.length+a.length),this.mulTo(a,b)},f.prototype.mulf=function(a){var b=new f(null);return b.words=new Array(this.length+a.length),l(this,a,b)},f.prototype.imul=function(a){return this.clone().mulTo(a,this)},f.prototype.imuln=function(a){d("number"==typeof a),d(a<67108864);for(var b=0,c=0;c<this.length;c++){var e=(0|this.words[c])*a,f=(67108863&e)+(67108863&b);b>>=26,b+=e/67108864|0,b+=f>>>26,this.words[c]=67108863&f}return 0!==b&&(this.words[c]=b,this.length++),this},f.prototype.muln=function(a){return this.clone().imuln(a)},f.prototype.sqr=function(){return this.mul(this)},f.prototype.isqr=function(){return this.imul(this.clone())},f.prototype.pow=function(a){var b=i(a);if(0===b.length)return new f(1);for(var c=this,d=0;d<b.length&&0===b[d];d++,c=c.sqr());if(++d<b.length)for(var e=c.sqr();d<b.length;d++,e=e.sqr())0!==b[d]&&(c=c.mul(e));return c},f.prototype.iushln=function(a){d("number"==typeof a&&a>=0);var b,c=a%26,e=(a-c)/26,f=67108863>>>26-c<<26-c;if(0!==c){var g=0;for(b=0;b<this.length;b++){var h=this.words[b]&f,i=(0|this.words[b])-h<<c;this.words[b]=i|g,g=h>>>26-c}g&&(this.words[b]=g,this.length++)}if(0!==e){for(b=this.length-1;b>=0;b--)this.words[b+e]=this.words[b];for(b=0;b<e;b++)this.words[b]=0;this.length+=e}return this.strip()},f.prototype.ishln=function(a){return d(0===this.negative),this.iushln(a)},f.prototype.iushrn=function(a,b,c){d("number"==typeof a&&a>=0);var e;e=b?(b-b%26)/26:0;var f=a%26,g=Math.min((a-f)/26,this.length),h=67108863^67108863>>>f<<f,i=c;if(e-=g,e=Math.max(0,e),i){for(var j=0;j<g;j++)i.words[j]=this.words[j];i.length=g}if(0===g);else if(this.length>g)for(this.length-=g,j=0;j<this.length;j++)this.words[j]=this.words[j+g];else this.words[0]=0,this.length=1;var k=0;for(j=this.length-1;j>=0&&(0!==k||j>=e);j--){var l=0|this.words[j];this.words[j]=k<<26-f|l>>>f,k=l&h}return i&&0!==k&&(i.words[i.length++]=k),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},f.prototype.ishrn=function(a,b,c){return d(0===this.negative),this.iushrn(a,b,c)},f.prototype.shln=function(a){return this.clone().ishln(a)},f.prototype.ushln=function(a){return this.clone().iushln(a)},f.prototype.shrn=function(a){return this.clone().ishrn(a)},f.prototype.ushrn=function(a){return this.clone().iushrn(a)},f.prototype.testn=function(a){d("number"==typeof a&&a>=0);var b=a%26,c=(a-b)/26,e=1<<b;if(this.length<=c)return!1;var f=this.words[c];return!!(f&e)},f.prototype.imaskn=function(a){d("number"==typeof a&&a>=0);var b=a%26,c=(a-b)/26;if(d(0===this.negative,"imaskn works only with positive numbers"),0!==b&&c++,this.length=Math.min(c,this.length),0!==b){var e=67108863^67108863>>>b<<b;this.words[this.length-1]&=e}return this.strip()},f.prototype.maskn=function(a){return this.clone().imaskn(a)},f.prototype.iaddn=function(a){return d("number"==typeof a),d(a<67108864),a<0?this.isubn(-a):0!==this.negative?1===this.length&&(0|this.words[0])<a?(this.words[0]=a-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},f.prototype._iaddn=function(a){this.words[0]+=a;for(var b=0;b<this.length&&this.words[b]>=67108864;b++)this.words[b]-=67108864,b===this.length-1?this.words[b+1]=1:this.words[b+1]++;return this.length=Math.max(this.length,b+1),this},f.prototype.isubn=function(a){if(d("number"==typeof a),d(a<67108864),a<0)return this.iaddn(-a);if(0!==this.negative)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var b=0;b<this.length&&this.words[b]<0;b++)this.words[b]+=67108864,this.words[b+1]-=1;return this.strip()},f.prototype.addn=function(a){return this.clone().iaddn(a)},f.prototype.subn=function(a){return this.clone().isubn(a)},f.prototype.iabs=function(){return this.negative=0,this},f.prototype.abs=function(){return this.clone().iabs()},f.prototype._ishlnsubmul=function(a,b,c){var e,f=a.length+c;this._expand(f);var g,h=0;for(e=0;e<a.length;e++){g=(0|this.words[e+c])+h;var i=(0|a.words[e])*b;g-=67108863&i,h=(g>>26)-(i/67108864|0),this.words[e+c]=67108863&g}for(;e<this.length-c;e++)g=(0|this.words[e+c])+h,h=g>>26,this.words[e+c]=67108863&g;if(0===h)return this.strip();for(d(h===-1),h=0,e=0;e<this.length;e++)g=-(0|this.words[e])+h,h=g>>26,this.words[e]=67108863&g;return this.negative=1,this.strip()},f.prototype._wordDiv=function(a,b){var c=this.length-a.length,d=this.clone(),e=a,g=0|e.words[e.length-1],h=this._countBits(g);c=26-h,0!==c&&(e=e.ushln(c),d.iushln(c),g=0|e.words[e.length-1]);var i,j=d.length-e.length;if("mod"!==b){i=new f(null),i.length=j+1,i.words=new Array(i.length);for(var k=0;k<i.length;k++)i.words[k]=0}var l=d.clone()._ishlnsubmul(e,1,j);0===l.negative&&(d=l,i&&(i.words[j]=1));for(var m=j-1;m>=0;m--){var n=67108864*(0|d.words[e.length+m])+(0|d.words[e.length+m-1]);for(n=Math.min(n/g|0,67108863),d._ishlnsubmul(e,n,m);0!==d.negative;)n--,d.negative=0,d._ishlnsubmul(e,1,m),d.isZero()||(d.negative^=1);i&&(i.words[m]=n)}return i&&i.strip(),d.strip(),"div"!==b&&0!==c&&d.iushrn(c),{div:i||null,mod:d}},f.prototype.divmod=function(a,b,c){if(d(!a.isZero()),this.isZero())return{div:new f(0),mod:new f(0)};var e,g,h;return 0!==this.negative&&0===a.negative?(h=this.neg().divmod(a,b),"mod"!==b&&(e=h.div.neg()),"div"!==b&&(g=h.mod.neg(),c&&0!==g.negative&&g.iadd(a)),{div:e,mod:g}):0===this.negative&&0!==a.negative?(h=this.divmod(a.neg(),b),"mod"!==b&&(e=h.div.neg()),{div:e,mod:h.mod}):0!==(this.negative&a.negative)?(h=this.neg().divmod(a.neg(),b),"div"!==b&&(g=h.mod.neg(),c&&0!==g.negative&&g.isub(a)),{div:h.div,mod:g}):a.length>this.length||this.cmp(a)<0?{div:new f(0),mod:this}:1===a.length?"div"===b?{div:this.divn(a.words[0]),mod:null}:"mod"===b?{div:null,mod:new f(this.modn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new f(this.modn(a.words[0]))}:this._wordDiv(a,b)},f.prototype.div=function(a){return this.divmod(a,"div",!1).div},f.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},f.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},f.prototype.divRound=function(a){var b=this.divmod(a);if(b.mod.isZero())return b.div;var c=0!==b.div.negative?b.mod.isub(a):b.mod,d=a.ushrn(1),e=a.andln(1),f=c.cmp(d);return f<0||1===e&&0===f?b.div:0!==b.div.negative?b.div.isubn(1):b.div.iaddn(1)},f.prototype.modn=function(a){d(a<=67108863);for(var b=(1<<26)%a,c=0,e=this.length-1;e>=0;e--)c=(b*c+(0|this.words[e]))%a;return c},f.prototype.idivn=function(a){d(a<=67108863);for(var b=0,c=this.length-1;c>=0;c--){var e=(0|this.words[c])+67108864*b;this.words[c]=e/a|0,b=e%a}return this.strip()},f.prototype.divn=function(a){return this.clone().idivn(a)},f.prototype.egcd=function(a){d(0===a.negative),d(!a.isZero());var b=this,c=a.clone();b=0!==b.negative?b.umod(a):b.clone();for(var e=new f(1),g=new f(0),h=new f(0),i=new f(1),j=0;b.isEven()&&c.isEven();)b.iushrn(1),c.iushrn(1),++j;for(var k=c.clone(),l=b.clone();!b.isZero();){for(var m=0,n=1;0===(b.words[0]&n)&&m<26;++m,n<<=1);if(m>0)for(b.iushrn(m);m-- >0;)(e.isOdd()||g.isOdd())&&(e.iadd(k),g.isub(l)),e.iushrn(1),g.iushrn(1);for(var o=0,p=1;0===(c.words[0]&p)&&o<26;++o,p<<=1);if(o>0)for(c.iushrn(o);o-- >0;)(h.isOdd()||i.isOdd())&&(h.iadd(k),i.isub(l)),h.iushrn(1),i.iushrn(1);b.cmp(c)>=0?(b.isub(c),e.isub(h),g.isub(i)):(c.isub(b),h.isub(e),i.isub(g))}return{a:h,b:i,gcd:c.iushln(j)}},f.prototype._invmp=function(a){d(0===a.negative),d(!a.isZero());var b=this,c=a.clone();b=0!==b.negative?b.umod(a):b.clone();for(var e=new f(1),g=new f(0),h=c.clone();b.cmpn(1)>0&&c.cmpn(1)>0;){for(var i=0,j=1;0===(b.words[0]&j)&&i<26;++i,j<<=1);if(i>0)for(b.iushrn(i);i-- >0;)e.isOdd()&&e.iadd(h),e.iushrn(1);for(var k=0,l=1;0===(c.words[0]&l)&&k<26;++k,l<<=1);if(k>0)for(c.iushrn(k);k-- >0;)g.isOdd()&&g.iadd(h),g.iushrn(1);b.cmp(c)>=0?(b.isub(c),e.isub(g)):(c.isub(b),g.isub(e))}var m;return m=0===b.cmpn(1)?e:g,m.cmpn(0)<0&&m.iadd(a),m},f.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var b=this.clone(),c=a.clone();b.negative=0,c.negative=0;for(var d=0;b.isEven()&&c.isEven();d++)b.iushrn(1),c.iushrn(1);for(;;){for(;b.isEven();)b.iushrn(1);for(;c.isEven();)c.iushrn(1);var e=b.cmp(c);if(e<0){var f=b;b=c,c=f}else if(0===e||0===c.cmpn(1))break;b.isub(c)}return c.iushln(d)},f.prototype.invm=function(a){return this.egcd(a).a.umod(a)},f.prototype.isEven=function(){return 0===(1&this.words[0])},f.prototype.isOdd=function(){return 1===(1&this.words[0])},f.prototype.andln=function(a){return this.words[0]&a},f.prototype.bincn=function(a){d("number"==typeof a);var b=a%26,c=(a-b)/26,e=1<<b;if(this.length<=c)return this._expand(c+1),this.words[c]|=e,this;for(var f=e,g=c;0!==f&&g<this.length;g++){var h=0|this.words[g];h+=f,f=h>>>26,h&=67108863,this.words[g]=h}return 0!==f&&(this.words[g]=f,this.length++),this},f.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},f.prototype.cmpn=function(a){var b=a<0;if(0!==this.negative&&!b)return-1;if(0===this.negative&&b)return 1;this.strip();var c;if(this.length>1)c=1;else{b&&(a=-a),d(a<=67108863,"Number is too big");var e=0|this.words[0];c=e===a?0:e<a?-1:1}return 0!==this.negative?0|-c:c},f.prototype.cmp=function(a){if(0!==this.negative&&0===a.negative)return-1;if(0===this.negative&&0!==a.negative)return 1;var b=this.ucmp(a);return 0!==this.negative?0|-b:b},f.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var b=0,c=this.length-1;c>=0;c--){var d=0|this.words[c],e=0|a.words[c];if(d!==e){d<e?b=-1:d>e&&(b=1);break}}return b},f.prototype.gtn=function(a){return 1===this.cmpn(a)},f.prototype.gt=function(a){return 1===this.cmp(a)},f.prototype.gten=function(a){return this.cmpn(a)>=0},f.prototype.gte=function(a){return this.cmp(a)>=0},f.prototype.ltn=function(a){return this.cmpn(a)===-1},f.prototype.lt=function(a){return this.cmp(a)===-1},f.prototype.lten=function(a){return this.cmpn(a)<=0},f.prototype.lte=function(a){return this.cmp(a)<=0},f.prototype.eqn=function(a){return 0===this.cmpn(a)},f.prototype.eq=function(a){return 0===this.cmp(a)},f.red=function(a){return new s(a)},f.prototype.toRed=function(a){return d(!this.red,"Already a number in reduction context"),d(0===this.negative,"red works only with positives"),a.convertTo(this)._forceRed(a)},f.prototype.fromRed=function(){return d(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},f.prototype._forceRed=function(a){return this.red=a,this},f.prototype.forceRed=function(a){return d(!this.red,"Already a number in reduction context"),this._forceRed(a)},f.prototype.redAdd=function(a){return d(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},f.prototype.redIAdd=function(a){return d(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},f.prototype.redSub=function(a){return d(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},f.prototype.redISub=function(a){return d(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},f.prototype.redShl=function(a){return d(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},f.prototype.redMul=function(a){return d(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},f.prototype.redIMul=function(a){return d(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},f.prototype.redSqr=function(){return d(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},f.prototype.redISqr=function(){return d(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},f.prototype.redSqrt=function(){return d(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},f.prototype.redInvm=function(){return d(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},f.prototype.redNeg=function(){return d(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},f.prototype.redPow=function(a){return d(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var z={k256:null,p224:null,p192:null,p25519:null};n.prototype._tmp=function(){var a=new f(null);return a.words=new Array(Math.ceil(this.n/13)),a},n.prototype.ireduce=function(a){var b,c=a;do this.split(c,this.tmp),c=this.imulK(c),c=c.iadd(this.tmp),b=c.bitLength();while(b>this.n);var d=b<this.n?-1:c.ucmp(this.p);return 0===d?(c.words[0]=0,c.length=1):d>0?c.isub(this.p):c.strip(),c},n.prototype.split=function(a,b){a.iushrn(this.n,0,b)},n.prototype.imulK=function(a){return a.imul(this.k)},e(o,n),o.prototype.split=function(a,b){for(var c=4194303,d=Math.min(a.length,9),e=0;e<d;e++)b.words[e]=a.words[e];if(b.length=d,a.length<=9)return a.words[0]=0,void(a.length=1);var f=a.words[9];for(b.words[b.length++]=f&c,e=10;e<a.length;e++){var g=0|a.words[e];a.words[e-10]=(g&c)<<4|f>>>22,f=g}f>>>=22,a.words[e-10]=f,0===f&&a.length>10?a.length-=10:a.length-=9},o.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var b=0,c=0;c<a.length;c++){var d=0|a.words[c];b+=977*d,a.words[c]=67108863&b,b=64*d+(b/67108864|0)}return 0===a.words[a.length-1]&&(a.length--,0===a.words[a.length-1]&&a.length--),a},e(p,n),e(q,n),e(r,n),r.prototype.imulK=function(a){for(var b=0,c=0;c<a.length;c++){var d=19*(0|a.words[c])+b,e=67108863&d;d>>>=26,a.words[c]=e,b=d}return 0!==b&&(a.words[a.length++]=b),a},f._prime=function a(b){if(z[b])return z[b];var a;if("k256"===b)a=new o;else if("p224"===b)a=new p;else if("p192"===b)a=new q;else{if("p25519"!==b)throw new Error("Unknown prime "+b);a=new r}return z[b]=a,a},s.prototype._verify1=function(a){d(0===a.negative,"red works only with positives"),d(a.red,"red works only with red numbers")},s.prototype._verify2=function(a,b){d(0===(a.negative|b.negative),"red works only with positives"),d(a.red&&a.red===b.red,"red works only with red numbers")},s.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):a.umod(this.m)._forceRed(this)},s.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},s.prototype.add=function(a,b){this._verify2(a,b);var c=a.add(b);return c.cmp(this.m)>=0&&c.isub(this.m),c._forceRed(this)},s.prototype.iadd=function(a,b){this._verify2(a,b);var c=a.iadd(b);return c.cmp(this.m)>=0&&c.isub(this.m),c},s.prototype.sub=function(a,b){this._verify2(a,b);var c=a.sub(b);return c.cmpn(0)<0&&c.iadd(this.m),c._forceRed(this)},s.prototype.isub=function(a,b){this._verify2(a,b);var c=a.isub(b);return c.cmpn(0)<0&&c.iadd(this.m),c},s.prototype.shl=function(a,b){return this._verify1(a),this.imod(a.ushln(b))},s.prototype.imul=function(a,b){return this._verify2(a,b),this.imod(a.imul(b))},s.prototype.mul=function(a,b){return this._verify2(a,b),this.imod(a.mul(b))},s.prototype.isqr=function(a){return this.imul(a,a.clone())},s.prototype.sqr=function(a){return this.mul(a,a)},s.prototype.sqrt=function(a){if(a.isZero())return a.clone();var b=this.m.andln(3);if(d(b%2===1),3===b){var c=this.m.add(new f(1)).iushrn(2);return this.pow(a,c)}for(var e=this.m.subn(1),g=0;!e.isZero()&&0===e.andln(1);)g++,e.iushrn(1);d(!e.isZero());var h=new f(1).toRed(this),i=h.redNeg(),j=this.m.subn(1).iushrn(1),k=this.m.bitLength();for(k=new f(2*k*k).toRed(this);0!==this.pow(k,j).cmp(i);)k.redIAdd(i);for(var l=this.pow(k,e),m=this.pow(a,e.addn(1).iushrn(1)),n=this.pow(a,e),o=g;0!==n.cmp(h);){for(var p=n,q=0;0!==p.cmp(h);q++)p=p.redSqr();d(q<o);var r=this.pow(l,new f(1).iushln(o-q-1));m=m.redMul(r),l=r.redSqr(),n=n.redMul(l),o=q}return m},s.prototype.invm=function(a){var b=a._invmp(this.m);return 0!==b.negative?(b.negative=0,this.imod(b).redNeg()):this.imod(b)},s.prototype.pow=function(a,b){if(b.isZero())return new f(1);if(0===b.cmpn(1))return a.clone();var c=4,d=new Array(1<<c);d[0]=new f(1).toRed(this),d[1]=a;for(var e=2;e<d.length;e++)d[e]=this.mul(d[e-1],a);var g=d[0],h=0,i=0,j=b.bitLength()%26;for(0===j&&(j=26),e=b.length-1;e>=0;e--){for(var k=b.words[e],l=j-1;l>=0;l--){var m=k>>l&1;g!==d[0]&&(g=this.sqr(g)),0!==m||0!==h?(h<<=1,h|=m,i++,(i===c||0===e&&0===l)&&(g=this.mul(g,d[h]),i=0,h=0)):i=0}j=26}return g},s.prototype.convertTo=function(a){var b=a.umod(this.m);return b===a?b.clone():b},s.prototype.convertFrom=function(a){var b=a.clone();return b.red=null,b},f.mont=function(a){return new t(a)},e(t,s),t.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},t.prototype.convertFrom=function(a){var b=this.imod(a.mul(this.rinv));return b.red=null,b},t.prototype.imul=function(a,b){if(a.isZero()||b.isZero())return a.words[0]=0,a.length=1,a;var c=a.imul(b),d=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=c.isub(d).iushrn(this.shift),f=e;return e.cmp(this.m)>=0?f=e.isub(this.m):e.cmpn(0)<0&&(f=e.iadd(this.m)),f._forceRed(this)},t.prototype.mul=function(a,b){if(a.isZero()||b.isZero())return new f(0)._forceRed(this);var c=a.mul(b),d=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=c.isub(d).iushrn(this.shift),g=e;return e.cmp(this.m)>=0?g=e.isub(this.m):e.cmpn(0)<0&&(g=e.iadd(this.m)),g._forceRed(this)},t.prototype.invm=function(a){var b=this.imod(a._invmp(this.m).mul(this.r2));return b._forceRed(this)}}("undefined"==typeof b||b,this)},{}],166:[function(a,b,c){(function(c){function d(a){var b=f(a),c=b.toRed(g.mont(a.modulus)).redPow(new g(a.publicExponent)).fromRed();return{blinder:c,unblinder:b.invm(a.modulus)}}function e(a,b){var e=d(b),f=b.modulus.byteLength(),h=(g.mont(b.modulus),new g(a).mul(e.blinder).umod(b.modulus)),i=h.toRed(g.mont(b.prime1)),j=h.toRed(g.mont(b.prime2)),k=b.coefficient,l=b.prime1,m=b.prime2,n=i.redPow(b.exponent1),o=j.redPow(b.exponent2);n=n.fromRed(),o=o.fromRed();var p=n.isub(o).imul(k).umod(l);return p.imul(m),o.iadd(p),new c(o.imul(e.unblinder).umod(b.modulus).toArray(!1,f))}function f(a){for(var b=a.modulus.byteLength(),c=new g(h(b));c.cmp(a.modulus)>=0||!c.umod(a.prime1)||!c.umod(a.prime2);)c=new g(h(b));return c}var g=a("bn.js"),h=a("randombytes");b.exports=e,e.getr=f}).call(this,a("buffer").Buffer)},{"bn.js":165,buffer:128,randombytes:323}],167:[function(a,b,c){"use strict";var d=c;d.version=a("../package.json").version,d.utils=a("./elliptic/utils"),d.rand=a("brorand"),d.hmacDRBG=a("./elliptic/hmac-drbg"),d.curve=a("./elliptic/curve"),d.curves=a("./elliptic/curves"),d.ec=a("./elliptic/ec"),d.eddsa=a("./elliptic/eddsa")},{"../package.json":190,"./elliptic/curve":170,"./elliptic/curves":173,"./elliptic/ec":174,"./elliptic/eddsa":177,"./elliptic/hmac-drbg":180,"./elliptic/utils":182,brorand:183}],168:[function(a,b,c){"use strict";function d(a,b){this.type=a,this.p=new f(b.p,16),this.red=b.prime?f.red(b.prime):f.mont(this.p),this.zero=new f(0).toRed(this.red),this.one=new f(1).toRed(this.red),this.two=new f(2).toRed(this.red),this.n=b.n&&new f(b.n,16),this.g=b.g&&this.pointFromJSON(b.g,b.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4)}function e(a,b){this.curve=a,this.type=b,this.precomputed=null}var f=a("bn.js"),g=a("../../elliptic"),h=g.utils,i=h.getNAF,j=h.getJSF,k=h.assert;b.exports=d,d.prototype.point=function(){throw new Error("Not implemented")},d.prototype.validate=function(){throw new Error("Not implemented")},d.prototype._fixedNafMul=function(a,b){k(a.precomputed);var c=a._getDoubles(),d=i(b,1),e=(1<<c.step+1)-(c.step%2===0?2:1);e/=3;for(var f=[],g=0;g<d.length;g+=c.step){for(var h=0,b=g+c.step-1;b>=g;b--)h=(h<<1)+d[b];f.push(h)}for(var j=this.jpoint(null,null,null),l=this.jpoint(null,null,null),m=e;m>0;m--){for(var g=0;g<f.length;g++){var h=f[g];h===m?l=l.mixedAdd(c.points[g]):h===-m&&(l=l.mixedAdd(c.points[g].neg()));
}j=j.add(l)}return j.toP()},d.prototype._wnafMul=function(a,b){var c=4,d=a._getNAFPoints(c);c=d.wnd;for(var e=d.points,f=i(b,c),g=this.jpoint(null,null,null),h=f.length-1;h>=0;h--){for(var b=0;h>=0&&0===f[h];h--)b++;if(h>=0&&b++,g=g.dblp(b),h<0)break;var j=f[h];k(0!==j),g="affine"===a.type?j>0?g.mixedAdd(e[j-1>>1]):g.mixedAdd(e[-j-1>>1].neg()):j>0?g.add(e[j-1>>1]):g.add(e[-j-1>>1].neg())}return"affine"===a.type?g.toP():g},d.prototype._wnafMulAdd=function(a,b,c,d){for(var e=this._wnafT1,f=this._wnafT2,g=this._wnafT3,h=0,k=0;k<d;k++){var l=b[k],m=l._getNAFPoints(a);e[k]=m.wnd,f[k]=m.points}for(var k=d-1;k>=1;k-=2){var n=k-1,o=k;if(1===e[n]&&1===e[o]){var p=[b[n],null,null,b[o]];0===b[n].y.cmp(b[o].y)?(p[1]=b[n].add(b[o]),p[2]=b[n].toJ().mixedAdd(b[o].neg())):0===b[n].y.cmp(b[o].y.redNeg())?(p[1]=b[n].toJ().mixedAdd(b[o]),p[2]=b[n].add(b[o].neg())):(p[1]=b[n].toJ().mixedAdd(b[o]),p[2]=b[n].toJ().mixedAdd(b[o].neg()));var q=[-3,-1,-5,-7,0,7,5,1,3],r=j(c[n],c[o]);h=Math.max(r[0].length,h),g[n]=new Array(h),g[o]=new Array(h);for(var s=0;s<h;s++){var t=0|r[0][s],u=0|r[1][s];g[n][s]=q[3*(t+1)+(u+1)],g[o][s]=0,f[n]=p}}else g[n]=i(c[n],e[n]),g[o]=i(c[o],e[o]),h=Math.max(g[n].length,h),h=Math.max(g[o].length,h)}for(var v=this.jpoint(null,null,null),w=this._wnafT4,k=h;k>=0;k--){for(var x=0;k>=0;){for(var y=!0,s=0;s<d;s++)w[s]=0|g[s][k],0!==w[s]&&(y=!1);if(!y)break;x++,k--}if(k>=0&&x++,v=v.dblp(x),k<0)break;for(var s=0;s<d;s++){var l,z=w[s];0!==z&&(z>0?l=f[s][z-1>>1]:z<0&&(l=f[s][-z-1>>1].neg()),v="affine"===l.type?v.mixedAdd(l):v.add(l))}}for(var k=0;k<d;k++)f[k]=null;return v.toP()},d.BasePoint=e,e.prototype.eq=function(){throw new Error("Not implemented")},e.prototype.validate=function(){return this.curve.validate(this)},d.prototype.decodePoint=function(a,b){a=h.toArray(a,b);var c=this.p.byteLength();if(4===a[0]&&a.length-1===2*c)return this.point(a.slice(1,1+c),a.slice(1+c,1+2*c));if((2===a[0]||3===a[0])&&a.length-1===c)return this.pointFromX(a.slice(1,1+c),3===a[0]);throw new Error("Unknown point format")},e.prototype.encodeCompressed=function(a){return this.encode(a,!0)},e.prototype._encode=function(a){var b=this.curve.p.byteLength(),c=this.getX().toArray("be",b);return a?[this.getY().isEven()?2:3].concat(c):[4].concat(c,this.getY().toArray("be",b))},e.prototype.encode=function(a,b){return h.encode(this._encode(b),a)},e.prototype.precompute=function(a){if(this.precomputed)return this;var b={doubles:null,naf:null,beta:null};return b.naf=this._getNAFPoints(8),b.doubles=this._getDoubles(4,a),b.beta=this._getBeta(),this.precomputed=b,this},e.prototype._hasDoubles=function(a){if(!this.precomputed)return!1;var b=this.precomputed.doubles;return!!b&&b.points.length>=Math.ceil((a.bitLength()+1)/b.step)},e.prototype._getDoubles=function(a,b){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var c=[this],d=this,e=0;e<b;e+=a){for(var f=0;f<a;f++)d=d.dbl();c.push(d)}return{step:a,points:c}},e.prototype._getNAFPoints=function(a){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var b=[this],c=(1<<a)-1,d=1===c?null:this.dbl(),e=1;e<c;e++)b[e]=b[e-1].add(d);return{wnd:a,points:b}},e.prototype._getBeta=function(){return null},e.prototype.dblp=function(a){for(var b=this,c=0;c<a;c++)b=b.dbl();return b}},{"../../elliptic":167,"bn.js":165}],169:[function(a,b,c){"use strict";function d(a){this.twisted=1!==(0|a.a),this.mOneA=this.twisted&&(0|a.a)===-1,this.extended=this.mOneA,j.call(this,"edwards",a),this.a=new h(a.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new h(a.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new h(a.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),k(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1===(0|a.c)}function e(a,b,c,d,e){j.BasePoint.call(this,a,"projective"),null===b&&null===c&&null===d?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new h(b,16),this.y=new h(c,16),this.z=d?new h(d,16):this.curve.one,this.t=e&&new h(e,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}var f=a("../curve"),g=a("../../elliptic"),h=a("bn.js"),i=a("inherits"),j=f.base,k=g.utils.assert;i(d,j),b.exports=d,d.prototype._mulA=function(a){return this.mOneA?a.redNeg():this.a.redMul(a)},d.prototype._mulC=function(a){return this.oneC?a:this.c.redMul(a)},d.prototype.jpoint=function(a,b,c,d){return this.point(a,b,c,d)},d.prototype.pointFromX=function(a,b){a=new h(a,16),a.red||(a=a.toRed(this.red));var c=a.redSqr(),d=this.c2.redSub(this.a.redMul(c)),e=this.one.redSub(this.c2.redMul(this.d).redMul(c)),f=d.redMul(e.redInvm()),g=f.redSqrt();if(0!==g.redSqr().redSub(f).cmp(this.zero))throw new Error("invalid point");var i=g.fromRed().isOdd();return(b&&!i||!b&&i)&&(g=g.redNeg()),this.point(a,g)},d.prototype.pointFromY=function(a,b){a=new h(a,16),a.red||(a=a.toRed(this.red));var c=a.redSqr(),d=c.redSub(this.one),e=c.redMul(this.d).redAdd(this.one),f=d.redMul(e.redInvm());if(0===f.cmp(this.zero)){if(b)throw new Error("invalid point");return this.point(this.zero,a)}var g=f.redSqrt();if(0!==g.redSqr().redSub(f).cmp(this.zero))throw new Error("invalid point");return g.isOdd()!==b&&(g=g.redNeg()),this.point(g,a)},d.prototype.validate=function(a){if(a.isInfinity())return!0;a.normalize();var b=a.x.redSqr(),c=a.y.redSqr(),d=b.redMul(this.a).redAdd(c),e=this.c2.redMul(this.one.redAdd(this.d.redMul(b).redMul(c)));return 0===d.cmp(e)},i(e,j.BasePoint),d.prototype.pointFromJSON=function(a){return e.fromJSON(this,a)},d.prototype.point=function(a,b,c,d){return new e(this,a,b,c,d)},e.fromJSON=function(a,b){return new e(a,b[0],b[1],b[2])},e.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},e.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},e.prototype._extDbl=function(){var a=this.x.redSqr(),b=this.y.redSqr(),c=this.z.redSqr();c=c.redIAdd(c);var d=this.curve._mulA(a),e=this.x.redAdd(this.y).redSqr().redISub(a).redISub(b),f=d.redAdd(b),g=f.redSub(c),h=d.redSub(b),i=e.redMul(g),j=f.redMul(h),k=e.redMul(h),l=g.redMul(f);return this.curve.point(i,j,l,k)},e.prototype._projDbl=function(){var a,b,c,d=this.x.redAdd(this.y).redSqr(),e=this.x.redSqr(),f=this.y.redSqr();if(this.curve.twisted){var g=this.curve._mulA(e),h=g.redAdd(f);if(this.zOne)a=d.redSub(e).redSub(f).redMul(h.redSub(this.curve.two)),b=h.redMul(g.redSub(f)),c=h.redSqr().redSub(h).redSub(h);else{var i=this.z.redSqr(),j=h.redSub(i).redISub(i);a=d.redSub(e).redISub(f).redMul(j),b=h.redMul(g.redSub(f)),c=h.redMul(j)}}else{var g=e.redAdd(f),i=this.curve._mulC(this.c.redMul(this.z)).redSqr(),j=g.redSub(i).redSub(i);a=this.curve._mulC(d.redISub(g)).redMul(j),b=this.curve._mulC(g).redMul(e.redISub(f)),c=g.redMul(j)}return this.curve.point(a,b,c)},e.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},e.prototype._extAdd=function(a){var b=this.y.redSub(this.x).redMul(a.y.redSub(a.x)),c=this.y.redAdd(this.x).redMul(a.y.redAdd(a.x)),d=this.t.redMul(this.curve.dd).redMul(a.t),e=this.z.redMul(a.z.redAdd(a.z)),f=c.redSub(b),g=e.redSub(d),h=e.redAdd(d),i=c.redAdd(b),j=f.redMul(g),k=h.redMul(i),l=f.redMul(i),m=g.redMul(h);return this.curve.point(j,k,m,l)},e.prototype._projAdd=function(a){var b,c,d=this.z.redMul(a.z),e=d.redSqr(),f=this.x.redMul(a.x),g=this.y.redMul(a.y),h=this.curve.d.redMul(f).redMul(g),i=e.redSub(h),j=e.redAdd(h),k=this.x.redAdd(this.y).redMul(a.x.redAdd(a.y)).redISub(f).redISub(g),l=d.redMul(i).redMul(k);return this.curve.twisted?(b=d.redMul(j).redMul(g.redSub(this.curve._mulA(f))),c=i.redMul(j)):(b=d.redMul(j).redMul(g.redSub(f)),c=this.curve._mulC(i).redMul(j)),this.curve.point(l,b,c)},e.prototype.add=function(a){return this.isInfinity()?a:a.isInfinity()?this:this.curve.extended?this._extAdd(a):this._projAdd(a)},e.prototype.mul=function(a){return this._hasDoubles(a)?this.curve._fixedNafMul(this,a):this.curve._wnafMul(this,a)},e.prototype.mulAdd=function(a,b,c){return this.curve._wnafMulAdd(1,[this,b],[a,c],2)},e.prototype.normalize=function(){if(this.zOne)return this;var a=this.z.redInvm();return this.x=this.x.redMul(a),this.y=this.y.redMul(a),this.t&&(this.t=this.t.redMul(a)),this.z=this.curve.one,this.zOne=!0,this},e.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},e.prototype.getX=function(){return this.normalize(),this.x.fromRed()},e.prototype.getY=function(){return this.normalize(),this.y.fromRed()},e.prototype.eq=function(a){return this===a||0===this.getX().cmp(a.getX())&&0===this.getY().cmp(a.getY())},e.prototype.toP=e.prototype.normalize,e.prototype.mixedAdd=e.prototype.add},{"../../elliptic":167,"../curve":170,"bn.js":165,inherits:326}],170:[function(a,b,c){"use strict";var d=c;d.base=a("./base"),d.short=a("./short"),d.mont=a("./mont"),d.edwards=a("./edwards")},{"./base":168,"./edwards":169,"./mont":171,"./short":172}],171:[function(a,b,c){"use strict";function d(a){i.call(this,"mont",a),this.a=new g(a.a,16).toRed(this.red),this.b=new g(a.b,16).toRed(this.red),this.i4=new g(4).toRed(this.red).redInvm(),this.two=new g(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function e(a,b,c){i.BasePoint.call(this,a,"projective"),null===b&&null===c?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new g(b,16),this.z=new g(c,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}var f=a("../curve"),g=a("bn.js"),h=a("inherits"),i=f.base,j=a("../../elliptic"),k=j.utils;h(d,i),b.exports=d,d.prototype.validate=function(a){var b=a.normalize().x,c=b.redSqr(),d=c.redMul(b).redAdd(c.redMul(this.a)).redAdd(b),e=d.redSqrt();return 0===e.redSqr().cmp(d)},h(e,i.BasePoint),d.prototype.decodePoint=function(a,b){return this.point(k.toArray(a,b),1)},d.prototype.point=function(a,b){return new e(this,a,b)},d.prototype.pointFromJSON=function(a){return e.fromJSON(this,a)},e.prototype.precompute=function(){},e.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},e.fromJSON=function(a,b){return new e(a,b[0],b[1]||a.one)},e.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},e.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},e.prototype.dbl=function(){var a=this.x.redAdd(this.z),b=a.redSqr(),c=this.x.redSub(this.z),d=c.redSqr(),e=b.redSub(d),f=b.redMul(d),g=e.redMul(d.redAdd(this.curve.a24.redMul(e)));return this.curve.point(f,g)},e.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},e.prototype.diffAdd=function(a,b){var c=this.x.redAdd(this.z),d=this.x.redSub(this.z),e=a.x.redAdd(a.z),f=a.x.redSub(a.z),g=f.redMul(c),h=e.redMul(d),i=b.z.redMul(g.redAdd(h).redSqr()),j=b.x.redMul(g.redISub(h).redSqr());return this.curve.point(i,j)},e.prototype.mul=function(a){for(var b=a.clone(),c=this,d=this.curve.point(null,null),e=this,f=[];0!==b.cmpn(0);b.iushrn(1))f.push(b.andln(1));for(var g=f.length-1;g>=0;g--)0===f[g]?(c=c.diffAdd(d,e),d=d.dbl()):(d=c.diffAdd(d,e),c=c.dbl());return d},e.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},e.prototype.eq=function(a){return 0===this.getX().cmp(a.getX())},e.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},e.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../../elliptic":167,"../curve":170,"bn.js":165,inherits:326}],172:[function(a,b,c){"use strict";function d(a){k.call(this,"short",a),this.a=new i(a.a,16).toRed(this.red),this.b=new i(a.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(a),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function e(a,b,c,d){k.BasePoint.call(this,a,"affine"),null===b&&null===c?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(b,16),this.y=new i(c,16),d&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function f(a,b,c,d){k.BasePoint.call(this,a,"jacobian"),null===b&&null===c&&null===d?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(b,16),this.y=new i(c,16),this.z=new i(d,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}var g=a("../curve"),h=a("../../elliptic"),i=a("bn.js"),j=a("inherits"),k=g.base,l=h.utils.assert;j(d,k),b.exports=d,d.prototype._getEndomorphism=function(a){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var b,c;if(a.beta)b=new i(a.beta,16).toRed(this.red);else{var d=this._getEndoRoots(this.p);b=d[0].cmp(d[1])<0?d[0]:d[1],b=b.toRed(this.red)}if(a.lambda)c=new i(a.lambda,16);else{var e=this._getEndoRoots(this.n);0===this.g.mul(e[0]).x.cmp(this.g.x.redMul(b))?c=e[0]:(c=e[1],l(0===this.g.mul(c).x.cmp(this.g.x.redMul(b))))}var f;return f=a.basis?a.basis.map(function(a){return{a:new i(a.a,16),b:new i(a.b,16)}}):this._getEndoBasis(c),{beta:b,lambda:c,basis:f}}},d.prototype._getEndoRoots=function(a){var b=a===this.p?this.red:i.mont(a),c=new i(2).toRed(b).redInvm(),d=c.redNeg(),e=new i(3).toRed(b).redNeg().redSqrt().redMul(c),f=d.redAdd(e).fromRed(),g=d.redSub(e).fromRed();return[f,g]},d.prototype._getEndoBasis=function(a){for(var b,c,d,e,f,g,h,j,k,l=this.n.ushrn(Math.floor(this.n.bitLength()/2)),m=a,n=this.n.clone(),o=new i(1),p=new i(0),q=new i(0),r=new i(1),s=0;0!==m.cmpn(0);){var t=n.div(m);j=n.sub(t.mul(m)),k=q.sub(t.mul(o));var u=r.sub(t.mul(p));if(!d&&j.cmp(l)<0)b=h.neg(),c=o,d=j.neg(),e=k;else if(d&&2===++s)break;h=j,n=m,m=j,q=o,o=k,r=p,p=u}f=j.neg(),g=k;var v=d.sqr().add(e.sqr()),w=f.sqr().add(g.sqr());return w.cmp(v)>=0&&(f=b,g=c),d.negative&&(d=d.neg(),e=e.neg()),f.negative&&(f=f.neg(),g=g.neg()),[{a:d,b:e},{a:f,b:g}]},d.prototype._endoSplit=function(a){var b=this.endo.basis,c=b[0],d=b[1],e=d.b.mul(a).divRound(this.n),f=c.b.neg().mul(a).divRound(this.n),g=e.mul(c.a),h=f.mul(d.a),i=e.mul(c.b),j=f.mul(d.b),k=a.sub(g).sub(h),l=i.add(j).neg();return{k1:k,k2:l}},d.prototype.pointFromX=function(a,b){a=new i(a,16),a.red||(a=a.toRed(this.red));var c=a.redSqr().redMul(a).redIAdd(a.redMul(this.a)).redIAdd(this.b),d=c.redSqrt();if(0!==d.redSqr().redSub(c).cmp(this.zero))throw new Error("invalid point");var e=d.fromRed().isOdd();return(b&&!e||!b&&e)&&(d=d.redNeg()),this.point(a,d)},d.prototype.validate=function(a){if(a.inf)return!0;var b=a.x,c=a.y,d=this.a.redMul(b),e=b.redSqr().redMul(b).redIAdd(d).redIAdd(this.b);return 0===c.redSqr().redISub(e).cmpn(0)},d.prototype._endoWnafMulAdd=function(a,b){for(var c=this._endoWnafT1,d=this._endoWnafT2,e=0;e<a.length;e++){var f=this._endoSplit(b[e]),g=a[e],h=g._getBeta();f.k1.negative&&(f.k1.ineg(),g=g.neg(!0)),f.k2.negative&&(f.k2.ineg(),h=h.neg(!0)),c[2*e]=g,c[2*e+1]=h,d[2*e]=f.k1,d[2*e+1]=f.k2}for(var i=this._wnafMulAdd(1,c,d,2*e),j=0;j<2*e;j++)c[j]=null,d[j]=null;return i},j(e,k.BasePoint),d.prototype.point=function(a,b,c){return new e(this,a,b,c)},d.prototype.pointFromJSON=function(a,b){return e.fromJSON(this,a,b)},e.prototype._getBeta=function(){if(this.curve.endo){var a=this.precomputed;if(a&&a.beta)return a.beta;var b=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(a){var c=this.curve,d=function(a){return c.point(a.x.redMul(c.endo.beta),a.y)};a.beta=b,b.precomputed={beta:null,naf:a.naf&&{wnd:a.naf.wnd,points:a.naf.points.map(d)},doubles:a.doubles&&{step:a.doubles.step,points:a.doubles.points.map(d)}}}return b}},e.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},e.fromJSON=function(a,b,c){function d(b){return a.point(b[0],b[1],c)}"string"==typeof b&&(b=JSON.parse(b));var e=a.point(b[0],b[1],c);if(!b[2])return e;var f=b[2];return e.precomputed={beta:null,doubles:f.doubles&&{step:f.doubles.step,points:[e].concat(f.doubles.points.map(d))},naf:f.naf&&{wnd:f.naf.wnd,points:[e].concat(f.naf.points.map(d))}},e},e.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},e.prototype.isInfinity=function(){return this.inf},e.prototype.add=function(a){if(this.inf)return a;if(a.inf)return this;if(this.eq(a))return this.dbl();if(this.neg().eq(a))return this.curve.point(null,null);if(0===this.x.cmp(a.x))return this.curve.point(null,null);var b=this.y.redSub(a.y);0!==b.cmpn(0)&&(b=b.redMul(this.x.redSub(a.x).redInvm()));var c=b.redSqr().redISub(this.x).redISub(a.x),d=b.redMul(this.x.redSub(c)).redISub(this.y);return this.curve.point(c,d)},e.prototype.dbl=function(){if(this.inf)return this;var a=this.y.redAdd(this.y);if(0===a.cmpn(0))return this.curve.point(null,null);var b=this.curve.a,c=this.x.redSqr(),d=a.redInvm(),e=c.redAdd(c).redIAdd(c).redIAdd(b).redMul(d),f=e.redSqr().redISub(this.x.redAdd(this.x)),g=e.redMul(this.x.redSub(f)).redISub(this.y);return this.curve.point(f,g)},e.prototype.getX=function(){return this.x.fromRed()},e.prototype.getY=function(){return this.y.fromRed()},e.prototype.mul=function(a){return a=new i(a,16),this._hasDoubles(a)?this.curve._fixedNafMul(this,a):this.curve.endo?this.curve._endoWnafMulAdd([this],[a]):this.curve._wnafMul(this,a)},e.prototype.mulAdd=function(a,b,c){var d=[this,b],e=[a,c];return this.curve.endo?this.curve._endoWnafMulAdd(d,e):this.curve._wnafMulAdd(1,d,e,2)},e.prototype.eq=function(a){return this===a||this.inf===a.inf&&(this.inf||0===this.x.cmp(a.x)&&0===this.y.cmp(a.y))},e.prototype.neg=function(a){if(this.inf)return this;var b=this.curve.point(this.x,this.y.redNeg());if(a&&this.precomputed){var c=this.precomputed,d=function(a){return a.neg()};b.precomputed={naf:c.naf&&{wnd:c.naf.wnd,points:c.naf.points.map(d)},doubles:c.doubles&&{step:c.doubles.step,points:c.doubles.points.map(d)}}}return b},e.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var a=this.curve.jpoint(this.x,this.y,this.curve.one);return a},j(f,k.BasePoint),d.prototype.jpoint=function(a,b,c){return new f(this,a,b,c)},f.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var a=this.z.redInvm(),b=a.redSqr(),c=this.x.redMul(b),d=this.y.redMul(b).redMul(a);return this.curve.point(c,d)},f.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},f.prototype.add=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var b=a.z.redSqr(),c=this.z.redSqr(),d=this.x.redMul(b),e=a.x.redMul(c),f=this.y.redMul(b.redMul(a.z)),g=a.y.redMul(c.redMul(this.z)),h=d.redSub(e),i=f.redSub(g);if(0===h.cmpn(0))return 0!==i.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var j=h.redSqr(),k=j.redMul(h),l=d.redMul(j),m=i.redSqr().redIAdd(k).redISub(l).redISub(l),n=i.redMul(l.redISub(m)).redISub(f.redMul(k)),o=this.z.redMul(a.z).redMul(h);return this.curve.jpoint(m,n,o)},f.prototype.mixedAdd=function(a){if(this.isInfinity())return a.toJ();if(a.isInfinity())return this;var b=this.z.redSqr(),c=this.x,d=a.x.redMul(b),e=this.y,f=a.y.redMul(b).redMul(this.z),g=c.redSub(d),h=e.redSub(f);if(0===g.cmpn(0))return 0!==h.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var i=g.redSqr(),j=i.redMul(g),k=c.redMul(i),l=h.redSqr().redIAdd(j).redISub(k).redISub(k),m=h.redMul(k.redISub(l)).redISub(e.redMul(j)),n=this.z.redMul(g);return this.curve.jpoint(l,m,n)},f.prototype.dblp=function(a){if(0===a)return this;if(this.isInfinity())return this;if(!a)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var b=this,c=0;c<a;c++)b=b.dbl();return b}for(var d=this.curve.a,e=this.curve.tinv,f=this.x,g=this.y,h=this.z,i=h.redSqr().redSqr(),j=g.redAdd(g),c=0;c<a;c++){var k=f.redSqr(),l=j.redSqr(),m=l.redSqr(),n=k.redAdd(k).redIAdd(k).redIAdd(d.redMul(i)),o=f.redMul(l),p=n.redSqr().redISub(o.redAdd(o)),q=o.redISub(p),r=n.redMul(q);r=r.redIAdd(r).redISub(m);var s=j.redMul(h);c+1<a&&(i=i.redMul(m)),f=p,h=s,j=r}return this.curve.jpoint(f,j.redMul(e),h)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},f.prototype._zeroDbl=function(){var a,b,c;if(this.zOne){var d=this.x.redSqr(),e=this.y.redSqr(),f=e.redSqr(),g=this.x.redAdd(e).redSqr().redISub(d).redISub(f);g=g.redIAdd(g);var h=d.redAdd(d).redIAdd(d),i=h.redSqr().redISub(g).redISub(g),j=f.redIAdd(f);j=j.redIAdd(j),j=j.redIAdd(j),a=i,b=h.redMul(g.redISub(i)).redISub(j),c=this.y.redAdd(this.y)}else{var k=this.x.redSqr(),l=this.y.redSqr(),m=l.redSqr(),n=this.x.redAdd(l).redSqr().redISub(k).redISub(m);n=n.redIAdd(n);var o=k.redAdd(k).redIAdd(k),p=o.redSqr(),q=m.redIAdd(m);q=q.redIAdd(q),q=q.redIAdd(q),a=p.redISub(n).redISub(n),b=o.redMul(n.redISub(a)).redISub(q),c=this.y.redMul(this.z),c=c.redIAdd(c)}return this.curve.jpoint(a,b,c)},f.prototype._threeDbl=function(){var a,b,c;if(this.zOne){var d=this.x.redSqr(),e=this.y.redSqr(),f=e.redSqr(),g=this.x.redAdd(e).redSqr().redISub(d).redISub(f);g=g.redIAdd(g);var h=d.redAdd(d).redIAdd(d).redIAdd(this.curve.a),i=h.redSqr().redISub(g).redISub(g);a=i;var j=f.redIAdd(f);j=j.redIAdd(j),j=j.redIAdd(j),b=h.redMul(g.redISub(i)).redISub(j),c=this.y.redAdd(this.y)}else{var k=this.z.redSqr(),l=this.y.redSqr(),m=this.x.redMul(l),n=this.x.redSub(k).redMul(this.x.redAdd(k));n=n.redAdd(n).redIAdd(n);var o=m.redIAdd(m);o=o.redIAdd(o);var p=o.redAdd(o);a=n.redSqr().redISub(p),c=this.y.redAdd(this.z).redSqr().redISub(l).redISub(k);var q=l.redSqr();q=q.redIAdd(q),q=q.redIAdd(q),q=q.redIAdd(q),b=n.redMul(o.redISub(a)).redISub(q)}return this.curve.jpoint(a,b,c)},f.prototype._dbl=function(){var a=this.curve.a,b=this.x,c=this.y,d=this.z,e=d.redSqr().redSqr(),f=b.redSqr(),g=c.redSqr(),h=f.redAdd(f).redIAdd(f).redIAdd(a.redMul(e)),i=b.redAdd(b);i=i.redIAdd(i);var j=i.redMul(g),k=h.redSqr().redISub(j.redAdd(j)),l=j.redISub(k),m=g.redSqr();m=m.redIAdd(m),m=m.redIAdd(m),m=m.redIAdd(m);var n=h.redMul(l).redISub(m),o=c.redAdd(c).redMul(d);return this.curve.jpoint(k,n,o)},f.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var a=this.x.redSqr(),b=this.y.redSqr(),c=this.z.redSqr(),d=b.redSqr(),e=a.redAdd(a).redIAdd(a),f=e.redSqr(),g=this.x.redAdd(b).redSqr().redISub(a).redISub(d);g=g.redIAdd(g),g=g.redAdd(g).redIAdd(g),g=g.redISub(f);var h=g.redSqr(),i=d.redIAdd(d);i=i.redIAdd(i),i=i.redIAdd(i),i=i.redIAdd(i);var j=e.redIAdd(g).redSqr().redISub(f).redISub(h).redISub(i),k=b.redMul(j);k=k.redIAdd(k),k=k.redIAdd(k);var l=this.x.redMul(h).redISub(k);l=l.redIAdd(l),l=l.redIAdd(l);var m=this.y.redMul(j.redMul(i.redISub(j)).redISub(g.redMul(h)));m=m.redIAdd(m),m=m.redIAdd(m),m=m.redIAdd(m);var n=this.z.redAdd(g).redSqr().redISub(c).redISub(h);return this.curve.jpoint(l,m,n)},f.prototype.mul=function(a,b){return a=new i(a,b),this.curve._wnafMul(this,a)},f.prototype.eq=function(a){if("affine"===a.type)return this.eq(a.toJ());if(this===a)return!0;var b=this.z.redSqr(),c=a.z.redSqr();if(0!==this.x.redMul(c).redISub(a.x.redMul(b)).cmpn(0))return!1;var d=b.redMul(this.z),e=c.redMul(a.z);return 0===this.y.redMul(e).redISub(a.y.redMul(d)).cmpn(0)},f.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},f.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},{"../../elliptic":167,"../curve":170,"bn.js":165,inherits:326}],173:[function(a,b,c){"use strict";function d(a){"short"===a.type?this.curve=new h.curve.short(a):"edwards"===a.type?this.curve=new h.curve.edwards(a):this.curve=new h.curve.mont(a),this.g=this.curve.g,this.n=this.curve.n,this.hash=a.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function e(a,b){Object.defineProperty(f,a,{configurable:!0,enumerable:!0,get:function(){var c=new d(b);return Object.defineProperty(f,a,{configurable:!0,enumerable:!0,value:c}),c}})}var f=c,g=a("hash.js"),h=a("../elliptic"),i=h.utils.assert;f.PresetCurve=d,e("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:g.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),e("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:g.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),e("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:g.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),e("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:g.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),e("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:g.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),e("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"0",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:g.sha256,gRed:!1,g:["9"]}),e("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:g.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var j;try{j=a("./precomputed/secp256k1")}catch(a){j=void 0}e("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:g.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",j]})},{"../elliptic":167,"./precomputed/secp256k1":181,"hash.js":184}],174:[function(a,b,c){"use strict";function d(a){return this instanceof d?("string"==typeof a&&(h(f.curves.hasOwnProperty(a),"Unknown curve "+a),a=f.curves[a]),a instanceof f.curves.PresetCurve&&(a={curve:a}),this.curve=a.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=a.curve.g,this.g.precompute(a.curve.n.bitLength()+1),void(this.hash=a.hash||a.curve.hash)):new d(a)}var e=a("bn.js"),f=a("../../elliptic"),g=f.utils,h=g.assert,i=a("./key"),j=a("./signature");b.exports=d,d.prototype.keyPair=function(a){return new i(this,a)},d.prototype.keyFromPrivate=function(a,b){return i.fromPrivate(this,a,b)},d.prototype.keyFromPublic=function(a,b){return i.fromPublic(this,a,b)},d.prototype.genKeyPair=function(a){a||(a={});for(var b=new f.hmacDRBG({hash:this.hash,pers:a.pers,entropy:a.entropy||f.rand(this.hash.hmacStrength),nonce:this.n.toArray()}),c=this.n.byteLength(),d=this.n.sub(new e(2));;){var g=new e(b.generate(c));if(!(g.cmp(d)>0))return g.iaddn(1),this.keyFromPrivate(g)}},d.prototype._truncateToN=function(a,b){var c=8*a.byteLength()-this.n.bitLength();return c>0&&(a=a.ushrn(c)),!b&&a.cmp(this.n)>=0?a.sub(this.n):a},d.prototype.sign=function(a,b,c,d){"object"==typeof c&&(d=c,c=null),d||(d={}),b=this.keyFromPrivate(b,c),a=this._truncateToN(new e(a,16));for(var g=this.n.byteLength(),h=b.getPrivate().toArray("be",g),i=a.toArray("be",g),k=new f.hmacDRBG({hash:this.hash,entropy:h,nonce:i,pers:d.pers,persEnc:d.persEnc}),l=this.n.sub(new e(1)),m=0;!0;m++){var n=d.k?d.k(m):new e(k.generate(this.n.byteLength()));if(n=this._truncateToN(n,!0),!(n.cmpn(1)<=0||n.cmp(l)>=0)){var o=this.g.mul(n);if(!o.isInfinity()){var p=o.getX(),q=p.umod(this.n);if(0!==q.cmpn(0)){var r=n.invm(this.n).mul(q.mul(b.getPrivate()).iadd(a));if(r=r.umod(this.n),0!==r.cmpn(0)){var s=(o.getY().isOdd()?1:0)|(0!==p.cmp(q)?2:0);return d.canonical&&r.cmp(this.nh)>0&&(r=this.n.sub(r),s^=1),new j({r:q,s:r,recoveryParam:s})}}}}}},d.prototype.verify=function(a,b,c,d){a=this._truncateToN(new e(a,16)),c=this.keyFromPublic(c,d),b=new j(b,"hex");var f=b.r,g=b.s;if(f.cmpn(1)<0||f.cmp(this.n)>=0)return!1;if(g.cmpn(1)<0||g.cmp(this.n)>=0)return!1;var h=g.invm(this.n),i=h.mul(a).umod(this.n),k=h.mul(f).umod(this.n),l=this.g.mulAdd(i,c.getPublic(),k);return!l.isInfinity()&&0===l.getX().umod(this.n).cmp(f)},d.prototype.recoverPubKey=function(a,b,c,d){h((3&c)===c,"The recovery param is more than two bits"),b=new j(b,d);var f=this.n,g=new e(a),i=b.r,k=b.s,l=1&c,m=c>>1;if(i.cmp(this.curve.p.umod(this.curve.n))>=0&&m)throw new Error("Unable to find sencond key candinate");
i=m?this.curve.pointFromX(i.add(this.curve.n),l):this.curve.pointFromX(i,l);var n=f.sub(g),o=b.r.invm(f);return this.g.mulAdd(n,i,k).mul(o)},d.prototype.getKeyRecoveryParam=function(a,b,c,d){if(b=new j(b,d),null!==b.recoveryParam)return b.recoveryParam;for(var e=0;e<4;e++){var f;try{f=this.recoverPubKey(a,b,e)}catch(a){continue}if(f.eq(c))return e}throw new Error("Unable to find valid recovery factor")}},{"../../elliptic":167,"./key":175,"./signature":176,"bn.js":165}],175:[function(a,b,c){"use strict";function d(a,b){this.ec=a,this.priv=null,this.pub=null,b.priv&&this._importPrivate(b.priv,b.privEnc),b.pub&&this._importPublic(b.pub,b.pubEnc)}var e=a("bn.js");b.exports=d,d.fromPublic=function(a,b,c){return b instanceof d?b:new d(a,{pub:b,pubEnc:c})},d.fromPrivate=function(a,b,c){return b instanceof d?b:new d(a,{priv:b,privEnc:c})},d.prototype.validate=function(){var a=this.getPublic();return a.isInfinity()?{result:!1,reason:"Invalid public key"}:a.validate()?a.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},d.prototype.getPublic=function(a,b){return"string"==typeof a&&(b=a,a=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),b?this.pub.encode(b,a):this.pub},d.prototype.getPrivate=function(a){return"hex"===a?this.priv.toString(16,2):this.priv},d.prototype._importPrivate=function(a,b){this.priv=new e(a,b||16),this.priv=this.priv.umod(this.ec.curve.n)},d.prototype._importPublic=function(a,b){return a.x||a.y?void(this.pub=this.ec.curve.point(a.x,a.y)):void(this.pub=this.ec.curve.decodePoint(a,b))},d.prototype.derive=function(a){return a.mul(this.priv).getX()},d.prototype.sign=function(a,b,c){return this.ec.sign(a,this,b,c)},d.prototype.verify=function(a,b){return this.ec.verify(a,b,this)},d.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"bn.js":165}],176:[function(a,b,c){"use strict";function d(a,b){return a instanceof d?a:void(this._importDER(a,b)||(l(a.r&&a.s,"Signature without r or s"),this.r=new i(a.r,16),this.s=new i(a.s,16),void 0===a.recoveryParam?this.recoveryParam=null:this.recoveryParam=a.recoveryParam))}function e(){this.place=0}function f(a,b){var c=a[b.place++];if(!(128&c))return c;for(var d=15&c,e=0,f=0,g=b.place;f<d;f++,g++)e<<=8,e|=a[g];return b.place=g,e}function g(a){for(var b=0,c=a.length-1;!a[b]&&!(128&a[b+1])&&b<c;)b++;return 0===b?a:a.slice(b)}function h(a,b){if(b<128)return void a.push(b);var c=1+(Math.log(b)/Math.LN2>>>3);for(a.push(128|c);--c;)a.push(b>>>(c<<3)&255);a.push(b)}var i=a("bn.js"),j=a("../../elliptic"),k=j.utils,l=k.assert;b.exports=d,d.prototype._importDER=function(a,b){a=k.toArray(a,b);var c=new e;if(48!==a[c.place++])return!1;var d=f(a,c);if(d+c.place!==a.length)return!1;if(2!==a[c.place++])return!1;var g=f(a,c),h=a.slice(c.place,g+c.place);if(c.place+=g,2!==a[c.place++])return!1;var j=f(a,c);if(a.length!==j+c.place)return!1;var l=a.slice(c.place,j+c.place);return 0===h[0]&&128&h[1]&&(h=h.slice(1)),0===l[0]&&128&l[1]&&(l=l.slice(1)),this.r=new i(h),this.s=new i(l),this.recoveryParam=null,!0},d.prototype.toDER=function(a){var b=this.r.toArray(),c=this.s.toArray();for(128&b[0]&&(b=[0].concat(b)),128&c[0]&&(c=[0].concat(c)),b=g(b),c=g(c);!(c[0]||128&c[1]);)c=c.slice(1);var d=[2];h(d,b.length),d=d.concat(b),d.push(2),h(d,c.length);var e=d.concat(c),f=[48];return h(f,e.length),f=f.concat(e),k.encode(f,a)}},{"../../elliptic":167,"bn.js":165}],177:[function(a,b,c){"use strict";function d(a){if(h("ed25519"===a,"only tested with ed25519 so far"),!(this instanceof d))return new d(a);var a=f.curves[a].curve;this.curve=a,this.g=a.g,this.g.precompute(a.n.bitLength()+1),this.pointClass=a.point().constructor,this.encodingLength=Math.ceil(a.n.bitLength()/8),this.hash=e.sha512}var e=a("hash.js"),f=a("../../elliptic"),g=f.utils,h=g.assert,i=g.parseBytes,j=a("./key"),k=a("./signature");b.exports=d,d.prototype.sign=function(a,b){a=i(a);var c=this.keyFromSecret(b),d=this.hashInt(c.messagePrefix(),a),e=this.g.mul(d),f=this.encodePoint(e),g=this.hashInt(f,c.pubBytes(),a).mul(c.priv()),h=d.add(g).umod(this.curve.n);return this.makeSignature({R:e,S:h,Rencoded:f})},d.prototype.verify=function(a,b,c){a=i(a),b=this.makeSignature(b);var d=this.keyFromPublic(c),e=this.hashInt(b.Rencoded(),d.pubBytes(),a),f=this.g.mul(b.S()),g=b.R().add(d.pub().mul(e));return g.eq(f)},d.prototype.hashInt=function(){for(var a=this.hash(),b=0;b<arguments.length;b++)a.update(arguments[b]);return g.intFromLE(a.digest()).umod(this.curve.n)},d.prototype.keyFromPublic=function(a){return j.fromPublic(this,a)},d.prototype.keyFromSecret=function(a){return j.fromSecret(this,a)},d.prototype.makeSignature=function(a){return a instanceof k?a:new k(this,a)},d.prototype.encodePoint=function(a){var b=a.getY().toArray("le",this.encodingLength);return b[this.encodingLength-1]|=a.getX().isOdd()?128:0,b},d.prototype.decodePoint=function(a){a=g.parseBytes(a);var b=a.length-1,c=a.slice(0,b).concat(a[b]&-129),d=0!==(128&a[b]),e=g.intFromLE(c);return this.curve.pointFromY(e,d)},d.prototype.encodeInt=function(a){return a.toArray("le",this.encodingLength)},d.prototype.decodeInt=function(a){return g.intFromLE(a)},d.prototype.isPoint=function(a){return a instanceof this.pointClass}},{"../../elliptic":167,"./key":178,"./signature":179,"hash.js":184}],178:[function(a,b,c){"use strict";function d(a,b){this.eddsa=a,this._secret=h(b.secret),a.isPoint(b.pub)?this._pub=b.pub:this._pubBytes=h(b.pub)}var e=a("../../elliptic"),f=e.utils,g=f.assert,h=f.parseBytes,i=f.cachedProperty;d.fromPublic=function(a,b){return b instanceof d?b:new d(a,{pub:b})},d.fromSecret=function(a,b){return b instanceof d?b:new d(a,{secret:b})},d.prototype.secret=function(){return this._secret},i(d,function(){return this.eddsa.encodePoint(this.pub())}),i(d,function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),i(d,function(){var a=this.eddsa,b=this.hash(),c=a.encodingLength-1,d=b.slice(0,a.encodingLength);return d[0]&=248,d[c]&=127,d[c]|=64,d}),i(d,function(){return this.eddsa.decodeInt(this.privBytes())}),i(d,function(){return this.eddsa.hash().update(this.secret()).digest()}),i(d,function(){return this.hash().slice(this.eddsa.encodingLength)}),d.prototype.sign=function(a){return g(this._secret,"KeyPair can only verify"),this.eddsa.sign(a,this)},d.prototype.verify=function(a,b){return this.eddsa.verify(a,b,this)},d.prototype.getSecret=function(a){return g(this._secret,"KeyPair is public only"),f.encode(this.secret(),a)},d.prototype.getPublic=function(a){return f.encode(this.pubBytes(),a)},b.exports=d},{"../../elliptic":167}],179:[function(a,b,c){"use strict";function d(a,b){this.eddsa=a,"object"!=typeof b&&(b=j(b)),Array.isArray(b)&&(b={R:b.slice(0,a.encodingLength),S:b.slice(a.encodingLength)}),h(b.R&&b.S,"Signature without R or S"),a.isPoint(b.R)&&(this._R=b.R),b.S instanceof e&&(this._S=b.S),this._Rencoded=Array.isArray(b.R)?b.R:b.Rencoded,this._Sencoded=Array.isArray(b.S)?b.S:b.Sencoded}var e=a("bn.js"),f=a("../../elliptic"),g=f.utils,h=g.assert,i=g.cachedProperty,j=g.parseBytes;i(d,function(){return this.eddsa.decodeInt(this.Sencoded())}),i(d,function(){return this.eddsa.decodePoint(this.Rencoded())}),i(d,function(){return this.eddsa.encodePoint(this.R())}),i(d,function(){return this.eddsa.encodeInt(this.S())}),d.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},d.prototype.toHex=function(){return g.encode(this.toBytes(),"hex").toUpperCase()},b.exports=d},{"../../elliptic":167,"bn.js":165}],180:[function(a,b,c){"use strict";function d(a){if(!(this instanceof d))return new d(a);this.hash=a.hash,this.predResist=!!a.predResist,this.outLen=this.hash.outSize,this.minEntropy=a.minEntropy||this.hash.hmacStrength,this.reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var b=g.toArray(a.entropy,a.entropyEnc),c=g.toArray(a.nonce,a.nonceEnc),e=g.toArray(a.pers,a.persEnc);h(b.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(b,c,e)}var e=a("hash.js"),f=a("../elliptic"),g=f.utils,h=g.assert;b.exports=d,d.prototype._init=function(a,b,c){var d=a.concat(b).concat(c);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var e=0;e<this.V.length;e++)this.K[e]=0,this.V[e]=1;this._update(d),this.reseed=1,this.reseedInterval=281474976710656},d.prototype._hmac=function(){return new e.hmac(this.hash,this.K)},d.prototype._update=function(a){var b=this._hmac().update(this.V).update([0]);a&&(b=b.update(a)),this.K=b.digest(),this.V=this._hmac().update(this.V).digest(),a&&(this.K=this._hmac().update(this.V).update([1]).update(a).digest(),this.V=this._hmac().update(this.V).digest())},d.prototype.reseed=function(a,b,c,d){"string"!=typeof b&&(d=c,c=b,b=null),a=g.toBuffer(a,b),c=g.toBuffer(c,d),h(a.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(a.concat(c||[])),this.reseed=1},d.prototype.generate=function(a,b,c,d){if(this.reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof b&&(d=c,c=b,b=null),c&&(c=g.toArray(c,d),this._update(c));for(var e=[];e.length<a;)this.V=this._hmac().update(this.V).digest(),e=e.concat(this.V);var f=e.slice(0,a);return this._update(c),this.reseed++,g.encode(f,b)}},{"../elliptic":167,"hash.js":184}],181:[function(a,b,c){b.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]
}}},{}],182:[function(a,b,c){"use strict";function d(a,b){if(Array.isArray(a))return a.slice();if(!a)return[];var c=[];if("string"!=typeof a){for(var d=0;d<a.length;d++)c[d]=0|a[d];return c}if(b){if("hex"===b){a=a.replace(/[^a-z0-9]+/gi,""),a.length%2!==0&&(a="0"+a);for(var d=0;d<a.length;d+=2)c.push(parseInt(a[d]+a[d+1],16))}}else for(var d=0;d<a.length;d++){var e=a.charCodeAt(d),f=e>>8,g=255&e;f?c.push(f,g):c.push(g)}return c}function e(a){return 1===a.length?"0"+a:a}function f(a){for(var b="",c=0;c<a.length;c++)b+=e(a[c].toString(16));return b}function g(a,b){for(var c=[],d=1<<b+1,e=a.clone();e.cmpn(1)>=0;){var f;if(e.isOdd()){var g=e.andln(d-1);f=g>(d>>1)-1?(d>>1)-g:g,e.isubn(f)}else f=0;c.push(f);for(var h=0!==e.cmpn(0)&&0===e.andln(d-1)?b+1:1,i=1;i<h;i++)c.push(0);e.iushrn(h)}return c}function h(a,b){var c=[[],[]];a=a.clone(),b=b.clone();for(var d=0,e=0;a.cmpn(-d)>0||b.cmpn(-e)>0;){var f=a.andln(3)+d&3,g=b.andln(3)+e&3;3===f&&(f=-1),3===g&&(g=-1);var h;if(0===(1&f))h=0;else{var i=a.andln(7)+d&7;h=3!==i&&5!==i||2!==g?f:-f}c[0].push(h);var j;if(0===(1&g))j=0;else{var i=b.andln(7)+e&7;j=3!==i&&5!==i||2!==f?g:-g}c[1].push(j),2*d===h+1&&(d=1-d),2*e===j+1&&(e=1-e),a.iushrn(1),b.iushrn(1)}return c}function i(a,b){var c=b.name,d="_"+c;a.prototype[c]=function(){return void 0!==this[d]?this[d]:this[d]=b.call(this)}}function j(a){return"string"==typeof a?l.toArray(a,"hex"):a}function k(a){return new m(a,"hex","le")}var l=c,m=a("bn.js");l.assert=function(a,b){if(!a)throw new Error(b||"Assertion failed")},l.toArray=d,l.zero2=e,l.toHex=f,l.encode=function(a,b){return"hex"===b?f(a):a},l.getNAF=g,l.getJSF=h,l.cachedProperty=i,l.parseBytes=j,l.intFromLE=k},{"bn.js":165}],183:[function(a,b,c){function d(a){this.rand=a}var e;if(b.exports=function(a){return e||(e=new d(null)),e.generate(a)},b.exports.Rand=d,d.prototype.generate=function(a){return this._rand(a)},"object"==typeof window)window.crypto&&window.crypto.getRandomValues?d.prototype._rand=function(a){var b=new Uint8Array(a);return window.crypto.getRandomValues(b),b}:window.msCrypto&&window.msCrypto.getRandomValues?d.prototype._rand=function(a){var b=new Uint8Array(a);return window.msCrypto.getRandomValues(b),b}:d.prototype._rand=function(){throw new Error("Not implemented yet")};else try{var f=a("crypto");d.prototype._rand=function(a){return f.randomBytes(a)}}catch(a){d.prototype._rand=function(a){for(var b=new Uint8Array(a),c=0;c<b.length;c++)b[c]=this.rand.getByte();return b}}},{}],184:[function(a,b,c){var d=c;d.utils=a("./hash/utils"),d.common=a("./hash/common"),d.sha=a("./hash/sha"),d.ripemd=a("./hash/ripemd"),d.hmac=a("./hash/hmac"),d.sha1=d.sha.sha1,d.sha256=d.sha.sha256,d.sha224=d.sha.sha224,d.sha384=d.sha.sha384,d.sha512=d.sha.sha512,d.ripemd160=d.ripemd.ripemd160},{"./hash/common":185,"./hash/hmac":186,"./hash/ripemd":187,"./hash/sha":188,"./hash/utils":189}],185:[function(a,b,c){function d(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var e=a("../hash"),f=e.utils,g=f.assert;c.BlockHash=d,d.prototype.update=function(a,b){if(a=f.toArray(a,b),this.pending?this.pending=this.pending.concat(a):this.pending=a,this.pendingTotal+=a.length,this.pending.length>=this._delta8){a=this.pending;var c=a.length%this._delta8;this.pending=a.slice(a.length-c,a.length),0===this.pending.length&&(this.pending=null),a=f.join32(a,0,a.length-c,this.endian);for(var d=0;d<a.length;d+=this._delta32)this._update(a,d,d+this._delta32)}return this},d.prototype.digest=function(a){return this.update(this._pad()),g(null===this.pending),this._digest(a)},d.prototype._pad=function(){var a=this.pendingTotal,b=this._delta8,c=b-(a+this.padLength)%b,d=new Array(c+this.padLength);d[0]=128;for(var e=1;e<c;e++)d[e]=0;if(a<<=3,"big"===this.endian){for(var f=8;f<this.padLength;f++)d[e++]=0;d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=a>>>24&255,d[e++]=a>>>16&255,d[e++]=a>>>8&255,d[e++]=255&a}else{d[e++]=255&a,d[e++]=a>>>8&255,d[e++]=a>>>16&255,d[e++]=a>>>24&255,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=0;for(var f=8;f<this.padLength;f++)d[e++]=0}return d}},{"../hash":184}],186:[function(a,b,c){function d(a,b,c){return this instanceof d?(this.Hash=a,this.blockSize=a.blockSize/8,this.outSize=a.outSize/8,this.inner=null,this.outer=null,void this._init(f.toArray(b,c))):new d(a,b,c)}var e=a("../hash"),f=e.utils,g=f.assert;b.exports=d,d.prototype._init=function(a){a.length>this.blockSize&&(a=(new this.Hash).update(a).digest()),g(a.length<=this.blockSize);for(var b=a.length;b<this.blockSize;b++)a.push(0);for(var b=0;b<a.length;b++)a[b]^=54;this.inner=(new this.Hash).update(a);for(var b=0;b<a.length;b++)a[b]^=106;this.outer=(new this.Hash).update(a)},d.prototype.update=function(a,b){return this.inner.update(a,b),this},d.prototype.digest=function(a){return this.outer.update(this.inner.digest()),this.outer.digest(a)}},{"../hash":184}],187:[function(a,b,c){function d(){return this instanceof d?(n.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.endian="little")):new d}function e(a,b,c,d){return a<=15?b^c^d:a<=31?b&c|~b&d:a<=47?(b|~c)^d:a<=63?b&d|c&~d:b^(c|~d)}function f(a){return a<=15?0:a<=31?1518500249:a<=47?1859775393:a<=63?2400959708:2840853838}function g(a){return a<=15?1352829926:a<=31?1548603684:a<=47?1836072691:a<=63?2053994217:0}var h=a("../hash"),i=h.utils,j=i.rotl32,k=i.sum32,l=i.sum32_3,m=i.sum32_4,n=h.common.BlockHash;i.inherits(d,n),c.ripemd160=d,d.blockSize=512,d.outSize=160,d.hmacStrength=192,d.padLength=64,d.prototype._update=function(a,b){for(var c=this.h[0],d=this.h[1],h=this.h[2],i=this.h[3],n=this.h[4],s=c,t=d,u=h,v=i,w=n,x=0;x<80;x++){var y=k(j(m(c,e(x,d,h,i),a[o[x]+b],f(x)),q[x]),n);c=n,n=i,i=j(h,10),h=d,d=y,y=k(j(m(s,e(79-x,t,u,v),a[p[x]+b],g(x)),r[x]),w),s=w,w=v,v=j(u,10),u=t,t=y}y=l(this.h[1],h,v),this.h[1]=l(this.h[2],i,w),this.h[2]=l(this.h[3],n,s),this.h[3]=l(this.h[4],c,t),this.h[4]=l(this.h[0],d,u),this.h[0]=y},d.prototype._digest=function(a){return"hex"===a?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],q=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],r=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"../hash":184}],188:[function(a,b,c){function d(){return this instanceof d?(V.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=W,void(this.W=new Array(64))):new d}function e(){return this instanceof e?(d.call(this),void(this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])):new e}function f(){return this instanceof f?(V.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=X,void(this.W=new Array(160))):new f}function g(){return this instanceof g?(f.call(this),void(this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428])):new g}function h(){return this instanceof h?(V.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.W=new Array(80))):new h}function i(a,b,c){return a&b^~a&c}function j(a,b,c){return a&b^a&c^b&c}function k(a,b,c){return a^b^c}function l(a){return F(a,2)^F(a,13)^F(a,22)}function m(a){return F(a,6)^F(a,11)^F(a,25)}function n(a){return F(a,7)^F(a,18)^a>>>3}function o(a){return F(a,17)^F(a,19)^a>>>10}function p(a,b,c,d){return 0===a?i(b,c,d):1===a||3===a?k(b,c,d):2===a?j(b,c,d):void 0}function q(a,b,c,d,e,f){var g=a&c^~a&e;return g<0&&(g+=4294967296),g}function r(a,b,c,d,e,f){var g=b&d^~b&f;return g<0&&(g+=4294967296),g}function s(a,b,c,d,e,f){var g=a&c^a&e^c&e;return g<0&&(g+=4294967296),g}function t(a,b,c,d,e,f){var g=b&d^b&f^d&f;return g<0&&(g+=4294967296),g}function u(a,b){var c=K(a,b,28),d=K(b,a,2),e=K(b,a,7),f=c^d^e;return f<0&&(f+=4294967296),f}function v(a,b){var c=L(a,b,28),d=L(b,a,2),e=L(b,a,7),f=c^d^e;return f<0&&(f+=4294967296),f}function w(a,b){var c=K(a,b,14),d=K(a,b,18),e=K(b,a,9),f=c^d^e;return f<0&&(f+=4294967296),f}function x(a,b){var c=L(a,b,14),d=L(a,b,18),e=L(b,a,9),f=c^d^e;return f<0&&(f+=4294967296),f}function y(a,b){var c=K(a,b,1),d=K(a,b,8),e=M(a,b,7),f=c^d^e;return f<0&&(f+=4294967296),f}function z(a,b){var c=L(a,b,1),d=L(a,b,8),e=N(a,b,7),f=c^d^e;return f<0&&(f+=4294967296),f}function A(a,b){var c=K(a,b,19),d=K(b,a,29),e=M(a,b,6),f=c^d^e;return f<0&&(f+=4294967296),f}function B(a,b){var c=L(a,b,19),d=L(b,a,29),e=N(a,b,6),f=c^d^e;return f<0&&(f+=4294967296),f}var C=a("../hash"),D=C.utils,E=D.assert,F=D.rotr32,G=D.rotl32,H=D.sum32,I=D.sum32_4,J=D.sum32_5,K=D.rotr64_hi,L=D.rotr64_lo,M=D.shr64_hi,N=D.shr64_lo,O=D.sum64,P=D.sum64_hi,Q=D.sum64_lo,R=D.sum64_4_hi,S=D.sum64_4_lo,T=D.sum64_5_hi,U=D.sum64_5_lo,V=C.common.BlockHash,W=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],X=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],Y=[1518500249,1859775393,2400959708,3395469782];D.inherits(d,V),c.sha256=d,d.blockSize=512,d.outSize=256,d.hmacStrength=192,d.padLength=64,d.prototype._update=function(a,b){for(var c=this.W,d=0;d<16;d++)c[d]=a[b+d];for(;d<c.length;d++)c[d]=I(o(c[d-2]),c[d-7],n(c[d-15]),c[d-16]);var e=this.h[0],f=this.h[1],g=this.h[2],h=this.h[3],k=this.h[4],p=this.h[5],q=this.h[6],r=this.h[7];E(this.k.length===c.length);for(var d=0;d<c.length;d++){var s=J(r,m(k),i(k,p,q),this.k[d],c[d]),t=H(l(e),j(e,f,g));r=q,q=p,p=k,k=H(h,s),h=g,g=f,f=e,e=H(s,t)}this.h[0]=H(this.h[0],e),this.h[1]=H(this.h[1],f),this.h[2]=H(this.h[2],g),this.h[3]=H(this.h[3],h),this.h[4]=H(this.h[4],k),this.h[5]=H(this.h[5],p),this.h[6]=H(this.h[6],q),this.h[7]=H(this.h[7],r)},d.prototype._digest=function(a){return"hex"===a?D.toHex32(this.h,"big"):D.split32(this.h,"big")},D.inherits(e,d),c.sha224=e,e.blockSize=512,e.outSize=224,e.hmacStrength=192,e.padLength=64,e.prototype._digest=function(a){return"hex"===a?D.toHex32(this.h.slice(0,7),"big"):D.split32(this.h.slice(0,7),"big")},D.inherits(f,V),c.sha512=f,f.blockSize=1024,f.outSize=512,f.hmacStrength=192,f.padLength=128,f.prototype._prepareBlock=function(a,b){for(var c=this.W,d=0;d<32;d++)c[d]=a[b+d];for(;d<c.length;d+=2){var e=A(c[d-4],c[d-3]),f=B(c[d-4],c[d-3]),g=c[d-14],h=c[d-13],i=y(c[d-30],c[d-29]),j=z(c[d-30],c[d-29]),k=c[d-32],l=c[d-31];c[d]=R(e,f,g,h,i,j,k,l),c[d+1]=S(e,f,g,h,i,j,k,l)}},f.prototype._update=function(a,b){this._prepareBlock(a,b);var c=this.W,d=this.h[0],e=this.h[1],f=this.h[2],g=this.h[3],h=this.h[4],i=this.h[5],j=this.h[6],k=this.h[7],l=this.h[8],m=this.h[9],n=this.h[10],o=this.h[11],p=this.h[12],y=this.h[13],z=this.h[14],A=this.h[15];E(this.k.length===c.length);for(var B=0;B<c.length;B+=2){var C=z,D=A,F=w(l,m),G=x(l,m),H=q(l,m,n,o,p,y),I=r(l,m,n,o,p,y),J=this.k[B],K=this.k[B+1],L=c[B],M=c[B+1],N=T(C,D,F,G,H,I,J,K,L,M),R=U(C,D,F,G,H,I,J,K,L,M),C=u(d,e),D=v(d,e),F=s(d,e,f,g,h,i),G=t(d,e,f,g,h,i),S=P(C,D,F,G),V=Q(C,D,F,G);z=p,A=y,p=n,y=o,n=l,o=m,l=P(j,k,N,R),m=Q(k,k,N,R),j=h,k=i,h=f,i=g,f=d,g=e,d=P(N,R,S,V),e=Q(N,R,S,V)}O(this.h,0,d,e),O(this.h,2,f,g),O(this.h,4,h,i),O(this.h,6,j,k),O(this.h,8,l,m),O(this.h,10,n,o),O(this.h,12,p,y),O(this.h,14,z,A)},f.prototype._digest=function(a){return"hex"===a?D.toHex32(this.h,"big"):D.split32(this.h,"big")},D.inherits(g,f),c.sha384=g,g.blockSize=1024,g.outSize=384,g.hmacStrength=192,g.padLength=128,g.prototype._digest=function(a){return"hex"===a?D.toHex32(this.h.slice(0,12),"big"):D.split32(this.h.slice(0,12),"big")},D.inherits(h,V),c.sha1=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(a,b){for(var c=this.W,d=0;d<16;d++)c[d]=a[b+d];for(;d<c.length;d++)c[d]=G(c[d-3]^c[d-8]^c[d-14]^c[d-16],1);for(var e=this.h[0],f=this.h[1],g=this.h[2],h=this.h[3],i=this.h[4],d=0;d<c.length;d++){var j=~~(d/20),k=J(G(e,5),p(j,f,g,h),i,c[d],Y[j]);i=h,h=g,g=G(f,30),f=e,e=k}this.h[0]=H(this.h[0],e),this.h[1]=H(this.h[1],f),this.h[2]=H(this.h[2],g),this.h[3]=H(this.h[3],h),this.h[4]=H(this.h[4],i)},h.prototype._digest=function(a){return"hex"===a?D.toHex32(this.h,"big"):D.split32(this.h,"big")}},{"../hash":184}],189:[function(a,b,c){function d(a,b){if(Array.isArray(a))return a.slice();if(!a)return[];var c=[];if("string"==typeof a)if(b){if("hex"===b){a=a.replace(/[^a-z0-9]+/gi,""),a.length%2!==0&&(a="0"+a);for(var d=0;d<a.length;d+=2)c.push(parseInt(a[d]+a[d+1],16))}}else for(var d=0;d<a.length;d++){var e=a.charCodeAt(d),f=e>>8,g=255&e;f?c.push(f,g):c.push(g)}else for(var d=0;d<a.length;d++)c[d]=0|a[d];return c}function e(a){for(var b="",c=0;c<a.length;c++)b+=h(a[c].toString(16));return b}function f(a){var b=a>>>24|a>>>8&65280|a<<8&16711680|(255&a)<<24;return b>>>0}function g(a,b){for(var c="",d=0;d<a.length;d++){var e=a[d];"little"===b&&(e=f(e)),c+=i(e.toString(16))}return c}function h(a){return 1===a.length?"0"+a:a}function i(a){return 7===a.length?"0"+a:6===a.length?"00"+a:5===a.length?"000"+a:4===a.length?"0000"+a:3===a.length?"00000"+a:2===a.length?"000000"+a:1===a.length?"0000000"+a:a}function j(a,b,c,d){var e=c-b;r(e%4===0);for(var f=new Array(e/4),g=0,h=b;g<f.length;g++,h+=4){var i;i="big"===d?a[h]<<24|a[h+1]<<16|a[h+2]<<8|a[h+3]:a[h+3]<<24|a[h+2]<<16|a[h+1]<<8|a[h],f[g]=i>>>0}return f}function k(a,b){for(var c=new Array(4*a.length),d=0,e=0;d<a.length;d++,e+=4){var f=a[d];"big"===b?(c[e]=f>>>24,c[e+1]=f>>>16&255,c[e+2]=f>>>8&255,c[e+3]=255&f):(c[e+3]=f>>>24,c[e+2]=f>>>16&255,c[e+1]=f>>>8&255,c[e]=255&f)}return c}function l(a,b){return a>>>b|a<<32-b}function m(a,b){return a<<b|a>>>32-b}function n(a,b){return a+b>>>0}function o(a,b,c){return a+b+c>>>0}function p(a,b,c,d){return a+b+c+d>>>0}function q(a,b,c,d,e){return a+b+c+d+e>>>0}function r(a,b){if(!a)throw new Error(b||"Assertion failed")}function s(a,b,c,d){var e=a[b],f=a[b+1],g=d+f>>>0,h=(g<d?1:0)+c+e;a[b]=h>>>0,a[b+1]=g}function t(a,b,c,d){var e=b+d>>>0,f=(e<b?1:0)+a+c;return f>>>0}function u(a,b,c,d){var e=b+d;return e>>>0}function v(a,b,c,d,e,f,g,h){var i=0,j=b;j=j+d>>>0,i+=j<b?1:0,j=j+f>>>0,i+=j<f?1:0,j=j+h>>>0,i+=j<h?1:0;var k=a+c+e+g+i;return k>>>0}function w(a,b,c,d,e,f,g,h){var i=b+d+f+h;return i>>>0}function x(a,b,c,d,e,f,g,h,i,j){var k=0,l=b;l=l+d>>>0,k+=l<b?1:0,l=l+f>>>0,k+=l<f?1:0,l=l+h>>>0,k+=l<h?1:0,l=l+j>>>0,k+=l<j?1:0;var m=a+c+e+g+i+k;return m>>>0}function y(a,b,c,d,e,f,g,h,i,j){var k=b+d+f+h+j;return k>>>0}function z(a,b,c){var d=b<<32-c|a>>>c;return d>>>0}function A(a,b,c){var d=a<<32-c|b>>>c;return d>>>0}function B(a,b,c){return a>>>c}function C(a,b,c){var d=a<<32-c|b>>>c;return d>>>0}var D=c,E=a("inherits");D.toArray=d,D.toHex=e,D.htonl=f,D.toHex32=g,D.zero2=h,D.zero8=i,D.join32=j,D.split32=k,D.rotr32=l,D.rotl32=m,D.sum32=n,D.sum32_3=o,D.sum32_4=p,D.sum32_5=q,D.assert=r,D.inherits=E,c.sum64=s,c.sum64_hi=t,c.sum64_lo=u,c.sum64_4_hi=v,c.sum64_4_lo=w,c.sum64_5_hi=x,c.sum64_5_lo=y,c.rotr64_hi=z,c.rotr64_lo=A,c.shr64_hi=B,c.shr64_lo=C},{inherits:326}],190:[function(a,b,c){b.exports={name:"elliptic",version:"6.2.3",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{coverage:"npm run unit --coverage",coveralls:"npm run coverage && cat ./coverage/lcov.info | coveralls",jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/*.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/*.js",lint:"npm run jscs && npm run jshint",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/*-test.js"},repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},keywords:["EC","Elliptic","curve","Cryptography"],author:{name:"Fedor Indutny",email:"fedor@indutny.com"},license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{coveralls:"^2.11.3",istanbul:"^0.4.2",jscs:"^2.9.0",jshint:"^2.6.0",mocha:"^2.1.0"},dependencies:{"bn.js":"^4.0.0",brorand:"^1.0.1","hash.js":"^1.0.0",inherits:"^2.0.1"},gitHead:"c32f20b22b420eb6af3c6dda28963deb7facf823",_id:"elliptic@6.2.3",_shasum:"18e46d7306b0951275a2d42063270a14b74ebe99",_from:"elliptic@>=6.0.0 <7.0.0",_npmVersion:"3.3.12",_nodeVersion:"5.4.1",_npmUser:{name:"indutny",email:"fedor@indutny.com"},dist:{shasum:"18e46d7306b0951275a2d42063270a14b74ebe99",tarball:"http://registry.npmjs.org/elliptic/-/elliptic-6.2.3.tgz"},maintainers:[{name:"indutny",email:"fedor@indutny.com"}],directories:{},_resolved:"https://registry.npmjs.org/elliptic/-/elliptic-6.2.3.tgz",readme:"ERROR: No README data found!"}},{}],191:[function(a,b,c){b.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],192:[function(a,b,c){var d=a("asn1.js"),e=d.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});c.RSAPrivateKey=e;var f=d.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});c.RSAPublicKey=f;var g=d.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(h),this.key("subjectPublicKey").bitstr())});c.PublicKey=g;var h=d.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),i=d.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(h),this.key("subjectPrivateKey").octstr())});c.PrivateKey=i;var j=d.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});c.EncryptedPrivateKey=j;var k=d.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});c.DSAPrivateKey=k,c.DSAparam=d.define("DSAparam",function(){this.int()});var l=d.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(m),this.key("publicKey").optional().explicit(1).bitstr())});c.ECPrivateKey=l;var m=d.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});c.signature=d.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"asn1.js":195}],193:[function(a,b,c){(function(c){var d=/Proc-Type: 4,ENCRYPTED\r?\nDEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)\r?\n\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n/m,e=/^-----BEGIN (.*) KEY-----\r?\n/m,f=/^-----BEGIN (.*) KEY-----\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n-----END \1 KEY-----$/m,g=a("evp_bytestokey"),h=a("browserify-aes");b.exports=function(a,b){var i,j=a.toString(),k=j.match(d);if(k){var l="aes"+k[1],m=new c(k[2],"hex"),n=new c(k[3].replace(/\r?\n/g,""),"base64"),o=g(b,m.slice(0,8),parseInt(k[1],10)).key,p=[],q=h.createDecipheriv(l,o,m);p.push(q.update(n)),p.push(q.final()),i=c.concat(p)}else{var r=j.match(f);i=new c(r[2].replace(/\r?\n/g,""),"base64")}var s=j.match(e)[1]+" KEY";return{tag:s,data:i}}}).call(this,a("buffer").Buffer)},{"browserify-aes":212,buffer:128,evp_bytestokey:227}],194:[function(a,b,c){(function(c){function d(a){var b;"object"!=typeof a||c.isBuffer(a)||(b=a.passphrase,a=a.key),"string"==typeof a&&(a=new c(a));var d,g,i=h(a,b),j=i.tag,k=i.data;switch(j){case"PUBLIC KEY":switch(g=f.PublicKey.decode(k,"der"),d=g.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return f.RSAPublicKey.decode(g.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return g.subjectPrivateKey=g.subjectPublicKey,{type:"ec",data:g};case"1.2.840.10040.4.1":return g.algorithm.params.pub_key=f.DSAparam.decode(g.subjectPublicKey.data,"der"),{type:"dsa",data:g.algorithm.params};default:throw new Error("unknown key id "+d)}throw new Error("unknown key type "+j);case"ENCRYPTED PRIVATE KEY":k=f.EncryptedPrivateKey.decode(k,"der"),k=e(k,b);case"PRIVATE KEY":switch(g=f.PrivateKey.decode(k,"der"),d=g.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return f.RSAPrivateKey.decode(g.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:g.algorithm.curve,privateKey:f.ECPrivateKey.decode(g.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return g.algorithm.params.priv_key=f.DSAparam.decode(g.subjectPrivateKey,"der"),{type:"dsa",params:g.algorithm.params};default:throw new Error("unknown key id "+d)}throw new Error("unknown key type "+j);case"RSA PUBLIC KEY":return f.RSAPublicKey.decode(k,"der");case"RSA PRIVATE KEY":return f.RSAPrivateKey.decode(k,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:f.DSAPrivateKey.decode(k,"der")};case"EC PRIVATE KEY":return k=f.ECPrivateKey.decode(k,"der"),{curve:k.parameters.value,privateKey:k.privateKey};default:throw new Error("unknown key type "+j)}}function e(a,b){var d=a.algorithm.decrypt.kde.kdeparams.salt,e=parseInt(a.algorithm.decrypt.kde.kdeparams.iters.toString(),10),f=g[a.algorithm.decrypt.cipher.algo.join(".")],h=a.algorithm.decrypt.cipher.iv,k=a.subjectPrivateKey,l=parseInt(f.split("-")[1],10)/8,m=j.pbkdf2Sync(b,d,e,l),n=i.createDecipheriv(f,m,h),o=[];return o.push(n.update(k)),o.push(n.final()),c.concat(o)}var f=a("./asn1"),g=a("./aesid.json"),h=a("./fixProc"),i=a("browserify-aes"),j=a("pbkdf2");b.exports=d,d.signature=f.signature}).call(this,a("buffer").Buffer)},{"./aesid.json":191,"./asn1":192,"./fixProc":193,"browserify-aes":212,buffer:128,pbkdf2:277}],195:[function(a,b,c){var d=c;d.bignum=a("bn.js"),d.define=a("./asn1/api").define,d.base=a("./asn1/base"),d.constants=a("./asn1/constants"),d.decoders=a("./asn1/decoders"),d.encoders=a("./asn1/encoders")},{"./asn1/api":196,"./asn1/base":198,"./asn1/constants":202,"./asn1/decoders":204,"./asn1/encoders":207,"bn.js":165}],196:[function(a,b,c){function d(a,b){this.name=a,this.body=b,this.decoders={},this.encoders={}}var e=a("../asn1"),f=a("inherits"),g=c;g.define=function(a,b){return new d(a,b)},d.prototype._createNamed=function(b){var c;try{c=a("vm").runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(a){c=function(a){this._initNamed(a)}}return f(c,b),c.prototype._initNamed=function(a){b.call(this,a)},new c(this)},d.prototype._getDecoder=function(a){return a=a||"der",this.decoders.hasOwnProperty(a)||(this.decoders[a]=this._createNamed(e.decoders[a])),this.decoders[a]},d.prototype.decode=function(a,b,c){return this._getDecoder(b).decode(a,c)},d.prototype._getEncoder=function(a){return a=a||"der",this.encoders.hasOwnProperty(a)||(this.encoders[a]=this._createNamed(e.encoders[a])),this.encoders[a]},d.prototype.encode=function(a,b,c){return this._getEncoder(b).encode(a,c)}},{"../asn1":195,inherits:326,vm:360}],197:[function(a,b,c){function d(a,b){return g.call(this,b),h.isBuffer(a)?(this.base=a,this.offset=0,void(this.length=a.length)):void this.error("Input not Buffer")}function e(a,b){if(Array.isArray(a))this.length=0,this.value=a.map(function(a){return a instanceof e||(a=new e(a,b)),this.length+=a.length,a},this);else if("number"==typeof a){if(!(0<=a&&a<=255))return b.error("non-byte EncoderBuffer value");this.value=a,this.length=1}else if("string"==typeof a)this.value=a,this.length=h.byteLength(a);else{if(!h.isBuffer(a))return b.error("Unsupported type: "+typeof a);this.value=a,this.length=a.length}}var f=a("inherits"),g=a("../base").Reporter,h=a("buffer").Buffer;f(d,g),c.DecoderBuffer=d,d.prototype.save=function(){return{offset:this.offset,reporter:g.prototype.save.call(this)}},d.prototype.restore=function(a){var b=new d(this.base);return b.offset=a.offset,b.length=this.offset,this.offset=a.offset,g.prototype.restore.call(this,a.reporter),b},d.prototype.isEmpty=function(){return this.offset===this.length},d.prototype.readUInt8=function(a){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(a||"DecoderBuffer overrun")},d.prototype.skip=function(a,b){if(!(this.offset+a<=this.length))return this.error(b||"DecoderBuffer overrun");var c=new d(this.base);return c._reporterState=this._reporterState,c.offset=this.offset,c.length=this.offset+a,this.offset+=a,c},d.prototype.raw=function(a){return this.base.slice(a?a.offset:this.offset,this.length)},c.EncoderBuffer=e,e.prototype.join=function(a,b){return a||(a=new h(this.length)),b||(b=0),0===this.length?a:(Array.isArray(this.value)?this.value.forEach(function(c){c.join(a,b),b+=c.length}):("number"==typeof this.value?a[b]=this.value:"string"==typeof this.value?a.write(this.value,b):h.isBuffer(this.value)&&this.value.copy(a,b),b+=this.length),a)}},{"../base":198,buffer:128,inherits:326}],198:[function(a,b,c){var d=c;d.Reporter=a("./reporter").Reporter,d.DecoderBuffer=a("./buffer").DecoderBuffer,d.EncoderBuffer=a("./buffer").EncoderBuffer,d.Node=a("./node")},{"./buffer":197,"./node":199,"./reporter":200}],199:[function(a,b,c){function d(a,b){var c={};this._baseState=c,c.enc=a,c.parent=b||null,c.children=null,c.tag=null,c.args=null,c.reverseArgs=null,c.choice=null,c.optional=!1,c.any=!1,c.obj=!1,c.use=null,c.useDecoder=null,c.key=null,c.default=null,c.explicit=null,c.implicit=null,c.contains=null,c.parent||(c.children=[],this._wrap())}var e=a("../base").Reporter,f=a("../base").EncoderBuffer,g=a("../base").DecoderBuffer,h=a("minimalistic-assert"),i=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],j=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(i),k=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];b.exports=d;var l=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit"];d.prototype.clone=function(){var a=this._baseState,b={};l.forEach(function(c){b[c]=a[c]});var c=new this.constructor(b.parent);return c._baseState=b,c},d.prototype._wrap=function(){var a=this._baseState;j.forEach(function(b){this[b]=function(){var c=new this.constructor(this);return a.children.push(c),c[b].apply(c,arguments)}},this)},d.prototype._init=function(a){var b=this._baseState;h(null===b.parent),a.call(this),b.children=b.children.filter(function(a){return a._baseState.parent===this},this),h.equal(b.children.length,1,"Root node can have only one child")},d.prototype._useArgs=function(a){var b=this._baseState,c=a.filter(function(a){return a instanceof this.constructor},this);a=a.filter(function(a){return!(a instanceof this.constructor)},this),0!==c.length&&(h(null===b.children),b.children=c,c.forEach(function(a){a._baseState.parent=this},this)),0!==a.length&&(h(null===b.args),b.args=a,b.reverseArgs=a.map(function(a){if("object"!=typeof a||a.constructor!==Object)return a;var b={};return Object.keys(a).forEach(function(c){c==(0|c)&&(c|=0);var d=a[c];b[d]=c}),b}))},k.forEach(function(a){d.prototype[a]=function(){var b=this._baseState;throw new Error(a+" not implemented for encoding: "+b.enc)}}),i.forEach(function(a){d.prototype[a]=function(){var b=this._baseState,c=Array.prototype.slice.call(arguments);return h(null===b.tag),b.tag=a,this._useArgs(c),this}}),d.prototype.use=function(a){var b=this._baseState;return h(null===b.use),b.use=a,this},d.prototype.optional=function(){var a=this._baseState;return a.optional=!0,this},d.prototype.def=function(a){var b=this._baseState;return h(null===b.default),b.default=a,b.optional=!0,this},d.prototype.explicit=function(a){var b=this._baseState;return h(null===b.explicit&&null===b.implicit),b.explicit=a,this},d.prototype.implicit=function(a){var b=this._baseState;return h(null===b.explicit&&null===b.implicit),b.implicit=a,this},d.prototype.obj=function(){var a=this._baseState,b=Array.prototype.slice.call(arguments);return a.obj=!0,
0!==b.length&&this._useArgs(b),this},d.prototype.key=function(a){var b=this._baseState;return h(null===b.key),b.key=a,this},d.prototype.any=function(){var a=this._baseState;return a.any=!0,this},d.prototype.choice=function(a){var b=this._baseState;return h(null===b.choice),b.choice=a,this._useArgs(Object.keys(a).map(function(b){return a[b]})),this},d.prototype.contains=function(a){var b=this._baseState;return h(null===b.use),b.contains=a,this},d.prototype._decode=function(a){var b=this._baseState;if(null===b.parent)return a.wrapResult(b.children[0]._decode(a));var c,d=b.default,e=!0;if(null!==b.key&&(c=a.enterKey(b.key)),b.optional){var f=null;if(null!==b.explicit?f=b.explicit:null!==b.implicit?f=b.implicit:null!==b.tag&&(f=b.tag),null!==f||b.any){if(e=this._peekTag(a,f,b.any),a.isError(e))return e}else{var h=a.save();try{null===b.choice?this._decodeGeneric(b.tag,a):this._decodeChoice(a),e=!0}catch(a){e=!1}a.restore(h)}}var i;if(b.obj&&e&&(i=a.enterObject()),e){if(null!==b.explicit){var j=this._decodeTag(a,b.explicit);if(a.isError(j))return j;a=j}if(null===b.use&&null===b.choice){if(b.any)var h=a.save();var k=this._decodeTag(a,null!==b.implicit?b.implicit:b.tag,b.any);if(a.isError(k))return k;b.any?d=a.raw(h):a=k}if(d=b.any?d:null===b.choice?this._decodeGeneric(b.tag,a):this._decodeChoice(a),a.isError(d))return d;if(b.any||null!==b.choice||null===b.children||b.children.forEach(function(b){b._decode(a)}),b.contains&&("octstr"===b.tag||"bitstr"===b.tag)){var l=new g(d);d=this._getUse(b.contains,a._reporterState.obj)._decode(l)}}return b.obj&&e&&(d=a.leaveObject(i)),null===b.key||null===d&&e!==!0||a.leaveKey(c,b.key,d),d},d.prototype._decodeGeneric=function(a,b){var c=this._baseState;return"seq"===a||"set"===a?null:"seqof"===a||"setof"===a?this._decodeList(b,a,c.args[0]):/str$/.test(a)?this._decodeStr(b,a):"objid"===a&&c.args?this._decodeObjid(b,c.args[0],c.args[1]):"objid"===a?this._decodeObjid(b,null,null):"gentime"===a||"utctime"===a?this._decodeTime(b,a):"null_"===a?this._decodeNull(b):"bool"===a?this._decodeBool(b):"int"===a||"enum"===a?this._decodeInt(b,c.args&&c.args[0]):null!==c.use?this._getUse(c.use,b._reporterState.obj)._decode(b):b.error("unknown tag: "+a)},d.prototype._getUse=function(a,b){var c=this._baseState;return c.useDecoder=this._use(a,b),h(null===c.useDecoder._baseState.parent),c.useDecoder=c.useDecoder._baseState.children[0],c.implicit!==c.useDecoder._baseState.implicit&&(c.useDecoder=c.useDecoder.clone(),c.useDecoder._baseState.implicit=c.implicit),c.useDecoder},d.prototype._decodeChoice=function(a){var b=this._baseState,c=null,d=!1;return Object.keys(b.choice).some(function(e){var f=a.save(),g=b.choice[e];try{var h=g._decode(a);if(a.isError(h))return!1;c={type:e,value:h},d=!0}catch(b){return a.restore(f),!1}return!0},this),d?c:a.error("Choice not matched")},d.prototype._createEncoderBuffer=function(a){return new f(a,this.reporter)},d.prototype._encode=function(a,b,c){var d=this._baseState;if(null===d.default||d.default!==a){var e=this._encodeValue(a,b,c);if(void 0!==e&&!this._skipDefault(e,b,c))return e}},d.prototype._encodeValue=function(a,b,c){var d=this._baseState;if(null===d.parent)return d.children[0]._encode(a,b||new e);var f=null;if(this.reporter=b,d.optional&&void 0===a){if(null===d.default)return;a=d.default}var g=null,h=!1;if(d.any)f=this._createEncoderBuffer(a);else if(d.choice)f=this._encodeChoice(a,b);else if(d.contains)g=this._getUse(d.contains,c)._encode(a,b),h=!0;else if(d.children)g=d.children.map(function(c){if("null_"===c._baseState.tag)return c._encode(null,b,a);if(null===c._baseState.key)return b.error("Child should have a key");var d=b.enterKey(c._baseState.key);if("object"!=typeof a)return b.error("Child expected, but input is not object");var e=c._encode(a[c._baseState.key],b,a);return b.leaveKey(d),e},this).filter(function(a){return a}),g=this._createEncoderBuffer(g);else if("seqof"===d.tag||"setof"===d.tag){if(!d.args||1!==d.args.length)return b.error("Too many args for : "+d.tag);if(!Array.isArray(a))return b.error("seqof/setof, but data is not Array");var i=this.clone();i._baseState.implicit=null,g=this._createEncoderBuffer(a.map(function(c){var d=this._baseState;return this._getUse(d.args[0],a)._encode(c,b)},i))}else null!==d.use?f=this._getUse(d.use,c)._encode(a,b):(g=this._encodePrimitive(d.tag,a),h=!0);var f;if(!d.any&&null===d.choice){var j=null!==d.implicit?d.implicit:d.tag,k=null===d.implicit?"universal":"context";null===j?null===d.use&&b.error("Tag could be ommited only for .use()"):null===d.use&&(f=this._encodeComposite(j,h,k,g))}return null!==d.explicit&&(f=this._encodeComposite(d.explicit,!1,"context",f)),f},d.prototype._encodeChoice=function(a,b){var c=this._baseState,d=c.choice[a.type];return d||h(!1,a.type+" not found in "+JSON.stringify(Object.keys(c.choice))),d._encode(a.value,b)},d.prototype._encodePrimitive=function(a,b){var c=this._baseState;if(/str$/.test(a))return this._encodeStr(b,a);if("objid"===a&&c.args)return this._encodeObjid(b,c.reverseArgs[0],c.args[1]);if("objid"===a)return this._encodeObjid(b,null,null);if("gentime"===a||"utctime"===a)return this._encodeTime(b,a);if("null_"===a)return this._encodeNull();if("int"===a||"enum"===a)return this._encodeInt(b,c.args&&c.reverseArgs[0]);if("bool"===a)return this._encodeBool(b);throw new Error("Unsupported tag: "+a)},d.prototype._isNumstr=function(a){return/^[0-9 ]*$/.test(a)},d.prototype._isPrintstr=function(a){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(a)}},{"../base":198,"minimalistic-assert":209}],200:[function(a,b,c){function d(a){this._reporterState={obj:null,path:[],options:a||{},errors:[]}}function e(a,b){this.path=a,this.rethrow(b)}var f=a("inherits");c.Reporter=d,d.prototype.isError=function(a){return a instanceof e},d.prototype.save=function(){var a=this._reporterState;return{obj:a.obj,pathLen:a.path.length}},d.prototype.restore=function(a){var b=this._reporterState;b.obj=a.obj,b.path=b.path.slice(0,a.pathLen)},d.prototype.enterKey=function(a){return this._reporterState.path.push(a)},d.prototype.leaveKey=function(a,b,c){var d=this._reporterState;d.path=d.path.slice(0,a-1),null!==d.obj&&(d.obj[b]=c)},d.prototype.enterObject=function(){var a=this._reporterState,b=a.obj;return a.obj={},b},d.prototype.leaveObject=function(a){var b=this._reporterState,c=b.obj;return b.obj=a,c},d.prototype.error=function(a){var b,c=this._reporterState,d=a instanceof e;if(b=d?a:new e(c.path.map(function(a){return"["+JSON.stringify(a)+"]"}).join(""),a.message||a,a.stack),!c.options.partial)throw b;return d||c.errors.push(b),b},d.prototype.wrapResult=function(a){var b=this._reporterState;return b.options.partial?{result:this.isError(a)?null:a,errors:b.errors}:a},f(e,Error),e.prototype.rethrow=function(a){return this.message=a+" at: "+(this.path||"(shallow)"),Error.captureStackTrace(this,e),this}},{inherits:326}],201:[function(a,b,c){var d=a("../constants");c.tagClass={0:"universal",1:"application",2:"context",3:"private"},c.tagClassByName=d._reverse(c.tagClass),c.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},c.tagByName=d._reverse(c.tag)},{"../constants":202}],202:[function(a,b,c){var d=c;d._reverse=function(a){var b={};return Object.keys(a).forEach(function(c){(0|c)==c&&(c|=0);var d=a[c];b[d]=c}),b},d.der=a("./der")},{"./der":201}],203:[function(a,b,c){function d(a){this.enc="der",this.name=a.name,this.entity=a,this.tree=new e,this.tree._init(a.body)}function e(a){j.Node.call(this,"der",a)}function f(a,b){var c=a.readUInt8(b);if(a.isError(c))return c;var d=l.tagClass[c>>6],e=0===(32&c);if(31===(31&c)){var f=c;for(c=0;128===(128&f);){if(f=a.readUInt8(b),a.isError(f))return f;c<<=7,c|=127&f}}else c&=31;var g=l.tag[c];return{cls:d,primitive:e,tag:c,tagStr:g}}function g(a,b,c){var d=a.readUInt8(c);if(a.isError(d))return d;if(!b&&128===d)return null;if(0===(128&d))return d;var e=127&d;if(e>=4)return a.error("length octect is too long");d=0;for(var f=0;f<e;f++){d<<=8;var g=a.readUInt8(c);if(a.isError(g))return g;d|=g}return d}var h=a("inherits"),i=a("../../asn1"),j=i.base,k=i.bignum,l=i.constants.der;b.exports=d,d.prototype.decode=function(a,b){return a instanceof j.DecoderBuffer||(a=new j.DecoderBuffer(a,b)),this.tree._decode(a,b)},h(e,j.Node),e.prototype._peekTag=function(a,b,c){if(a.isEmpty())return!1;var d=a.save(),e=f(a,'Failed to peek tag: "'+b+'"');return a.isError(e)?e:(a.restore(d),e.tag===b||e.tagStr===b||e.tagStr+"of"===b||c)},e.prototype._decodeTag=function(a,b,c){var d=f(a,'Failed to decode tag of "'+b+'"');if(a.isError(d))return d;var e=g(a,d.primitive,'Failed to get length of "'+b+'"');if(a.isError(e))return e;if(!c&&d.tag!==b&&d.tagStr!==b&&d.tagStr+"of"!==b)return a.error('Failed to match tag: "'+b+'"');if(d.primitive||null!==e)return a.skip(e,'Failed to match body of: "'+b+'"');var h=a.save(),i=this._skipUntilEnd(a,'Failed to skip indefinite length body: "'+this.tag+'"');return a.isError(i)?i:(e=a.offset-h.offset,a.restore(h),a.skip(e,'Failed to match body of: "'+b+'"'))},e.prototype._skipUntilEnd=function(a,b){for(;;){var c=f(a,b);if(a.isError(c))return c;var d=g(a,c.primitive,b);if(a.isError(d))return d;var e;if(e=c.primitive||null!==d?a.skip(d):this._skipUntilEnd(a,b),a.isError(e))return e;if("end"===c.tagStr)break}},e.prototype._decodeList=function(a,b,c){for(var d=[];!a.isEmpty();){var e=this._peekTag(a,"end");if(a.isError(e))return e;var f=c.decode(a,"der");if(a.isError(f)&&e)break;d.push(f)}return d},e.prototype._decodeStr=function(a,b){if("bitstr"===b){var c=a.readUInt8();return a.isError(c)?c:{unused:c,data:a.raw()}}if("bmpstr"===b){var d=a.raw();if(d.length%2===1)return a.error("Decoding of string type: bmpstr length mismatch");for(var e="",f=0;f<d.length/2;f++)e+=String.fromCharCode(d.readUInt16BE(2*f));return e}if("numstr"===b){var g=a.raw().toString("ascii");return this._isNumstr(g)?g:a.error("Decoding of string type: numstr unsupported characters")}if("octstr"===b)return a.raw();if("printstr"===b){var h=a.raw().toString("ascii");return this._isPrintstr(h)?h:a.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(b)?a.raw().toString():a.error("Decoding of string type: "+b+" unsupported")},e.prototype._decodeObjid=function(a,b,c){for(var d,e=[],f=0;!a.isEmpty();){var g=a.readUInt8();f<<=7,f|=127&g,0===(128&g)&&(e.push(f),f=0)}128&g&&e.push(f);var h=e[0]/40|0,i=e[0]%40;if(d=c?e:[h,i].concat(e.slice(1)),b){var j=b[d.join(" ")];void 0===j&&(j=b[d.join(".")]),void 0!==j&&(d=j)}return d},e.prototype._decodeTime=function(a,b){var c=a.raw().toString();if("gentime"===b)var d=0|c.slice(0,4),e=0|c.slice(4,6),f=0|c.slice(6,8),g=0|c.slice(8,10),h=0|c.slice(10,12),i=0|c.slice(12,14);else{if("utctime"!==b)return a.error("Decoding "+b+" time is not supported yet");var d=0|c.slice(0,2),e=0|c.slice(2,4),f=0|c.slice(4,6),g=0|c.slice(6,8),h=0|c.slice(8,10),i=0|c.slice(10,12);d=d<70?2e3+d:1900+d}return Date.UTC(d,e-1,f,g,h,i,0)},e.prototype._decodeNull=function(a){return null},e.prototype._decodeBool=function(a){var b=a.readUInt8();return a.isError(b)?b:0!==b},e.prototype._decodeInt=function(a,b){var c=a.raw(),d=new k(c);return b&&(d=b[d.toString(10)]||d),d},e.prototype._use=function(a,b){return"function"==typeof a&&(a=a(b)),a._getDecoder("der").tree}},{"../../asn1":195,inherits:326}],204:[function(a,b,c){var d=c;d.der=a("./der"),d.pem=a("./pem")},{"./der":203,"./pem":205}],205:[function(a,b,c){function d(a){g.call(this,a),this.enc="pem"}var e=a("inherits"),f=a("buffer").Buffer,g=a("./der");e(d,g),b.exports=d,d.prototype.decode=function(a,b){for(var c=a.toString().split(/[\r\n]+/g),d=b.label.toUpperCase(),e=/^-----(BEGIN|END) ([^-]+)-----$/,h=-1,i=-1,j=0;j<c.length;j++){var k=c[j].match(e);if(null!==k&&k[2]===d){if(h!==-1){if("END"!==k[1])break;i=j;break}if("BEGIN"!==k[1])break;h=j}}if(h===-1||i===-1)throw new Error("PEM section not found for: "+d);var l=c.slice(h+1,i).join("");l.replace(/[^a-z0-9\+\/=]+/gi,"");var m=new f(l,"base64");return g.prototype.decode.call(this,m,b)}},{"./der":203,buffer:128,inherits:326}],206:[function(a,b,c){function d(a){this.enc="der",this.name=a.name,this.entity=a,this.tree=new e,this.tree._init(a.body)}function e(a){k.Node.call(this,"der",a)}function f(a){return a<10?"0"+a:a}function g(a,b,c,d){var e;if("seqof"===a?a="seq":"setof"===a&&(a="set"),l.tagByName.hasOwnProperty(a))e=l.tagByName[a];else{if("number"!=typeof a||(0|a)!==a)return d.error("Unknown tag: "+a);e=a}return e>=31?d.error("Multi-octet tag encoding unsupported"):(b||(e|=32),e|=l.tagClassByName[c||"universal"]<<6)}var h=a("inherits"),i=a("buffer").Buffer,j=a("../../asn1"),k=j.base,l=j.constants.der;b.exports=d,d.prototype.encode=function(a,b){return this.tree._encode(a,b).join()},h(e,k.Node),e.prototype._encodeComposite=function(a,b,c,d){var e=g(a,b,c,this.reporter);if(d.length<128){var f=new i(2);return f[0]=e,f[1]=d.length,this._createEncoderBuffer([f,d])}for(var h=1,j=d.length;j>=256;j>>=8)h++;var f=new i(2+h);f[0]=e,f[1]=128|h;for(var j=1+h,k=d.length;k>0;j--,k>>=8)f[j]=255&k;return this._createEncoderBuffer([f,d])},e.prototype._encodeStr=function(a,b){if("bitstr"===b)return this._createEncoderBuffer([0|a.unused,a.data]);if("bmpstr"===b){for(var c=new i(2*a.length),d=0;d<a.length;d++)c.writeUInt16BE(a.charCodeAt(d),2*d);return this._createEncoderBuffer(c)}return"numstr"===b?this._isNumstr(a)?this._createEncoderBuffer(a):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===b?this._isPrintstr(a)?this._createEncoderBuffer(a):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(b)?this._createEncoderBuffer(a):this.reporter.error("Encoding of string type: "+b+" unsupported")},e.prototype._encodeObjid=function(a,b,c){if("string"==typeof a){if(!b)return this.reporter.error("string objid given, but no values map found");if(!b.hasOwnProperty(a))return this.reporter.error("objid not found in values map");a=b[a].split(/[\s\.]+/g);for(var d=0;d<a.length;d++)a[d]|=0}else if(Array.isArray(a)){a=a.slice();for(var d=0;d<a.length;d++)a[d]|=0}if(!Array.isArray(a))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(a));if(!c){if(a[1]>=40)return this.reporter.error("Second objid identifier OOB");a.splice(0,2,40*a[0]+a[1])}for(var e=0,d=0;d<a.length;d++){var f=a[d];for(e++;f>=128;f>>=7)e++}for(var g=new i(e),h=g.length-1,d=a.length-1;d>=0;d--){var f=a[d];for(g[h--]=127&f;(f>>=7)>0;)g[h--]=128|127&f}return this._createEncoderBuffer(g)},e.prototype._encodeTime=function(a,b){var c,d=new Date(a);return"gentime"===b?c=[f(d.getFullYear()),f(d.getUTCMonth()+1),f(d.getUTCDate()),f(d.getUTCHours()),f(d.getUTCMinutes()),f(d.getUTCSeconds()),"Z"].join(""):"utctime"===b?c=[f(d.getFullYear()%100),f(d.getUTCMonth()+1),f(d.getUTCDate()),f(d.getUTCHours()),f(d.getUTCMinutes()),f(d.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+b+" time is not supported yet"),this._encodeStr(c,"octstr")},e.prototype._encodeNull=function(){return this._createEncoderBuffer("")},e.prototype._encodeInt=function(a,b){if("string"==typeof a){if(!b)return this.reporter.error("String int or enum given, but no values map");if(!b.hasOwnProperty(a))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(a));a=b[a]}if("number"!=typeof a&&!i.isBuffer(a)){var c=a.toArray();!a.sign&&128&c[0]&&c.unshift(0),a=new i(c)}if(i.isBuffer(a)){var d=a.length;0===a.length&&d++;var e=new i(d);return a.copy(e),0===a.length&&(e[0]=0),this._createEncoderBuffer(e)}if(a<128)return this._createEncoderBuffer(a);if(a<256)return this._createEncoderBuffer([0,a]);for(var d=1,f=a;f>=256;f>>=8)d++;for(var e=new Array(d),f=e.length-1;f>=0;f--)e[f]=255&a,a>>=8;return 128&e[0]&&e.unshift(0),this._createEncoderBuffer(new i(e))},e.prototype._encodeBool=function(a){return this._createEncoderBuffer(a?255:0)},e.prototype._use=function(a,b){return"function"==typeof a&&(a=a(b)),a._getEncoder("der").tree},e.prototype._skipDefault=function(a,b,c){var d,e=this._baseState;if(null===e.default)return!1;var f=a.join();if(void 0===e.defaultBuffer&&(e.defaultBuffer=this._encodeValue(e.default,b,c).join()),f.length!==e.defaultBuffer.length)return!1;for(d=0;d<f.length;d++)if(f[d]!==e.defaultBuffer[d])return!1;return!0}},{"../../asn1":195,buffer:128,inherits:326}],207:[function(a,b,c){var d=c;d.der=a("./der"),d.pem=a("./pem")},{"./der":206,"./pem":208}],208:[function(a,b,c){function d(a){f.call(this,a),this.enc="pem"}var e=a("inherits"),f=a("./der");e(d,f),b.exports=d,d.prototype.encode=function(a,b){for(var c=f.prototype.encode.call(this,a),d=c.toString("base64"),e=["-----BEGIN "+b.label+"-----"],g=0;g<d.length;g+=64)e.push(d.slice(g,g+64));return e.push("-----END "+b.label+"-----"),e.join("\n")}},{"./der":206,inherits:326}],209:[function(a,b,c){arguments[4][160][0].apply(c,arguments)},{dup:160}],210:[function(a,b,c){arguments[4][134][0].apply(c,arguments)},{buffer:128,dup:134}],211:[function(a,b,c){arguments[4][135][0].apply(c,arguments)},{"./aes":210,"./ghash":215,buffer:128,"buffer-xor":224,"cipher-base":225,dup:135,inherits:326}],212:[function(a,b,c){arguments[4][136][0].apply(c,arguments)},{"./decrypter":213,"./encrypter":214,"./modes":216,dup:136}],213:[function(a,b,c){arguments[4][137][0].apply(c,arguments)},{"./aes":210,"./authCipher":211,"./modes":216,"./modes/cbc":217,"./modes/cfb":218,"./modes/cfb1":219,"./modes/cfb8":220,"./modes/ctr":221,"./modes/ecb":222,"./modes/ofb":223,"./streamCipher":226,buffer:128,"cipher-base":225,dup:137,evp_bytestokey:227,inherits:326}],214:[function(a,b,c){arguments[4][138][0].apply(c,arguments)},{"./aes":210,"./authCipher":211,"./modes":216,"./modes/cbc":217,"./modes/cfb":218,"./modes/cfb1":219,"./modes/cfb8":220,"./modes/ctr":221,"./modes/ecb":222,"./modes/ofb":223,"./streamCipher":226,buffer:128,"cipher-base":225,dup:138,evp_bytestokey:227,inherits:326}],215:[function(a,b,c){arguments[4][139][0].apply(c,arguments)},{buffer:128,dup:139}],216:[function(a,b,c){arguments[4][140][0].apply(c,arguments)},{dup:140}],217:[function(a,b,c){arguments[4][141][0].apply(c,arguments)},{"buffer-xor":224,dup:141}],218:[function(a,b,c){arguments[4][142][0].apply(c,arguments)},{buffer:128,"buffer-xor":224,dup:142}],219:[function(a,b,c){arguments[4][143][0].apply(c,arguments)},{buffer:128,dup:143}],220:[function(a,b,c){arguments[4][144][0].apply(c,arguments)},{buffer:128,dup:144}],221:[function(a,b,c){arguments[4][145][0].apply(c,arguments)},{buffer:128,"buffer-xor":224,dup:145}],222:[function(a,b,c){arguments[4][146][0].apply(c,arguments)},{dup:146}],223:[function(a,b,c){arguments[4][147][0].apply(c,arguments)},{buffer:128,"buffer-xor":224,dup:147}],224:[function(a,b,c){arguments[4][148][0].apply(c,arguments)},{buffer:128,dup:148}],225:[function(a,b,c){arguments[4][149][0].apply(c,arguments)},{buffer:128,dup:149,inherits:326,stream:348,string_decoder:355}],226:[function(a,b,c){arguments[4][150][0].apply(c,arguments)},{"./aes":210,buffer:128,"cipher-base":225,dup:150,inherits:326}],227:[function(a,b,c){arguments[4][161][0].apply(c,arguments)},{buffer:128,"create-hash/md5":258,dup:161}],228:[function(a,b,c){(function(c){function d(a,b,c,d){var g=q(b);if(g.curve){if("ecdsa"!==d)throw new Error("wrong private key type");return e(a,g)}if("dsa"===g.type){if("dsa"!==d)throw new Error("wrong private key type");return f(a,g,c)}if("rsa"!==d)throw new Error("wrong private key type");for(var h=g.modulus.byteLength(),i=[0,1];a.length+i.length+1<h;)i.push(255);i.push(0);for(var j=-1;++j<a.length;)i.push(a[j]);var k=n(i,g);return k}function e(a,b){var d=o[b.curve.join(".")];if(!d)throw new Error("unknown curve "+b.curve.join("."));var e=new s(d),f=e.genKeyPair();f._importPrivate(b.privateKey);var g=f.sign(a);return new c(g.toDER())}function f(a,b,c){for(var d,e=b.params.priv_key,f=b.params.p,j=b.params.q,m=b.params.g,n=new r(0),o=i(a,j).mod(j),p=!1,q=h(e,j,a,c);p===!1;)d=k(j,q,c),n=l(m,d,f,j),p=d.invm(j).imul(o.add(e.mul(n))).mod(j),p.cmpn(0)||(p=!1,n=new r(0));return g(n,p)}function g(a,b){a=a.toArray(),b=b.toArray(),128&a[0]&&(a=[0].concat(a)),128&b[0]&&(b=[0].concat(b));var d=a.length+b.length+4,e=[48,d,2,a.length];return e=e.concat(a,[2,b.length],b),new c(e)}function h(a,b,d,e){if(a=new c(a.toArray()),a.length<b.byteLength()){var f=new c(b.byteLength()-a.length);f.fill(0),a=c.concat([f,a])}var g=d.length,h=j(d,b),i=new c(g);i.fill(1);var k=new c(g);return k.fill(0),k=m(e,k).update(i).update(new c([0])).update(a).update(h).digest(),i=m(e,k).update(i).digest(),k=m(e,k).update(i).update(new c([1])).update(a).update(h).digest(),i=m(e,k).update(i).digest(),{k:k,v:i}}function i(a,b){var c=new r(a),d=(a.length<<3)-b.bitLength();return d>0&&c.ishrn(d),c}function j(a,b){a=i(a,b),a=a.mod(b);var d=new c(a.toArray());if(d.length<b.byteLength()){var e=new c(b.byteLength()-d.length);e.fill(0),d=c.concat([e,d])}return d}function k(a,b,d){var e,f;do{for(e=new c("");8*e.length<a.bitLength();)b.v=m(d,b.k).update(b.v).digest(),e=c.concat([e,b.v]);f=i(e,a),b.k=m(d,b.k).update(b.v).update(new c([0])).digest(),b.v=m(d,b.k).update(b.v).digest()}while(f.cmp(a)!==-1);return f}function l(a,b,c,d){return a.toRed(r.mont(c)).redPow(b).fromRed().mod(d)}var m=a("create-hmac"),n=a("browserify-rsa"),o=a("./curves"),p=a("elliptic"),q=a("parse-asn1"),r=a("bn.js"),s=p.ec;b.exports=d,b.exports.getKey=h,b.exports.makeKey=k}).call(this,a("buffer").Buffer)},{"./curves":164,"bn.js":165,"browserify-rsa":166,buffer:128,"create-hmac":269,elliptic:167,"parse-asn1":194}],229:[function(a,b,c){(function(c){function d(a,b,d,g){var h=j(d);if("ec"===h.type){if("ecdsa"!==g)throw new Error("wrong public key type");return e(a,b,h)}if("dsa"===h.type){if("dsa"!==g)throw new Error("wrong public key type");return f(a,b,h)}if("rsa"!==g)throw new Error("wrong public key type");for(var i=h.modulus.byteLength(),l=[1],m=0;b.length+l.length+2<i;)l.push(255),m++;l.push(0);for(var n=-1;++n<b.length;)l.push(b[n]);l=new c(l);var o=k.mont(h.modulus);a=new k(a).toRed(o),a=a.redPow(new k(h.publicExponent)),a=new c(a.fromRed().toArray());var p=0;for(m<8&&(p=1),i=Math.min(a.length,l.length),a.length!==l.length&&(p=1),n=-1;++n<i;)p|=a[n]^l[n];return 0===p}function e(a,b,c){var d=h[c.data.algorithm.curve.join(".")];if(!d)throw new Error("unknown curve "+c.data.algorithm.curve.join("."));var e=new l(d),f=c.data.subjectPrivateKey.data;return e.verify(b,a,f)}function f(a,b,c){var d=c.data.p,e=c.data.q,f=c.data.g,h=c.data.pub_key,i=j.signature.decode(a,"der"),l=i.s,m=i.r;g(l,e),g(m,e);var n=k.mont(d),o=l.invm(e),p=f.toRed(n).redPow(new k(b).mul(o).mod(e)).fromRed().mul(h.toRed(n).redPow(m.mul(o).mod(e)).fromRed()).mod(d).mod(e);return!p.cmp(m)}function g(a,b){if(a.cmpn(0)<=0)throw new Error("invalid sig");if(a.cmp(b)>=b)throw new Error("invalid sig")}var h=a("./curves"),i=a("elliptic"),j=a("parse-asn1"),k=a("bn.js"),l=i.ec;b.exports=d}).call(this,a("buffer").Buffer)},{"./curves":164,"bn.js":165,buffer:128,elliptic:167,"parse-asn1":194}],230:[function(a,b,c){(function(c){function d(a){this.curveType=h[a],this.curveType||(this.curveType={name:a}),this.curve=new f.ec(this.curveType.name),this.keys=void 0}function e(a,b,d){Array.isArray(a)||(a=a.toArray());var e=new c(a);if(d&&e.length<d){var f=new c(d-e.length);f.fill(0),e=c.concat([f,e])}return b?e.toString(b):e}var f=a("elliptic"),g=a("bn.js");b.exports=function(a){return new d(a)};var h={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};h.p224=h.secp224r1,h.p256=h.secp256r1=h.prime256v1,h.p192=h.secp192r1=h.prime192v1,h.p384=h.secp384r1,h.p521=h.secp521r1,d.prototype.generateKeys=function(a,b){return this.keys=this.curve.genKeyPair(),this.getPublicKey(a,b)},d.prototype.computeSecret=function(a,b,d){b=b||"utf8",c.isBuffer(a)||(a=new c(a,b));var f=this.curve.keyFromPublic(a).getPublic(),g=f.mul(this.keys.getPrivate()).getX();return e(g,d,this.curveType.byteLength)},d.prototype.getPublicKey=function(a,b){var c=this.keys.getPublic("compressed"===b,!0);return"hybrid"===b&&(c[c.length-1]%2?c[0]=7:c[0]=6),e(c,a)},d.prototype.getPrivateKey=function(a){return e(this.keys.getPrivate(),a)},d.prototype.setPublicKey=function(a,b){return b=b||"utf8",c.isBuffer(a)||(a=new c(a,b)),this.keys._importPublic(a),this},d.prototype.setPrivateKey=function(a,b){b=b||"utf8",c.isBuffer(a)||(a=new c(a,b));var d=new g(a);return d=d.toString(16),this.keys._importPrivate(d),this}}).call(this,a("buffer").Buffer)},{"bn.js":231,buffer:128,elliptic:232}],231:[function(a,b,c){arguments[4][165][0].apply(c,arguments)},{dup:165}],232:[function(a,b,c){arguments[4][167][0].apply(c,arguments)},{"../package.json":255,"./elliptic/curve":235,"./elliptic/curves":238,"./elliptic/ec":239,"./elliptic/eddsa":242,"./elliptic/hmac-drbg":245,"./elliptic/utils":247,brorand:248,dup:167}],233:[function(a,b,c){arguments[4][168][0].apply(c,arguments)},{"../../elliptic":232,"bn.js":231,dup:168}],234:[function(a,b,c){arguments[4][169][0].apply(c,arguments)},{"../../elliptic":232,"../curve":235,"bn.js":231,dup:169,inherits:326}],235:[function(a,b,c){arguments[4][170][0].apply(c,arguments)},{"./base":233,"./edwards":234,"./mont":236,"./short":237,dup:170}],236:[function(a,b,c){arguments[4][171][0].apply(c,arguments)},{"../../elliptic":232,"../curve":235,"bn.js":231,dup:171,inherits:326}],237:[function(a,b,c){arguments[4][172][0].apply(c,arguments)},{"../../elliptic":232,"../curve":235,"bn.js":231,dup:172,inherits:326}],238:[function(a,b,c){arguments[4][173][0].apply(c,arguments)},{"../elliptic":232,"./precomputed/secp256k1":246,dup:173,"hash.js":249}],239:[function(a,b,c){arguments[4][174][0].apply(c,arguments)},{"../../elliptic":232,"./key":240,"./signature":241,"bn.js":231,dup:174}],240:[function(a,b,c){arguments[4][175][0].apply(c,arguments)},{"bn.js":231,dup:175}],241:[function(a,b,c){arguments[4][176][0].apply(c,arguments)},{"../../elliptic":232,"bn.js":231,dup:176}],242:[function(a,b,c){arguments[4][177][0].apply(c,arguments)},{"../../elliptic":232,"./key":243,"./signature":244,dup:177,"hash.js":249}],243:[function(a,b,c){arguments[4][178][0].apply(c,arguments)},{"../../elliptic":232,dup:178}],244:[function(a,b,c){arguments[4][179][0].apply(c,arguments)},{"../../elliptic":232,"bn.js":231,dup:179}],245:[function(a,b,c){arguments[4][180][0].apply(c,arguments)},{"../elliptic":232,dup:180,"hash.js":249}],246:[function(a,b,c){arguments[4][181][0].apply(c,arguments)},{dup:181}],247:[function(a,b,c){arguments[4][182][0].apply(c,arguments)},{"bn.js":231,dup:182}],248:[function(a,b,c){arguments[4][183][0].apply(c,arguments)},{dup:183}],249:[function(a,b,c){arguments[4][184][0].apply(c,arguments)},{"./hash/common":250,"./hash/hmac":251,"./hash/ripemd":252,"./hash/sha":253,"./hash/utils":254,dup:184}],250:[function(a,b,c){arguments[4][185][0].apply(c,arguments)},{"../hash":249,dup:185}],251:[function(a,b,c){arguments[4][186][0].apply(c,arguments)},{"../hash":249,dup:186}],252:[function(a,b,c){arguments[4][187][0].apply(c,arguments)},{"../hash":249,dup:187}],253:[function(a,b,c){arguments[4][188][0].apply(c,arguments)},{"../hash":249,dup:188}],254:[function(a,b,c){arguments[4][189][0].apply(c,arguments)},{dup:189,inherits:326}],255:[function(a,b,c){arguments[4][190][0].apply(c,arguments)},{dup:190}],256:[function(a,b,c){(function(c){"use strict";function d(a){j.call(this,"digest"),this._hash=a,this.buffers=[]}function e(a){j.call(this,"digest"),this._hash=a}var f=a("inherits"),g=a("./md5"),h=a("ripemd160"),i=a("sha.js"),j=a("cipher-base");f(d,j),d.prototype._update=function(a){this.buffers.push(a)},d.prototype._final=function(){var a=c.concat(this.buffers),b=this._hash(a);return this.buffers=null,b},f(e,j),e.prototype._update=function(a){this._hash.update(a)},e.prototype._final=function(){return this._hash.digest()},b.exports=function(a){return a=a.toLowerCase(),"md5"===a?new d(g):"rmd160"===a||"ripemd160"===a?new d(h):new e(i(a))}}).call(this,a("buffer").Buffer)},{"./md5":258,buffer:128,"cipher-base":259,inherits:326,ripemd160:260,"sha.js":262}],257:[function(a,b,c){(function(a){"use strict";function b(b,c){if(b.length%f!==0){var d=b.length+(f-b.length%f);b=a.concat([b,g],d)}for(var e=[],h=c?b.readInt32BE:b.readInt32LE,i=0;i<b.length;i+=f)e.push(h.call(b,i));return e}function d(b,c,d){for(var e=new a(c),f=d?e.writeInt32BE:e.writeInt32LE,g=0;g<b.length;g++)f.call(e,b[g],4*g,!0);return e}function e(c,e,f,g){a.isBuffer(c)||(c=new a(c));var i=e(b(c,g),c.length*h);return d(i,f,g)}var f=4,g=new a(f);g.fill(0);var h=8;c.hash=e}).call(this,a("buffer").Buffer)},{buffer:128}],258:[function(a,b,c){"use strict";function d(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,k=271733878,l=0;l<a.length;l+=16){var m=c,n=d,o=e,p=k;c=f(c,d,e,k,a[l+0],7,-680876936),k=f(k,c,d,e,a[l+1],12,-389564586),e=f(e,k,c,d,a[l+2],17,606105819),d=f(d,e,k,c,a[l+3],22,-1044525330),c=f(c,d,e,k,a[l+4],7,-176418897),k=f(k,c,d,e,a[l+5],12,1200080426),e=f(e,k,c,d,a[l+6],17,-1473231341),d=f(d,e,k,c,a[l+7],22,-45705983),c=f(c,d,e,k,a[l+8],7,1770035416),k=f(k,c,d,e,a[l+9],12,-1958414417),e=f(e,k,c,d,a[l+10],17,-42063),d=f(d,e,k,c,a[l+11],22,-1990404162),c=f(c,d,e,k,a[l+12],7,1804603682),k=f(k,c,d,e,a[l+13],12,-40341101),e=f(e,k,c,d,a[l+14],17,-1502002290),d=f(d,e,k,c,a[l+15],22,1236535329),c=g(c,d,e,k,a[l+1],5,-165796510),k=g(k,c,d,e,a[l+6],9,-1069501632),e=g(e,k,c,d,a[l+11],14,643717713),d=g(d,e,k,c,a[l+0],20,-373897302),c=g(c,d,e,k,a[l+5],5,-701558691),k=g(k,c,d,e,a[l+10],9,38016083),e=g(e,k,c,d,a[l+15],14,-660478335),d=g(d,e,k,c,a[l+4],20,-405537848),c=g(c,d,e,k,a[l+9],5,568446438),k=g(k,c,d,e,a[l+14],9,-1019803690),e=g(e,k,c,d,a[l+3],14,-187363961),d=g(d,e,k,c,a[l+8],20,1163531501),c=g(c,d,e,k,a[l+13],5,-1444681467),k=g(k,c,d,e,a[l+2],9,-51403784),e=g(e,k,c,d,a[l+7],14,1735328473),d=g(d,e,k,c,a[l+12],20,-1926607734),c=h(c,d,e,k,a[l+5],4,-378558),k=h(k,c,d,e,a[l+8],11,-2022574463),e=h(e,k,c,d,a[l+11],16,1839030562),d=h(d,e,k,c,a[l+14],23,-35309556),c=h(c,d,e,k,a[l+1],4,-1530992060),k=h(k,c,d,e,a[l+4],11,1272893353),e=h(e,k,c,d,a[l+7],16,-155497632),d=h(d,e,k,c,a[l+10],23,-1094730640),c=h(c,d,e,k,a[l+13],4,681279174),k=h(k,c,d,e,a[l+0],11,-358537222),e=h(e,k,c,d,a[l+3],16,-722521979),d=h(d,e,k,c,a[l+6],23,76029189),c=h(c,d,e,k,a[l+9],4,-640364487),k=h(k,c,d,e,a[l+12],11,-421815835),e=h(e,k,c,d,a[l+15],16,530742520),d=h(d,e,k,c,a[l+2],23,-995338651),c=i(c,d,e,k,a[l+0],6,-198630844),k=i(k,c,d,e,a[l+7],10,1126891415),e=i(e,k,c,d,a[l+14],15,-1416354905),d=i(d,e,k,c,a[l+5],21,-57434055),c=i(c,d,e,k,a[l+12],6,1700485571),k=i(k,c,d,e,a[l+3],10,-1894986606),e=i(e,k,c,d,a[l+10],15,-1051523),d=i(d,e,k,c,a[l+1],21,-2054922799),c=i(c,d,e,k,a[l+8],6,1873313359),k=i(k,c,d,e,a[l+15],10,-30611744),e=i(e,k,c,d,a[l+6],15,-1560198380),d=i(d,e,k,c,a[l+13],21,1309151649),c=i(c,d,e,k,a[l+4],6,-145523070),k=i(k,c,d,e,a[l+11],10,-1120210379),e=i(e,k,c,d,a[l+2],15,718787259),d=i(d,e,k,c,a[l+9],21,-343485551),c=j(c,m),d=j(d,n),e=j(e,o),k=j(k,p)}return Array(c,d,e,k)}function e(a,b,c,d,e,f){return j(k(j(j(b,a),j(d,f)),e),c)}function f(a,b,c,d,f,g,h){return e(b&c|~b&d,a,b,f,g,h)}function g(a,b,c,d,f,g,h){return e(b&d|c&~d,a,b,f,g,h)}function h(a,b,c,d,f,g,h){return e(b^c^d,a,b,f,g,h)}function i(a,b,c,d,f,g,h){return e(c^(b|~d),a,b,f,g,h)}function j(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function k(a,b){return a<<b|a>>>32-b}var l=a("./helpers");b.exports=function(a){return l.hash(a,d,16)}},{"./helpers":257
}],259:[function(a,b,c){arguments[4][149][0].apply(c,arguments)},{buffer:128,dup:149,inherits:326,stream:348,string_decoder:355}],260:[function(a,b,c){(function(a){function c(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=a[c]<<24-d%32;return b}function d(a){for(var b=[],c=0;c<32*a.length;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b}function e(a,b,c){for(var d=0;d<16;d++){var e=c+d,l=b[e];b[e]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var s,t,u,v,w,x,y,z,A,B;x=s=a[0],y=t=a[1],z=u=a[2],A=v=a[3],B=w=a[4];var C;for(d=0;d<80;d+=1)C=s+b[c+m[d]]|0,C+=d<16?f(t,u,v)+q[0]:d<32?g(t,u,v)+q[1]:d<48?h(t,u,v)+q[2]:d<64?i(t,u,v)+q[3]:j(t,u,v)+q[4],C|=0,C=k(C,o[d]),C=C+w|0,s=w,w=v,v=k(u,10),u=t,t=C,C=x+b[c+n[d]]|0,C+=d<16?j(y,z,A)+r[0]:d<32?i(y,z,A)+r[1]:d<48?h(y,z,A)+r[2]:d<64?g(y,z,A)+r[3]:f(y,z,A)+r[4],C|=0,C=k(C,p[d]),C=C+B|0,x=B,B=A,A=k(z,10),z=y,y=C;C=a[1]+u+A|0,a[1]=a[2]+v+B|0,a[2]=a[3]+w+x|0,a[3]=a[4]+s+y|0,a[4]=a[0]+t+z|0,a[0]=C}function f(a,b,c){return a^b^c}function g(a,b,c){return a&b|~a&c}function h(a,b,c){return(a|~b)^c}function i(a,b,c){return a&c|b&~c}function j(a,b,c){return a^(b|~c)}function k(a,b){return a<<b|a>>>32-b}function l(b){var f=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof b&&(b=new a(b,"utf8"));var g=c(b),h=8*b.length,i=8*b.length;g[h>>>5]|=128<<24-h%32,g[(h+64>>>9<<4)+14]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);for(var j=0;j<g.length;j+=16)e(f,g,j);for(j=0;j<5;j++){var k=f[j];f[j]=16711935&(k<<8|k>>>24)|4278255360&(k<<24|k>>>8)}var l=d(f);return new a(l)}var m=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],n=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],o=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],p=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],q=[0,1518500249,1859775393,2400959708,2840853838],r=[1352829926,1548603684,1836072691,2053994217,0];b.exports=l}).call(this,a("buffer").Buffer)},{buffer:128}],261:[function(a,b,c){(function(a){function c(b,c){this._block=new a(b),this._finalSize=c,this._blockSize=b,this._len=0,this._s=0}c.prototype.update=function(b,c){"string"==typeof b&&(c=c||"utf8",b=new a(b,c));for(var d=this._len+=b.length,e=this._s||0,f=0,g=this._block;e<d;){for(var h=Math.min(b.length,f+this._blockSize-e%this._blockSize),i=h-f,j=0;j<i;j++)g[e%this._blockSize+j]=b[j+f];e+=i,f+=i,e%this._blockSize===0&&this._update(g)}return this._s=e,this},c.prototype.digest=function(a){var b=8*this._len;this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),b%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(b,this._blockSize-4);var c=this._update(this._block)||this._hash();return a?c.toString(a):c},c.prototype._update=function(){throw new Error("_update must be implemented by subclass")},b.exports=c}).call(this,a("buffer").Buffer)},{buffer:128}],262:[function(a,b,c){var c=b.exports=function(a){a=a.toLowerCase();var b=c[a];if(!b)throw new Error(a+" is not supported (we accept pull requests)");return new b};c.sha=a("./sha"),c.sha1=a("./sha1"),c.sha224=a("./sha224"),c.sha256=a("./sha256"),c.sha384=a("./sha384"),c.sha512=a("./sha512")},{"./sha":263,"./sha1":264,"./sha224":265,"./sha256":266,"./sha384":267,"./sha512":268}],263:[function(a,b,c){(function(c){function d(){this.init(),this._w=k,i.call(this,64,56)}function e(a){return a<<5|a>>>27}function f(a){return a<<30|a>>>2}function g(a,b,c,d){return 0===a?b&c|~b&d:2===a?b&c|b&d|c&d:b^c^d}var h=a("inherits"),i=a("./hash"),j=[1518500249,1859775393,-1894007588,-899497514],k=new Array(80);h(d,i),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(a){for(var b=this._w,c=0|this._a,d=0|this._b,h=0|this._c,i=0|this._d,k=0|this._e,l=0;l<16;++l)b[l]=a.readInt32BE(4*l);for(;l<80;++l)b[l]=b[l-3]^b[l-8]^b[l-14]^b[l-16];for(var m=0;m<80;++m){var n=~~(m/20),o=e(c)+g(n,d,h,i)+k+b[m]+j[n]|0;k=i,i=h,h=f(d),d=c,c=o}this._a=c+this._a|0,this._b=d+this._b|0,this._c=h+this._c|0,this._d=i+this._d|0,this._e=k+this._e|0},d.prototype._hash=function(){var a=new c(20);return a.writeInt32BE(0|this._a,0),a.writeInt32BE(0|this._b,4),a.writeInt32BE(0|this._c,8),a.writeInt32BE(0|this._d,12),a.writeInt32BE(0|this._e,16),a},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":261,buffer:128,inherits:326}],264:[function(a,b,c){(function(c){function d(){this.init(),this._w=l,j.call(this,64,56)}function e(a){return a<<1|a>>>31}function f(a){return a<<5|a>>>27}function g(a){return a<<30|a>>>2}function h(a,b,c,d){return 0===a?b&c|~b&d:2===a?b&c|b&d|c&d:b^c^d}var i=a("inherits"),j=a("./hash"),k=[1518500249,1859775393,-1894007588,-899497514],l=new Array(80);i(d,j),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(a){for(var b=this._w,c=0|this._a,d=0|this._b,i=0|this._c,j=0|this._d,l=0|this._e,m=0;m<16;++m)b[m]=a.readInt32BE(4*m);for(;m<80;++m)b[m]=e(b[m-3]^b[m-8]^b[m-14]^b[m-16]);for(var n=0;n<80;++n){var o=~~(n/20),p=f(c)+h(o,d,i,j)+l+b[n]+k[o]|0;l=j,j=i,i=g(d),d=c,c=p}this._a=c+this._a|0,this._b=d+this._b|0,this._c=i+this._c|0,this._d=j+this._d|0,this._e=l+this._e|0},d.prototype._hash=function(){var a=new c(20);return a.writeInt32BE(0|this._a,0),a.writeInt32BE(0|this._b,4),a.writeInt32BE(0|this._c,8),a.writeInt32BE(0|this._d,12),a.writeInt32BE(0|this._e,16),a},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":261,buffer:128,inherits:326}],265:[function(a,b,c){(function(c){function d(){this.init(),this._w=h,g.call(this,64,56)}var e=a("inherits"),f=a("./sha256"),g=a("./hash"),h=new Array(64);e(d,f),d.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},d.prototype._hash=function(){var a=new c(28);return a.writeInt32BE(this._a,0),a.writeInt32BE(this._b,4),a.writeInt32BE(this._c,8),a.writeInt32BE(this._d,12),a.writeInt32BE(this._e,16),a.writeInt32BE(this._f,20),a.writeInt32BE(this._g,24),a},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":261,"./sha256":266,buffer:128,inherits:326}],266:[function(a,b,c){(function(c){function d(){this.init(),this._w=n,l.call(this,64,56)}function e(a,b,c){return c^a&(b^c)}function f(a,b,c){return a&b|c&(a|b)}function g(a){return(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10)}function h(a){return(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7)}function i(a){return(a>>>7|a<<25)^(a>>>18|a<<14)^a>>>3}function j(a){return(a>>>17|a<<15)^(a>>>19|a<<13)^a>>>10}var k=a("inherits"),l=a("./hash"),m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n=new Array(64);k(d,l),d.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},d.prototype._update=function(a){for(var b=this._w,c=0|this._a,d=0|this._b,k=0|this._c,l=0|this._d,n=0|this._e,o=0|this._f,p=0|this._g,q=0|this._h,r=0;r<16;++r)b[r]=a.readInt32BE(4*r);for(;r<64;++r)b[r]=j(b[r-2])+b[r-7]+i(b[r-15])+b[r-16]|0;for(var s=0;s<64;++s){var t=q+h(n)+e(n,o,p)+m[s]+b[s]|0,u=g(c)+f(c,d,k)|0;q=p,p=o,o=n,n=l+t|0,l=k,k=d,d=c,c=t+u|0}this._a=c+this._a|0,this._b=d+this._b|0,this._c=k+this._c|0,this._d=l+this._d|0,this._e=n+this._e|0,this._f=o+this._f|0,this._g=p+this._g|0,this._h=q+this._h|0},d.prototype._hash=function(){var a=new c(32);return a.writeInt32BE(this._a,0),a.writeInt32BE(this._b,4),a.writeInt32BE(this._c,8),a.writeInt32BE(this._d,12),a.writeInt32BE(this._e,16),a.writeInt32BE(this._f,20),a.writeInt32BE(this._g,24),a.writeInt32BE(this._h,28),a},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":261,buffer:128,inherits:326}],267:[function(a,b,c){(function(c){function d(){this.init(),this._w=h,g.call(this,128,112)}var e=a("inherits"),f=a("./sha512"),g=a("./hash"),h=new Array(160);e(d,f),d.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},d.prototype._hash=function(){function a(a,c,d){b.writeInt32BE(a,d),b.writeInt32BE(c,d+4)}var b=new c(48);return a(this._ah,this._al,0),a(this._bh,this._bl,8),a(this._ch,this._cl,16),a(this._dh,this._dl,24),a(this._eh,this._el,32),a(this._fh,this._fl,40),b},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":261,"./sha512":268,buffer:128,inherits:326}],268:[function(a,b,c){(function(c){function d(){this.init(),this._w=q,o.call(this,128,112)}function e(a,b,c){return c^a&(b^c)}function f(a,b,c){return a&b|c&(a|b)}function g(a,b){return(a>>>28|b<<4)^(b>>>2|a<<30)^(b>>>7|a<<25)}function h(a,b){return(a>>>14|b<<18)^(a>>>18|b<<14)^(b>>>9|a<<23)}function i(a,b){return(a>>>1|b<<31)^(a>>>8|b<<24)^a>>>7}function j(a,b){return(a>>>1|b<<31)^(a>>>8|b<<24)^(a>>>7|b<<25)}function k(a,b){return(a>>>19|b<<13)^(b>>>29|a<<3)^a>>>6}function l(a,b){return(a>>>19|b<<13)^(b>>>29|a<<3)^(a>>>6|b<<26)}function m(a,b){return a>>>0<b>>>0?1:0}var n=a("inherits"),o=a("./hash"),p=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],q=new Array(160);n(d,o),d.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},d.prototype._update=function(a){for(var b=this._w,c=0|this._ah,d=0|this._bh,n=0|this._ch,o=0|this._dh,q=0|this._eh,r=0|this._fh,s=0|this._gh,t=0|this._hh,u=0|this._al,v=0|this._bl,w=0|this._cl,x=0|this._dl,y=0|this._el,z=0|this._fl,A=0|this._gl,B=0|this._hl,C=0;C<32;C+=2)b[C]=a.readInt32BE(4*C),b[C+1]=a.readInt32BE(4*C+4);for(;C<160;C+=2){var D=b[C-30],E=b[C-30+1],F=i(D,E),G=j(E,D);D=b[C-4],E=b[C-4+1];var H=k(D,E),I=l(E,D),J=b[C-14],K=b[C-14+1],L=b[C-32],M=b[C-32+1],N=G+K|0,O=F+J+m(N,G)|0;N=N+I|0,O=O+H+m(N,I)|0,N=N+M|0,O=O+L+m(N,M)|0,b[C]=O,b[C+1]=N}for(var P=0;P<160;P+=2){O=b[P],N=b[P+1];var Q=f(c,d,n),R=f(u,v,w),S=g(c,u),T=g(u,c),U=h(q,y),V=h(y,q),W=p[P],X=p[P+1],Y=e(q,r,s),Z=e(y,z,A),$=B+V|0,_=t+U+m($,B)|0;$=$+Z|0,_=_+Y+m($,Z)|0,$=$+X|0,_=_+W+m($,X)|0,$=$+N|0,_=_+O+m($,N)|0;var aa=T+R|0,ba=S+Q+m(aa,T)|0;t=s,B=A,s=r,A=z,r=q,z=y,y=x+$|0,q=o+_+m(y,x)|0,o=n,x=w,n=d,w=v,d=c,v=u,u=$+aa|0,c=_+ba+m(u,$)|0}this._al=this._al+u|0,this._bl=this._bl+v|0,this._cl=this._cl+w|0,this._dl=this._dl+x|0,this._el=this._el+y|0,this._fl=this._fl+z|0,this._gl=this._gl+A|0,this._hl=this._hl+B|0,this._ah=this._ah+c+m(this._al,u)|0,this._bh=this._bh+d+m(this._bl,v)|0,this._ch=this._ch+n+m(this._cl,w)|0,this._dh=this._dh+o+m(this._dl,x)|0,this._eh=this._eh+q+m(this._el,y)|0,this._fh=this._fh+r+m(this._fl,z)|0,this._gh=this._gh+s+m(this._gl,A)|0,this._hh=this._hh+t+m(this._hl,B)|0},d.prototype._hash=function(){function a(a,c,d){b.writeInt32BE(a,d),b.writeInt32BE(c,d+4)}var b=new c(64);return a(this._ah,this._al,0),a(this._bh,this._bl,8),a(this._ch,this._cl,16),a(this._dh,this._dl,24),a(this._eh,this._el,32),a(this._fh,this._fl,40),a(this._gh,this._gl,48),a(this._hh,this._hl,56),b},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":261,buffer:128,inherits:326}],269:[function(a,b,c){(function(c){"use strict";function d(a,b){g.call(this),a=a.toLowerCase(),"string"==typeof b&&(b=new c(b));var d="sha512"===a||"sha384"===a?128:64;this._alg=a,this._key=b,b.length>d?b=e(a).update(b).digest():b.length<d&&(b=c.concat([b,h],d));for(var f=this._ipad=new c(d),i=this._opad=new c(d),j=0;j<d;j++)f[j]=54^b[j],i[j]=92^b[j];this._hash=e(a).update(f)}var e=a("create-hash/browser"),f=a("inherits"),g=a("stream").Transform,h=new c(128);h.fill(0),f(d,g),d.prototype.update=function(a,b){return this._hash.update(a,b),this},d.prototype._transform=function(a,b,c){this._hash.update(a),c()},d.prototype._flush=function(a){this.push(this.digest()),a()},d.prototype.digest=function(a){var b=this._hash.digest();return e(this._alg).update(this._opad).update(b).digest(a)},b.exports=function(a,b){return new d(a,b)}}).call(this,a("buffer").Buffer)},{buffer:128,"create-hash/browser":256,inherits:326,stream:348}],270:[function(a,b,c){(function(b){function d(a){var c=new b(g[a].prime,"hex"),d=new b(g[a].gen,"hex");return new h(c,d)}function e(a,c,d,g){return b.isBuffer(c)||void 0===i[c]?e(a,"binary",c,d):(c=c||"binary",g=g||"binary",d=d||new b([2]),b.isBuffer(d)||(d=new b(d,g)),"number"==typeof a?new h(f(a,d),d,!0):(b.isBuffer(a)||(a=new b(a,c)),new h(a,d,!0)))}var f=a("./lib/generatePrime"),g=a("./lib/primes.json"),h=a("./lib/dh"),i={binary:!0,hex:!0,base64:!0};c.DiffieHellmanGroup=c.createDiffieHellmanGroup=c.getDiffieHellman=d,c.createDiffieHellman=c.DiffieHellman=e}).call(this,a("buffer").Buffer)},{"./lib/dh":271,"./lib/generatePrime":272,"./lib/primes.json":273,buffer:128}],271:[function(a,b,c){(function(c){function d(a,b){return b=b||"utf8",c.isBuffer(a)||(a=new c(a,b)),this._pub=new i(a),this}function e(a,b){return b=b||"utf8",c.isBuffer(a)||(a=new c(a,b)),this._priv=new i(a),this}function f(a,b){var c=b.toString("hex"),d=[c,a.toString(16)].join("_");if(d in s)return s[d];var e=0;if(a.isEven()||!q.simpleSieve||!q.fermatTest(a)||!k.test(a))return e+=1,e+="02"===c||"05"===c?8:4,s[d]=e,e;k.test(a.shrn(1))||(e+=2);var f;switch(c){case"02":a.mod(l).cmp(m)&&(e+=8);break;case"05":f=a.mod(n),f.cmp(o)&&f.cmp(p)&&(e+=8);break;default:e+=4}return s[d]=e,e}function g(a,b,c){this.setGenerator(b),this.__prime=new i(a),this._prime=i.mont(this.__prime),this._primeLen=a.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,c?(this.setPublicKey=d,this.setPrivateKey=e):this._primeCode=8}function h(a,b){var d=new c(a.toArray());return b?d.toString(b):d}var i=a("bn.js"),j=a("miller-rabin"),k=new j,l=new i(24),m=new i(11),n=new i(10),o=new i(3),p=new i(7),q=a("./generatePrime"),r=a("randombytes");b.exports=g;var s={};Object.defineProperty(g.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=f(this.__prime,this.__gen)),this._primeCode}}),g.prototype.generateKeys=function(){return this._priv||(this._priv=new i(r(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},g.prototype.computeSecret=function(a){a=new i(a),a=a.toRed(this._prime);var b=a.redPow(this._priv).fromRed(),d=new c(b.toArray()),e=this.getPrime();if(d.length<e.length){var f=new c(e.length-d.length);f.fill(0),d=c.concat([f,d])}return d},g.prototype.getPublicKey=function(a){return h(this._pub,a)},g.prototype.getPrivateKey=function(a){return h(this._priv,a)},g.prototype.getPrime=function(a){return h(this.__prime,a)},g.prototype.getGenerator=function(a){return h(this._gen,a)},g.prototype.setGenerator=function(a,b){return b=b||"utf8",c.isBuffer(a)||(a=new c(a,b)),this.__gen=a,this._gen=new i(a),this}}).call(this,a("buffer").Buffer)},{"./generatePrime":272,"bn.js":274,buffer:128,"miller-rabin":275,randombytes:323}],272:[function(a,b,c){function d(){if(null!==t)return t;var a=1048576,b=[];b[0]=2;for(var c=1,d=3;d<a;d+=2){for(var e=Math.ceil(Math.sqrt(d)),f=0;f<c&&b[f]<=e&&d%b[f]!==0;f++);c!==f&&b[f]<=e||(b[c++]=d)}return t=b,b}function e(a){for(var b=d(),c=0;c<b.length;c++)if(0===a.modn(b[c]))return 0===a.cmpn(b[c]);return!0}function f(a){var b=i.mont(a);return 0===n.toRed(b).redPow(a.subn(1)).fromRed().cmpn(1)}function g(a,b){if(a<16)return new i(2===b||5===b?[140,123]:[140,39]);b=new i(b);for(var c,d;;){for(c=new i(h(Math.ceil(a/8)));c.bitLength()>a;)c.ishrn(1);if(c.isEven()&&c.iadd(m),c.testn(1)||c.iadd(n),b.cmp(n)){if(!b.cmp(o))for(;c.mod(p).cmp(q);)c.iadd(s)}else for(;c.mod(j).cmp(r);)c.iadd(s);if(d=c.shrn(1),e(d)&&e(c)&&f(d)&&f(c)&&l.test(d)&&l.test(c))return c}}var h=a("randombytes");b.exports=g,g.simpleSieve=e,g.fermatTest=f;var i=a("bn.js"),j=new i(24),k=a("miller-rabin"),l=new k,m=new i(1),n=new i(2),o=new i(5),p=(new i(16),new i(8),new i(10)),q=new i(3),r=(new i(7),new i(11)),s=new i(4),t=(new i(12),null)},{"bn.js":274,"miller-rabin":275,randombytes:323}],273:[function(a,b,c){b.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],274:[function(a,b,c){arguments[4][165][0].apply(c,arguments)},{dup:165}],275:[function(a,b,c){function d(a){this.rand=a||new f.Rand}var e=a("bn.js"),f=a("brorand");b.exports=d,d.create=function(a){return new d(a)},d.prototype._rand=function(a){var b=a.bitLength(),c=this.rand.generate(Math.ceil(b/8));c[0]|=3;var d=7&b;return 0!==d&&(c[c.length-1]>>=7-d),new e(c)},d.prototype.test=function(a,b,c){var d=a.bitLength(),f=e.mont(a),g=new e(1).toRed(f);b||(b=Math.max(1,d/48|0));for(var h=a.subn(1),i=h.subn(1),j=0;!h.testn(j);j++);for(var k=a.shrn(j),l=h.toRed(f),m=!0;b>0;b--){var n=this._rand(i);c&&c(n);var o=n.toRed(f).redPow(k);if(0!==o.cmp(g)&&0!==o.cmp(l)){for(var p=1;p<j;p++){if(o=o.redSqr(),0===o.cmp(g))return!1;if(0===o.cmp(l))break}if(p===j)return!1}}return m},d.prototype.getDivisor=function(a,b){var c=a.bitLength(),d=e.mont(a),f=new e(1).toRed(d);b||(b=Math.max(1,c/48|0));for(var g=a.subn(1),h=g.subn(1),i=0;!g.testn(i);i++);for(var j=a.shrn(i),k=g.toRed(d);b>0;b--){var l=this._rand(h),m=a.gcd(l);if(0!==m.cmpn(1))return m;var n=l.toRed(d).redPow(j);if(0!==n.cmp(f)&&0!==n.cmp(k)){for(var o=1;o<i;o++){if(n=n.redSqr(),0===n.cmp(f))return n.fromRed().subn(1).gcd(a);if(0===n.cmp(k))break}if(o===i)return n=n.redSqr(),n.fromRed().subn(1).gcd(a)}}return!1}},{"bn.js":274,brorand:276}],276:[function(a,b,c){arguments[4][183][0].apply(c,arguments)},{dup:183}],277:[function(a,b,c){(function(b){function d(a,b,c,d,f,g){if("function"==typeof f&&(g=f,f=void 0),"function"!=typeof g)throw new Error("No callback provided to pbkdf2");var h=e(a,b,c,d,f);setTimeout(function(){g(void 0,h)})}function e(a,c,d,e,h){if("number"!=typeof d)throw new TypeError("Iterations not a number");if(d<0)throw new TypeError("Bad iterations");if("number"!=typeof e)throw new TypeError("Key length not a number");if(e<0||e>g)throw new TypeError("Bad key length");h=h||"sha1",b.isBuffer(a)||(a=new b(a,"binary")),b.isBuffer(c)||(c=new b(c,"binary"));var i,j=1,k=new b(e),l=new b(c.length+4);c.copy(l,0,0,c.length);for(var m,n,o=1;o<=j;o++){l.writeUInt32BE(o,c.length);var p=f(h,a).update(l).digest();i||(i=p.length,n=new b(i),j=Math.ceil(e/i),m=e-(j-1)*i),p.copy(n,0,0,i);for(var q=1;q<d;q++){p=f(h,a).update(p).digest();for(var r=0;r<i;r++)n[r]^=p[r]}var s=(o-1)*i,t=o===j?m:i;n.copy(k,s,0,t)}return k}var f=a("create-hmac"),g=Math.pow(2,30)-1;c.pbkdf2=d,c.pbkdf2Sync=e}).call(this,a("buffer").Buffer)},{buffer:128,"create-hmac":269}],278:[function(a,b,c){c.publicEncrypt=a("./publicEncrypt"),c.privateDecrypt=a("./privateDecrypt"),c.privateEncrypt=function(a,b){return c.publicEncrypt(a,b,!0)},c.publicDecrypt=function(a,b){return c.privateDecrypt(a,b,!0)}},{"./privateDecrypt":319,"./publicEncrypt":320}],279:[function(a,b,c){(function(c){function d(a){var b=new c(4);return b.writeUInt32BE(a,0),b}var e=a("create-hash");b.exports=function(a,b){for(var f,g=new c(""),h=0;g.length<b;)f=d(h++),g=c.concat([g,e("sha1").update(a).update(f).digest()]);return g.slice(0,b)}}).call(this,a("buffer").Buffer)},{buffer:128,"create-hash":256}],280:[function(a,b,c){arguments[4][165][0].apply(c,arguments)},{dup:165}],281:[function(a,b,c){arguments[4][166][0].apply(c,arguments)},{"bn.js":280,buffer:128,dup:166,randombytes:323}],282:[function(a,b,c){arguments[4][191][0].apply(c,arguments)},{dup:191}],283:[function(a,b,c){arguments[4][192][0].apply(c,arguments)},{"asn1.js":286,dup:192}],284:[function(a,b,c){arguments[4][193][0].apply(c,arguments)},{"browserify-aes":303,buffer:128,dup:193,evp_bytestokey:318}],285:[function(a,b,c){arguments[4][194][0].apply(c,arguments)},{"./aesid.json":282,"./asn1":283,"./fixProc":284,"browserify-aes":303,buffer:128,dup:194,pbkdf2:277}],286:[function(a,b,c){arguments[4][195][0].apply(c,arguments)},{"./asn1/api":287,"./asn1/base":289,"./asn1/constants":293,"./asn1/decoders":295,"./asn1/encoders":298,"bn.js":280,dup:195}],287:[function(a,b,c){arguments[4][196][0].apply(c,arguments)},{"../asn1":286,dup:196,inherits:326,vm:360}],288:[function(a,b,c){arguments[4][197][0].apply(c,arguments)},{"../base":289,buffer:128,dup:197,inherits:326}],289:[function(a,b,c){arguments[4][198][0].apply(c,arguments)},{"./buffer":288,"./node":290,"./reporter":291,dup:198}],290:[function(a,b,c){arguments[4][199][0].apply(c,arguments)},{"../base":289,dup:199,"minimalistic-assert":300}],291:[function(a,b,c){arguments[4][200][0].apply(c,arguments)},{dup:200,inherits:326}],292:[function(a,b,c){arguments[4][201][0].apply(c,arguments)},{"../constants":293,dup:201}],293:[function(a,b,c){arguments[4][202][0].apply(c,arguments)},{"./der":292,dup:202}],294:[function(a,b,c){arguments[4][203][0].apply(c,arguments)},{"../../asn1":286,dup:203,inherits:326}],295:[function(a,b,c){arguments[4][204][0].apply(c,arguments)},{"./der":294,"./pem":296,dup:204}],296:[function(a,b,c){arguments[4][205][0].apply(c,arguments)},{"./der":294,buffer:128,dup:205,inherits:326}],297:[function(a,b,c){arguments[4][206][0].apply(c,arguments)},{"../../asn1":286,buffer:128,dup:206,inherits:326}],298:[function(a,b,c){arguments[4][207][0].apply(c,arguments)},{"./der":297,"./pem":299,dup:207}],299:[function(a,b,c){arguments[4][208][0].apply(c,arguments)},{"./der":297,dup:208,inherits:326}],300:[function(a,b,c){arguments[4][160][0].apply(c,arguments)},{dup:160}],301:[function(a,b,c){arguments[4][134][0].apply(c,arguments)},{buffer:128,dup:134}],302:[function(a,b,c){arguments[4][135][0].apply(c,arguments)},{"./aes":301,"./ghash":306,buffer:128,"buffer-xor":315,"cipher-base":316,dup:135,inherits:326}],303:[function(a,b,c){arguments[4][136][0].apply(c,arguments)},{"./decrypter":304,"./encrypter":305,"./modes":307,dup:136}],304:[function(a,b,c){arguments[4][137][0].apply(c,arguments)},{"./aes":301,"./authCipher":302,"./modes":307,"./modes/cbc":308,"./modes/cfb":309,"./modes/cfb1":310,"./modes/cfb8":311,"./modes/ctr":312,
"./modes/ecb":313,"./modes/ofb":314,"./streamCipher":317,buffer:128,"cipher-base":316,dup:137,evp_bytestokey:318,inherits:326}],305:[function(a,b,c){arguments[4][138][0].apply(c,arguments)},{"./aes":301,"./authCipher":302,"./modes":307,"./modes/cbc":308,"./modes/cfb":309,"./modes/cfb1":310,"./modes/cfb8":311,"./modes/ctr":312,"./modes/ecb":313,"./modes/ofb":314,"./streamCipher":317,buffer:128,"cipher-base":316,dup:138,evp_bytestokey:318,inherits:326}],306:[function(a,b,c){arguments[4][139][0].apply(c,arguments)},{buffer:128,dup:139}],307:[function(a,b,c){arguments[4][140][0].apply(c,arguments)},{dup:140}],308:[function(a,b,c){arguments[4][141][0].apply(c,arguments)},{"buffer-xor":315,dup:141}],309:[function(a,b,c){arguments[4][142][0].apply(c,arguments)},{buffer:128,"buffer-xor":315,dup:142}],310:[function(a,b,c){arguments[4][143][0].apply(c,arguments)},{buffer:128,dup:143}],311:[function(a,b,c){arguments[4][144][0].apply(c,arguments)},{buffer:128,dup:144}],312:[function(a,b,c){arguments[4][145][0].apply(c,arguments)},{buffer:128,"buffer-xor":315,dup:145}],313:[function(a,b,c){arguments[4][146][0].apply(c,arguments)},{dup:146}],314:[function(a,b,c){arguments[4][147][0].apply(c,arguments)},{buffer:128,"buffer-xor":315,dup:147}],315:[function(a,b,c){arguments[4][148][0].apply(c,arguments)},{buffer:128,dup:148}],316:[function(a,b,c){arguments[4][149][0].apply(c,arguments)},{buffer:128,dup:149,inherits:326,stream:348,string_decoder:355}],317:[function(a,b,c){arguments[4][150][0].apply(c,arguments)},{"./aes":301,buffer:128,"cipher-base":316,dup:150,inherits:326}],318:[function(a,b,c){arguments[4][161][0].apply(c,arguments)},{buffer:128,"create-hash/md5":258,dup:161}],319:[function(a,b,c){(function(c){function d(a,b){var d=(a.modulus,a.modulus.byteLength()),e=(b.length,l("sha1").update(new c("")).digest()),g=e.length;if(0!==b[0])throw new Error("decryption error");var j=b.slice(1,g+1),k=b.slice(g+1),m=i(j,h(k,g)),n=i(k,h(m,d-g-1));if(f(e,n.slice(0,g)))throw new Error("decryption error");for(var o=g;0===n[o];)o++;if(1!==n[o++])throw new Error("decryption error");return n.slice(o)}function e(a,b,c){for(var d=b.slice(0,2),e=2,f=0;0!==b[e++];)if(e>=b.length){f++;break}var g=b.slice(2,e-1);b.slice(e-1,e);if(("0002"!==d.toString("hex")&&!c||"0001"!==d.toString("hex")&&c)&&f++,g.length<8&&f++,f)throw new Error("decryption error");return b.slice(e)}function f(a,b){a=new c(a),b=new c(b);var d=0,e=a.length;a.length!==b.length&&(d++,e=Math.min(a.length,b.length));for(var f=-1;++f<e;)d+=a[f]^b[f];return d}var g=a("parse-asn1"),h=a("./mgf"),i=a("./xor"),j=a("bn.js"),k=a("browserify-rsa"),l=a("create-hash"),m=a("./withPublic");b.exports=function(a,b,f){var h;h=a.padding?a.padding:f?1:4;var i=g(a),l=i.modulus.byteLength();if(b.length>l||new j(b).cmp(i.modulus)>=0)throw new Error("decryption error");var n;n=f?m(new j(b),i):k(b,i);var o=new c(l-n.length);if(o.fill(0),n=c.concat([o,n],l),4===h)return d(i,n);if(1===h)return e(i,n,f);if(3===h)return n;throw new Error("unknown padding")}}).call(this,a("buffer").Buffer)},{"./mgf":279,"./withPublic":321,"./xor":322,"bn.js":280,"browserify-rsa":281,buffer:128,"create-hash":256,"parse-asn1":285}],320:[function(a,b,c){(function(c){function d(a,b){var d=a.modulus.byteLength(),e=b.length,f=i("sha1").update(new c("")).digest(),g=f.length,m=2*g;if(e>d-m-2)throw new Error("message too long");var n=new c(d-e-m-2);n.fill(0);var o=d-g-1,p=h(g),q=k(c.concat([f,n,new c([1]),b],o),j(p,o)),r=k(p,j(q,g));return new l(c.concat([new c([0]),r,q],d))}function e(a,b,d){var e=b.length,g=a.modulus.byteLength();if(e>g-11)throw new Error("message too long");var h;return d?(h=new c(g-e-3),h.fill(255)):h=f(g-e-3),new l(c.concat([new c([0,d?1:2]),h,new c([0]),b],g))}function f(a,b){for(var d,e=new c(a),f=0,g=h(2*a),i=0;f<a;)i===g.length&&(g=h(2*a),i=0),d=g[i++],d&&(e[f++]=d);return e}var g=a("parse-asn1"),h=a("randombytes"),i=a("create-hash"),j=a("./mgf"),k=a("./xor"),l=a("bn.js"),m=a("./withPublic"),n=a("browserify-rsa");b.exports=function(a,b,c){var f;f=a.padding?a.padding:c?1:4;var h,i=g(a);if(4===f)h=d(i,b);else if(1===f)h=e(i,b,c);else{if(3!==f)throw new Error("unknown padding");if(h=new l(b),h.cmp(i.modulus)>=0)throw new Error("data too long for modulus")}return c?n(h,i):m(h,i)}}).call(this,a("buffer").Buffer)},{"./mgf":279,"./withPublic":321,"./xor":322,"bn.js":280,"browserify-rsa":281,buffer:128,"create-hash":256,"parse-asn1":285,randombytes:323}],321:[function(a,b,c){(function(c){function d(a,b){return new c(a.toRed(e.mont(b.modulus)).redPow(new e(b.publicExponent)).fromRed().toArray())}var e=a("bn.js");b.exports=d}).call(this,a("buffer").Buffer)},{"bn.js":280,buffer:128}],322:[function(a,b,c){b.exports=function(a,b){for(var c=a.length,d=-1;++d<c;)a[d]^=b[d];return a}},{}],323:[function(a,b,c){(function(a,c,d){"use strict";function e(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}function f(b,e){if(b>65536)throw new Error("requested too many random bytes");var f=new c.Uint8Array(b);b>0&&g.getRandomValues(f);var h=new d(f.buffer);return"function"==typeof e?a.nextTick(function(){e(null,h)}):h}var g=c.crypto||c.msCrypto;g&&g.getRandomValues?b.exports=f:b.exports=e}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer)},{_process:329,buffer:128}],324:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),c.apply(this,f)}else if(g(c))for(f=Array.prototype.slice.call(arguments,1),j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f);return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned&&(c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else if(c)for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.prototype.listenerCount=function(a){if(this._events){var b=this._events[a];if(e(b))return 1;if(b)return b.length}return 0},d.listenerCount=function(a,b){return a.listenerCount(b)}},{}],325:[function(a,b,c){var d=a("http"),e=b.exports;for(var f in d)d.hasOwnProperty(f)&&(e[f]=d[f]);e.request=function(a,b){return a||(a={}),a.scheme="https",a.protocol="https:",d.request.call(this,a,b)}},{http:349}],326:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],327:[function(a,b,c){b.exports=function(a){return!(null==a||!(a._isBuffer||a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)))}},{}],328:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a,b){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;i<g;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return b<0&&(b=a.length+b),a.substr(b,c)}}).call(this,a("_process"))},{_process:329}],329:[function(a,b,c){function d(){k&&h&&(k=!1,h.length?j=h.concat(j):l=-1,j.length&&e())}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h&&h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],330:[function(a,b,c){(function(a){!function(d){function e(a){throw new RangeError(H[a])}function f(a,b){for(var c=a.length,d=[];c--;)d[c]=b(a[c]);return d}function g(a,b){var c=a.split("@"),d="";c.length>1&&(d=c[0]+"@",a=c[1]),a=a.replace(G,".");var e=a.split("."),g=f(e,b).join(".");return d+g}function h(a){for(var b,c,d=[],e=0,f=a.length;e<f;)b=a.charCodeAt(e++),b>=55296&&b<=56319&&e<f?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function i(a){return f(a,function(a){var b="";return a>65535&&(a-=65536,b+=K(a>>>10&1023|55296),a=56320|1023&a),b+=K(a)}).join("")}function j(a){return a-48<10?a-22:a-65<26?a-65:a-97<26?a-97:w}function k(a,b){return a+22+75*(a<26)-((0!=b)<<5)}function l(a,b,c){var d=0;for(a=c?J(a/A):a>>1,a+=J(a/b);a>I*y>>1;d+=w)a=J(a/I);return J(d+(I+1)*a/(a+z))}function m(a){var b,c,d,f,g,h,k,m,n,o,p=[],q=a.length,r=0,s=C,t=B;for(c=a.lastIndexOf(D),c<0&&(c=0),d=0;d<c;++d)a.charCodeAt(d)>=128&&e("not-basic"),p.push(a.charCodeAt(d));for(f=c>0?c+1:0;f<q;){for(g=r,h=1,k=w;f>=q&&e("invalid-input"),m=j(a.charCodeAt(f++)),(m>=w||m>J((v-r)/h))&&e("overflow"),r+=m*h,n=k<=t?x:k>=t+y?y:k-t,!(m<n);k+=w)o=w-n,h>J(v/o)&&e("overflow"),h*=o;b=p.length+1,t=l(r-g,b,0==g),J(r/b)>v-s&&e("overflow"),s+=J(r/b),r%=b,p.splice(r++,0,s)}return i(p)}function n(a){var b,c,d,f,g,i,j,m,n,o,p,q,r,s,t,u=[];for(a=h(a),q=a.length,b=C,c=0,g=B,i=0;i<q;++i)p=a[i],p<128&&u.push(K(p));for(d=f=u.length,f&&u.push(D);d<q;){for(j=v,i=0;i<q;++i)p=a[i],p>=b&&p<j&&(j=p);for(r=d+1,j-b>J((v-c)/r)&&e("overflow"),c+=(j-b)*r,b=j,i=0;i<q;++i)if(p=a[i],p<b&&++c>v&&e("overflow"),p==b){for(m=c,n=w;o=n<=g?x:n>=g+y?y:n-g,!(m<o);n+=w)t=m-o,s=w-o,u.push(K(k(o+t%s,0))),m=J(t/s);u.push(K(k(m,0))),g=l(c,r,d==f),c=0,++d}++c,++b}return u.join("")}function o(a){return g(a,function(a){return E.test(a)?m(a.slice(4).toLowerCase()):a})}function p(a){return g(a,function(a){return F.test(a)?"xn--"+n(a):a})}var q="object"==typeof c&&c&&!c.nodeType&&c,r="object"==typeof b&&b&&!b.nodeType&&b,s="object"==typeof a&&a;s.global!==s&&s.window!==s&&s.self!==s||(d=s);var t,u,v=2147483647,w=36,x=1,y=26,z=38,A=700,B=72,C=128,D="-",E=/^xn--/,F=/[^\x20-\x7E]/,G=/[\x2E\u3002\uFF0E\uFF61]/g,H={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=w-x,J=Math.floor,K=String.fromCharCode;if(t={version:"1.4.1",ucs2:{decode:h,encode:i},decode:m,encode:n,toASCII:p,toUnicode:o},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return t});else if(q&&r)if(b.exports==q)r.exports=t;else for(u in t)t.hasOwnProperty(u)&&(q[u]=t[u]);else d.punycode=t}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],331:[function(a,b,c){"use strict";function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,c,f){b=b||"&",c=c||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;k<j;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(c);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),d(g,n)?e(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],332:[function(a,b,c){"use strict";function d(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var e=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,c,h){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"==typeof a?d(g(a),function(g){var h=encodeURIComponent(e(g))+c;return f(a[g])?d(a[g],function(a){return h+encodeURIComponent(e(a))}).join(b):h+encodeURIComponent(e(a[g]))}).join(b):h?encodeURIComponent(e(h))+c+encodeURIComponent(e(a)):""};var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],333:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":331,"./encode":332}],334:[function(a,b,c){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":335}],335:[function(a,b,c){"use strict";function d(a){return this instanceof d?(j.call(this,a),k.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||h(f,this)}function f(a){a.end()}var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b};b.exports=d;var h=a("process-nextick-args"),i=a("core-util-is");i.inherits=a("inherits");var j=a("./_stream_readable"),k=a("./_stream_writable");i.inherits(d,j);for(var l=g(k.prototype),m=0;m<l.length;m++){var n=l[m];d.prototype[n]||(d.prototype[n]=k.prototype[n])}},{"./_stream_readable":337,"./_stream_writable":339,"core-util-is":340,inherits:326,"process-nextick-args":342}],336:[function(a,b,c){"use strict";function d(a){return this instanceof d?void e.call(this,a):new d(a)}b.exports=d;var e=a("./_stream_transform"),f=a("core-util-is");f.inherits=a("inherits"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":338,"core-util-is":340,inherits:326}],337:[function(a,b,c){(function(c){"use strict";function d(b,c){I=I||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof I&&(this.objectMode=this.objectMode||!!b.readableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(H||(H=a("string_decoder/").StringDecoder),this.decoder=new H(b.encoding),this.encoding=b.encoding)}function e(b){return I=I||a("./_stream_duplex"),this instanceof e?(this._readableState=new d(b,this),this.readable=!0,b&&"function"==typeof b.read&&(this._read=b.read),void C.call(this)):new e(b)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(null===c)b.reading=!1,k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else{var i;!b.decoder||e||d||(c=b.decoder.write(c),i=!b.objectMode&&0===c.length),e||(b.reading=!1),i||(b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&l(a))),n(a,b)}else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){return a>=J?a=J:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++),a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:null===a||isNaN(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:a<=0?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return B.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(!b.ended){if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,l(a)}}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(G("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?z(m,a):m(a))}function m(a){G("emit readable"),a.emit("readable"),t(a)}function n(a,b){b.readingMore||(b.readingMore=!0,z(o,a,b))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(G("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;G("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&D(a,"data")&&(b.flowing=!0,t(a))}}function q(a){G("readable nexttick read 0"),a.read(0)}function r(a,b){b.resumeScheduled||(b.resumeScheduled=!0,z(s,a,b))}function s(a,b){b.reading||(G("resume read 0"),a.read(0)),b.resumeScheduled=!1,a.emit("resume"),t(a),b.flowing&&!b.reading&&a.read(0)}function t(a){var b=a._readableState;if(G("flow",b.flowing),b.flowing)do var c=a.read();while(null!==c&&b.flowing)}function u(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):1===d.length?d[0]:B.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new B(a);for(var i=0,j=0,k=d.length;j<k&&i<a;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function v(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");b.endEmitted||(b.ended=!0,z(w,b,a))}function w(a,b){a.endEmitted||0!==a.length||(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function x(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)}function y(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}b.exports=e;var z=a("process-nextick-args"),A=a("isarray"),B=a("buffer").Buffer;e.ReadableState=d;var C,D=(a("events"),function(a,b){return a.listeners(b).length});!function(){try{C=a("stream")}catch(a){}finally{C||(C=a("events").EventEmitter)}}();var B=a("buffer").Buffer,E=a("core-util-is");E.inherits=a("inherits");var F=a("util"),G=void 0;G=F&&F.debuglog?F.debuglog("stream"):function(){};var H;E.inherits(e,C);var I,I;e.prototype.push=function(a,b){var c=this._readableState;return c.objectMode||"string"!=typeof a||(b=b||c.defaultEncoding,b!==c.encoding&&(a=new B(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.isPaused=function(){return this._readableState.flowing===!1},e.prototype.setEncoding=function(b){return H||(H=a("string_decoder/").StringDecoder),this._readableState.decoder=new H(b),this._readableState.encoding=b,this};var J=8388608;e.prototype.read=function(a){G("read",a);var b=this._readableState,c=a;if(("number"!=typeof a||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return G("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?v(this):l(this),null;if(a=i(a,b),0===a&&b.ended)return 0===b.length&&v(this),null;var d=b.needReadable;G("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,G("length less than watermark",d)),(b.ended||b.reading)&&(d=!1,G("reading or ended",d)),d&&(G("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=i(c,b));var e;return e=a>0?u(a,b):null,null===e&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),c!==a&&b.ended&&0===b.length&&v(this),null!==e&&this.emit("data",e),e},e.prototype._read=function(a){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){G("onunpipe"),a===l&&f()}function e(){G("onend"),a.end()}function f(){G("cleanup"),a.removeListener("close",i),a.removeListener("finish",j),a.removeListener("drain",q),a.removeListener("error",h),a.removeListener("unpipe",d),l.removeListener("end",e),l.removeListener("end",f),l.removeListener("data",g),r=!0,!m.awaitDrain||a._writableState&&!a._writableState.needDrain||q()}function g(b){G("ondata");var c=a.write(b);!1===c&&(1!==m.pipesCount||m.pipes[0]!==a||1!==l.listenerCount("data")||r||(G("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++),l.pause())}function h(b){G("onerror",b),k(),a.removeListener("error",h),0===D(a,"error")&&a.emit("error",b)}function i(){a.removeListener("finish",j),k()}function j(){G("onfinish"),a.removeListener("close",i),k()}function k(){G("unpipe"),l.unpipe(a)}var l=this,m=this._readableState;switch(m.pipesCount){case 0:m.pipes=a;break;case 1:m.pipes=[m.pipes,a];break;default:m.pipes.push(a)}m.pipesCount+=1,G("pipe count=%d opts=%j",m.pipesCount,b);var n=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,o=n?e:f;m.endEmitted?z(o):l.once("end",o),a.on("unpipe",d);var q=p(l);a.on("drain",q);var r=!1;return l.on("data",g),a._events&&a._events.error?A(a._events.error)?a._events.error.unshift(h):a._events.error=[h,a._events.error]:a.on("error",h),a.once("close",i),a.once("finish",j),a.emit("pipe",l),m.flowing||(G("pipe resume"),l.resume()),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;e<d;e++)c[e].emit("unpipe",this);return this}var f=y(b.pipes,a);return f===-1?this:(b.pipes.splice(f,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var c=C.prototype.on.call(this,a,b);if("data"===a&&!1!==this._readableState.flowing&&this.resume(),"readable"===a&&!this._readableState.endEmitted){var d=this._readableState;d.readableListening||(d.readableListening=!0,d.emittedReadable=!1,d.needReadable=!0,d.reading?d.length&&l(this,d):z(q,this))}return c},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){var a=this._readableState;return a.flowing||(G("resume"),a.flowing=!0,r(this,a)),this},e.prototype.pause=function(){return G("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(G("pause"),this._readableState.flowing=!1,this.emit("pause")),this},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(G("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(G("wrapped data"),b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)void 0===this[e]&&"function"==typeof a[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return x(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){G("wrapped _read",b),c&&(c=!1,a.resume())},d},e._fromList=u}).call(this,a("_process"))},{"./_stream_duplex":335,_process:329,buffer:128,"core-util-is":340,events:324,inherits:326,isarray:341,"process-nextick-args":342,"string_decoder/":355,util:114}],338:[function(a,b,c){"use strict";function d(a){this.afterTransform=function(b,c){return e(a,b,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a),this._transformState=new d(this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,a&&("function"==typeof a.transform&&(this._transform=a.transform),"function"==typeof a.flush&&(this._flush=a.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=a._transformState;if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0}},{"./_stream_duplex":335,"core-util-is":340,inherits:326}],339:[function(a,b,c){(function(c){"use strict";function d(){}function e(a,b,c){this.chunk=a,this.encoding=b,this.callback=c,this.next=null}function f(b,c){D=D||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof D&&(this.objectMode=this.objectMode||!!b.writableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var f=b.decodeStrings===!1;this.decodeStrings=!f,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){o(c,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new w(this),this.corkedRequestsFree.next=new w(this)}function g(b){return D=D||a("./_stream_duplex"),this instanceof g||this instanceof D?(this._writableState=new f(b,this),this.writable=!0,b&&("function"==typeof b.write&&(this._write=b.write),"function"==typeof b.writev&&(this._writev=b.writev)),void B.call(this)):new g(b)}function h(a,b){var c=new Error("write after end");a.emit("error",c),x(b,c)}function i(a,b,c,d){var e=!0;if(!z.isBuffer(c)&&"string"!=typeof c&&null!==c&&void 0!==c&&!b.objectMode){var f=new TypeError("Invalid non-string/buffer chunk");a.emit("error",f),x(d,f),e=!1}return e}function j(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=new z(b,c)),b}function k(a,b,c,d,f){c=j(b,c,d),z.isBuffer(c)&&(d="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;if(h||(b.needDrain=!0),b.writing||b.corked){var i=b.lastBufferedRequest;b.lastBufferedRequest=new e(c,d,f),i?i.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest,b.bufferedRequestCount+=1}else l(a,b,!1,g,c,d,f);return h}function l(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function m(a,b,c,d,e){
--b.pendingcb,c?x(e,d):e(d),a._writableState.errorEmitted=!0,a.emit("error",d)}function n(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function o(a,b){var c=a._writableState,d=c.sync,e=c.writecb;if(n(c),b)m(a,c,d,b,e);else{var f=s(c);f||c.corked||c.bufferProcessing||!c.bufferedRequest||r(a,c),d?y(p,a,c,f,e):p(a,c,f,e)}}function p(a,b,c,d){c||q(a,b),b.pendingcb--,d(),u(a,b)}function q(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function r(a,b){b.bufferProcessing=!0;var c=b.bufferedRequest;if(a._writev&&c&&c.next){var d=b.bufferedRequestCount,e=new Array(d),f=b.corkedRequestsFree;f.entry=c;for(var g=0;c;)e[g]=c,c=c.next,g+=1;l(a,b,!0,b.length,e,"",f.finish),b.pendingcb++,b.lastBufferedRequest=null,b.corkedRequestsFree=f.next,f.next=null}else{for(;c;){var h=c.chunk,i=c.encoding,j=c.callback,k=b.objectMode?1:h.length;if(l(a,b,!1,k,h,i,j),c=c.next,b.writing)break}null===c&&(b.lastBufferedRequest=null)}b.bufferedRequestCount=0,b.bufferedRequest=c,b.bufferProcessing=!1}function s(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function t(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function u(a,b){var c=s(b);return c&&(0===b.pendingcb?(t(a,b),b.finished=!0,a.emit("finish")):t(a,b)),c}function v(a,b,c){b.ending=!0,u(a,b),c&&(b.finished?x(c):a.once("finish",c)),b.ended=!0,a.writable=!1}function w(a){var b=this;this.next=null,this.entry=null,this.finish=function(c){var d=b.entry;for(b.entry=null;d;){var e=d.callback;a.pendingcb--,e(c),d=d.next}a.corkedRequestsFree?a.corkedRequestsFree.next=b:a.corkedRequestsFree=b}}b.exports=g;var x=a("process-nextick-args"),y=!c.browser&&["v0.10","v0.9."].indexOf(c.version.slice(0,5))>-1?setImmediate:x,z=a("buffer").Buffer;g.WritableState=f;var A=a("core-util-is");A.inherits=a("inherits");var B,C={deprecate:a("util-deprecate")};!function(){try{B=a("stream")}catch(a){}finally{B||(B=a("events").EventEmitter)}}();var z=a("buffer").Buffer;A.inherits(g,B);var D;f.prototype.getBuffer=function(){for(var a=this.bufferedRequest,b=[];a;)b.push(a),a=a.next;return b},function(){try{Object.defineProperty(f.prototype,"buffer",{get:C.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(a){}}();var D;g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},g.prototype.write=function(a,b,c){var e=this._writableState,f=!1;return"function"==typeof b&&(c=b,b=null),z.isBuffer(a)?b="buffer":b||(b=e.defaultEncoding),"function"!=typeof c&&(c=d),e.ended?h(this,c):i(this,e,a,c)&&(e.pendingcb++,f=k(this,e,a,b,c)),f},g.prototype.cork=function(){var a=this._writableState;a.corked++},g.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.bufferedRequest||r(this,a))},g.prototype.setDefaultEncoding=function(a){if("string"==typeof a&&(a=a.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+a);this._writableState.defaultEncoding=a},g.prototype._write=function(a,b,c){c(new Error("not implemented"))},g.prototype._writev=null,g.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),null!==a&&void 0!==a&&this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||v(this,d,c)}}).call(this,a("_process"))},{"./_stream_duplex":335,_process:329,buffer:128,"core-util-is":340,events:324,inherits:326,"process-nextick-args":342,"util-deprecate":343}],340:[function(a,b,c){(function(a){function b(a){return Array.isArray?Array.isArray(a):"[object Array]"===q(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return"[object RegExp]"===q(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return"[object Date]"===q(a)}function n(a){return"[object Error]"===q(a)||a instanceof Error}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=a.isBuffer}).call(this,{isBuffer:a("../../../../insert-module-globals/node_modules/is-buffer/index.js")})},{"../../../../insert-module-globals/node_modules/is-buffer/index.js":327}],341:[function(a,b,c){arguments[4][65][0].apply(c,arguments)},{dup:65}],342:[function(a,b,c){(function(a){"use strict";function c(b,c,d,e){if("function"!=typeof b)throw new TypeError('"callback" argument must be a function');var f,g,h=arguments.length;switch(h){case 0:case 1:return a.nextTick(b);case 2:return a.nextTick(function(){b.call(null,c)});case 3:return a.nextTick(function(){b.call(null,c,d)});case 4:return a.nextTick(function(){b.call(null,c,d,e)});default:for(f=new Array(h-1),g=0;g<f.length;)f[g++]=arguments[g];return a.nextTick(function(){b.apply(null,f)})}}!a.version||0===a.version.indexOf("v0.")||0===a.version.indexOf("v1.")&&0!==a.version.indexOf("v1.8.")?b.exports=c:b.exports=a.nextTick}).call(this,a("_process"))},{_process:329}],343:[function(a,b,c){(function(a){function c(a,b){function c(){if(!e){if(d("throwDeprecation"))throw new Error(b);d("traceDeprecation")?console.trace(b):console.warn(b),e=!0}return a.apply(this,arguments)}if(d("noDeprecation"))return a;var e=!1;return c}function d(b){try{if(!a.localStorage)return!1}catch(a){return!1}var c=a.localStorage[b];return null!=c&&"true"===String(c).toLowerCase()}b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],344:[function(a,b,c){b.exports=a("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":336}],345:[function(a,b,c){(function(d){var e=function(){try{return a("stream")}catch(a){}}();c=b.exports=a("./lib/_stream_readable.js"),c.Stream=e||c,c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js"),!d.browser&&"disable"===d.env.READABLE_STREAM&&e&&(b.exports=e)}).call(this,a("_process"))},{"./lib/_stream_duplex.js":335,"./lib/_stream_passthrough.js":336,"./lib/_stream_readable.js":337,"./lib/_stream_transform.js":338,"./lib/_stream_writable.js":339,_process:329}],346:[function(a,b,c){b.exports=a("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":338}],347:[function(a,b,c){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":339}],348:[function(a,b,c){function d(){e.call(this)}b.exports=d;var e=a("events").EventEmitter,f=a("inherits");f(d,e),d.Readable=a("readable-stream/readable.js"),d.Writable=a("readable-stream/writable.js"),d.Duplex=a("readable-stream/duplex.js"),d.Transform=a("readable-stream/transform.js"),d.PassThrough=a("readable-stream/passthrough.js"),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{events:324,inherits:326,"readable-stream/duplex.js":334,"readable-stream/passthrough.js":344,"readable-stream/readable.js":345,"readable-stream/transform.js":346,"readable-stream/writable.js":347}],349:[function(a,b,c){(function(b){var d=a("./lib/request"),e=a("xtend"),f=a("builtin-status-codes"),g=a("url"),h=c;h.request=function(a,c){a="string"==typeof a?g.parse(a):e(a);var f=b.location.protocol.search(/^https?:$/)===-1?"http:":"",h=a.protocol||f,i=a.hostname||a.host,j=a.port,k=a.path||"/";i&&i.indexOf(":")!==-1&&(i="["+i+"]"),a.url=(i?h+"//"+i:"")+(j?":"+j:"")+k,a.method=(a.method||"GET").toUpperCase(),a.headers=a.headers||{};var l=new d(a);return c&&l.on("response",c),l},h.get=function(a,b){var c=h.request(a,b);return c.end(),c},h.Agent=function(){},h.Agent.defaultMaxSockets=4,h.STATUS_CODES=f,h.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/request":351,"builtin-status-codes":353,url:356,xtend:362}],350:[function(a,b,c){(function(a){function b(a){try{return e.responseType=a,e.responseType===a}catch(a){}return!1}function d(a){return"function"==typeof a}c.fetch=d(a.fetch)&&d(a.ReadableByteStream),c.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),c.blobConstructor=!0}catch(a){}var e=new a.XMLHttpRequest;e.open("GET",a.location.host?"/":"https://example.com");var f="undefined"!=typeof a.ArrayBuffer,g=f&&d(a.ArrayBuffer.prototype.slice);c.arraybuffer=f&&b("arraybuffer"),c.msstream=!c.fetch&&g&&b("ms-stream"),c.mozchunkedarraybuffer=!c.fetch&&f&&b("moz-chunked-arraybuffer"),c.overrideMimeType=d(e.overrideMimeType),c.vbArray=d(a.VBArray),e=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],351:[function(a,b,c){(function(c,d,e){function f(a){return h.fetch?"fetch":h.mozchunkedarraybuffer?"moz-chunked-arraybuffer":h.msstream?"ms-stream":h.arraybuffer&&a?"arraybuffer":h.vbArray&&a?"text:vbarray":"text"}function g(a){try{var b=a.status;return null!==b&&0!==b}catch(a){return!1}}var h=a("./capability"),i=a("inherits"),j=a("./response"),k=a("readable-stream"),l=a("to-arraybuffer"),m=j.IncomingMessage,n=j.readyStates,o=b.exports=function(a){var b=this;k.Writable.call(b),b._opts=a,b._body=[],b._headers={},a.auth&&b.setHeader("Authorization","Basic "+new e(a.auth).toString("base64")),Object.keys(a.headers).forEach(function(c){b.setHeader(c,a.headers[c])});var c;if("prefer-streaming"===a.mode)c=!1;else if("allow-wrong-content-type"===a.mode)c=!h.overrideMimeType;else{if(a.mode&&"default"!==a.mode&&"prefer-fast"!==a.mode)throw new Error("Invalid value for opts.mode");c=!0}b._mode=f(c),b.on("finish",function(){b._onFinish()})};i(o,k.Writable),o.prototype.setHeader=function(a,b){var c=this,d=a.toLowerCase();p.indexOf(d)===-1&&(c._headers[d]={name:a,value:b})},o.prototype.getHeader=function(a){var b=this;return b._headers[a.toLowerCase()].value},o.prototype.removeHeader=function(a){var b=this;delete b._headers[a.toLowerCase()]},o.prototype._onFinish=function(){var a=this;if(!a._destroyed){var b,f=a._opts,g=a._headers;if("POST"!==f.method&&"PUT"!==f.method&&"PATCH"!==f.method||(b=h.blobConstructor?new d.Blob(a._body.map(function(a){return l(a)}),{type:(g["content-type"]||{}).value||""}):e.concat(a._body).toString()),"fetch"===a._mode){var i=Object.keys(g).map(function(a){return[g[a].name,g[a].value]});d.fetch(a._opts.url,{method:a._opts.method,headers:i,body:b,mode:"cors",credentials:f.withCredentials?"include":"same-origin"}).then(function(b){a._fetchResponse=b,a._connect()},function(b){a.emit("error",b)})}else{var j=a._xhr=new d.XMLHttpRequest;try{j.open(a._opts.method,a._opts.url,!0)}catch(b){return void c.nextTick(function(){a.emit("error",b)})}"responseType"in j&&(j.responseType=a._mode.split(":")[0]),"withCredentials"in j&&(j.withCredentials=!!f.withCredentials),"text"===a._mode&&"overrideMimeType"in j&&j.overrideMimeType("text/plain; charset=x-user-defined"),Object.keys(g).forEach(function(a){j.setRequestHeader(g[a].name,g[a].value)}),a._response=null,j.onreadystatechange=function(){switch(j.readyState){case n.LOADING:case n.DONE:a._onXHRProgress()}},"moz-chunked-arraybuffer"===a._mode&&(j.onprogress=function(){a._onXHRProgress()}),j.onerror=function(){a._destroyed||a.emit("error",new Error("XHR error"))};try{j.send(b)}catch(b){return void c.nextTick(function(){a.emit("error",b)})}}}},o.prototype._onXHRProgress=function(){var a=this;g(a._xhr)&&!a._destroyed&&(a._response||a._connect(),a._response._onXHRProgress())},o.prototype._connect=function(){var a=this;a._destroyed||(a._response=new m(a._xhr,a._fetchResponse,a._mode),a.emit("response",a._response))},o.prototype._write=function(a,b,c){var d=this;d._body.push(a),c()},o.prototype.abort=o.prototype.destroy=function(){var a=this;a._destroyed=!0,a._response&&(a._response._destroyed=!0),a._xhr&&a._xhr.abort()},o.prototype.end=function(a,b,c){var d=this;"function"==typeof a&&(c=a,a=void 0),k.Writable.prototype.end.call(d,a,b,c)},o.prototype.flushHeaders=function(){},o.prototype.setTimeout=function(){},o.prototype.setNoDelay=function(){},o.prototype.setSocketKeepAlive=function(){};var p=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"]}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer)},{"./capability":350,"./response":352,_process:329,buffer:128,inherits:326,"readable-stream":345,"to-arraybuffer":354}],352:[function(a,b,c){(function(b,d,e){var f=a("./capability"),g=a("inherits"),h=a("readable-stream"),i=c.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},j=c.IncomingMessage=function(a,c,d){function g(){m.read().then(function(a){if(!i._destroyed){if(a.done)return void i.push(null);i.push(new e(a.value)),g()}})}var i=this;if(h.Readable.call(i),i._mode=d,i.headers={},i.rawHeaders=[],i.trailers={},i.rawTrailers=[],i.on("end",function(){b.nextTick(function(){i.emit("close")})}),"fetch"===d){i._fetchResponse=c,i.url=c.url,i.statusCode=c.status,i.statusMessage=c.statusText;for(var j,k,l=c.headers[Symbol.iterator]();j=(k=l.next()).value,!k.done;)i.headers[j[0].toLowerCase()]=j[1],i.rawHeaders.push(j[0],j[1]);var m=c.body.getReader();g()}else{i._xhr=a,i._pos=0,i.url=a.responseURL,i.statusCode=a.status,i.statusMessage=a.statusText;var n=a.getAllResponseHeaders().split(/\r?\n/);if(n.forEach(function(a){var b=a.match(/^([^:]+):\s*(.*)/);if(b){var c=b[1].toLowerCase();"set-cookie"===c?(void 0===i.headers[c]&&(i.headers[c]=[]),i.headers[c].push(b[2])):void 0!==i.headers[c]?i.headers[c]+=", "+b[2]:i.headers[c]=b[2],i.rawHeaders.push(b[1],b[2])}}),i._charset="x-user-defined",!f.overrideMimeType){var o=i.rawHeaders["mime-type"];if(o){var p=o.match(/;\s*charset=([^;])(;|$)/);p&&(i._charset=p[1].toLowerCase())}i._charset||(i._charset="utf-8")}}};g(j,h.Readable),j.prototype._read=function(){},j.prototype._onXHRProgress=function(){var a=this,b=a._xhr,c=null;switch(a._mode){case"text:vbarray":if(b.readyState!==i.DONE)break;try{c=new d.VBArray(b.responseBody).toArray()}catch(a){}if(null!==c){a.push(new e(c));break}case"text":try{c=b.responseText}catch(b){a._mode="text:vbarray";break}if(c.length>a._pos){var f=c.substr(a._pos);if("x-user-defined"===a._charset){for(var g=new e(f.length),h=0;h<f.length;h++)g[h]=255&f.charCodeAt(h);a.push(g)}else a.push(f,a._charset);a._pos=c.length}break;case"arraybuffer":if(b.readyState!==i.DONE)break;c=b.response,a.push(new e(new Uint8Array(c)));break;case"moz-chunked-arraybuffer":if(c=b.response,b.readyState!==i.LOADING||!c)break;a.push(new e(new Uint8Array(c)));break;case"ms-stream":if(c=b.response,b.readyState!==i.LOADING)break;var j=new d.MSStreamReader;j.onprogress=function(){j.result.byteLength>a._pos&&(a.push(new e(new Uint8Array(j.result.slice(a._pos)))),a._pos=j.result.byteLength)},j.onload=function(){a.push(null)},j.readAsArrayBuffer(c)}a._xhr.readyState===i.DONE&&"ms-stream"!==a._mode&&a.push(null)}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer)},{"./capability":350,_process:329,buffer:128,inherits:326,"readable-stream":345}],353:[function(a,b,c){b.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],354:[function(a,b,c){var d=a("buffer").Buffer;b.exports=function(a){if(a instanceof Uint8Array){if(0===a.byteOffset&&a.byteLength===a.buffer.byteLength)return a.buffer;if("function"==typeof a.buffer.slice)return a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength)}if(d.isBuffer(a)){for(var b=new Uint8Array(a.length),c=a.length,e=0;e<c;e++)b[e]=a[e];return b.buffer}throw new Error("Argument must be a Buffer")}},{buffer:128}],355:[function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){this.charReceived=a.length%2,this.charLength=this.charReceived?2:0}function g(a){this.charReceived=a.length%3,this.charLength=this.charReceived?3:0}var h=a("buffer").Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="";this.charLength;){var c=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,0,c),this.charReceived+=c,this.charReceived<this.charLength)return"";a=a.slice(c,a.length),b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var d=b.charCodeAt(b.length-1);if(!(d>=55296&&d<=56319)){if(this.charReceived=this.charLength=0,0===a.length)return b;break}this.charLength+=this.surrogateSize,b=""}this.detectIncompleteChar(a);var e=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-this.charReceived,e),e-=this.charReceived),b+=a.toString(this.encoding,0,e);var e=b.length-1,d=b.charCodeAt(e);if(d>=55296&&d<=56319){var f=this.surrogateSize;return this.charLength+=f,this.charReceived+=f,this.charBuffer.copy(this.charBuffer,f,0,f),a.copy(this.charBuffer,0,0,f),b.substring(0,e)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(b<=2&&c>>4==14){this.charLength=3;break}if(b<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:128}],356:[function(a,b,c){"use strict";function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j.isObject(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return j.isString(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}var i=a("punycode"),j=a("./util");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var k=/^([a-z0-9.+-]+:)/i,l=/:[0-9]*$/,m=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,n=["<",">",'"',"`"," ","\r","\n","\t"],o=["{","}","|","\\","^","`"].concat(n),p=["'"].concat(o),q=["%","/","?",";","#"].concat(p),r=["/","?","#"],s=255,t=/^[+a-z0-9A-Z_-]{0,63}$/,u=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},w={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=a("querystring");d.prototype.parse=function(a,b,c){if(!j.isString(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a.indexOf("?"),e=d!==-1&&d<a.indexOf("#")?"?":"#",f=a.split(e),g=/\\/g;f[0]=f[0].replace(g,"/"),a=f.join(e);var h=a;if(h=h.trim(),!c&&1===a.split("#").length){var l=m.exec(h);if(l)return this.path=h,this.href=h,this.pathname=l[1],l[2]?(this.search=l[2],b?this.query=y.parse(this.search.substr(1)):this.query=this.search.substr(1)):b&&(this.search="",this.query={}),this}var n=k.exec(h);if(n){n=n[0];var o=n.toLowerCase();this.protocol=o,h=h.substr(n.length)}if(c||n||h.match(/^\/\/[^@\/]+@[^@\/]+/)){var z="//"===h.substr(0,2);!z||n&&w[n]||(h=h.substr(2),this.slashes=!0)}if(!w[n]&&(z||n&&!x[n])){for(var A=-1,B=0;B<r.length;B++){var C=h.indexOf(r[B]);C!==-1&&(A===-1||C<A)&&(A=C)}var D,E;E=A===-1?h.lastIndexOf("@"):h.lastIndexOf("@",A),E!==-1&&(D=h.slice(0,E),h=h.slice(E+1),this.auth=decodeURIComponent(D)),A=-1;for(var B=0;B<q.length;B++){var C=h.indexOf(q[B]);C!==-1&&(A===-1||C<A)&&(A=C)}A===-1&&(A=h.length),this.host=h.slice(0,A),h=h.slice(A),this.parseHost(),this.hostname=this.hostname||"";var F="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!F)for(var G=this.hostname.split(/\./),B=0,H=G.length;B<H;B++){var I=G[B];if(I&&!I.match(t)){for(var J="",K=0,L=I.length;K<L;K++)J+=I.charCodeAt(K)>127?"x":I[K];if(!J.match(t)){var M=G.slice(0,B),N=G.slice(B+1),O=I.match(u);O&&(M.push(O[1]),N.unshift(O[2])),N.length&&(h="/"+N.join(".")+h),this.hostname=M.join(".");break}}}this.hostname.length>s?this.hostname="":this.hostname=this.hostname.toLowerCase(),F||(this.hostname=i.toASCII(this.hostname));var P=this.port?":"+this.port:"",Q=this.hostname||"";this.host=Q+P,this.href+=this.host,F&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==h[0]&&(h="/"+h))}if(!v[o])for(var B=0,H=p.length;B<H;B++){var R=p[B];if(h.indexOf(R)!==-1){var S=encodeURIComponent(R);S===R&&(S=escape(R)),h=h.split(R).join(S)}}var T=h.indexOf("#");T!==-1&&(this.hash=h.substr(T),h=h.slice(0,T));var U=h.indexOf("?");if(U!==-1?(this.search=h.substr(U),this.query=h.substr(U+1),b&&(this.query=y.parse(this.query)),h=h.slice(0,U)):b&&(this.search="",this.query={}),h&&(this.pathname=h),x[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var P=this.pathname||"",V=this.search||"";this.path=P+V}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j.isObject(this.query)&&Object.keys(this.query).length&&(f=y.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||x[b])&&e!==!1?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(j.isString(a)){var b=new d;b.parse(a,!1,!0),a=b}for(var c=new d,e=Object.keys(this),f=0;f<e.length;f++){var g=e[f];c[g]=this[g]}if(c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol){for(var h=Object.keys(a),i=0;i<h.length;i++){var k=h[i];"protocol"!==k&&(c[k]=a[k])}return x[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c}if(a.protocol&&a.protocol!==c.protocol){if(!x[a.protocol]){for(var l=Object.keys(a),m=0;m<l.length;m++){var n=l[m];c[n]=a[n]}return c.href=c.format(),c}if(c.protocol=a.protocol,a.host||w[a.protocol])c.pathname=a.pathname;else{for(var o=(a.pathname||"").split("/");o.length&&!(a.host=o.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),c.pathname=o.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var p=c.pathname||"",q=c.search||"";c.path=p+q}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var r=c.pathname&&"/"===c.pathname.charAt(0),s=a.host||a.pathname&&"/"===a.pathname.charAt(0),t=s||r||c.host&&a.pathname,u=t,v=c.pathname&&c.pathname.split("/")||[],o=a.pathname&&a.pathname.split("/")||[],y=c.protocol&&!x[c.protocol];if(y&&(c.hostname="",c.port=null,c.host&&(""===v[0]?v[0]=c.host:v.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===o[0]?o[0]=a.host:o.unshift(a.host)),a.host=null),t=t&&(""===o[0]||""===v[0])),s)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,v=o;else if(o.length)v||(v=[]),v.pop(),v=v.concat(o),c.search=a.search,c.query=a.query;else if(!j.isNullOrUndefined(a.search)){if(y){c.hostname=c.host=v.shift();var z=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@");z&&(c.auth=z.shift(),c.host=c.hostname=z.shift())}return c.search=a.search,c.query=a.query,j.isNull(c.pathname)&&j.isNull(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!v.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var A=v.slice(-1)[0],B=(c.host||a.host||v.length>1)&&("."===A||".."===A)||""===A,C=0,D=v.length;D>=0;D--)A=v[D],"."===A?v.splice(D,1):".."===A?(v.splice(D,1),C++):C&&(v.splice(D,1),C--);if(!t&&!u)for(;C--;C)v.unshift("..");!t||""===v[0]||v[0]&&"/"===v[0].charAt(0)||v.unshift(""),B&&"/"!==v.join("/").substr(-1)&&v.push("");var E=""===v[0]||v[0]&&"/"===v[0].charAt(0);if(y){c.hostname=c.host=E?"":v.length?v.shift():"";var z=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@");z&&(c.auth=z.shift(),c.host=c.hostname=z.shift())}return t=t||c.host&&v.length,t&&!E&&v.unshift(""),v.length?c.pathname=v.join("/"):(c.pathname=null,c.path=null),j.isNull(c.pathname)&&j.isNull(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=l.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{"./util":357,punycode:330,querystring:333}],357:[function(a,b,c){"use strict";b.exports={isString:function(a){return"string"==typeof a},isObject:function(a){return"object"==typeof a&&null!==a},isNull:function(a){return null===a},isNullOrUndefined:function(a){return null==a}}},{}],358:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],359:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(d<0)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;g<h;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){
return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return a<10?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(a){return"[Circular]"}default:return a}}),h=d[c];c<f;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":358,_process:329,inherits:326}],360:[function(require,module,exports){function Context(){}var indexOf=require("indexof"),Object_keys=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)b.push(c);return b},forEach=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c++)b(a[c],c,a)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(a,b,c){Object.defineProperty(a,b,{writable:!0,enumerable:!1,configurable:!0,value:c})}}catch(a){return function(a,b,c){a[b]=c}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];Context.prototype={};var Script=exports.Script=function(a){return this instanceof Script?void(this.code=a):new Script(a)};Script.prototype.runInContext=function(a){if(!(a instanceof Context))throw new TypeError("needs a 'context' argument.");var b=document.createElement("iframe");b.style||(b.style={}),b.style.display="none",document.body.appendChild(b);var c=b.contentWindow,d=c.eval,e=c.execScript;!d&&e&&(e.call(c,"null"),d=c.eval),forEach(Object_keys(a),function(b){c[b]=a[b]}),forEach(globals,function(b){a[b]&&(c[b]=a[b])});var f=Object_keys(c),g=d.call(c,this.code);return forEach(Object_keys(c),function(b){(b in a||indexOf(f,b)===-1)&&(a[b]=c[b])}),forEach(globals,function(b){b in a||defineProp(a,b,c[b])}),document.body.removeChild(b),g},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(a){var b=Script.createContext(a),c=this.runInContext(b);return forEach(Object_keys(b),function(c){a[c]=b[c]}),c},forEach(Object_keys(Script.prototype),function(a){exports[a]=Script[a]=function(b){var c=Script(b);return c[a].apply(c,[].slice.call(arguments,1))}}),exports.createScript=function(a){return exports.Script(a)},exports.createContext=Script.createContext=function(a){var b=new Context;return"object"==typeof a&&forEach(Object_keys(a),function(c){b[c]=a[c]}),b}},{indexof:361}],361:[function(a,b,c){var d=[].indexOf;b.exports=function(a,b){if(d)return a.indexOf(b);for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}},{}],362:[function(a,b,c){function d(){for(var a={},b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)e.call(c,d)&&(a[d]=c[d])}return a}b.exports=d;var e=Object.prototype.hasOwnProperty},{}]},{},[3])(3)}),function(a){function b(){}function c(a,b){return function(){a.apply(b,arguments)}}function d(a){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],j(a,this)}function e(a,b){for(;3===a._state;)a=a._value;return 0===a._state?void a._deferreds.push(b):(a._handled=!0,void d._immediateFn(function(){var c=1===a._state?b.onFulfilled:b.onRejected;if(null===c)return void(1===a._state?f:g)(b.promise,a._value);var d;try{d=c(a._value)}catch(a){return void g(b.promise,a)}f(b.promise,d)}))}function f(a,b){try{if(b===a)throw new TypeError("A promise cannot be resolved with itself.");if(b&&("object"==typeof b||"function"==typeof b)){var e=b.then;if(b instanceof d)return a._state=3,a._value=b,void h(a);if("function"==typeof e)return void j(c(e,b),a)}a._state=1,a._value=b,h(a)}catch(b){g(a,b)}}function g(a,b){a._state=2,a._value=b,h(a)}function h(a){2===a._state&&0===a._deferreds.length&&d._immediateFn(function(){a._handled||d._unhandledRejectionFn(a._value)});for(var b=0,c=a._deferreds.length;b<c;b++)e(a,a._deferreds[b]);a._deferreds=null}function i(a,b,c){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.promise=c}function j(a,b){var c=!1;try{a(function(a){c||(c=!0,f(b,a))},function(a){c||(c=!0,g(b,a))})}catch(a){if(c)return;c=!0,g(b,a)}}var k=setTimeout;d.prototype.catch=function(a){return this.then(null,a)},d.prototype.then=function(a,c){var d=new this.constructor(b);return e(this,new i(a,c,d)),d},d.all=function(a){var b=Array.prototype.slice.call(a);return new d(function(a,c){function d(f,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(a){d(f,a)},c)}b[f]=g,0===--e&&a(b)}catch(a){c(a)}}if(0===b.length)return a([]);for(var e=b.length,f=0;f<b.length;f++)d(f,b[f])})},d.resolve=function(a){return a&&"object"==typeof a&&a.constructor===d?a:new d(function(b){b(a)})},d.reject=function(a){return new d(function(b,c){c(a)})},d.race=function(a){return new d(function(b,c){for(var d=0,e=a.length;d<e;d++)a[d].then(b,c)})},d._immediateFn="function"==typeof setImmediate&&function(a){setImmediate(a)}||function(a){k(a,0)},d._unhandledRejectionFn=function(a){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",a)},d._setImmediateFn=function(a){d._immediateFn=a},d._setUnhandledRejectionFn=function(a){d._unhandledRejectionFn=a},"undefined"!=typeof module&&module.exports?module.exports=d:a.Promise||(a.Promise=d)}(this);var IAcceptable=new function(){this.dragAccept="type1 type2 type3",this.accept=function(a){}},IActionListener=new function(){this.handleAction=function(a){}},IActivatable=new function(){this.isActivatable=!0,this.activate=function(){},this.deActivate=function(){}},IActivationAware=new function(){this.isActivationAware=!0,this.isActivated=!1,this.onActivate=function(){},this.onDeactivate=function(){}},IBroadcastListener=new function(){this.handleBroadcast=function(a,b){}},IContextContainerBinding=new function(){this.getContextContainer=function(){},this.setContextContainer=function(a){}},ICrawlerHandler=new function(){this.handleCrawler=function(a){}},IData=new function(){this.isFocusable=!0,this.validate=function(){},this.manifest=function(){},this.dirty=function(){},this.clean=function(){},this.focus=function(){},this.blur=function(){},this.getName=function(){},this.getValue=function(){},this.setValue=function(a){},this.getResult=function(){},this.setResult=function(a){}},IDialogResponseHandler=new function(){this.handleDialogResponse=function(){response,result}},IDOMHandler=new function(){this.fireOnDOM=function(){}},IDraggable=new function(){this.dragType="type",this.getImage=function(){}},IDragHandler=new function(){this.onDragStart=function(a){},this.onDrag=function(a){},this.onDragStop=function(a){}},IEditorControlBinding=new function(){this.isEditorControlBinding=!0},IEventListener=new function(){this.handleEvent=function(a){}},IFit=new function(){this.isFit=!0,this.fit=function(){return!0}},IFlexible=new function(){this.flex=function(){}},IFocusable=new function(){this.isFocusable=!0,this.isFocused=!1,this.focus=function(){this.dispatchAction(Binding.ACTION_FOCUSED)},this.blur=function(){this.dispatchAction(Binding.ACTION_BLURRED)}},IImageProfile=new function(){this.getDefaultImage=function(){},this.getHoverImage=function(){},this.getActiveImage=function(){},this.getDisabledImage=function(){}},IKeyEventHandler=new function(){this.handleKeyEvent=function(){}},ILabel=new function(){this.getLabel=function(){},this.getImage=function(){},this.getToolTip=function(){}},ILoadHandler=new function(){this.fireOnLoad=function(){}},IMenuContainer=new function(){this.isOpen=function(){},this.setOpenElement=function(a){}},IResizeHandler=new function(){this.fireOnResize=function(){}},ISourceEditorComponent=new function(){this.initializeSourceEditorComponent=function(a,b,c){}},IUpdateHandler=new function(){this.handleElement=function(a,b){},this.updateElement=function(a,b){}},IWysiwygEditorComponent=new function(){this.initializeComponent=function(a,b,c,d){}},IWysiwygEditorContentChangeHandler=new function(){this.handleContentChange=function(){}},IWysiwygEditorNodeChangeHandler=new function(){this.handleNodeChange=function(a){}};List.prototype.init=function(a){var b=void 0!==a&&void 0!==a.splice;if(b)this._array=a;else if(a.length)for(var c=0,c=0;c<a.length;c++)this._array.push(a[c]);else for(var d,c=0;null!=(d=a[c++]);)this._array.push(d);this.reset()},List.prototype.add=function(a){return this._array.push(a),a},List.prototype.addFirst=function(a){return this._array.unshift(a),a},List.prototype.remove=function(a){for(var b,c=0;void 0!==(b=this._array[c++]);)if(b==a){this._array.splice(c-1,1);break}},List.prototype.get=function(a){var b=null;return this._array[a]&&(b=this._array[a]),b},List.prototype.set=function(a,b){this._array[a]=b},List.prototype.del=function(a){this._array.splice(a,1)},List.prototype.has=function(a){for(var b,c=!1,d=0;void 0!==(b=this._array[d++]);)if(b==a){c=!0;break}return c},List.prototype.getLength=function(){return this._array.length},List.prototype.hasEntries=function(){return this.getLength()>0},List.prototype.hasNext=function(){var a=!1;return null!=this._array?a=this._index<this._array.length:SystemLogger.getLogger("List").error("Mysterious List#hasNext exception in IE"),a},List.prototype.getNext=function(){var a=null;return this.hasNext()&&(a=this._array[this._index++]),a},List.prototype.getFollowing=function(a){for(var b=null,c=0,d=null;null!=(d=this._array[c])&&!b;)d==a&&this._array[c+1]&&(b=this._array[c+1]),c++;return b},List.prototype.getPreceding=function(a){for(var b=null,c=1,d=null;null!=(d=this._array[c])&&!b;)d==a&&this._array[c-1]&&(b=this._array[c-1]),c++;return b},List.prototype.getIndex=function(a){var b=-1;if(null!=this._array.indexOf)b=this._array.indexOf(a);else{var c=0;this.each(function(d){var e=!0;return d==a&&(b=c,e=!1),c++,e})}return b},List.prototype.reset=function(){return this._index=0,this},List.prototype.clear=function(){return this._array=[],this.reset()},List.prototype.each=function(a,b){this.reset();for(var c=!0;0!=c&&this.hasNext();){void 0===b&&(b=null);var d=this._index,e=this.getNext();c=a.call(b,e,d)}this.reset()},List.prototype.copy=function(){return new List(this._array)},List.prototype.reverse=function(){return this._array.reverse(),this},List.prototype.extractFirst=function(){return this._array.shift()},List.prototype.extractLast=function(){return this._array.pop()},List.prototype.getFirst=function(){return this.get(0)},List.prototype.getLast=function(){return this.get(this.getLength()-1)},List.prototype.toString=function(){return"undefined"==typeof this._array?null:this._array.toString()},List.prototype.toArray=function(){return this._array.concat([])},List.prototype.merge=function(a){for(a.reset();a.hasNext();)this.add(a.getNext());return this},List.prototype.dispose=function(){for(var a=this._array.length-1;a>=0;)this._array[a--]=null;this._array=null,this._index=null,this._isDisposed=!0},Map.prototype._map={},Map.prototype.get=function(a){var b=null;if(this.has(a))b=this._map[a];else{var c="Map: Invalid key: "+a;SystemLogger.getLogger("Map").error(c),SystemDebug.stack(arguments),Application.isDeveloperMode&&(console.log(c),console.log(arguments))}return b},Map.prototype.set=function(a,b){this._map[a]=b},Map.prototype.del=function(a){delete this._map[a]},Map.prototype.has=function(a){return"undefined"!=typeof this._map[a]},Map.prototype.each=function(a,b){for(var c in this._map){var d=a.call(b,c,this._map[c]);if(0==d)break}},Map.prototype.hasEntries=function(){var a=!1;for(var b in this._map){a=!0;break}return a},Map.prototype.countEntries=function(){var a=0;for(var b in this._map)a++;return a},Map.prototype.toList=function(a){var b=new List;for(var c in this._map)b.add(a?c:this._map[c]);return b},Map.prototype.copy=function(){var a=new Map;for(var b in this._map)a.set(b,this._map[b]);return a},Map.prototype.inverse=function(){var a=new Map;for(var b in this._map)a.set(this._map[b],b);return a},Map.prototype.empty=function(){for(var a in this._map)delete this._map[a]},Map.prototype.dispose=function(){for(var a in this._map)this._map[a]=null},SystemNodeList.prototype.clear=function(){this._entityTokens.clear()},SystemNodeList.prototype.add=function(a){if(a.getEntityToken){var b=a.getEntityToken();this._entityTokens.add(b)}},SystemNodeList.prototype.has=function(a){if(a.getEntityToken){var b=a.getEntityToken();return this._entityTokens.has(b)}return!1},SystemNodeList.prototype.getEntityTokens=function(){return this._entityTokens.copy()},_LocalStorage.prototype={set:function(a,b){window.localStorage&&window.JSON&&a&&localStorage.setItem(a,JSON.stringify(b))},get:function(a){if(window.localStorage&&window.JSON&&a){var b=localStorage.getItem(a);if(b)return JSON.parse(b)}},remove:function(a){window.localStorage&&window.JSON&&a&&localStorage.removeItem(a)},store_data:function(a,b){this.set(b,a)},get_data:function(a){return this.get(a)},remove_data:function(a){this.remove(a)}};var LocalStorage=new _LocalStorage;_BroadcastMessages.prototype={APPLICATION_STARTUP:"application startup",APPLICATION_LOGIN:"application login",APPLICATION_LOGOUT:"application logout",APPLICATION_OPERATIONAL:"application operational",APPLICATION_ONSHUTDOWN:"application onshutdown",APPLICATION_SHUTDOWN:"application shutdown",APPLICATION_ERROR:"application error",APPLICATION_BLURRED:"application blurred",APPLICATION_FOCUSED:"application focused",APPLICATION_KICKSTART:"application kickstart",CODEMIRROR_LOADED:"codemirror loaded",MOUSEEVENT_MOUSEDOWN:"mouseevent mousedown",MOUSEEVENT_MOUSEUP:"mouseevent mouseup",MOUSEEVENT_MOUSEMOVE:"mouseevent mousemove",TOUCHEVENT_TOUCHSTART:"touchevent touchstart",$WINKEY_LOADED:"${windowkey} loaded",$WINKEY_UNLOADED:"${windowkey} unloaded",$WINKEY_EVALUATED:"${windowkey} evaluated",$WINKEY_RESIZED:"${windowkey} resized",$WINKEY_HRESIZED:"${windowkey} horizontally resized",$WINKEY_VRESIZED:"${windowkey} vertically resized",LOADED_NAVIGATOR:"navigator loaded",LOADED_MAINSTAGE:"mainstage loaded",LOCALSTORE_INITIALIZED:"localstore initialized",PERSISTANCE_INITIALIZED:"persistance initialized",STAGE_INITIALIZED:"stage initialized",KEY_SHIFT_DOWN:"shiftkeydown",KEY_SHIFT_UP:"shiftkeyup",KEY_CONTROL_DOWN:"controlkeydown",KEY_CONTROL_UP:"controlkeyup",KEY_ARROW:"arrowkey",KEY_ENTER:"enterkeydown",KEY_ESCAPE:"escapekeydown",KEY_SPACE:"spacekeydown",KEY_TAB:"tabkeydown",KEY_ALT:"altkeydown",KEY_CONTROLTAB:"controltabkeysdown",TYPEDRAG_START:"typedrag start",TYPEDRAG_STOP:"typedrag stop",TYPEDRAG_PAUSE:"typedrag pause",DOCK_MAXIMIZED:"dockmaximized",DOCK_MINIMIZED:"dockminimized",DOCK_NORMALIZED:"docknormalized",DOCKTABBINDING_SELECT:"docktab select",SYSTEMTREEBINDING_REFRESH:"systemtree refresh",SYSTEMTREEBINDING_REFRESHALL:"systemtree refresh all",SYSTEMTREEBINDING_REFRESHING:"systemtree refreshing",SYSTEMTREEBINDING_REFRESHED:"systemtree refreshed",SYSTEMTREEBINDING_REFRESHED_AFTER:"systemtree refreshed after",SYSTEMTREEBINDING_FOCUS:"systemtree focus",SYSTEMTREEBINDING_CUT:"systemtree cut",SYSTEMTREEBINDING_COPY:"systemtree copy",SYSTEMTREEBINDING_PASTE:"systemtree paste",SYSTEMTREEBINDING_COLLAPSEALL:"systemtree collapse all",SYSTEMTREENODEBINDING_FOCUS:"systemtreenode focus",SYSTEMTREEBINDING_LOCKTOEDITOR:"systemtreenode lock to editor",SYSTEMTREENODEBINDING_FORCE_OPEN:"systemtreenode force open",SYSTEMTREENODEBINDING_FORCING_OPEN:"systemtreenode forcing open",SYSTEMTREENODEBINDING_FORCED_OPEN:"systemtreenode forced open",START_COMPOSITE:"startcomposite",STOP_COMPOSITE:"stopcomposite",COMPOSITE_START:"compositestart",COMPOSITE_STOP:"compositestop",VIEW_OPENING:"view opening",VIEW_OPENED:"view opened",VIEW_COMPLETED:"view completed",CLOSE_VIEW:"close view",CLOSE_VIEWS:"close views",VIEW_CLOSED:"view closed",TINYMCE_INITIALIZED:"tinymce initialized",CODEPRESS_INITIALIZED:"codepress initialized",VISUALEDITOR_FOCUSED:"visualeditor focused",VISUALEDITOR_BLURRED:"visualditor blurred",PERSPECTIVE_CHANGED:"perspective changed",PERSPECTIVES_NONE:"no perspectives",SYSTEMLOG_OPENED:"systemlog opened",SYSTEMLOG_CLOSED:"systemlog closed",SYSTEMACTION_INVOKE:"systemaction invoke",SYSTEMACTION_INVOKED:"systemaction invoked",SYSTEM_ACTIONPROFILE_PUBLISHED:"system actionprofile published",NAVIGATOR_TREENODE_SELECTED:"navigator treenode selected",MODAL_DIALOG_OPENED:"modal dialog invoked",MODAL_DIALOG_CLOSED:"modal dialog closed",COVERBINDING_MOUSEDOWN:"userinterfacecoverbinding mousedown",SERVER_OFFLINE:"server offline",SERVER_ONLINE:"server online",OFFLINE_FLASH_INITIALIZED:"offline flash initialized",CLOSE_CURRENT:"close current",CLOSE_ALL:"close all",CLOSE_ALL_DONE:"close all done",SAVE_CURRENT:"save current",CURRENT_SAVED:"current saved",SAVE_ALL:"save all",SAVE_ALL_DONE:"save all done",DOCKTAB_DIRTY:"docktab dirty",DOCKTAB_CLEAN:"docktab clean",BINDING_RELATE:"binding relate",LOCALIZATION_CHANGED:"localization changed",XHTML_MARKUP_ON:"xhtml markup on",XHTML_MARKUP_OFF:"xhtml markup off",XHTML_MARKUP_ACTIVATE:"xhtml markup activate",XHTML_MARKUP_DEACTIVATE:"xhtml markup deactivate",HIGHLIGHT_KEYWORDS:"highlight keywords",BIND_TOKEN_TO_VIEW:"bind entitytoken to view",STAGEDIALOG_OPENED:"stage dialog opened",INVOKE_DEFAULT_ACTION:"invoke default action",STAGEDECK_CHANGED:"stage deck changed",LANGUAGES_UPDATED:"LocalesUpdated",FROMLANGUAGE_UPDATED:"ForeignLocaleChanged",TOLANGUAGE_UPDATED:"ActiveLocaleChanged",MESSAGEQUEUE_REQUESTED:"messagequeue requested",MESSAGEQUEUE_EVALUATED:"messagequeue evaluated",UPDATE_LANGUAGES:"update languages"};var BroadcastMessages=new _BroadcastMessages;_EventBroadcaster.prototype={_broadcasts:{},subscribe:function(a,b){if(null==a)throw SystemDebug.stack(arguments),"Undefined broadcast: "+b;if(!Interfaces.isImplemented(IBroadcastListener,b,!0))throw"IBroadcastListener not implemented: "+a;this._broadcasts[a]?this._broadcasts[a].push(b):this._broadcasts[a]=[b]},unsubscribe:function(a,b){if(null==a)throw"Undefined broadcast"+b;if(Interfaces.isImplemented(IBroadcastListener,b)){var c,d=0,e=this._broadcasts[a];if(e)for(;d<e.length;){if(c=e[d],c==b){e.splice(d,1);break}d++}}},hasSubscribers:function(a){var b=this._broadcasts[a];return null!=b&&b.length>0},broadcast:function(a,b){if(null==a)throw SystemDebug.stack(arguments),"Undefined broadcast";var c=0,d=this._broadcasts[a],e=[];if(null!=d){for(var f=new List;c<d.length;)e.push(d[c++]);for(c=0;c<e.length;){var g=e[c];if(Application.isDeveloperMode)g.handleBroadcast(a,b);else try{g.handleBroadcast(a,b)}catch(b){f.add(g);var h="Exception in "+new String(g)+" on broadcast '"+a+"':"+new String(b);SystemLogger.getLogger("EventBroadcaster").error(h),SystemDebug.stack(arguments)}c++}f.hasEntries()&&f.each(function(b){EventBroadcaster.unsubscribe(a,b)})}}};var EventBroadcaster=new _EventBroadcaster,temppath=document.location.pathname,temproot=temppath.substring(0,temppath.lastIndexOf("/"));_Constants.prototype={COMPOSITE_HOME:"http://www.composite.net",DUMMY_LINK:"javascript:void(false);",APPROOT:temproot,WEBSITEROOT:temproot.substring(0,temproot.length-9),CONFIGROOT:temproot.substring(0,temproot.length-9)+"Frontend/Config/VisualEditor/",TEMPLATESROOT:temproot+"/templates",SKINROOT:temproot+"/skins/system",TINYROOT:temproot+"/content/misc/editors/visualeditor/tinymce",URL_WSDL_SETUPSERVICE:temproot+"/services/Setup/SetupService.asmx?WSDL",URL_WSDL_CONFIGURATION:temproot+"/services/Configuration/ConfigurationService.asmx?WSDL",URL_WSDL_LOGINSERVICE:temproot+"/services/Login/Login.asmx?WSDL",URL_WSDL_INSTALLSERVICE:temproot+"/services/Installation/InstallationService.asmx?WSDL",URL_WSDL_MESSAGEQUEUE:temproot+"/services/ConsoleMessageQueue/ConsoleMessageQueueServices.asmx?WSDL",URL_WSDL_EDITORCONFIG:temproot+"/services/WysiwygEditor/ConfigurationServices.asmx?WSDL",URL_WSDL_FLOWCONTROLLER:temproot+"/services/FlowController/FlowControllerServices.asmx?WSDL",URL_WSDL_STRINGSERVICE:temproot+"/services/StringResource/StringService.asmx?WSDL",URL_WSDL_TREESERVICE:temproot+"/services/Tree/TreeServices.asmx?WSDL",URL_WSDL_XHTMLTRANSFORM:temproot+"/services/WysiwygEditor/XhtmlTransformations.asmx?WSDL",URL_WSDL_PAGETEMPLATE:temproot+"/services/WysiwygEditor/PageTemplate.asmx?WSDL",URL_WSDL_FUNCTIONSERVICE:temproot+"/services/WysiwygEditor/FunctionService.asmx?WSDL",URL_WSDL_SECURITYSERVICE:temproot+"/services/Tree/SecurityServices.asmx?WSDL",URL_WSDL_READYSERVICE:temproot+"/services/Ready/ReadyService.asmx?WSDL",URL_WSDL_LOCALIZATION:temproot+"/services/Localization/LocalizationService.asmx?WSDL",URL_WSDL_SOURCEVALIDATION:temproot+"/services/SourceEditor/SourceValidationService.asmx?WSDL",URL_WSDL_MARKUPFORMAT:temproot+"/services/SourceEditor/MarkupFormatService.asmx?WSDL",URL_WSDL_SEOSERVICE:temproot+"/services/SearchEngineOptimizationKeyword/SearchEngineOptimizationKeyword.asmx?WSDL",URL_WSDL_PAGESERVICE:temproot+"/services/Page/PageService.asmx?WSDL",URL_WSDL_DIFFSERVICE:temproot+"/services/StringResource/DiffService.asmx?WSDL",NS_XHTML:"http://www.w3.org/1999/xhtml",NS_UI:"http://www.w3.org/1999/xhtml",NX_XUL:"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul",NS_XBL:"http://www.mozilla.org/xbl",NS_WSDL:"http://schemas.xmlsoap.org/wsdl/",NS_SOAP:"http://schemas.xmlsoap.org/wsdl/soap/",NS_ENVELOPE:"http://schemas.xmlsoap.org/soap/envelope/",NS_ENCODING:"http://schemas.xmlsoap.org/soap/encoding/",NS_SCHEMA:"http://www.w3.org/2001/XMLSchema",NS_SCHEMA_INSTANCE:"http://www.w3.org/1999/XMLSchema-instance",NS_DOMPARSEERROR:"http://www.mozilla.org/newlayout/xml/parsererror.xml",NS_NS:"http://www.w3.org/2000/xmlns/",NS_PERSISTANCE:"http://www.composite.net/ns/localstore/persistance",NS_FUNCTION:"http://www.composite.net/ns/function/1.0",SCROLLBAR_DIMENSION_HARDCODED_VALUE:19};var Constants=new _Constants;temppath=null,temproot=null,ContextContainer.getContextContainer=function(a){var b=null;return a.getContextContainer&&(b=a.getContextContainer()),null==b&&(b=ContextContainer.getAncestorContextContainer(a)),b},ContextContainer.getAncestorContextContainer=function(a){var b=BindingFinder.getAncestorBindingByInterface(a,IContextContainerBinding,!0);if(null!=b){var c=b.getContextContainer();return null==c?ContextContainer.getAncestorContextContainer(b):c}return null},ContextContainer.resolve=function(a,b){if("string"!=typeof a)return a;if(void 0==b)return a;var c=/\{context\:([^\}]+)\}/gm,d=a.match(c);return new List(d).each(function(c){var d=/\{context\:([^\}]+)\}/gm.exec(c),e=d[1];a=a.replace(c,b.getProperty(e))}),a},ContextContainer.CONTAINER_CLASSES="containerClasses",ContextContainer.prototype.toString=function(){return"[ContextContainer]"},ContextContainer.prototype.setProperty=function(a,b){this._data[a]=b},ContextContainer.prototype.getProperty=function(a){return this._data[a]},ContextContainer.prototype.getData=function(){return this._data},ContextContainer.prototype.getContainerClasses=function(){return this._data[ContextContainer.CONTAINER_CLASSES]},ContextContainer.prototype.getContainerClassesList=function(){var a=this._data[ContextContainer.CONTAINER_CLASSES];return a?new List(a.split(",").map(function(a){return a.trim()})):new List},ContextContainer.prototype.getContainerClassesList=function(){var a=this._data[ContextContainer.CONTAINER_CLASSES];return a?new List(a.split(",").map(function(a){return a.trim()})):new List},ContextContainer.prototype.setContainerClasses=function(a){return this.setProperty(ContextContainer.CONTAINER_CLASSES,a),this},ContextContainer.prototype.clone=function(){var a=new ContextContainer,b=this;for(var c in b)b.hasOwnProperty(c)&&(a[c]=ViewDefinition.cloneProperty(b[c]));return a},_Client.prototype={isExplorer:!1,isMozilla:!1,isPrism:!1,hasFlash:!1,isWindows:!1,isVista:!1,hasTransitions:!1,_getFlashVersion:function(){var a=null,b=10;try{if(1==this.isMozilla){if("undefined"!=typeof navigator.plugins["Shockwave Flash"]){var c=navigator.plugins["Shockwave Flash"];if(c){var d=c.description;null!=d&&(a=d.charAt(d.indexOf(".")-1))}}}else for(var e=2;e<=b;e++)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+e),a=e}catch(a){continue}}catch(a){}return a},qualifies:function(){var a=!0,b=!1;return!this.isMozilla||this.isWebKit||this.isExplorer11||(b=void 0===document.documentElement.mozMatchesSelector),(null!=window.opera||b||this.isExplorer&&!this.canvas)&&(a=!1),a},fixUI:function(a){return Client.isExplorer&&(a=a.replace(/<ui:/g,"<").replace(/<\/ui:/g,"</"),a=a.replace(/(<(\w+)[^>]*)\/>/g,"$1></$2>")),a}};var Client=new _Client;SystemLogger.TAB_SEQUENCE="&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;",SystemLogger.LEVEL_INFO="info",SystemLogger.LEVEL_DEBUG="debug",SystemLogger.LEVEL_ERROR="error",SystemLogger.LEVEL_WARN="warn",SystemLogger.LEVEL_FATAL="fatal",SystemLogger.LEVEL_FINE="fine",SystemLogger.isFlushing=!1,SystemLogger.prototype.info=function(a){SystemLogger.log(this.identifier,SystemLogger.LEVEL_INFO,a)},SystemLogger.prototype.debug=function(a){"page"==a&&alert(arguments.caller.callee),SystemLogger.log(this.identifier,SystemLogger.LEVEL_DEBUG,a)},SystemLogger.prototype.error=function(a){SystemLogger.log(this.identifier,SystemLogger.LEVEL_ERROR,a)},SystemLogger.prototype.warn=function(a){SystemLogger.log(this.identifier,SystemLogger.LEVEL_WARN,a)},SystemLogger.prototype.fatal=function(a){SystemLogger.log(this.identifier,SystemLogger.LEVEL_FATAL,a)},SystemLogger.prototype.fine=function(a){SystemLogger.log(this.identifier,SystemLogger.LEVEL_FINE,a)},SystemLogger.loggers={},SystemLogger.buffer=new List,SystemLogger.suspend=function(){SystemLogger.outputWindow=null,SystemLogger.outputDocument=null,SystemLogger.outputElement=null,SystemLogger.log=SystemLogger.bufferLog},SystemLogger.unsuspend=function(a){SystemLogger.outputWindow=a,SystemLogger.outputDocument=a.document,SystemLogger.outputElement=a.document.body,SystemLogger.log=SystemLogger.outputLog,SystemLogger.flushBuffer()},SystemLogger.getLogger=function(a){var b=SystemLogger.loggers[a];return b||(b=new SystemLogger(a),SystemLogger.loggers[a]=b),b},SystemLogger.flushBuffer=function(){if(SystemLogger.buffer.reset(),SystemLogger.isFlushing=!0,SystemLogger.buffer.hasEntries())for(;SystemLogger.buffer.hasNext();){var a=SystemLogger.buffer.getNext();this.log(a.identifier,a.level,a.message)}SystemLogger.isFlushing=!1},SystemLogger.bufferLog=function(a,b,c){Application.isDeveloperMode&&(c=String(c),SystemLogger.buffer.add({identifier:a,level:b,message:c}))},SystemLogger.outputLog=function(a,b,c){c=String(c),SystemLogger.isFlushing||SystemLogger.bufferLog(a,b,c);var d=SystemLogger.outputWindow,e=SystemLogger.outputDocument,f=SystemLogger.outputElement,g=e.createElement("div"),h=e.createElement("span"),i=e.createElement("pre");Client.isExplorer?(c=c.replace(/</g,"&lt;"),c=c.replace(/>/g,"&gt;"),c=c.replace(/\n/g,"<br/>"),c=c.replace(/\t/g,SystemLogger.TAB_SEQUENCE),i.innerHTML=c):i.textContent=c,g.className=b,h.innerHTML=a,g.appendChild(h),g.appendChild(i),f.insertBefore(g,f.firstChild),d.scrollTo(0,0)},SystemLogger.log=SystemLogger.bufferLog,SystemLogger.clear=function(){SystemLogger.buffer=new List;var a=SystemLogger.outputDocument;a&&(a.body.innerHTML="")},SystemTimer.getTimer=function(a){return new SystemTimer(a.toString())},SystemTimer.prototype.reset=function(){this._time=(new Date).getTime()},SystemTimer.prototype.report=function(a){this.logger.debug(this._id+": "+this.getTime()+(a?": "+a:""))},SystemTimer.prototype.getTime=function(){return(new Date).getTime()-this._time},_SystemDebug.prototype={_logger:SystemLogger.getLogger("SystemDebug"),_stacklength:parseInt(5),stack:function(a,b){this._stackMozilla(a,b)},_stackMozilla:function(a,b){if(b=b?b:this._stacklength,Client.isMozilla&&a.callee||a.caller){for(var c=Client.isMozilla?a.callee.caller:a.caller.callee,d="",e=0;null!=c&&e++<b;)d+="\n#"+e+"\n",d+=c.toString(),c=c.caller,d+="\n";this._logger.error(d)}else this._logger.error("(Error stack unreachable!)")}};var SystemDebug=new _SystemDebug,Interfaces=new _Interfaces;_Types.prototype={_logger:SystemLogger.getLogger("Types"),BOOLEAN:"boolean",STRING:"string",NUMBER:"number",FUNCTION:"function",UNDEFINED:"undefined",castFromString:function(a){var b=a;return parseInt(b).toString()===b?b=parseInt(b):parseFloat(b).toString()===b?b=parseFloat(b):"true"!==b&&"false"!==b||(b="true"===b),b},isDefined:function(a){return typeof a!=Types.UNDEFINED},isFunction:function(a){return typeof a==Types.FUNCTION}};var Types=new _Types,MimeTypes={JPG:"image/jpeg",GIF:"image/gif",PNG:"image/png",CSS:"text/css",JAVASCRIPT:"text/javascript",TEXT:"text/plain",HTML:"text/html",XHTML:"applcication/xhtml+xml",FLASH:"application/x-shockwave-flash",QUICKTIME:"video/quicktime",SHOCKWAVE:"application/x-director",WINMEDIA:"application/x-mplayer2",COMPOSITEPAGES:"application/x-composite-page",COMPOSITEFUNCTION:"application/x-composite-function"};window.SearchTokens=new function(){var a={"MediaFileElementProvider.WebImages":null,"MediaFileElementProvider.EmbeddableMedia":null,"MediaFileElementProvider.WritableFolders":null,
"AllFunctionsElementProvider.VisualEditorFunctions":null,"AllFunctionsElementProvider.XsltFunctionCall":null};this.getToken=function(b){var c=null;if(!this.hasToken(b))throw"Unknown search token key: "+b;return c=a[b]},this.hasToken=function(b){return typeof a[b]!=Types.UNDEFINED},EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_LOGIN,{handleBroadcast:function(){new List(TreeService.GetSearchTokens(!0)).each(function(b){SearchTokens.hasToken(b.Key)?a[b.Key]=b.Value:alert("SearchTokens need updating!")})}})},window.StringBundle=new function(){function a(a,b){var c=new List(StringService.GetLocalisation(a));if(!c.hasEntries())throw"No strings from provider: "+a;c.each(function(a){b[a.Key]=a.Value})}var b=SystemLogger.getLogger("StringBundle");this.UI="Composite.Management";var c={};this.getString=function(d,e){var f=null;if(null!=window.StringService)try{if("ui"==d&&(d=StringBundle.UI),!c[d]){var g=c[d]={};a(d,g)}if(c[d]&&(f=c[d][e]),!f)throw"No such string: "+e}catch(a){var h="StringBundle exception in string "+d+":"+e;b.error(h),Application.isDeveloperMode&&alert(h)}return f}},_KeyMaster.prototype={_uniqueKeys:{},getUniqueKey:function(){var a=new String("key"+Math.random().toString().split(".")[1]);return null!=this._uniqueKeys[a]?this.getUniqueKey():(this._uniqueKeys[a]=!0,a)},hasKey:function(a){var b=!1;return this._uniqueKeys[a]&&(b=!0),b}};var KeyMaster=new _KeyMaster;_ImageProvider.prototype={_logger:SystemLogger.getLogger("ImageProvider"),UI:"Composite.Icons",getImageURL:function(a,b){return"string"==typeof a?a:a.ResourceName?a.ResourceName:""}};var ImageProvider=new _ImageProvider;_Resolver.prototype={_logger:SystemLogger.getLogger("Resolver"),resolve:function(a){return typeof a!=Types.UNDEFINED&&(a=String(a),a=a.replace("${root}",Constants.APPROOT),a=a.replace("${skin}",Constants.SKINROOT),a=a.replace("${tiny}",Constants.TINYROOT),a.indexOf("${icon:")>-1?a=this._resolveImage(a):a.indexOf("${class:")>-1?a=this._resolveClasses(a):a.indexOf("${string:")>-1&&(a=this._resolveString(a))),a},resolveVars:function(a,b){for(var c=0;c<b.length;)a=a.replace("{"+c+"}",b[c]),c++;return a},_resolveString:function(a){var b=null,c=null,d=a.split("${string:")[1].split("}")[0];return d.indexOf(":")>-1?(c=d.split(":")[0],d=d.split(":")[1]):c=StringBundle.UI,b=StringBundle.getString(c,d),b||(b="(?)"),b},_resolveImage:function(a){var b=null,c=null,d=null,e=null;return d=a.split("${icon:")[1].split("}")[0],d.indexOf(":")>-1?(c=d.split(":")[0],d=d.split(":")[1]):c=ImageProvider.UI,d.indexOf("(")>-1&&(e=d.split("(")[1].split(")")[0],d=d.split("(")[0]),b=ImageProvider.getImageURL({ResourceNamespace:c,ResourceName:d},e)},_resolveClasses:function(a){var b={};return resource=a.split("${class:")[1].split("}")[0],b.classes=resource,b}};var Resolver=new _Resolver;_Download.prototype.init=function(a){var b=top.app.bindingMap.downloadwindow;b.setURL(a)};var Download=new _Download;_Cookies.prototype={createCookie:function(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()}return document.cookie=a+"="+escape(b)+d+"; path=/",this.readCookie(a)},readCookie:function(a){for(var b=null,c=a+"=",d=document.cookie.split(";"),e=0;e<d.length;e++){for(var f=d[e];" "==f.charAt(0);)f=f.substring(1,f.length);0==f.indexOf(c)&&(b=unescape(f.substring(c.length,f.length)))}return b},eraseCookie:function(a){this.createCookie(a,"",-1)}};var Cookies=new _Cookies,StatusBar=new _StatusBar;_Localization.prototype={languages:null,source:null,target:null,isUIRtl:!1,isRtl:!1,handleBroadcast:function(a,b){switch(a){case BroadcastMessages.APPLICATION_LOGIN:case BroadcastMessages.LANGUAGES_UPDATED:case BroadcastMessages.TOLANGUAGE_UPDATED:this.isUIRtl="rtl"==LocalizationService.GetUITextDirection(!0),this.isRtl="rtl"==LocalizationService.GetTextDirection(!0);var c=LocalizationService.GetActiveLocales(!0);c.length>=1?this.languages=new List(c):this.languages=null,EventBroadcaster.broadcast(BroadcastMessages.UPDATE_LANGUAGES,this.languages)}switch(a){case BroadcastMessages.APPLICATION_LOGIN:case BroadcastMessages.FROMLANGUAGE_UPDATED:var d=LocalizationService.GetLocales(!0);this.source=d.ForeignLocaleName,this.target=d.ActiveLocaleName,EventBroadcaster.broadcast(BroadcastMessages.LOCALIZATION_CHANGED,{source:d.ForeignLocaleName,target:d.ActiveLocaleName})}},currentLang:function(){if(null!=this.languages)for(var a=this.languages.copy();a.hasNext();){var b=a.getNext();if(b.IsCurrent)return b.IsoName}return null}};var Localization=new _Localization;_Validator.prototype={validate:function(a,b,c){var d=!0,e=SourceValidationService.ValidateSource(a,b);return"True"!=e&&(1==c&&this._dialog(e),d=!1),d},validateInformed:function(a,b){return this.validate(a,b,!0)},_dialog:function(a){setTimeout(function(){Dialog.error("Source Invalid",a)},0)}};var Validator=new _Validator;_DOMEvents.prototype={_logger:SystemLogger.getLogger("DOMEvents"),MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",CLICK:"click",DOUBLECLICK:"dblclick",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",CONTEXTMENU:"contextmenu",SCROLL:"scroll",LOAD:"load",BEFOREUNLOAD:"beforeunload",UNLOAD:"unload",RESIZE:"resize",FOCUS:"focus",BLUR:"blur",SUBMIT:"submit",CUT:"cut",COPY:"copy",PASTE:"paste",DOM:"DOMContentLoaded",DRAGOVER:"dragover",DROP:"drop",WHEEL:"wheel",HASHCHANGE:"hashchange",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",ACTIVATE:"activate",DEACTIVATE:"deactivate",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",SELECTSTART:"selectstart",FOCUSIN:"focusin",FOCUSOUT:"focusout",HELP:"help",BEFOREUPDATE:"beforeupdate",AFTERUPDATE:"afterupdate",ERRORUPDATE:"errorupdate",_count:0,addEventListener:function(a,b,c,d){this._count++,this._eventListener(!0,a,b,c,d)},removeEventListener:function(a,b,c,d){this._count--,this._eventListener(!1,a,b,c,d)},getTarget:function(a){return a?a.target?a.target:a.srcElement:null},stopPropagation:function(a){try{null!=a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}catch(a){1==Application.isDeveloperMode&&this._logger.error(a)}},preventDefault:function(a){try{a.preventDefault?a.preventDefault():a.returnValue=!1}catch(a){1==Application.isDeveloperMode&&this._logger.error(a)}},isRightButton:function(a){return 2==a.button},isButtonPressed:function(a){return(!Client.isFirefox&&!Client.isExplorer11||0!==a.buttons)&&((!Client.isWebKit||0!==a.which)&&void 0)},cleanupEventListeners:function(a){this._deleteWrappedHandler(a)},isCurrentTarget:function(a){var b=!1;return 1==Client.isMozilla&&(b=a.target==a.currentTarget),!0},_isChildOf:function(a,b){var c=!0;if(a==b&&(c=!1),1==c){for(;null!=b&&b.nodeType!=Node.DOCUMENT_NODE&&b!=a;)b=b.parentNode;c=b==a}return c},_eventListener:function(a,b,c,d,e,f){if(Interfaces.isImplemented(IEventListener,d,!0)){if(typeof c==Types.UNDEFINED)throw"No such event allowed!";var g=this._getAction(a);if(b[g])if(Client.isPad&&c==DOMEvents.DOUBLECLICK){if(a){var h=null,i={handleEvent:function(a){var b=(new Date).getTime();if(h&&b-h<500){DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a);var c=new MouseEvent(DOMEvents.DOUBLECLICK,a);return d.handleEvent(c),void(h=null)}h=b}};b[g](DOMEvents.TOUCHSTART,i,!!e)}}else if(Client.isExplorer||Client.isExplorer11)switch(c){case DOMEvents.MOUSEDOWN:case DOMEvents.MOUSEUP:case DOMEvents.MOUSEOVER:case DOMEvents.MOUSEOUT:case DOMEvents.MOUSEMOVE:d=this._getWrappedHandler(b,c,d,f),b[g](c,d,!1);break;default:b[g](c,d,!1)}else switch(c){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSELEAVE:c=c==DOMEvents.MOUSEENTER?DOMEvents.MOUSEOVER:DOMEvents.MOUSEOUT,b[g](c,{handleEvent:function(a){var b=a.relatedTarget;a.currentTarget==b||DOMEvents._isChildOf(a.currentTarget,b)||d.handleEvent(a)}},!!e);break;default:b[g](c,d,!!e)}}},_getAction:function(a){var b=null;switch(a){case!0:b="addEventListener";break;case!1:b="removeEventListener"}return b},_getWrappedHandler:function(a,b,c,d){var e=null;try{if(c._domEventHandlers||(c._domEventHandlers={}),c._domEventHandlers[a]||(c._domEventHandlers[a]={}),!c._domEventHandlers[a][b]){var f=a.nodeType?DOMUtil.getParentWindow(a):a;f&&(c._domEventHandlers[a][b]=function(a){null!=f.event&&null!=c?c.handleEvent(f.event):null!=c&&c.handleEvent(a)})}e=c._domEventHandlers[a][b]}catch(e){this._report(a,b,c,d)}return e},_deleteWrappedHandler:function(a){for(var b in a._domEventHandlers){if(b)for(var c in a._domEventHandlers[b])c&&delete a._domEventHandlers[b][c];delete a._domEventHandlers[b]}},_report:function(a,b,c,d){alert("DOMEvents.getWrappedHandler malfunction.\n\n\ttarget: "+(a?a.nodeName:a)+"\n\tevent: "+b+"\n\thandler: "+c+"\n\nOffending invoker: "+(d.callee?d.callee.toString():d.constructor))}};var DOMEvents=new _DOMEvents;_DOMSerializer.prototype={_serializer:window.XMLSerializer?new XMLSerializer:null,serialize:function(a,b){var c=null,d=a;return a.nodeType==Node.DOCUMENT_NODE&&(d=a.documentElement),null!=d.xml?d.xml:(null!=this._serializer&&(1==b&&(d=d.cloneNode(!0),d=DOMFormatter.format(d,DOMFormatter.INDENTED_TYPE_RESULT)),c=this._serializer.serializeToString(d)),c)}};var DOMSerializer=new _DOMSerializer;window.DOMFormatter=new function(){function a(a){var b=a.ownerDocument,f=function(a,g){if(a.hasChildNodes()&&a.firstChild.nodeType!=Node.TEXT_NODE){for(var h="",i=0;i++<g;)h+=d;for(var j=a.firstChild;j;){switch(j.nodeType){case Node.ELEMENT_NODE:j==a.lastChild&&a.appendChild(b.createTextNode(e+h)),a.insertBefore(b.createTextNode(e+h+d),j),f(j,g+1);break;case Node.COMMENT_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.CDATA_SECTION_NODE:a.insertBefore(b.createTextNode(e+h+d),j)}j.nodeType==Node.CDATA_SECTION_NODE&&(this.ignoreCDATASections||c(j,h+d)),j=j.nextSibling}}};f(a,0)}function b(a){for(var b=[],c={acceptNode:function(a){return f.test(a.nodeValue)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}},d=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_TEXT,c,!0);d.nextNode();)b.push(d.currentNode);for(var e,g=0;null!=(e=b[g++]);)e.parentNode.removeChild(e)}function c(a,b){if(a.textContent.indexOf(e)>-1){for(var c,f=a.textContent.split(e),g="",h=0,i=!0;null!=(c=f.shift());){if(0==h&&c.charAt(0)==d)for(;c.charAt(h++)==d;);c=c.substring(h,c.length),f.length>0?(g+=b+d+c,g+=i?"":"\n"):(g+=b+c,b=b.slice(1,b.length),a.parentNode.appendChild(doc.createTextNode(e+b))),i=!1}a.textContent=g}}var d="\t",e="\n",f=new RegExp(/[^\t\n\r ]/);this.ignoreCDATASections=!1,this.format=function(c,d){var e=1;if(document.createTreeWalker&&!Client.isExplorer&&!Client.isExplorer11)try{b(c),d!=e&&a(c)}catch(a){throw new Error(a)}return c}},DOMFormatter.INDENTED_TYPE_RESULT=0,DOMFormatter.STRIPPED_TYPE_RESULT=1,_DOMUtil.prototype={_logger:SystemLogger.getLogger("DOMUtil"),MSXML_MAXVERSION:6,MSXML_MINVERSION:1,MSXML_HTTPREQUEST:"MSXML2.XMLHTTP.{$version}.0",MSXML_DOMDOCUMENT:"MSXML2.DOMDocument.{$version}.0",MSXML_FREETHREADED:"MSXML2.FreeThreadedDOMDocument.{$version}.0",MSXML_XSLTEMPLATE:"MSXML2.XSLTemplate.{$version}.0",getMSComponent:function(a){for(var b,c=null,d=this.MSXML_MAXVERSION;!c&&d>=this.MSXML_MINVERSION;){try{b=a.replace("{$version}",d),c=new ActiveXObject(b)}catch(a){}d--}return c},getXMLHTTPRequest:function(){var a=null;return a=Client.isExplorer||Client.isExplorer11?this.getMSComponent(this.MSXML_HTTPREQUEST):new XMLHttpRequest},getDOMDocument:function(a){var b=null;if(Client.isExplorer||Client.isExplorer11)b=this.getMSComponent(a?this.MSXML_FREETHREADED:this.MSXML_DOMDOCUMENT);else{var c=XMLParser.parse('<?xml version="1.0" encoding="UTF-8"?><ROOT/>');c.removeChild(c.documentElement),b=c}return b},getMSXMLXSLTemplate:function(){var a=null;return Client.isAnyExplorer&&(a=this.getMSComponent(this.MSXML_XSLTEMPLATE)),a},getLocalName:function(a){var b=null;return b=a.localName?a.localName.replace("ui:",""):a.baseName?a.baseName:a.nodeName.toLowerCase()},getComputedStyle:function(a,b){var c=null;if(Client.isExplorer)null!=a.currentStyle?c=a.currentStyle[b]:(this._logger.error("Could not compute style for element "+a.nodeName),SystemDebug.stack(arguments));else{var d=a.ownerDocument.defaultView.getComputedStyle(a,null);null!=d?c=d.getPropertyValue(b):(this._logger.error("Could not compute style for element "+a.nodeName),SystemDebug.stack(arguments))}return c},getMaxIndex:function(a){var b=0,c=new List(a.getElementsByTagName("*"));return c.each(function(a){var c=CSSComputer.getZIndex(a);c>b&&(b=c)}),b},getOrdinalPosition:function(a,b){for(var c=null,d=-1,e=this.getLocalName(a),f=new List(a.parentNode.childNodes);f.hasNext();){var g=f.getNext();if(g.nodeType==Node.ELEMENT_NODE&&(!b||this.getLocalName(g)==e)&&(d++,g==a||""!=g.id&&g.id==a.id)){c=d;break}}return c},isFirstElement:function(a,b){return 0==this.getOrdinalPosition(a,b)},isLastElement:function(a,b){var c=a.parentNode.getElementsByTagName(b?this.getLocalName(a):"*");return this.getOrdinalPosition(a)==c.length},getParentWindow:function(a){var b=a.nodeType==Node.DOCUMENT_NODE?a:a.ownerDocument;return b.defaultView?b.defaultView:b.parentWindow},getTextContent:function(a){var b=null;return b=a.textContent?a.textContent:a.text?a.text:a.innerText},setTextContent:function(a,b){b=String(b),a.textContent?a.textContent=b:a.text?a.text=b:a.innerText=b},getAncestorByLocalName:function(a,b,c){for(var d=null;null==d;){if(b=b.parentNode,b.nodeType==Node.DOCUMENT_NODE){if(1!=c)break;var e=this.getParentWindow(b);b=e.frameElement}this.getLocalName(b)==a&&(d=b)}return d},contains:function(a,b){return a.contains?a!=b&&a.contains(b):!!(16&a.compareDocumentPosition(b))},createElementNS:function(a,b,c){var d=null;return null==c?alert("DOMUtil#createElementNS : Missing argument (DOMDocument)"):d=Client.isExplorer||Client.isExplorer11?null!=c.xml?c.createNode(Node.ELEMENT_NODE,b,a):c.createElement(b.replace("ui:","")):c.createElementNS(a,b),d},getElementsByTagName:function(a,b){var c=null;return c=Client.isMozilla?a.getElementsByTagNameNS(Constants.NS_XHTML,b):a.getElementsByTagName(b)},getChildElementsByLocalName:function(a,b){var c=new List,d=a.childNodes;return new List(d).each(function(a){a.nodeType==Node.ELEMENT_NODE&&("*"!=b&&DOMUtil.getLocalName(a)!=b||c.add(a))}),c},getNextElementSibling:function(a){return Client.isExplorer?a.nextSibling:a.nextElementSibling},getPreviousElementSibling:function(a){return Client.isExplorer?a.previousSibling:a.previousElementSibling},cloneNode:function(a){var b=null;return b=1==Client.isMozilla?XMLParser.parse(DOMSerializer.serialize(a)):a.cloneNode(!0)},getLocalPosition:function(a){var b=new Point(a.offsetLeft,a.offsetTop);if(Client.isExplorer&&a.parentNode&&a.parentNode.currentStyle&&"static"==a.parentNode.currentStyle.position){var c=this.getLocalPosition(a.parentNode);b.x+=c.x,b.y+=c.y}return b},getGlobalPosition:function(a){return this._getPosition(a,!1)},getUniversalPosition:function(a){return this._getPosition(a,!0)},_getPosition:function(a,b){var c=null;if(typeof a.getBoundingClientRect!=Types.UNDEFINED){var d=a.getBoundingClientRect();c={x:d.left,y:d.top},Client.isMozilla&&(c.x-=a.scrollLeft,c.y-=a.scrollTop)}else for(c={x:a.offsetLeft-a.scrollLeft,y:a.offsetTop-a.scrollTop};a.offsetParent;)a=a.offsetParent,c.x+=a.offsetLeft-a.scrollLeft,c.y+=a.offsetTop-a.scrollTop;if(b){var e=DOMUtil.getParentWindow(a);if(e){var f=e.frameElement;if(f){var g=DOMUtil.getUniversalPosition(f);c.x+=g.x,c.y+=g.y}}}return new Point(c.x,c.y)},getGlobalMousePosition:function(a){return this._getMousePosition(a,!1)},getUniversalMousePosition:function(a){return this._getMousePosition(a,!0)},_getMousePosition:function(a,b){var c=DOMEvents.getTarget(a),d={x:a.clientX,y:a.clientY};if(b){var e=this.getParentWindow(c).frameElement;if(e){var f=this.getUniversalPosition(e);d.x+=f.x,d.y+=f.y}}return d}};var DOMUtil=new _DOMUtil;_XMLParser.prototype={_logger:SystemLogger.getLogger("XMLParser"),_domParser:null!=window.DOMParser&&null!=window.XPathResult?new DOMParser:null,parse:function(a,b){var c=null;if(null==a)throw"XMLParser: No XML input to parse!";if(null!=this._domParser){try{c=this._domParser.parseFromString(a,"text/xml")}catch(b){alert(a)}c.documentElement.namespaceURI==Constants.NS_DOMPARSEERROR&&(b||(this._logger.error(DOMSerializer.serialize(c.documentElement,!0)),Application.isDeveloperMode&&alert("XMLParser failed: \n\n"+DOMSerializer.serialize(c.documentElement,!0))),c=null)}else c=DOMUtil.getDOMDocument(),c.setProperty("ProhibitDTD",!1),c.validateOnParse=!1,c.async=!1,c.loadXML(a),0!=c.parseError.errorCode&&(b||(this._logger.error("XMLParser failed!"),Application.isDeveloperMode&&alert("XMLParser failed!")),c=null);return c},isWellFormedDocument:function(a,b,c){var d=!0,e='<?xml version="1.0" encoding="UTF-8"?>';a.indexOf("<?xml ")==-1&&(a=e+a);var f=SourceValidationService.IsWellFormedDocument(a);return"True"!=f&&(d=!1,1==b&&(c?confirm("Not well-formed\n"+f+"\nContinue?")&&(d=!0):this._illFormedDialog(f))),d},isWellFormedFragment:function(a,b){var c=!0,d=SourceValidationService.IsWellFormedFragment(a);return"True"!=d&&(c=!1,1==b&&this._illFormedDialog(d)),c},_illFormedDialog:function(a){setTimeout(function(){Dialog.error("Not well-formed",a)},0)}};var XMLParser=new _XMLParser;XPathResolver.prototype.setNamespacePrefixResolver=function(a){this._evaluator?this._nsResolver={lookupNamespaceURI:function(b){return a[b]}}:this._nsResolver=a},XPathResolver.prototype.resolve=function(a,b,c){var d=null;try{d=this._evaluator?this._evaluateDOMXpath(a,b,!!c):this._evaluateMSXpath(a,b,!!c)}catch(a){throw alert("XPathResolver#resolve: "+a),a.stack?alert(a.stack):alert(arguments.caller.callee.toString()),a}return d},XPathResolver.prototype.resolveAll=function(a,b){return this.resolve(a,b,!0)},XPathResolver.prototype._evaluateDOMXpath=function(a,b,c){var d=null;if(b){var d=this._evaluator.evaluate(a,b,this._nsResolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(c){for(var e=new List;null!=(b=d.iterateNext());)e.add(b);d=e}else d=d.iterateNext()}else{var f="XPathResolver#_evaluateDOMXpath: No DOMNode to evaluate!";Application.isDeveloperMode?alert(f):this.logger.fatal(f)}return d},XPathResolver.prototype._evaluateMSXpath=function(a,b,c){var d=b.nodeType==Node.DOCUMENT_NODE?b:b.ownerDocument,e="";for(var f in this._nsResolver)e+="xmlns:"+f+'="'+this._nsResolver[f]+'" ';if(d.setProperty("SelectionNamespaces",e),c){for(var g=new List,h=0,i=b.selectNodes(a);h<i.length;)g.add(i.item(h++));result=g}else result=b.selectSingleNode(a);return result},XSLTransformer.prototype.importStylesheet=function(a){var b=this._import(Resolver.resolve(a));Client.hasXSLTProcessor?(this._processor=new XSLTProcessor,this._processor.importStylesheet(b)):(this._cache=DOMUtil.getMSXMLXSLTemplate(),this._cache.stylesheet=b)},XSLTransformer.prototype._import=function(a){var b=null;if(Client.hasXSLTProcessor){var c=DOMUtil.getXMLHTTPRequest();c.open("get",Resolver.resolve(a),!1),c.send(null),b=c.responseXML}else{var b=DOMUtil.getDOMDocument(!0);b.async=!1,b.load(a)}return b},XSLTransformer.prototype.transformToDocument=function(a){var b=null;return Client.hasXSLTProcessor?b=this._processor.transformToDocument(a):alert("TODO!"),b},XSLTransformer.prototype.transformToString=function(a,b){var c=null;if(Client.hasXSLTProcessor){var d=this.transformToDocument(a);c=DOMSerializer.serialize(d,b)}else{var e=this._cache.createProcessor();e.input=a,e.transform(),c=e.output}return c},_CSSUtil.prototype={_getCurrent:function(a){var b=a.style?a.className:a.getAttribute("class");return b=b?b:""},_contains:function(a,b){return a.indexOf(b)>-1},_attach:function(a,b){return a+(""==a?"":" ")+b},_detach:function(a,b){return this._contains(a," "+b)&&(b=" "+b),a.replace(b,"")},attachClassName:function(a,b){if(null!=a.classList)a.classList.contains(b)||a.classList.add(b);else{var c=this._getCurrent(a);this._contains(c,b)||(c=this._attach(c,b)),null!=a.style?a.className=c:a.setAttribute("class",c)}},detachClassName:function(a,b){if(null!=a.classList)a.classList.contains(b)&&a.classList.remove(b);else{var c=this._getCurrent(a);this._contains(c,b)&&(c=this._detach(c,b)),null!=a.style?a.className=c:""==c?a.removeAttribute("class"):a.setAttribute("class",c)}},hasClassName:function(a,b){var c=!1;return c=null!=a.classList?a.classList.contains(b):this._contains(this._getCurrent(a),b)}};var CSSUtil=new _CSSUtil;_CSSComputer.prototype={_margins:{top:Client.isExplorer?"marginTop":"margin-top",right:Client.isExplorer?"marginRight":"margin-right",bottom:Client.isExplorer?"marginBottom":"margin-bottom",left:Client.isExplorer?"marginLeft":"margin-left"},_paddings:{top:Client.isExplorer?"paddingTop":"padding-top",right:Client.isExplorer?"paddingRight":"padding-right",bottom:Client.isExplorer?"paddingBottom":"padding-bottom",left:Client.isExplorer?"paddingLeft":"padding-left"},_borders:{top:Client.isExplorer?"borderTopWidth":"border-top-width",right:Client.isExplorer?"borderRightWidth":"border-right-width",bottom:Client.isExplorer?"borderBottomWidth":"border-bottom-width",left:Client.isExplorer?"borderLeftWidth":"border-left-width"},_getComplexResult:function(a,b){var c={};for(var d in a){var e=parseInt(DOMUtil.getComputedStyle(b,a[d]));c[d]=isNaN(e)?0:e}return c},getMargin:function(a){return this._getComplexResult(this._margins,a)},getPadding:function(a){return this._getComplexResult(this._paddings,a)},getBorder:function(a){return this._getComplexResult(this._borders,a)},getPosition:function(a){return DOMUtil.getComputedStyle(a,"position")},getFloat:function(a){return DOMUtil.getComputedStyle(a,Client.isExplorer?"styleFloat":"float")},getZIndex:function(a){return parseInt(DOMUtil.getComputedStyle(a,Client.isExplorer?"zIndex":"z-index"))},getBackgroundColor:function(a){return DOMUtil.getComputedStyle(a,Client.isExplorer?"backgroundColor":"background-color")},getWidth:function(a){return DOMUtil.getComputedStyle(a,"width")}};var CSSComputer=new _CSSComputer,System=new function(){var a=SystemLogger.getLogger("System"),b=null,c=null;this.hasActivePerspectives=!1,this.nodes=new Map,this.parents=new Map,this.getDefaultEntityToken=function(a){return null==c&&(c={},new List(TreeService.GetDefaultEntityTokens(!0)).each(function(a){c[a.Key]=a.Value})),c[a]},this.getRootNode=function(){return null==b&&(b=new SystemNode(TreeService.GetRootElements("")[0])),b},this.getPerspectiveNodes=function(){var a=new List,b=TreeService.GetActivePerspectiveElements("dummy"),c=new List(b);return c.hasEntries()?(this.hasActivePerspectives=!0,c.each(function(b){a.add(new SystemNode(b))})):EventBroadcaster.broadcast(BroadcastMessages.PERSPECTIVES_NONE),a},this.getChildNodes=function(a,b){var c=new List,d=null,e=this;return b?(SearchTokens.hasToken(b)&&(b=SearchTokens.getToken(b)),d=TreeService.GetElementsBySearchToken(a.getData(),b)):d=TreeService.GetElements(a.getData()),new List(d).each(function(d){var f=new SystemNode(d);b&&(f.searchToken=b),c.add(f),b||e.parents.set(f.getHandle(),a)}),this.groupListByBundles(c)},this.getParents=function(a){for(var b=new List,c=new List;this.parents.has(a)&&!b.has(a);){var d=this.parents.get(a);b.add(a),c.add(d),a=d.getHandle()}return c},this.getDescendantBranch=function(a){var b=new Map,c=[];a.each(function(a){c.push({ProviderName:a.getProviderName(),EntityToken:a.getEntityToken(),Piggybag:a.getPiggyBag(),SearchToken:a.searchToken})});for(var d=TreeService.GetMultipleChildren(c),e=new List(d);e.hasNext();)this._listNodesInMap(e.getNext(),b);return this.groupMapByBundles(b)},this.getInvisibleBranch=function(b,c,d){var e=new Map,f=[];d.each(function(a){f.push({ProviderName:a.getProviderName(),EntityToken:a.getEntityToken(),Piggybag:a.getPiggyBag()})});var g=TreeService.FindEntityToken(b,c,f);if(g instanceof SOAPFault)a.error(g.getFaultString()),Application.isDeveloperMode&&alert(g.getFaultString()),e=null;else for(var h=new List(g);h.hasNext();)this._listNodesInMap(h.getNext(),e);return this.groupMapByBundles(e)},this._listNodesInMap=function(a,b){var c=new List,d=a.ElementKey,e=new List(a.ClientElements);for(b.set(d,c);e.hasNext();){var f=e.getNext();c.add(new SystemNode(f))}var g=this;b.each(function(a,b){g.nodes.set(a,b.copy())})},this.getChildNodesBySearchToken=function(a,b){return this.getChildNodes(a,b)},this.getNamedRoots=function(a,b){var c=new List,d=null;return b?(SearchTokens.hasToken(b)&&(b=SearchTokens.getToken(b)),d=TreeService.GetNamedRootsBySearchToken(a,b)):d=TreeService.GetNamedRoots(a),new List(d).each(function(a){var d=new SystemNode(a);b&&(d.searchToken=b),c.add(d)}),c},this.getNamedRootsBySearchToken=function(a,b){return this.getNamedRoots(a,b)},this.groupListByBundles=function(a){for(var b=new List,c=new Map;a.hasEntries();){var d=a.extractFirst(),e=d.getData().ElementBundle;if(e){var f=null;c.has(e)?(f=c.get(e),f.add(d)):(b.add(d),c.set(e,d))}else b.add(d)}return b},this.groupMapByBundles=function(a){var b=new Map;return a.each(function(c){b.set(c,this.groupListByBundles(a.get(c)))},this),b}};SystemNode.dispose=function(a){for(var b in a)a[b]=null},SystemNode.taggedNodes=new Map,SystemNode.prototype.toString=function(){return"[SystemNode]"},SystemNode.prototype._registerSystemActions=function(){var a=this;new List(this._data.ActionKeys).each(function(b){SystemAction.actionMap.has(b)||new List(a._data.Actions).each(function(a){var b=a.ActionCategory.Name;if(!SystemAction.hasCategory(b))throw"No such action category: "+b;var c=new SystemAction(a);SystemAction.actionMap.set(a.ActionKey,c)})})},SystemNode.prototype.getData=function(){return this._data},SystemNode.prototype.getChildren=function(){var a=null;return a=this.searchToken?System.getChildNodesBySearchToken(this,this.searchToken):System.getChildNodes(this)},SystemNode.prototype.getDescendantBranch=function(a){return System.getDescendantBranch(a)},SystemNode.prototype.getLabel=function(){return this._data.Label},SystemNode.prototype.getProviderName=function(){return this._data.ProviderName},SystemNode.prototype.getEntityToken=function(){return this._data.EntityToken},SystemNode.prototype.getPiggyBag=function(){var a=this._data.Piggybag;return null==a&&(a=""),a},SystemNode.prototype.getHandle=function(){return this._data.ElementKey},SystemNode.prototype.getHandles=function(){var a=new List;return null!=this._datas?this._datas.each(function(b){a.add(b.ElementKey)}):a.add(this._data.ElementKey),a},SystemNode.prototype.getTag=function(){return this._data.TagValue},SystemNode.prototype.getImageProfile=function(a){return new ImageProfile({image:ImageProvider.getImageURL(this._data.Icon,a),imageActive:ImageProvider.getImageURL(this._data.OpenedIcon?this._data.OpenedIcon:this._data.Icon,a)})},SystemNode.prototype.getToolTip=function(){var a=null;return"undefined"!=typeof this._data.ToolTip&&(a=this._data.ToolTip),a},SystemNode.prototype.getPropertyBag=function(){if(!this._propertyBag&&this._data.PropertyBag&&0!=this._data.PropertyBag.length){var a={};new List(this._data.PropertyBag).each(function(b){a[b.Key]=b.Value}),this._propertyBag=a}return this._propertyBag},SystemNode.prototype.hasChildren=function(){return this._data.HasChildren},SystemNode.prototype.getActionProfile=function(){if(null==this._actionProfile&&null!=this._data.ActionKeys&&this._data.ActionKeys.length>0){var a=new Map;new List(this._data.ActionKeys).each(function(b){if(!SystemAction.actionMap.has(b))throw"No details for action key: "+b;var c=SystemAction.actionMap.get(b),d=!0;if(c.getCategory()==SystemAction.categories.DeveloperMode&&(Application.isDeveloperMode||(d=!1)),d){var e=c.getGroupID();a.has(e)||a.set(e,new List);var f=a.get(e);f.add(c)}}),this._actionProfile=a}return this._actionProfile},SystemNode.prototype.hasDragType=function(){return null!=this._data.DragType},SystemNode.prototype.getDragType=function(){return this._data.DragType},SystemNode.prototype.hasDragAccept=function(){return null!=this._data.DropTypeAccept},SystemNode.prototype.getDragAccept=function(){return new List(this._data.DropTypeAccept)},SystemNode.prototype.hasDetailedDropSupport=function(){return 1==this._data.DetailedDropSupported},SystemNode.prototype.isDisabled=function(){return 1==this._data.IsDisabled},SystemNode.prototype.isTreeLockEnabled=function(){return 1==this._data.TreeLockEnabled},SystemNode.prototype.isMultiple=function(){return null!=this._datas},SystemNode.prototype.getDatas=function(){return this._datas},SystemNode.prototype.select=function(a){null!=this._datas&&this._datas.each(function(b){return b.ElementKey!==a||(this._data=b,this._actionProfile=null,this._registerSystemActions(),!1)},this)},SystemNode.prototype.selectByToken=function(a){null!=this._datas&&this._datas.each(function(b){return b.EntityToken!==a||(this._data=b,this._actionProfile=null,this._registerSystemActions(),!1)},this)},SystemNode.prototype.getEntityTokens=function(){var a=new List;return null!=this._datas?this._datas.each(function(b){a.add(b.EntityToken)}):a.add(this._data.EntityToken),a},SystemNode.prototype.add=function(a){return null==this._datas&&(this._datas=new List,this._datas.add(this._data)),this._datas.add(a.getData()),this},SystemNode.prototype.dispose=function(){SystemNode.dispose(this)},SystemAction.OPEN_DOCUMENT="OpenDocument",SystemAction.OPEN_MODAL_DIALOG="OpenModalDialog",SystemAction.TAG_CHANGEFROMLANGUAGE="ChangeFromLocale",SystemAction.TAG_USER="User",SystemAction.categories={Edit:"Edit",Add:"Add",Delete:"Delete",Other:"Other",DeveloperMode:"DeveloperMode"},SystemAction.activePositions={NavigatorTree:1,SelectorTree:2},SystemAction.taggedActions=new Map,SystemAction.actionMap=new Map,SystemAction.invoke=function(a,b){var c=b;if(!(c instanceof SystemNode))throw"Multiple actiontargets not supported.";Application.lock(SystemAction),a.logger.debug('Execute "'+a.getLabel()+'" on "'+c.getLabel()+'".'),TreeService.ExecuteSingleElementAction(c.getData(),a.getHandle(),Application.CONSOLE_ID),MessageQueue.update(a.isSyncedRequest()),Application.unlock(SystemAction)},SystemAction.invokeTagged=function(a,b){action=SystemAction.taggedActions.get(a),node=SystemNode.taggedNodes.get(b),SystemAction.invoke(action,node)},SystemAction.hasCategory=function(a){return!!SystemAction.categories[a]},SystemAction.prototype.toString=function(){return"[SystemAction]"},SystemAction.prototype.getHandle=function(){return this._data.ActionToken},SystemAction.prototype.getKey=function(){return this._data.ActionKey},SystemAction.prototype.getLabel=function(){return this._data.Label},SystemAction.prototype.getImage=function(){return ImageProvider.getImageURL(this._data.Icon)},SystemAction.prototype.getDisabledImage=function(){return null},SystemAction.prototype.getToolTip=function(){return this._data.ToolTip},SystemAction.prototype.getCategory=function(){return this._data.ActionCategory.Name},SystemAction.prototype.getGroupID=function(){return this._data.ActionCategory.GroupId},SystemAction.prototype.getGroupName=function(){return this._data.ActionCategory.GroupName},SystemAction.prototype.getActivePositions=function(){return this._data.ActivePositions},SystemAction.prototype.isInToolBar=function(){return this._data.ActionCategory.IsInToolbar},SystemAction.prototype.isInFolder=function(){return this._data.ActionCategory.IsInFolder},SystemAction.prototype.isSyncedRequest=function(){return!0},SystemAction.prototype.getBundleName=function(){return this._data.ActionCategory.ActionBundle},SystemAction.prototype.getBulkExecutionDialog=function(){return this._data.BulkExecutionDialog},SystemAction.prototype.getFolderName=function(){var a=null;return this.isInFolder()&&(a=this._data.ActionCategory.FolderName),a},SystemAction.prototype.isDisabled=function(){return this._data.Disabled},SystemAction.prototype.isCheckBox=function(){return typeof this._data.CheckboxStatus!=Types.UNDEFINED},SystemAction.prototype.getTag=function(){var a=null;return"undefined"!=typeof this._data.TagValue&&(a=this._data.TagValue),a},SystemAction.prototype.isChecked=function(){var a=null;if(!this.isCheckBox())throw"Not a checkbox!";return a="Checked"==this._data.CheckboxStatus},_UpdateManager.prototype={version:"0.1",CLASSNAME_FORM:"updateform",CLASSNAME_ZONE:"updatezone",CLASSNAME_GONE:"updategone",
EVENT_BEFOREUPDATE:"beforeupdate",EVENT_AFTERUPDATE:"afterupdate",EVENT_ERRORUPDATE:"errorupdate",xhtml:null,summary:null,isEnabled:!0,isDebugging:!1,isUpdating:!1,hasSoftAttributes:!1,hasSoftSiblings:!1,pendingResponse:null,currentDOM:null,errormessage:null,_assistant:null,_updates:null,_replaced:null,_dotnetnames:["__VIEWSTATE","__EVENTVALIDATION","__EVENTTARGET","__EVENTARGUMENT","__LASTFOCUS"],plugins:[],toString:function(){return"[object UpdateManager]"},_construct:function(a){var b=document.documentElement,c=b.namespaceURI;null==c&&(c=new String(b.getAttribute("xmlns"))),"http://www.w3.org/1999/xhtml"==c?(this._addListener(window,"load"),this._addListener(window,"unload")):this.error("Not an XHTML document!")},_setup:function(){if(this.isEnabled&&(this.isEnabled=this.setupForms(),this.isEnabled))if(null!=this.xhtml){if("string"!=typeof this.xhtml)throw new TypeError;var a=decodeURIComponent(this.xhtml);this.currentDOM=UpdateAssistant.parse(a)}else{var b=this;UpdateAssistant.getXMLHttpRequest("get",window.location.toString(),{handleResponse:function(a){b.currentDOM=a}}).send(null)}},setupForms:function(){var a=!1;return Array.forEach(document.forms,function(b){b.className.indexOf(this.CLASSNAME_FORM)>-1&&(b.__isSetup||(this._setupForm(b),b.__isSetup=!0),a=!0)},this),a},_setupForm:function(a){var b=this;this._addListener(a,"submit"),a.__submit=a.submit,a.submit=function(){return b.isEnabled?b._submit(a):a.__submit(),!1}},_addListener:function(a,b){if(null!=a.addEventListener)a.addEventListener(b,this,!1);else{var c=this;a.attachEvent("on"+b,function(){c.handleEvent(window.event)})}},handleEvent:function(a){switch(a.type){case"load":this.isEnabled&&this._setup();break;case"unload":this.isEnabled=!1;break;case"submit":if(this.isEnabled){document.all?a.returnValue=!1:a.preventDefault();var b=a.target?a.target:a.srcElement;this._submit(b)}}},_submit:function(a){this.isUpdating||(this.isUpdating=!0,UpdateAssistant.dispatchEvent(document.documentElement,this.EVENT_BEFOREUPDATE),this._postRequest(a))},handleResponse:function(a){if(this.isEnabled&&(this.summary=new String(""),this.errors=new String(""),null!=a)){var b=UpdateAssistant.getUpdateZones(a),c=UpdateAssistant.getUpdateZones(this.currentDOM);this._updates=[],this._replaced={},b.forEach(function(a,b){var d=c[b];this._crawl(a,d)},this),this._updates.forEach(function(a,b){a.update(),a.dispose()},this),this._dotnetnames.forEach(function(b){this._fixdotnet(a,b)},this),this.currentDOM=a}this.isUpdating=!1,UpdateAssistant.dispatchEvent(document.documentElement,this.EVENT_AFTERUPDATE)},handleSimilarResponse:function(){UpdateAssistant.dispatchEvent(document.documentElement,this.EVENT_AFTERUPDATE)},_crawl:function(a,b,c,d){var e=!0,f=b.getAttribute("class");if(null==f||f.indexOf(this.CLASSNAME_GONE)==-1){if(b.nodeType==Node.ELEMENT_NODE){var g=b.getAttribute("id");null!=g&&(c=a,d=g)}if(e=this._check(a,b,c,d))for(var h=a.firstChild,i=b.firstChild;null!=h&&null!=i&&!this._replaced[d];){switch(h.nodeType){case Node.TEXT_NODE:e=this._check(h,i,c,d);break;case Node.DOCUMENT_NODE:case Node.ELEMENT_NODE:e=this._crawl(h,i,c,d)}this._replaced[d]?e=!1:(h=h.nextSibling,i=i.nextSibling)}}return e},_check:function(a,b,c,d){var e=!0,f=null,g=!1,h=!1;if(null!=a&&null==b||null==a&&null!=b)e=!1;else if(e=a.nodeType==b.nodeType)switch(b.nodeType){case Node.ELEMENT_NODE:if(a.namespaceURI!=b.namespaceURI||a.nodeName!=b.nodeName)e=!1;else if(e=a.nodeName==b.nodeName){var i=b.getAttribute("id"),j=a.getAttribute("id");null!=i&&null!=j&&(i!=j?e=!1:null!=(f=this._getPlugin(a,b))&&f.updateElement(a,b)&&(h=!0,e=!1)),e&&(e=this._checkAttributes(a,b))&&(this.hasSoftSiblings&&this._hasSoftChildren(a)&&this._hasSoftChildren(b)?(this._validateSoftChildren(a,b)&&(this._updateSoftChildren(a,b),g=!0),e=!1):e=a.childNodes.length==b.childNodes.length)}break;case Node.TEXT_NODE:a.data.trim()!=b.data.trim()&&(e=!1)}return 0!=e||g||h||null!=d&&null!=c&&this.addUpdate(new ReplaceUpdate(d,c)),e},_checkAttributes:function(a,b){var c=!0,d=!1,e=a.attributes,f=b.attributes;if(d=e.length!=f.length||!Array.every(e,function(a,b){var c=f.item(b);return a.nodeName==c.nodeName&&a.nodeValue==c.nodeValue})){var g=a.getAttribute("id"),h=b.getAttribute("id");this.hasSoftAttributes&&null!=g&&g==h?this.addUpdate(new AttributesUpdate(h,a,b)):c=!1}return c},_hasSoftChildren:function(a){var b=!0;return a.hasChildNodes()&&(b=Array.every(a.childNodes,function(a){var b=!0;switch(a.nodeType){case Node.TEXT_NODE:b=!/[^\t\n\r ]/.test(a.nodeValue);break;case Node.ELEMENT_NODE:b=null!=a.getAttribute("id")}return b})),b},_validateSoftChildren:function(a,b){var c=!0,d=-1,e=-1,f=-1,g=this._toMap(a.childNodes,!0),h=this._toMap(b.childNodes,!0);for(var i in h){if(c){var j=h[i];c=j>=d,null!=g[i]&&(f=g[i],c=f>=e)}d=j,f>-1&&(e=f)}return c},_updateSoftChildren:function(a,b){var c=this._toMap(a.childNodes),d=this._toMap(b.childNodes);for(var e in d)null==c[e]?this.addUpdate(new SiblingUpdate(Update.TYPE_REMOVE,e,null,null)):this._crawl(c[e],d[e]);var f=null;for(e in c){if(null==d[e]){var g=c[e];if(null==f){var h=b.getAttribute("id");this.addUpdate(new SiblingUpdate(Update.TYPE_INSERT,h,g,!0))}else this.addUpdate(new SiblingUpdate(Update.TYPE_INSERT,f,g,!1))}f=e}},addUpdate:function(a){this._updates.push(a),a instanceof ReplaceUpdate&&(this._replaced[a.id]=!0)},_getPlugin:function(a,b){var c=null;return this.plugins.every(function(d){return d.handleElement(a,b)&&(c=d),null==c}),c},_toMap:function(a,b){var c={};return Array.forEach(a,function(a,d){a.nodeType==Node.ELEMENT_NODE&&(c[a.getAttribute("id")]=b?d:a)}),c},_getPost:function(a){var b=new String("");if(null!=a){var c="";Array.forEach(a.elements,function(a){if(null!=a.name&&""!=a.name){var d=a.name,e=encodeURIComponent(a.value);switch(a.type){case"button":case"submit":var f=UpdateAssistant.getActiveElement();a==f&&""!=d&&(b+=d+"="+e+"&");break;case"radio":a.checked&&(b+=d+"="+e+"&");break;case"checkbox":a.checked&&(a.name==c?(b.lastIndexOf("&")==b.length-1&&(b=b.substr(0,b.length-1)),b+=","+e):b+=d+"="+a.value,c=d,b+="&");break;case"text":case"hidden":case"password":case"textarea":case"select-one":b+=d+"="+e+"&"}}})}return b.substr(0,b.length-1)},_postRequest:function(a){var b=""!=a.method?a.method:"get",c=""!=a.action?a.action:window.location.toString(),d=this._getPost(a);"get"==b&&c.indexOf("?")>-1&&(c=c+"&"+d);var e=UpdateAssistant.getXMLHttpRequest(b,c,this);"post"==b&&e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send("post"==b?d:null)},_fixdotnet:function(a,b){var c=document.getElementById(b);if(null!=c){var d=UpdateAssistant.getElementById(a,b);if(null!=d){var e=d.getAttribute("value");e!==c.value&&(c.value=e)}}},debug:function(a){this.isDebugging&&alert("UpdateManager dysfunction. \n\n"+a)},error:function(a){this.errorsmessage=a,UpdateAssistant.dispatchEvent(document.documentElement,UpdateManager.EVENT_ERRORUPDATE),this.debug(a)},report:function(a){this.summary+=a+"\n"}};var UpdateManager=new _UpdateManager;_UpdateAssistant.prototype={_serializer:null!=window.XMLSerializer?new XMLSerializer:null,_parser:null!=window.DOMParser&&null!=window.XPathResult?new DOMParser:null,_activeElement:null,_construct:function(){window.Node||(window.Node={ELEMENT_NODE:1,TEXT_NODE:3,DOCUMENT_NODE:9}),Array.every||(Array.every=function(a,b){var c=!0,d=a.length>>>0;if("function"!=typeof b)throw new TypeError;for(var e=arguments[2],f=0;f<d;f++)if("undefined"!=typeof a[f]&&!b.call(e,a[f],f,a)){c=!1;break}return c}),Array.prototype.every||(Array.prototype.every=function(a){var b=arguments[1];return Array.every(this,a,b)}),Array.forEach||(Array.forEach=function(a,b){var c=a.length>>>0;if("function"!=typeof b)throw new TypeError;for(var d=arguments[2],e=0;e<c;e++)"undefined"!=typeof a[e]&&b.call(d,a[e],e,a)}),Array.prototype.forEach||(Array.prototype.forEach=function(a){var b=arguments[1];Array.forEach(this,a,b)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")}),null!=document.addEventListener&&(document.addEventListener("focus",this,!1),document.addEventListener("blur",this,!1),document.addEventListener("mousedown",this,!1))},handleEvent:function(a){switch(a.type){case"focus":case"mousedown":this._activeElement=a.target;break;case"blur":this._activeElement==a.target&&(this._activeElement=null)}},getXMLHttpRequest:function(a,b,c){function d(){if(4==e.readyState){var a=e.getResponseHeader("X-Error-Type");if(a){for(var d="",f=0;f<10;f++){var g=f?f:"",a=e.getResponseHeader("X-Error-Type"+g);if(!a)break;var h=e.getResponseHeader("X-Error-Message"+g);d+=a+"\n"+h+"\n"}Dialog.error("Error",d)}else{var i=e.responseText;UpdateManager.pendingResponse=i;var j=UpdateAssistant.parse(i);null!=j&&c.handleResponse(j)}Application.unlock(b)}}var e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Msxml2.XMLHTTP.3.0");return null!=e&&(e.open(a,b,null!=c),null!=c&&(Application.lock(b),null!=e.addEventListener?e.addEventListener("readystatechange",{handleEvent:function(){d()}},!1):e.onreadystatechange=d)),e},dispatchEvent:function(a,b){var c=!0,d=document.createEvent("UIEvents");return d.initEvent(b,!0,!0),c=a.dispatchEvent(d)},getUpdateZones:function(a){var b="//*[@id and contains(@class,'updatezone')]",c=[],d=null,e=null;if(null!=window.XPathResult){var f=XPathResult.ORDERED_NODE_ITERATOR_TYPE;for(d=a.evaluate(b,a,null,f,null);null!=(e=d.iterateNext());)c.push(e)}else d=a.documentElement.selectNodes(b),Array.forEach(d,function(a){c.push(a)});return c},getElementById:function(a,b){var c="//*[@id='"+b+"']",d=null,e=null;if(null!=window.XPathResult){var f=XPathResult.FIRST_ORDERED_NODE_TYPE;d=a.evaluate(c,a,null,f,null),e=d.singleNodeValue}else e=a.documentElement.selectNodes(c)[0];return e},_getIds:function(a){var b="//*[@id]",c=null,d=[];if(null!=window.XPathResult){var e=XPathResult.ORDERED_NODE_ITERATOR_TYPE;for(c=a.evaluate(b,a,null,e,null);null!=(element=c.iterateNext());)d.push(element.getAttribute("id"))}else c=a.documentElement.selectNodes(b),Array.forEach(c,function(a){d.push(a.getAttribute("id"))});return d},toHTMLElement:function(a){var b=this.serialize(a),c=document.createElement("temp");return c.innerHTML=b,c.firstChild},getActiveElement:function(){var a=document.activeElement;return null!=a&&a!=document.body||(a=this._activeElement),a},serialize:function(a){var b=null;return null!=a.xml?b=a.xml:null!=this._serializer&&(b=this._serializer.serializeToString(a)),b},hasDifferences:function(a,b){var c=null,d=null;return null!=a.xml?(c=a.xml,d=b.xml):null!=this._serializer&&(c=this._serializer.serializeToString(a),d=this._serializer.serializeToString(b)),c!=d},parse:function(a){var b=null;return null!=this._parser&&null!=window.XPathResult?b=this._parser.parseFromString(a,"text/xml"):(b=new ActiveXObject("Msxml2.DOMDocument.3.0"),b.setProperty("SelectionLanguage","XPath"),b.loadXML(a)),this._validate(b)},_validate:function(a){var b=null;if(null!=a.parseError&&0!=a.parseError.errorCode)b=a.parseError.reason;else{var c=a.getElementsByTagName("parsererror").item(0);null!=c&&(b=c.textContent.replace(/\^/g,"").replace(/\-/g,""))}if(null==b){var d={},e=this._getIds(a);e.every(function(a){var c=!d[a];return d[a]=!0,c||(b='Element "'+a+'" encountered twice.'),c})}return null!=b&&(UpdateManager.error(b),a=null),a}};var UpdateAssistant=new _UpdateAssistant;UpdateManager.plugins.push(new UpdatePlugin),Update.TYPE_REPLACE="replace",Update.TYPE_ATTRIBUTES="attributes",Update.TYPE_REMOVE="remove",Update.TYPE_INSERT="insert",Update.EVENT_BEFOREUPDATE="beforeupdate",Update.EVENT_AFTERUPDATE="afterupdate",Update.prototype={type:null,key:null,id:null,element:null,update:function(){},dispose:function(){this.element=null},_beforeUpdate:function(a){var b=!0;return null!=a&&(a.__updateType=this.type,b=UpdateAssistant.dispatchEvent(a,Update.EVENT_BEFOREUPDATE)),b},_afterUpdate:function(a){var b=!0;return null!=a&&(a.__updateType=this.type,b=UpdateAssistant.dispatchEvent(a,Update.EVENT_AFTERUPDATE)),b}},ReplaceUpdate.prototype=new Update,ReplaceUpdate.superclass=Update.prototype,ReplaceUpdate.prototype.update=function(){var a,b,c=UpdateAssistant.toHTMLElement(this.element);if(null!=(a=document.getElementById(this.id))){if(null!=(b=a.parentNode)){var d=UserInterface.getBinding(a);null!=d&&(c.__isAttached=d.isAttached),this._beforeUpdate(a)&&(b.replaceChild(c,a),this._afterUpdate(c))}}else UpdateManager.error("Element null point: "+this.id)},ReplaceUpdate.prototype._afterUpdate=function(a){var b=ReplaceUpdate.superclass._afterUpdate.call(this,a);return UpdateManager.report('Replaced element id="'+this.id+'"'),"form"!=a.nodeName&&null==a.getElementsByTagName("form").item(0)||UpdateManager.setupForms(),b},SiblingUpdate.prototype=new Update,SiblingUpdate.superclass=Update.prototype,SiblingUpdate.prototype.update=function(){var a=document.getElementById(this.id);switch(this.type){case Update.TYPE_REMOVE:this._remove(a);break;case Update.TYPE_INSERT:this._insert(this.element,a)}},SiblingUpdate.prototype._remove=function(a){var b=a.parentNode;null!=b&&this._beforeUpdate(a)&&(b.removeChild(a),this._afterUpdate(b))},SiblingUpdate.prototype._insert=function(a,b){var c=UpdateAssistant.toHTMLElement(a);if(this.isFirst){var d=b;null!=d&&this._beforeUpdate(d)&&(d.insertBefore(c,d.firstChild),this._afterUpdate(c))}else{var d=b.parentNode;null!=d&&this._beforeUpdate(d)&&(d.insertBefore(c,b.nextSibling),this._afterUpdate(c))}},SiblingUpdate.prototype._beforeUpdate=function(a){var b=SiblingUpdate.superclass._beforeUpdate.call(this,a);return this.type==Update.TYPE_REMOVE&&UpdateManager.report('Removed element id="'+a.id+'"'),b},SiblingUpdate.prototype._afterUpdate=function(a){var b=!0;return null!=a&&(b=SiblingUpdate.superclass._afterUpdate.call(this,a),this.type==Update.TYPE_INSERT&&(UpdateManager.report('Inserted element id="'+a.id+'"'),"form"!=a.nodeName&&null==a.getElementsByTagName("form").item(0)||UpdateManager.setupForms())),b},AttributesUpdate.prototype=new Update,AttributesUpdate.superclass=Update.prototype,AttributesUpdate.prototype.currentElement=null,AttributesUpdate.prototype.update=function(){var a=document.getElementById(this.id);this._beforeUpdate(a)&&(this._updateAttributes(a),this._afterUpdate(a))},AttributesUpdate.prototype._updateAttributes=function(a){Array.forEach(this.element.attributes,function(b){var c=this.currentElement.getAttribute(b.nodeName);null!=c&&c==b.nodeValue||(this._setAttribute(a,b.nodeName,b.nodeValue),this._summary.push("@"+b.nodeName))},this),Array.forEach(this.currentElement.attributes,function(b){null==this.element.getAttribute(b.nodeName)&&(this._setAttribute(a,b.nodeName,null),this._summary.push("@"+b.nodeName))},this)},AttributesUpdate.prototype._setAttribute=function(a,b,c){null==a&&(alert(this.id+": "+document.getElementById(this.id)+"\n\n"+b+"="+c),SystemLogger.getLogger("AttributesUpdate").fine(document.body.innerHTML));var d=null==c;if(d?a.removeAttribute(b):a.setAttribute(b,c),null!=document.all)switch(d&&(c=""),b.toLowerCase()){case"class":a.className=c;break;case"disabled":a.disabled=!d;break;case"checked":a.checked=!d;break;case"readonly":a.readOnly=!d}},AttributesUpdate.prototype._afterUpdate=function(a){AttributesUpdate.superclass._afterUpdate.call(this,a),UpdateManager.report('Attributes updated on element id="'+this.id+'": '+this._summary.toString())},AttributesUpdate.prototype.dispose=function(){Update.prototype.dispose.call(this),this.currentElement=null},window.Node||(window.Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),window.KeyEventCodes={VK_BACK:8,VK_TAB:9,VK_ENTER:13,VK_SHIFT:16,VK_CONTROL:17,VK_ALT:18,VK_ESCAPE:27,VK_SPACE:32,VK_PAGE_UP:33,VK_PAGE_DOWN:34,VK_END:35,VK_HOME:36,VK_LEFT:37,VK_UP:38,VK_RIGHT:39,VK_DOWN:40,VK_COMMAND:91,VK_INSERT:null,VK_DELETE:127,VK_PLUS:187,VK_MINUS:189,VK_NUMPLUS:107,VK_NUMMINUS:109,VK_F1:112},window==top?window.app=this:window.app=top.app,window.bindingMap={},window.standardEventHandler=null,window!=window.top&&top.Application.declareTopLocal(window),_WindowManager.prototype={WINDOW_LOADED_BROADCAST:null,WINDOW_UNLOADED_BROADCAST:null,WINDOW_EVALUATED_BROADCAST:null,WINDOW_RESIZED_BROADCAST:null,isWindowLoaded:!1,_logger:SystemLogger.getLogger("WindowManager ["+document.title+"]"),_ondomstatements:new List,_onloadstatements:new List,_onresizestatements:new List,_currentDimensions:null,_newDimensions:null,_broadcastTimeout:null,_isHorizontalResize:!1,_isVerticalResize:!1,_broadcastTimeout:null,_compute:function(a,b){return a.replace("${windowkey}",document.location+":"+b)},_construct:function(a){this.WINDOW_LOADED_BROADCAST=this._compute(BroadcastMessages.$WINKEY_LOADED,a),this.WINDOW_UNLOADED_BROADCAST=this._compute(BroadcastMessages.$WINKEY_UNLOADED,a),this.WINDOW_EVALUATED_BROADCAST=this._compute(BroadcastMessages.$WINKEY_EVALUATED,a),this.WINDOW_RESIZED_BROADCAST=this._compute(BroadcastMessages.$WINKEY_RESIZED,a),DOMEvents.addEventListener(window,DOMEvents.DOM,this),DOMEvents.addEventListener(window,DOMEvents.LOAD,this),DOMEvents.addEventListener(window,DOMEvents.UNLOAD,this)},handleEvent:function(a){switch(a.type){case DOMEvents.DOM:this.onDOMContentLoaded();break;case DOMEvents.LOAD:if(!this.isWindowLoaded){for(this.isWindowLoaded=!0,EventBroadcaster.broadcast(this.WINDOW_LOADED_BROADCAST,this);this._onloadstatements.hasNext();)this._onloadstatements.getNext().fireOnLoad();this._currentDimensions=this.getWindowDimensions(),DOMEvents.addEventListener(window,DOMEvents.RESIZE,this),EventBroadcaster.broadcast(this.WINDOW_EVALUATED_BROADCAST,this),DOMEvents.removeEventListener(window,DOMEvents.LOAD,this),DOMEvents.stopPropagation(a)}break;case DOMEvents.RESIZE:for(window==top&&EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,document.body),this._onresizestatements.reset();this._onresizestatements.hasNext();)this._onresizestatements.getNext().fireOnResize();this._newDimensions=WindowManager.getWindowDimensions();var b=this._newDimensions.w!=this._currentDimensions.w,c=this._newDimensions.h!=this._currentDimensions.h;if(b||c){null!=this._broadcastTimeout&&(clearTimeout(this._broadcastTimeout),this._broadcastTimeout=null);var d=this;this._broadcastTimeout=setTimeout(function(){d._broadcastResizeEvent()},250)}break;case DOMEvents.UNLOAD:EventBroadcaster.broadcast(this.WINDOW_UNLOADED_BROADCAST)}},_broadcastResizeEvent:function(){clearTimeout(this._broadcastTimeout),this._broadcastTimeout=null,EventBroadcaster.broadcast(this.WINDOW_RESIZED_BROADCAST),this._currentDimensions=this._newDimensions},fireOnDOM:function(a){Interfaces.isImplemented(IDOMHandler,a,!0)&&this._ondomstatements.add(a)},fireOnLoad:function(a){Interfaces.isImplemented(ILoadHandler,a,!0)&&this._onloadstatements.add(a)},fireOnResize:function(a){Interfaces.isImplemented(IResizeHandler,a,!0)&&this._onresizestatements.add(a)},onDOMContentLoaded:function(){for(;this._ondomstatements.hasNext();)this._ondomstatements.getNext().fireOnDOM()},getWindowDimensions:function(){return new Dimension(Client.isMozilla?window.innerWidth:document.body.clientWidth,Client.isMozilla?window.innerHeight:document.body.clientHeight)},evaluate:function(string){return eval(string)}};var WindowManager=new _WindowManager;new function(){Client.isExplorer&&WindowManager.onDOMContentLoaded()},top.app=null,_Application.prototype={CONSOLE_ID:KeyMaster.getUniqueKey(),_TIMEOUT_LOSTFOCUS:250,logger:SystemLogger.getLogger("Application"),timer:SystemTimer.getTimer("Application"),isDeveloperMode:!1,isLocalHost:!1,hasExternalConnection:!1,isLoggedIn:!1,isLoggedOut:!1,isLocked:!1,hasStartPage:!0,isMalFunctional:!1,isOperational:!1,isShuttingDown:!1,isOffLine:!1,isFocused:!0,isBlurred:!1,isTestEnvironment:!0,_isMousePositionTracking:!1,_mousePosition:null,_cursorStartPoint:null,_isDragging:!1,_isShutDownAllowed:!0,_lockers:0,_lockthings:{},_isRegistered:null,_activeBinding:null,_activatedBindings:new List,_dirtyTabs:new Map,_topLevelClasses:"undefined"!=typeof topLevelClassNames?new List(topLevelClassNames):null,_construct:function(){EventBroadcaster.subscribe(WindowManager.WINDOW_EVALUATED_BROADCAST,{handleBroadcast:function(){try{Application.initialize()}catch(a){throw SystemDebug.stack(arguments),a}}}),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMLOG_OPENED,{handleBroadcast:function(a,b){SystemLogger.unsuspend(b)}}),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMLOG_CLOSED,{handleBroadcast:function(){SystemLogger.suspend()}}),EventBroadcaster.subscribe(BroadcastMessages.STAGE_INITIALIZED,{handleBroadcast:function(){setTimeout(function(){ProgressBarBinding.notch(4),Application.isOperational=!0,EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_OPERATIONAL)},PageBinding.TIMEOUT)}}),EventBroadcaster.subscribe(BroadcastMessages.KEY_ESCAPE,{handleBroadcast:function(){Application.isLocked&&Application.unlock(Application,!0)}}),EventBroadcaster.subscribe(BroadcastMessages.SERVER_OFFLINE,{handleBroadcast:function(){Application.isOffLine=!0}}),EventBroadcaster.subscribe(BroadcastMessages.SERVER_ONLINE,{handleBroadcast:function(){Application.isOffLine=!1}}),EventBroadcaster.subscribe(BroadcastMessages.DOCKTAB_DIRTY,{handleBroadcast:function(a,b){var c=Application._dirtyTabs;if(c.set(b.key,b),1==c.countEntries()){var d=top.app.bindingMap.broadcasterHasDirtyTabs;d.enable()}}}),EventBroadcaster.subscribe(BroadcastMessages.DOCKTAB_CLEAN,{handleBroadcast:function(a,b){var c=Application._dirtyTabs;if(c.del(b.key),0==c.countEntries()){var d=top.app.bindingMap.broadcasterHasDirtyTabs;d.disable()}}})},toString:function(){return"[Application]"},login:function(){function a(){EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_LOGIN)}this.isLoggedIn=!0,ConfigurationService=WebServiceProxy.createProxy(Constants.URL_WSDL_CONFIGURATION),ConsoleMessageQueueService=WebServiceProxy.createProxy(Constants.URL_WSDL_MESSAGEQUEUE),EditorConfigurationService=WebServiceProxy.createProxy(Constants.URL_WSDL_EDITORCONFIG),FlowControllerService=WebServiceProxy.createProxy(Constants.URL_WSDL_FLOWCONTROLLER),StringService=WebServiceProxy.createProxy(Constants.URL_WSDL_STRINGSERVICE),TreeService=WebServiceProxy.createProxy(Constants.URL_WSDL_TREESERVICE),SecurityService=WebServiceProxy.createProxy(Constants.URL_WSDL_SECURITYSERVICE),XhtmlTransformationsService=WebServiceProxy.createProxy(Constants.URL_WSDL_XHTMLTRANSFORM),PageTemplateService=WebServiceProxy.createProxy(Constants.URL_WSDL_PAGETEMPLATE),FunctionService=WebServiceProxy.createProxy(Constants.URL_WSDL_FUNCTIONSERVICE),LocalizationService=WebServiceProxy.createProxy(Constants.URL_WSDL_LOCALIZATION),SourceValidationService=WebServiceProxy.createProxy(Constants.URL_WSDL_SOURCEVALIDATION),MarkupFormatService=WebServiceProxy.createProxy(Constants.URL_WSDL_MARKUPFORMAT),PageService=WebServiceProxy.createProxy(Constants.URL_WSDL_PAGESERVICE),ProgressBarBinding.notch(4),Client.isWebKit?setTimeout(function(){a()},0):a()},logout:function(){var a=this,b=new Promise(function(b,c){a.isLoggedIn&&(a.isLoggedIn=!1,a.isLoggedOut=!0,LoginService.Logout(!0,function(d,e){e?(a.isLoggedIn=!0,a.isLoggedOut=!1,alert("Logout failed."),c()):b(d)}))});return b},lock:function(a){if(null==a)throw"Application: No locker specified.";this._lockthings[a]=!0,null!=top.bindingMap.mastercover&&this._lockers>=0&&(this._lockers++,1==this._lockers&&(this.isLocked=!0,top.bindingMap.mastercover.show(),null!=top.app&&null!=top.app.bindingMap.throbber&&top.app.bindingMap.throbber.play()))},unlock:function(a,b){if(null==a)throw"Application: No unlocker specified.";if(delete this._lockthings[a],null!=top.bindingMap.mastercover&&(b||this._lockers>0)){if(b){var c="Unlocked by "+new String(a)+"\n";for(var d in this._lockthings)c+="Locked by "+new String(d)+". ";this.logger.debug(c),this._lockers=0}else this._lockers--;0==this._lockers&&(this.isLocked=!1,top.bindingMap.mastercover.hide(),null!=top.app&&null!=top.app.bindingMap.throbber&&setTimeout(function(){top.app.bindingMap.throbber.stop()},250))}},hasLock:function(a){return 1==this._lockthings[a]},activate:function(a){if(a!==this._activeBinding){var b=this._activeBinding;this._activeBinding=a,this._activatedBindings.add(a),b&&b.isActive&&b.deActivate()}},deActivate:function(a){var b=null,c=null;if(a==this._activeBinding){for(;!c&&this._activatedBindings.hasEntries();)b=this._activatedBindings.extractLast(),b!=a&&b.isActivatable&&(c=b);c&&c.activate()}},focused:function(a){this.isFocused=a,a?this.isBlurred&&(this.isBlurred=!1,EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_FOCUSED)):setTimeout(function(){Application.isFocused||(Application.isBlurred=!0,EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_BLURRED))},Application._TIMEOUT_LOSTFOCUS)},initialize:function(){DOMEvents.addEventListener(top,DOMEvents.UNLOAD,{handleEvent:function(a){EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_ONSHUTDOWN),EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_SHUTDOWN),Application.isShuttingDown||(Application.isShuttingDown=!0,null!=FlowControllerService&&FlowControllerService.ReleaseAllConsoleResources(Application.CONSOLE_ID)),this.isLoggedIn&&!Application.isDeveloperMode&&Application.logout()}}),EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_STARTUP)},cancelShutDown:function(){this._isShutDownAllowed=!1},framework:function(a){var b=DOMUtil.getParentWindow(a);null!=b&&(b.standardEventHandler||(b.standardEventHandler=new StandardEventHandler(a)))},normalize:function(a){},handleAction:function(a){switch(a.type){case Application.REFRESH:this.refresh()}},declareTopLocal:function(a){var b=Resolver.resolve("/scripts/source/top/");if(null==this._topLevelClasses){this._topLevelClasses=new List;var c=this;new List(DOMUtil.getElementsByTagName(document,"script")).each(function(a){var d=a.src;if(d.indexOf(b)>-1){var e=d.substring(d.lastIndexOf("/")+1,d.lastIndexOf(".js"));c._topLevelClasses.add(e)}})}this._topLevelClasses.each(function(b){null!=window[b]&&(a[b]=window[b])})},trackMousePosition:function(a){var b=!1;return this._isMousePositionTracking&&(b=!0,Client.isExplorer&&1!=a.button&&(b=!1),b&&(this._mousePosition=DOMUtil.getUniversalMousePosition(a))),b},enableMousePositionTracking:function(a){if(!a)throw new Error("Application: MouseEvent undefined.");this._isMousePositionTracking=!0,this._mousePosition=DOMUtil.getUniversalMousePosition(a)},disableMousePositionTracking:function(){this._isMousePositionTracking=!1,this._mouseposition=null},getMousePosition:function(){return this._mousePosition},onDragStart:function(a){var b=BindingDragger.draggedBinding;1==Interfaces.isImplemented(IDraggable,b,!0)&&(this._isDragging||(app.bindingMap.dragdropcursor.setImage(b.getImage()),this._cursorStartPoint=a,app.bindingMap.dragdropcursor.setPosition(this._cursorStartPoint),CursorBinding.fadeIn(app.bindingMap.dragdropcursor),b.showDrag&&b.showDrag(),EventBroadcaster.broadcast(BroadcastMessages.TYPEDRAG_START,b.dragType),this._isDragging=!0))},onDrag:function(a){if(this._isDragging){var b=new Point(this._cursorStartPoint.x+a.x,this._cursorStartPoint.y+a.y);app.bindingMap.dragdropcursor.setPosition(b)}},onDragStop:function(a){if(this._isDragging){var b=BindingDragger.draggedBinding;if(b.hideDrag&&b.hideDrag(),EventBroadcaster.broadcast(BroadcastMessages.TYPEDRAG_STOP,b.dragType),this._isDragging=!1,b=BindingAcceptor.acceptingBinding,null!=b){if(1!=Interfaces.isImplemented(IAcceptable,b,!0))throw new Error("Application: IAcceptable not implemented "+b);b.accept(BindingDragger.draggedBinding),BindingAcceptor.acceptingBinding=null,CursorBinding.fadeOut(app.bindingMap.dragdropcursor)}else app.bindingMap.dragdropcursor.hide()}},reload:function(a){this.isDeveloperMode||a?(this.isDeveloperMode&&Client.isPrism&&Prism.clearCache(),Application.lock(Application),setTimeout(function(){top.window.location.reload(!0)},0)):Application.isOperational?Dialog.question(StringBundle.getString("ui","Website.Application.DialogReload.Title"),StringBundle.getString("ui","Website.Application.DialogReload.Text"),Dialog.BUTTONS_ACCEPT_CANCEL,{handleDialogResponse:function(a){a==Dialog.RESPONSE_ACCEPT&&Application.reload(!0)}}):Application.reload(!0)},quit:function(){Application.isShuttingDown=!0,null!=FlowControllerService&&FlowControllerService.ReleaseAllConsoleResources(Application.CONSOLE_ID),this.logout().then(function(a){a?location=a:location.reload()})},hasDirtyDockTabs:function(){return this._dirtyTabs.countEntries()>0},getDirtyDockTabsTabs:function(){return this._dirtyTabs}};var Application=new _Application;_Installation.prototype={applicationName:null,versionString:null,versionPrettyString:null,installationID:null,passwordExpirationTimeInDays:null,handleBroadcast:function(a){switch(a){case BroadcastMessages.APPLICATION_KICKSTART:var b=new List(InstallationService.GetInstallationInfo(!0));b.each(function(a){switch(a.Key){case"ApplicationName":this.applicationName=a.Value;break;case"ProductVersion":this.versionString=a.Value;break;case"ProductTitle":this.versionPrettyString=a.Value;break;case"InstallationId":this.installationID=a.Value;break;case"PasswordExpirationTimeInDays":this.passwordExpirationTimeInDays=a.Value}},this)}}};var Installation=new _Installation;_Keyboard.prototype={_logger:SystemLogger.getLogger("Keyboard"),isShiftPressed:!1,isControlPressed:!1,keyEnter:function(){EventBroadcaster.broadcast(BroadcastMessages.KEY_ENTER)},keyEscape:function(){EventBroadcaster.broadcast(BroadcastMessages.KEY_ESCAPE)},keySpace:function(){EventBroadcaster.broadcast(BroadcastMessages.KEY_SPACE)},keyShift:function(){this.isShiftPressed=!0,EventBroadcaster.broadcast(BroadcastMessages.KEY_SHIFT_DOWN)},keyControl:function(){this.isControlPressed=!0,EventBroadcaster.broadcast(BroadcastMessages.KEY_CONTROL_DOWN)},keyArrow:function(a){EventBroadcaster.broadcast(BroadcastMessages.KEY_ARROW,a)},keyAlt:function(){EventBroadcaster.broadcast(BroadcastMessages.KEY_ALT)},keyTab:function(){EventBroadcaster.broadcast(BroadcastMessages.KEY_TAB)},keyUp:function(a){this.isShiftPressed&&a.keyCode==window.KeyEventCodes.VK_SHIFT?(this.isShiftPressed=!1,EventBroadcaster.broadcast(BroadcastMessages.KEY_SHIFT_UP)):this.isControlPressed&&a.keyCode==window.KeyEventCodes.VK_CONTROL&&(this.isControlPressed=!1,EventBroadcaster.broadcast(BroadcastMessages.KEY_CONTROL_UP))}};var Keyboard=new _Keyboard;window.Preferences=new function(){function a(a){var d=a?"Persisted preferences":"No persisted preferences. Using defaults";d+=":\n";for(var e in c){var f=c[e];d+="\n\t"+e+": "+f+" ["+typeof f+"]"}b.fine(d)}var b=SystemLogger.getLogger("Preferences");this.LOGIN="login";var c={login:!0};EventBroadcaster.subscribe(BroadcastMessages.LOCALSTORE_INITIALIZED,{handleBroadcast:function(){if(LocalStore.isEnabled){var b=LocalStore.getProperty(LocalStore.PREFERENCES);if(b){for(var d in b)c[d]=b[d];a(!0)}else a(!1)}else a(!1)}}),EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_SHUTDOWN,{handleBroadcast:function(){LocalStore.isEnabled&&LocalStore.setProperty(LocalStore.PREFERENCES,c)}}),this.getPref=function(a){var b=null;if(!a)throw"No such preference.";return b=c[a]},this.setPref=function(a,b){if(!a)throw"No such preference.";c[a]=b}},_Persistance.prototype={_logger:SystemLogger.getLogger("Persistance"),_persistance:null,_isEnabled:!1,isInitialized:!1,isEnabled:!1,getPersistedProperty:function(a,b){var c=null;if(1!=this.isInitialized)throw"Persistance not initialized!";if(this._persistance){var d=this._persistance[a];d&&(c=d[b])}return c},setPersistedProperty:function(a,b,c){if(1!=this.isInitialized)throw"Persistance not initialized!";this._persistance&&(null!=c?(this._persistance[a]||(this._persistance[a]={}),this._persistance[a][b]=String(c)):this._logger.error("Cannot persist "+b+" with value: null"))},clearAllPersistedProperties:function(){this._logger.debug("TODO: clearAllPersistedProperties")},handleBroadcast:function(a){
switch(a){case BroadcastMessages.APPLICATION_SHUTDOWN:var b=top.bindingMap.persistance;b.persist(this._persistance)}},initialize:function(){if(!this.isInitialized){if(this.isInitialized=!0,1==this._isEnabled){var a=top.bindingMap.persistance,b=a.getPersistanceMap();b&&(this.isEnabled=!0,this._persistance=b,EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_SHUTDOWN,this))}else this.isEnabled=!1;EventBroadcaster.broadcast(BroadcastMessages.PERSISTANCE_INITIALIZED)}}};var Persistance=new _Persistance,LocalStore=new function(){this.isInitialized=!0,this.isEnabled=!1,this.openedNodes=new SystemNodeList,this.focuseNodes=new SystemNodeList};StandardEventHandler.isBackAllowed=!1,StandardEventHandler.prototype._addListeners=function(){var a=this._contextDocument;if(DOMEvents.addEventListener(a,DOMEvents.MOUSEDOWN,this),DOMEvents.addEventListener(a,DOMEvents.MOUSEUP,this),DOMEvents.addEventListener(a,DOMEvents.MOUSEMOVE,this),DOMEvents.addEventListener(a,DOMEvents.TOUCHSTART,this),(Client.isExplorer||Client.isExplorer11)&&(DOMEvents.addEventListener(this._contextDocument,DOMEvents.HELP,{handleEvent:function(a){DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a)}}),DOMEvents.addEventListener(this._contextWindow,DOMEvents.HELP,{handleEvent:function(a){DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a)}})),!this._isMouseHandlerOnly){DOMEvents.addEventListener(a,DOMEvents.KEYDOWN,this),DOMEvents.addEventListener(a,DOMEvents.KEYUP,this),null==this._contextWindow.WindowManager&&(Client.isExplorer||Client.isExplorer11?(DOMEvents.addEventListener(a,DOMEvents.FOCUSIN,this),DOMEvents.addEventListener(a,DOMEvents.FOCUSOUT,this)):"on"!=this._contextDocument.designMode&&(DOMEvents.addEventListener(a,DOMEvents.FOCUS,this,!0),DOMEvents.addEventListener(a,DOMEvents.BLUR,this,!0)));var b={handleEvent:function(a){switch(a.type){case DOMEvents.BLUR:Application.focused(!1);break;case DOMEvents.FOCUS:Application.focused(!0)}}};DOMEvents.addEventListener(this._contextWindow,DOMEvents.BLUR,b),DOMEvents.addEventListener(this._contextWindow,DOMEvents.FOCUS,b)}Client.isMozilla&&a.addEventListener(DOMEvents.KEYDOWN,{handleEvent:function(a){var b=83;Client.isMac?a.metaKey&&a.keyCode==b&&!a.altKey&&a.preventDefault():a.ctrlKey&&a.keyCode==b&&!a.altKey&&a.preventDefault()}},!0)},StandardEventHandler.prototype.handleEvent=function(a){switch(a.type){case DOMEvents.MOUSEDOWN:this._handleMouseDown(a);break;case DOMEvents.MOUSEUP:this._handleMouseUp(a);break;case DOMEvents.MOUSEMOVE:this._handleMouseMove(a);break;case DOMEvents.TOUCHSTART:this._handleTouchStart(a);break;case DOMEvents.KEYDOWN:this._handleKeyDown(a);break;case DOMEvents.KEYUP:this._handleKeyUp(a);break;case DOMEvents.FOCUS:case DOMEvents.BLUR:case DOMEvents.FOCUSIN:case DOMEvents.FOCUSOUT:this._handleFocus(a)}},StandardEventHandler.prototype._handleMouseDown=function(a){if(Application.trackMousePosition(a),EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,a),a.button!=ButtonStateManager.RIGHT_BUTTON)for(var b=DOMEvents.getTarget(a);null!=b;)switch(b.nodeType){case Node.ELEMENT_NODE:var c=UserInterface.getBinding(b);null!=c&&c.dispatchAction(Binding.ACTION_ACTIVATED),b=null!=c?null:b.parentNode;break;case Node.DOCUMENT_NODE:b=DOMUtil.getParentWindow(b).frameElement;break;default:b=null}},StandardEventHandler.prototype._handleMouseUp=function(a){Application.trackMousePosition(a),EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEUP,a)},StandardEventHandler.prototype._handleMouseMove=function(a){try{var b=Application.trackMousePosition(a);b&&EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEMOVE,a)}catch(a){throw DOMEvents.removeEventListener(this._contextDocument,DOMEvents.MOUSEMOVE,this),a}},StandardEventHandler.prototype._handleTouchStart=function(a){EventBroadcaster.broadcast(BroadcastMessages.TOUCHEVENT_TOUCHSTART,a)},StandardEventHandler.prototype._handleKeyDown=function(a,b,c){if(a.keyCode==KeyEventCodes.VK_TAB&&(this._isAllowTabs?(a.shiftKey||a.ctrlKey)&&DOMEvents.preventDefault(a):b||(this._handleTab(a),DOMEvents.preventDefault(a)),b=!0),!(this.hasNativeKeys||a.shiftKey||a.ctrlKey||c))switch(a.keyCode){case KeyEventCodes.VK_UP:case KeyEventCodes.VK_DOWN:case KeyEventCodes.VK_LEFT:case KeyEventCodes.VK_RIGHT:case KeyEventCodes.VK_SPACE:case KeyEventCodes.VK_PAGE_UP:case KeyEventCodes.VK_PAGE_DOWN:DOMEvents.preventDefault(a)}a.keyCode==KeyEventCodes.VK_BACK&&(StandardEventHandler.isBackAllowed&&!UserInterface.hasBinding(a.target)||DOMEvents.preventDefault(a));var d=KeySetBinding.handleKey(this._contextDocument,a);if(!d)switch(a.keyCode){case KeyEventCodes.VK_PAGE_UP:case KeyEventCodes.VK_PAGE_DOWN:break;default:var e=this._contextWindow.frameElement;if(null!=e){var f=DOMUtil.getParentWindow(e);null!=f.standardEventHandler&&f.standardEventHandler._handleKeyDown(a,b,c?c:this.hasNativeKeys)}}},StandardEventHandler.prototype._handleTab=function(a){this._isAllowTabs||a.ctrlKey||(a.shiftKey?FocusBinding.navigatePrevious():FocusBinding.navigateNext())},StandardEventHandler.prototype._handleFocus=function(a){var b=!1,c=DOMEvents.getTarget(a),d=c.nodeName.toLowerCase();switch(d){case"input":case"textarea":case"select":b=a.type==DOMEvents.FOCUS||a.type==DOMEvents.FOCUSIN,"input"!=d&&"textarea"!=d||(StandardEventHandler.isBackAllowed=b),b?this.hasNativeKeys||this.enableNativeKeys():this.hasNativeKeys&&this.disableNativeKeys()}},StandardEventHandler.prototype._handleKeyUp=function(a){Keyboard.keyUp(a)},StandardEventHandler.prototype.enableNativeKeys=function(a){this._isAllowTabs=1==a;var b=this;top.setTimeout(function(){b.hasNativeKeys=!0,StandardEventHandler.isBackAllowed=!0},0)},StandardEventHandler.prototype.disableNativeKeys=function(){this._isAllowTabs=!1,this.hasNativeKeys=!1,StandardEventHandler.isBackAllowed=!1},Action.isValid=function(a){return typeof a!=Types.UNDEFINED},Action.prototype.consume=function(){this.isConsumed=!0},Action.prototype.cancel=function(){this.isCancelled=!0},Animation.DEFAULT_TIME=parseInt(250),Animation.prototype.play=function(){if(this.isPlaying)if(this.modifier>0?this.iterator>=this.endcount:this.iterator<=this.endcount)this.stop();else{var a=this.iterator,b=this.onstep(this.iterator);b&&b!=a?this.iterator=b:this.iterator+=this.modifier,this._nextframe()}else{var c=this;this._nextframe=function(){window[this.id]=setTimeout(function(){c.play()},this.interval)},this.onstart(this.iterator),this._nextframe(),this.isPlaying=!0}},Animation.prototype.stop=function(){this.onstop(this.iterator),this.isPlaying=!1},Animation.prototype.onstart=function(a){},Animation.prototype.onstep=function(a){},Animation.prototype.onstop=function(a){},Point.isEqual=function(a,b){var c=!1;return a&&b&&(c=a.x==b.x&&a.y==b.y),c},Point.prototype={x:0,y:0},Dimension.isEqual=function(a,b){var c=!1;return a&&b&&(c=a.w==b.w&&a.h==b.h),c},Dimension.prototype={w:0,h:0},BindingAcceptor.acceptingBinding=null,BindingAcceptor.prototype._initialize=function(){if(EventBroadcaster.subscribe(BroadcastMessages.TYPEDRAG_START,this),EventBroadcaster.subscribe(BroadcastMessages.TYPEDRAG_STOP,this),this._binding.dragAccept){EventBroadcaster.subscribe(BroadcastMessages.TYPEDRAG_PAUSE,this);for(var a=new List(this._binding.dragAccept.split(" "));a.hasNext();){var b=a.getNext();this._acceptedList[b]=!0}}},BindingAcceptor.prototype.handleBroadcast=function(a,b){var c=b;try{switch(a){case BroadcastMessages.TYPEDRAG_START:null==this._cursor&&(this._cursor=app.bindingMap.dragdropcursor),this._binding.addEventListener(DOMEvents.MOUSEENTER,this),this._binding.addEventListener(DOMEvents.MOUSELEAVE,this),this.isAccepting(c)&&(this._isAccepting=!0,this._startAccepting());break;case BroadcastMessages.TYPEDRAG_STOP:this._binding.removeEventListener(DOMEvents.MOUSEENTER,this),this._binding.removeEventListener(DOMEvents.MOUSELEAVE,this),this.isAccepting(c)&&(this._isAccepting=!1,this._stopAccepting());break;case BroadcastMessages.TYPEDRAG_PAUSE:this.isAccepting(c)&&this._pauseAccepting()}}catch(a){this.logger.debug(a)}},BindingAcceptor.prototype.isAccepting=function(a){return Types.isDefined(this._acceptedList[a])},BindingAcceptor.prototype._startAccepting=function(){Types.isFunction(this._binding.showGeneralAcceptance)&&this._binding.showGeneralAcceptance()},BindingAcceptor.prototype._pauseAccepting=function(){this._binding.hideAcceptance&&this._binding.hideAcceptance(),this._cursor.hideAcceptance(),BindingAcceptor.acceptingBinding=null},BindingAcceptor.prototype._stopAccepting=function(){this._binding.hideGeneralAcceptance&&this._binding.hideGeneralAcceptance(),this._binding.hideAcceptance&&this._binding.hideAcceptance()},BindingAcceptor.prototype.handleEvent=function(a){switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:this._isAccepting?BindingAcceptor.acceptingBinding!=this._binding&&(BindingAcceptor.acceptingBinding=this._binding,this._cursor.showAcceptance(),Types.isFunction(this._binding.showAcceptance)&&this._binding.showAcceptance()):(EventBroadcaster.broadcast(BroadcastMessages.TYPEDRAG_PAUSE),DOMEvents.stopPropagation(a));break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:this._isAccepting?(BindingAcceptor.acceptingBinding=null,this._cursor.hideAcceptance(),Types.isFunction(this._binding.hideAcceptance)&&this._binding.hideAcceptance()):DOMEvents.stopPropagation(a)}DOMEvents.stopPropagation(a)},BindingAcceptor.prototype.dispose=function(){EventBroadcaster.unsubscribe(BroadcastMessages.TYPEDRAG_START,this),EventBroadcaster.unsubscribe(BroadcastMessages.TYPEDRAG_STOP,this)},BindingBoxObject.prototype.getUniversalPosition=function(){return DOMUtil.getUniversalPosition(this._domElement)},BindingBoxObject.prototype.getGlobalPosition=function(){return DOMUtil.getGlobalPosition(this._domElement)},BindingBoxObject.prototype.getLocalPosition=function(){return DOMUtil.getLocalPosition(this._domElement)},BindingBoxObject.prototype.getDimension=function(){var a=this._domElement.getBoundingClientRect();return new Dimension(a.right-a.left,a.bottom-a.top)},BindingBoxObject.prototype.dispose=function(){this._domElement=null},BindingDragger.isDragging=!1,BindingDragger.draggedBinding=null,BindingDragger.bindingDragger=null,BindingDragger.prototype.handleEvent=function(a){if(a.type==DOMEvents.MOUSEUP)this.isDragReady=!1;else if(!BindingDragger.isDragging)switch(a.type){case DOMEvents.MOUSEDOWN:DOMEvents.isRightButton(a)||(this.isDragReady=!0,DOMEvents.preventDefault(a));break;case DOMEvents.MOUSEMOVE:1==this.isDragReady&&(this.binding.dispatchAction(Binding.ACTION_DRAG),this.handler&&this.onDragStart(a),this.isDragReady=!1)}},BindingDragger.prototype.registerHandler=function(a){if(1!=Interfaces.isImplemented(IDragHandler,a))throw new Error("BindingDragger: Interface IDraghandler not implemented.");this.handler=a},BindingDragger.prototype.onDragStart=function(a){this.isDragging||(Application.enableMousePositionTracking(a),this.startPoint=Application.getMousePosition(),this.isDragging=!0,BindingDragger.isDragging=!0,BindingDragger.draggedBinding=this.binding,this.handler.onDragStart(this.startPoint),EventBroadcaster.subscribe(BroadcastMessages.MOUSEEVENT_MOUSEMOVE,this),EventBroadcaster.subscribe(BroadcastMessages.MOUSEEVENT_MOUSEUP,this))},BindingDragger.prototype.onDrag=function(a){if(1==this.isDragging){var b=a.button==(a.target?0:1);b?this.handler.onDrag(this.getDiff()):this.onDragStop(a)}},BindingDragger.prototype.onDragStop=function(a){1==this.isDragging&&(Application.disableMousePositionTracking(),this.handler.onDragStop(this.getDiff()),this.isDragging=!1,BindingDragger.isDragging=!1,BindingDragger.draggedBinding=null,EventBroadcaster.unsubscribe(BroadcastMessages.MOUSEEVENT_MOUSEMOVE,this),EventBroadcaster.unsubscribe(BroadcastMessages.MOUSEEVENT_MOUSEUP,this))},BindingDragger.prototype.getDiff=function(){var a=Application.getMousePosition(),b=a.x-this.startPoint.x,c=a.y-this.startPoint.y;return new Point(b,c)},BindingDragger.prototype.handleBroadcast=function(a,b){switch(a){case BroadcastMessages.MOUSEEVENT_MOUSEMOVE:this.onDrag(b);break;case BroadcastMessages.MOUSEEVENT_MOUSEUP:this.onDragStop(b)}},BindingDragger.prototype.dispose=function(){this.binding=null},BindingParser.XML='<div xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://www.w3.org/1999/xhtml">${markup}</div>',BindingParser.prototype.parseFromString=function(a){var b=new List,c=(BindingParser.XML.replace("${markup}",a),XMLParser.parse(a));if(c){var d=DOMUtil.createElementNS(Constants.NS_XHTML,"div",this._ownerDocument);this._iterate(c.documentElement,d);for(var e=d.firstChild;e;)e.nodeType==Node.ELEMENT_NODE&&b.add(e),e=e.nextSibling}return b},BindingParser.prototype._iterate=function(a,b){var c=null;switch(a.nodeType){case Node.ELEMENT_NODE:c=this._cloneElement(a),UserInterface.registerBinding(c);break;case Node.TEXT_NODE:c=this._ownerDocument.createTextNode(a.nodeValue)}if(c&&b.appendChild(c),c&&a.hasChildNodes())for(var d=a.firstChild;d;)this._iterate(d,c),d=d.nextSibling},BindingParser.prototype._cloneElement=function(a){for(var b=DOMUtil.createElementNS(a.namespaceURI?a.namespaceURI:Constants.NS_XHTML,a.nodeName,this._ownerDocument),c=0;c<a.attributes.length;){var d=a.attributes.item(c++);b.setAttribute(d.nodeName,String(d.nodeValue))}return b},BindingSerializer.activeInstance=null,BindingSerializer.KEYPOINTER="bindingserializerkeypointer",BindingSerializer.filter=function(a){var b=null,c=!1,d=a.parentNode.getAttribute(BindingSerializer.KEYPOINTER);if(UserInterface.hasBinding(a)){var e=UserInterface.getBinding(a);c=BindingSerializer.activeInstance.indexBinding(e),c&&(b=e.key,a.setAttribute(BindingSerializer.KEYPOINTER,b))}b=b?b:d;var f=new List(a.childNodes);f.each(function(a){a.nodeType==Node.ELEMENT_NODE&&a.setAttribute(BindingSerializer.KEYPOINTER,b)}),c&&BindingSerializer.activeInstance.append(b,d)},BindingSerializer.prototype.serializeBinding=function(a){return BindingSerializer.activeInstance=this,a.bindingWindow.ElementIterator.iterate(a.bindingElement,BindingSerializer.filter),DOMSerializer.serialize(this._dom,!0)},BindingSerializer.prototype.indexBinding=function(a){var b=!1,c=a.serialize();if(0!=c){b=!0;var d="ui:"+DOMUtil.getLocalName(a.bindingElement),e=DOMUtil.createElementNS(Constants.NS_UI,d,this._dom);this._pointers[a.key]=e;for(var f in c)null!=c[f]&&e.setAttribute(f,String(c[f]))}return b},BindingSerializer.prototype.append=function(a,b){var c=this._pointers[a],d=b?this._pointers[b]:this._dom;d.appendChild(c)},ImageProfile.prototype.getDefaultImage=function(){return this._default},ImageProfile.prototype.setDefaultImage=function(a){this._default=a},ImageProfile.prototype.getHoverImage=function(){return this._default},ImageProfile.prototype.setHoverImage=function(a){this._hover=a},ImageProfile.prototype.getActiveImage=function(){return this._active},ImageProfile.prototype.setActiveImage=function(a){this._active=a},ImageProfile.prototype.getDisabledImage=function(){return this._default},ImageProfile.prototype.setDisabledImage=function(a){this._disabled=a},_BindingFinder.prototype={getDescendantBindingsByLocalName:function(a,b,c){var d=null;if(a.isAttached){d=new List;var e=c?a.getChildElementsByLocalName(b):a.getDescendantElementsByLocalName(b);e.each(function(a){var b=UserInterface.getBinding(a);b&&d.add(b)})}else{var f="Could not resolve descendants of unattached binding "+a.toString();if(Application.isDeveloperMode)throw f}return d},getAncestorBindingByType:function(a,b,c){var d=null;if(Binding.exists(a))for(var e=a.bindingElement;null==d&&null!=e;)if(e=e.parentNode,null!=e)if(UserInterface.hasBinding(e)){var f=UserInterface.getBinding(e);f instanceof b&&(d=f)}else if(c&&e.nodeType==Node.DOCUMENT_NODE){var g=DOMUtil.getParentWindow(e);if(null==g){SystemDebug.stack(arguments);break}e=g.frameElement}return d},getAncestorBindingByInterface:function(a,b,c){var d=null;if(Binding.exists(a))for(var e=a.bindingElement;null==d&&null!=e;)if(e=e.parentNode,null!=e)if(UserInterface.hasBinding(e)){var f=UserInterface.getBinding(e);Interfaces.isImplemented(b,f)&&(d=f)}else if(c&&e.nodeType==Node.DOCUMENT_NODE){var g=DOMUtil.getParentWindow(e);if(null==g)break;e=g.frameElement}return d},getAncestorBindingByLocalName:function(a,b,c){var d=null;if("*"==b)for(var e=a.bindingElement;!d&&null!=(e=e.parentNode);)UserInterface.hasBinding(e)&&(d=UserInterface.getBinding(e));else d=UserInterface.getBinding(DOMUtil.getAncestorByLocalName(b,a.bindingElement,c));return d},getChildElementsByLocalName:function(a,b){var c=new List,d=new List(a.bindingElement.childNodes);return d.each(function(a){a.nodeType==Node.ELEMENT_NODE&&("*"!=b&&DOMUtil.getLocalName(a)!=b||c.add(a))}),c},getChildBindingByType:function(a,b){var c=null;return a.getChildElementsByLocalName("*").each(function(a){var d=UserInterface.getBinding(a);return!(null!=d&&d instanceof b)||(c=d,!1)}),c},getDescendantBindingByType:function(a,b){var c=null;return a.getDescendantElementsByLocalName("*").each(function(a){var d=UserInterface.getBinding(a);return!(null!=d&&d instanceof b)||(c=d,!1)}),c},getDescendantBindingsByType:function(a,b,c){var d=new List;return a.getDescendantElementsByLocalName("*").each(function(a){var e=UserInterface.getBinding(a);return null!=e&&e instanceof b?d.add(e):c&&e instanceof WindowBinding&&e.getRootBinding()&&this.getDescendantBindingsByType(e.getRootBinding(),b,c).each(function(a){d.add(a)}),!0},this),d},getNextBindingByLocalName:function(a,b){for(var c=null,d=a.bindingElement;null!=(d=DOMUtil.getNextElementSibling(d))&&DOMUtil.getLocalName(d)!=b;);return null!=d&&(c=UserInterface.getBinding(d)),c},getPreviousBindingByLocalName:function(a,b){for(var c=null,d=a.bindingElement;null!=(d=DOMUtil.getPreviousElementSibling(d))&&DOMUtil.getLocalName(d)!=b;);return null!=d&&(c=UserInterface.getBinding(d)),c}};var BindingFinder=new _BindingFinder;NodeCrawler.NORMAL=1,NodeCrawler.SKIP_NODE=2,NodeCrawler.SKIP_CHILDREN=4,NodeCrawler.STOP_CRAWLING=8,NodeCrawler.TYPE_DESCENDING="descending",NodeCrawler.TYPE_ASCENDING="ascending",NodeCrawler.prototype={logger:SystemLogger.getLogger("NodeCrawler"),type:NodeCrawler.TYPE_DESCENDING,currentNode:null,previousNode:null,contextDocument:null,_filters:null,_construct:function(){this.currentNode=null,this.previousNode=null,this.nextNode=null,this._filters=new List,this.type=NodeCrawler.TYPE_DESCENDING},addFilter:function(a){this._filters.add(a)},removeFilter:function(a){var b=-1;this._filters.each(function(c){b++;var d=!0;return c==a&&(d=!1),d}),b>-1&&this._filters.del(b)},_applyFilters:function(a,b){var c=null,d=NodeCrawler.STOP_CRAWLING,e=NodeCrawler.SKIP_NODE,f=NodeCrawler.SKIP_CHILDREN;this._filters.reset();for(var g=!0;this._filters.hasNext()&&1==g;){var h=this._filters.getNext(),i=h.call(this,a,b);if(null!=i)switch(c=i,i){case d:case e:case e+f:g=!1}}return c},crawl:function(a,b){this.contextDocument=a.ownerDocument,this.onCrawlStart();var c=this.type==NodeCrawler.TYPE_ASCENDING,d=this._applyFilters(a,b);if(d!=NodeCrawler.STOP_CRAWLING)if(c&&d==NodeCrawler.SKIP_CHILDREN);else{var e=null;null!=this.nextNode?(e=this.nextNode,this.nextNode=null):e=c?a.parentNode:a,this._crawl(e,b)}this.onCrawlStop()},onCrawlStart:function(){},onCrawlStop:function(){},_crawl:function(a,b){var c=null;switch(this.type){case NodeCrawler.TYPE_DESCENDING:c=this._crawlDescending(a,b);break;case NodeCrawler.TYPE_ASCENDING:c=this._crawlAscending(a,b)}return c},_crawlDescending:function(a,b){var c=NodeCrawler.SKIP_NODE,d=NodeCrawler.SKIP_CHILDREN,e=NodeCrawler.STOP_CRAWLING,f=null;if(a.hasChildNodes())for(var g=a.firstChild;null!=g&&f!=e;){switch(this.currentNode=g,f=this._applyFilters(g,b)){case e:case d:case c+d:break;default:if(g.nodeType==Node.ELEMENT_NODE&&null==this.nextNode){var h=this._crawl(g,b);if(h==e){f=e;break}}f!=e&&f!=c&&(this.previousNode=g)}f!=e&&(g=this.nextNode?this.nextNode:g.nextSibling,this.nextNode=null)}return f},_crawlAscending:function(a,b){var c=null,d=(NodeCrawler.SKIP_CHILDREN,NodeCrawler.STOP_CRAWLING);if(null!=a){if(this.currentNode=a,c=this._applyFilters(a,b),c!=d){var e=this.nextNode?this.nextNode:a.parentNode;this.nextNode=null,e&&e.nodeType!=Node.DOCUMENT_NODE&&(this.previousNode=a,c=this._crawl(e,b))}}else c=d;return c}},NodeCrawler.prototype.dispose=function(){this._filters.dispose();for(var a in this)this[a]=null},ElementCrawler.prototype=new NodeCrawler,ElementCrawler.prototype.constructor=ElementCrawler,ElementCrawler.superclass=NodeCrawler.prototype,ElementCrawler.prototype._construct=function(){ElementCrawler.superclass._construct.call(this),this.addFilter(function(a,b){var c=null;return a.nodeType!=Node.ELEMENT_NODE&&(c=NodeCrawler.SKIP_NODE),c})},BindingCrawler.prototype=new ElementCrawler,BindingCrawler.prototype.constructor=BindingCrawler,BindingCrawler.superclass=ElementCrawler.prototype,BindingCrawler.prototype._construct=function(){BindingCrawler.superclass._construct.call(this),this.addFilter(function(a,b){var c=null;return UserInterface.hasBinding(a)||(c=NodeCrawler.SKIP_NODE),c})},Crawler.prototype=new BindingCrawler,Crawler.prototype.constructor=Crawler,Crawler.superclass=BindingCrawler.prototype,Crawler.prototype._construct=function(){Crawler.superclass._construct.call(this),this.response=null;var a=this;this.addFilter(function(b,c){var d=null,e=UserInterface.getBinding(b);return 1==Interfaces.isImplemented(ICrawlerHandler,e)&&(a.response=null,e.handleCrawler(a),d=a.response),d})},FlexBoxCrawler.prototype=new Crawler,FlexBoxCrawler.prototype.constructor=FlexBoxCrawler,FlexBoxCrawler.superclass=Crawler.prototype,FlexBoxCrawler.ID="flexboxcrawler",FlexBoxCrawler.MODE_FORCE="force",FlexBoxCrawler.MODE_NORMAL="normal",FlexBoxCrawler.prototype._construct=function(){FlexBoxCrawler.superclass._construct.call(this);var a=this;this.addFilter(function(b,c){var d=null,e=UserInterface.getBinding(b);if(1==Interfaces.isImplemented(IFlexible,e))switch(a.mode){case FlexBoxCrawler.MODE_FORCE:c.add(e);break;case FlexBoxCrawler.MODE_NORMAL:1==e.isFlexSuspended?d=NodeCrawler.SKIP_CHILDREN:c.add(e)}return d})},FocusCrawler.prototype=new Crawler,FocusCrawler.prototype.constructor=FocusCrawler,FocusCrawler.superclass=Crawler.prototype,FocusCrawler.ID="focuscrawler",FocusCrawler.MODE_INDEX="index",FocusCrawler.MODE_FOCUS="focus",FocusCrawler.MODE_BLUR="blur",FocusCrawler.prototype._construct=function(){FocusCrawler.superclass._construct.call(this),this.addFilter(function(a,b){var c=null,d=UserInterface.getBinding(a);if(1==d.isAttached&&1==Interfaces.isImplemented(IFocusable,d)&&d.isFocusable&&d.isVisible)switch(this.mode){case FocusCrawler.MODE_INDEX:b.add(d);break;case FocusCrawler.MODE_FOCUS:d.isFocused||d.focus(),c=NodeCrawler.STOP_CRAWLING;break;case FocusCrawler.MODE_BLUR:1==d.isFocused&&(d.blur(),c=NodeCrawler.STOP_CRAWLING)}return c})},FitnessCrawler.prototype=new Crawler,FitnessCrawler.prototype.constructor=FitnessCrawler,FitnessCrawler.superclass=Crawler.prototype,FitnessCrawler.ID="fitnesscrawler",FitnessCrawler.MODE_BRUTAL="brutal fitness",FitnessCrawler.MODE_TRAINING="train fitness",FitnessCrawler.prototype._construct=function(){FitnessCrawler.superclass._construct.call(this),this.addFilter(function(a,b){var c=null,d=UserInterface.getBinding(a);return d.isVisible||(c=NodeCrawler.SKIP_NODE+NodeCrawler.SKIP_CHILDREN),c}),this.addFilter(function(a,b){var c=UserInterface.getBinding(a);return c.isAttached&&Interfaces.isImplemented(IFit,c)&&(c.isFit&&this.mode!=FitnessCrawler.MODE_BRUTAL||b.add(c)),null})},_DocumentUpdatePlugin.prototype={toString:function(){return"[DocumentUpdatePlugin]"},_logger:SystemLogger.getLogger("DocumentUpdatePlugin ["+document.title+"]"),_isUpdating:!1,_attributesbuffer:null,_elementsbuffer:null,isDebugging:Application.isDeveloperMode,_oldDOM:null,_focusID:null,_setup:function(){UpdateManager.isDebugging=Application.isDeveloperMode,UpdateManager.hasSoftAttributes=!0,UpdateManager.hasSoftSiblings=!0,DOMEvents.addEventListener(document,DOMEvents.BEFOREUPDATE,this),DOMEvents.addEventListener(document,DOMEvents.AFTERUPDATE,this),DOMEvents.addEventListener(document,DOMEvents.ERRORUPDATE,this),DOMEvents.addEventListener(window,DOMEvents.UNLOAD,this),Client.isFirefox&&(UpdateAssistant.serialize=function(a){return a=a.cloneNode(!0),a.setAttributeNS(Constants.NS_NS,"xmlns",Constants.NS_XHTML),a.setAttributeNS(Constants.NS_NS,"xmlns:ui",Constants.NS_UI),this._serializer.serializeToString(a)})},handleEvent:function(a){var b=DOMEvents.getTarget(a);switch(a.type){case DOMEvents.BEFOREUPDATE:this._beforeUpdate(b);break;case DOMEvents.AFTERUPDATE:this._afterUpdate(b);break;case DOMEvents.ERRORUPDATE:this._errorUpdate();break;case DOMEvents.UNLOAD:Application.hasLock(this)&&Application.unlock(this)}},_beforeUpdate:function(a){var b=a==document.documentElement;if(b){this._elementsbuffer=new List,this._isUpdating=!0,Application.lock(this);var c=UserInterface.getBinding(document.body);if(null!=c){var d=c.getDescendantBindingByType(PageBinding);null!=d&&d.onBeforeUpdates()}var e=FocusBinding.focusedBinding;null!=e&&(this._focusID=e.getID()),this.isDebugging&&(this._oldDOM=DOMSerializer.serialize(UpdateManager.currentDOM,!0))}else switch(a.__updateType){case Update.TYPE_REPLACE:case Update.TYPE_REMOVE:DocumentManager.detachBindings(a);break;case Update.TYPE_ATTRIBUTES:this._backupattributes(a,!1)}},_afterUpdate:function(a){var b=a==document.documentElement;if(b){var c=this._elementsbuffer;c.hasEntries()&&c.each(function(a){DocumentManager.attachBindings(a)}),this._isUpdating=!1,Application.unlock(this);var d=UserInterface.getBinding(document.body);if(null!=d){var e=d.getDescendantBindingByType(PageBinding);null!=e&&e.onAfterUpdates()}var f=FocusBinding.focusedBinding;if(null==f){var g=document.getElementById(this._focusID);if(null!=g){var f=UserInterface.getBinding(g);null!=f&&f.focus()}}if(this._focusID=null,""!=UpdateManager.summary){if(this.isDebugging){var h=DOMSerializer.serialize(UpdateManager.currentDOM,!0),i="NEW DOM: "+document.title+"\n\n"+h+"\n\n";i+="OLD DOM: "+document.title+"\n\n"+this._oldDOM,this._logger.debug(i),this._oldDOM=null}this._logger.fine(UpdateManager.summary)}}else{switch(a.__updateType){case Update.TYPE_REPLACE:case Update.TYPE_INSERT:a.__isAttached!==!1&&this._elementsbuffer.add(a);break;case Update.TYPE_ATTRIBUTES:this._backupattributes(a,!0)}switch(a.id){case"__VIEWSTATE":case"__EVENTTARGET":case"__EVENTARGUMENT":case"__EVENTVALIDATION":case"__LASTFOCUS":case"__REQUEST":case"__RESPONSE":case"__CONSOLEID":break;default:for(var f=UserInterface.getBinding(a);null==f&&null!=a;)f=UserInterface.getBinding(a),a=a.parentNode;null!=f&&f.dispatchAction(Binding.ACTION_UPDATED)}}},_errorUpdate:function(){Application.unlock(this);var a="UpdateManager dysfunction:\n\n"+UpdateManager.errorsmessage;this._logger.error(a+"\n\n"+UpdateManager.pendingResponse),Application.isDeveloperMode&&alert(a)},_backupattributes:function(a,b){var c=UserInterface.getBinding(a);if(null!=c)if(b){var d=this._attributesbuffer,e=new Map;d.each(function(b,c){var d=a.getAttribute(b);null!=d?d!=c&&e.set(b,Types.castFromString(d)):e.set(b,null)}),new List(a.attributes).each(function(a){a.specified&&(d.has(a.nodeName)||e.set(a.nodeName,Types.castFromString(a.nodeValue)))}),e.each(function(a,b){var d=c.propertyMethodMap[a];null!=d&&d.call(c,b)})}else{var e=new Map;new List(a.attributes).each(function(a){a.specified&&e.set(a.nodeName,a.nodeValue)}),this._attributesbuffer=e}},handleElement:function(a,b){var c=window.bindingMap[a.getAttribute("id")];if(null!=c)return c.handleElement(a,b)},updateElement:function(a,b){var c=window.bindingMap[a.getAttribute("id")];if(null!=c)return c.updateElement(a,b)}};var DocumentUpdatePlugin=new _DocumentUpdatePlugin;DocumentCrawler.prototype=new ElementCrawler,DocumentCrawler.prototype.constructor=DocumentCrawler,DocumentCrawler.superclass=ElementCrawler.prototype,DocumentCrawler.ID="documentcrawler",DocumentCrawler.MODE_REGISTER="register",DocumentCrawler.MODE_ATTACH="attach",DocumentCrawler.MODE_DETACH="detach",DocumentCrawler.prototype._construct=function(){DocumentCrawler.superclass._construct.call(this);var a=this;this.addFilter(function(b,c){var d=UserInterface.getBinding(b),e=null;switch(a.mode){case DocumentCrawler.MODE_REGISTER:null==d&&UserInterface.registerBinding(b);break;case DocumentCrawler.MODE_ATTACH:null!=d&&(d.isAttached||c.add(d),1==d.isLazy&&(e=NodeCrawler.SKIP_CHILDREN));break;case DocumentCrawler.MODE_DETACH:null!=d&&c.add(d)}return e})},_DocumentManager.prototype={_logger:SystemLogger.getLogger("DocumentManager ["+document.title+"]"),_maxIndex:-1,customUserInterfaceMapping:null,isDocumentSelectable:!1,hasNativeContextMenu:!1,_construct:function(){Application.framework(document),EventBroadcaster.subscribe(WindowManager.WINDOW_LOADED_BROADCAST,this),Client.isExplorer&&DOMEvents.addEventListener(document,DOMEvents.CLICK,this)},handleBroadcast:function(a,b){this.isDocumentSelectable||this._makeDocumentUnselectable(),this.hasNativeContextMenu||DOMEvents.addEventListener(document,DOMEvents.CONTEXTMENU,this),Application.isMalFunctional||(this._resolveCustomBindingMappings(),this.attachBindings(document.documentElement))},handleEvent:function(a){var b=DOMEvents.getTarget(a);switch(a.type){case DOMEvents.SELECTSTART:case DOMEvents.CONTEXTMENU:this._isTextInputElement(b)||DOMEvents.preventDefault(a);break;case DOMEvents.CLICK:Client.isExplorer&&null!=b&&null!=b.href&&b.href.indexOf(Constants.DUMMY_LINK)>-1&&DOMEvents.preventDefault(a)}},_resolveCustomBindingMappings:function(){var bindingset=DOMUtil.getElementsByTagName(document.documentElement,"bindingmappingset").item(0);if(null!=bindingset){var map={},mappings=DOMUtil.getElementsByTagName(bindingset,"bindingmapping");new List(mappings).each(function(mapping){var element=mapping.getAttribute("element"),binding=mapping.getAttribute("binding");map[element]=eval(binding)}),this.setCustomUserInterfaceMapping(new UserInterfaceMapping(map))}},setCustomUserInterfaceMapping:function(a){null==this.customUserInterfaceMapping?this.customUserInterfaceMapping=a:this.customUserInterfaceMapping.merge(a)},_registerBindings:function(a){var b=new DocumentCrawler;b.mode=DocumentCrawler.MODE_REGISTER,b.crawl(a),b.dispose()},_attachBindings:function(a){var b=new DocumentCrawler;b.mode=DocumentCrawler.MODE_ATTACH;var c=new List;b.crawl(a,c);for(var d=!1;c.hasNext();){var e=c.getNext();e.isAttached||(e.onBindingAttach(),e.memberDependencies||e.onBindingInitialize(),Interfaces.isImplemented(IData,e)&&(d=!0))}if(d){var f=UserInterface.getBinding(document.body);null!=f&&setTimeout(function(){Binding.exists(f)&&f.dispatchAction(FocusBinding.ACTION_UPDATE)},250)}b.dispose(),c.dispose()},attachBindings:function(a){this._registerBindings(a),this._attachBindings(a)},detachBindings:function(a,b){var c=new DocumentCrawler;c.mode=DocumentCrawler.MODE_DETACH;var d=new List;c.crawl(a,d),1==b&&d.extractFirst();var e=!1;if(d.reverse().each(function(a){Interfaces.isImplemented(IData,a)&&(e=!0),a.dispose(!0)}),e){var f=UserInterface.getBinding(document.body);null!=f&&setTimeout(function(){Binding.exists(f)&&f.dispatchAction(FocusBinding.ACTION_UPDATE)},250)}c.dispose(),d.dispose()},detachAllBindings:function(){this.detachBindings(document.documentElement)},computeMaxIndex:function(){return this._maxIndex==-1&&(this._maxIndex=DOMUtil.getMaxIndex(document)),this._maxIndex++},_isTextInputElement:function(a){return/textarea|input/.test(DOMUtil.getLocalName(a))},_makeDocumentUnselectable:function(){Client.isExplorer&&DOMEvents.addEventListener(document,DOMEvents.SELECTSTART,this)}};var DocumentManager=new _DocumentManager;_DataManager.prototype={isPostBackFun:!1,_logger:SystemLogger.getLogger("DataManager ["+document.title+"]"),_dataBindings:{},isDirty:!1,dirty:function(a){this.isDirty=!0;var b=!1;return null==a||a.isDirty||(a.isDirty=!0,a.dispatchAction(Binding.ACTION_DIRTY),b=!0),b},clean:function(a){a.isDirty&&(a.isDirty=!1)},registerDataBinding:function(a,b){if(!Interfaces.isImplemented(IData,b,!0))throw"Invalid DataBinding: "+b;if(null!=this._dataBindings[a])throw"no proper support for checkbox multiple values! "+a;
this._dataBindings[a]=b},unRegisterDataBinding:function(a){null!=this._dataBindings[a]&&delete this._dataBindings[a]},getDataBinding:function(a){var b=null;return null!=this._dataBindings[a]&&(b=this._dataBindings[a]),b},getAllDataBindings:function(a){var b=new List;for(var c in this._dataBindings){var d=this._dataBindings[c];if(b.add(d),a&&d instanceof WindowBinding){var e=d.getContentWindow().DataManager;null!=e&&b.merge(e.getAllDataBindings())}}return b},hasDataBindings:function(){var a=!1;for(var b in this._dataBindings){a=!0;break}return a},populateDataBindings:function(a){a instanceof DataBindingMap&&a.each(function(b,c){var d=this._dataBindings[b];if(null!=d)switch(a.type){case DataBindingMap.TYPE_RESULT:try{d.setResult(c)}catch(a){throw Application.isDeveloperMode&&alert(d),a}break;case DataBindingMap.TYPE_VALUE:throw"Not implemented!"}})},getDataBindingValueMap:function(){var a=new DataBindingMap;a.type=DataBindingMap.TYPE_VALUE;for(var b in this._dataBindings){var c=this._dataBindings[b];if(c instanceof DataDialogBinding)throw"DataDialogBinding valuemap not supported!";a[b]=c.getValue()}return a},getDataBindingResultMap:function(){var a=new DataBindingMap;a.type=DataBindingMap.TYPE_RESULT;for(var b in this._dataBindings){var c=this._dataBindings[b],d=c.getResult();d instanceof DataBindingMap?d.each(function(b,c){a.set(b,c)}):a.set(b,d)}return a},getPostBackString:function(){var a="",b=document.forms[0];if(null!=b){var c="";new List(b.elements).each(function(b){var d=b.name,e=encodeURIComponent(b.value);switch(b.type){case"text":case"hidden":case"password":case"textarea":case"select-one":a+=d+"="+e+"&";break;case"submit":document.activeElement==b&&(a+=d+"="+e+"&");break;case"radio":b.checked&&(a+=d+"="+e+"&");break;case"checkbox":b.checked&&(b.name==c?(a.lastIndexOf("&")==a.length-1&&(a=a.substr(0,a.length-1)),a+=","+e):a+=d+"="+b.value,c=d,a+="&")}})}return a.substr(0,a.length-1)}};var DataManager=new _DataManager;_Templates.prototype={_logger:SystemLogger.getLogger("Templates"),_cache:{},_mode:null,_modes:{MODE_PLAINTEXT:0,MODE_DOCUMENT:1,MODE_ELEMENT:2,MODE_DOCUMENTTEXT:3,MODE_ELEMENTTEXT:4},getTemplateDocument:function(a){return this._mode=this._modes.MODE_DOCUMENT,this._getIt(a)},getTemplateElement:function(a){return this._mode=this._modes.MODE_ELEMENT,this._getIt(a)},getTemplateDocumentText:function(a){return this._mode=this._modes.MODE_DOCUMENTTEXT,this._getIt(a)},getTemplateElementText:function(a){return this._mode=this._modes.MODE_ELEMENTTEXT,this._getIt(a)},getTemplateBodyText:function(a){var b=this.getTemplateDocumentText(a);return b=b.split("<body>")[1].split("</body>")[0]},getPlainText:function(a){return this._mode=this._modes.MODE_PLAINTEXT,this._getIt(a)},_getIt:function(a){var b=null,c=null,d=!1;if(!this._cache[a]){d=!0;var e=Constants.TEMPLATESROOT+"/"+a,f=DOMUtil.getXMLHTTPRequest();switch(f.open("get",e,!1),f.setRequestHeader("Content-Type","text/xml; charset=UTF-8"),f.send(null),this._mode){case this._modes.MODE_PLAINTEXT:c=f.responseText;break;default:c=f.responseXML}if(null==c)throw new Error("Templates: Could not read template. Malformed XML?");this._cache[a]=c}switch(c=this._cache[a],this._mode){case this._modes.MODE_PLAINTEXT:b=c;break;case this._modes.MODE_DOCUMENT:b=DOMUtil.cloneNode(c,!0);break;case this._modes.MODE_ELEMENT:b=DOMUtil.cloneNode(c.documentElement,!0);break;case this._modes.MODE_DOCUMENTTEXT:b=DOMSerializer.serialize(c,!0);break;case this._modes.MODE_ELEMENTTEXT:b=DOMSerializer.serialize(c.documentElement,!0)}return d&&Application.isDeveloperMode,b}};var Templates=new _Templates;_Dialog.prototype={_logger:SystemLogger.getLogger("Dialog"),_URL_STANDARDDIALOG:"${root}/content/dialogs/standard/standard.aspx",MODAL:"modal",NON_MODAL:"nonmodal",URL_TREESELECTOR:"${root}/content/dialogs/treeselector/treeselector.aspx",URL_TREESEARCH:"${root}/content/dialogs/treesearch/treeSearchForm.aspx",URL_IMAGESELECTOR:"${root}/content/dialogs/treeselector/treeselector.aspx",URL_TREEACTIONSELECTOR:"${root}/content/dialogs/treeselector/treeselector.aspx",URL_SERVICEFAULT:"${root}/content/dialogs/webservices/error.aspx",BUTTONS_YES_NO_CANCEL:["yes:default","no","cancel"],BUTTONS_ACCEPT_CANCEL:["accept:default","cancel"],BUTTONS_ACCEPT:["accept:default"],RESPONSE_YES:"yes",RESPONSE_NO:"no",RESPONSE_ACCEPT:"accept",RESPONSE_CANCEL:"cancel",RESPONSE_DEFAULT:"default",_TYPE_WARNING:"warning",_TYPE_MESSAGE:"message",_TYPE_ERROR:"error",_TYPE_QUESTION:"question",_dialogImages:{warning:"${icon:warning}",message:"${icon:message}",error:"${icon:error}",question:"${icon:question}"},dialogButton:function(a){return void 0==this._dialogButtons&&(this._dialogButtons={yes:new DialogButton({label:StringBundle.getString("ui","Website.Dialogs.LabelYes"),response:this.RESPONSE_YES}),no:new DialogButton({label:StringBundle.getString("ui","Website.Dialogs.LabelNo"),response:this.RESPONSE_NO}),accept:new DialogButton({label:StringBundle.getString("ui","Website.Dialogs.LabelAccept"),response:this.RESPONSE_ACCEPT}),cancel:new DialogButton({label:StringBundle.getString("ui","Website.Dialogs.LabelCancel"),response:this.RESPONSE_CANCEL})}),Dialog._dialogButtons[a]},invoke:function(a,b,c){this._logger.error("Not implemented")},invokeModal:function(a,b,c,d){var e=new DialogViewDefinition({handle:KeyMaster.getUniqueKey(),position:Dialog.MODAL,url:a,handler:b,argument:c});return StageBinding.presentViewDefinition(e,d),e},invokeDefinition:function(a,b){return a instanceof DialogViewDefinition&&StageBinding.presentViewDefinition(a,b),a},question:function(a,b,c,d){c||(c=this.BUTTONS_ACCEPT_CANCEL),this._standardDialog(this._TYPE_QUESTION,a,b,c,d)},message:function(a,b,c,d){c||(c=this.BUTTONS_ACCEPT),this._standardDialog(this._TYPE_MESSAGE,a,b,c,d)},error:function(a,b,c,d){c||(c=this.BUTTONS_ACCEPT),this._standardDialog(this._TYPE_ERROR,a,b,c,d)},warning:function(a,b,c,d){c||(c=this.BUTTONS_ACCEPT),this._standardDialog(this._TYPE_WARNING,a,b,c,d)},_standardDialog:function(a,b,c,d,e){var f=null;d?(f=new List,new List(d).each(function(a){var b=null;switch(typeof a){case"object":b=a;break;case"string":var c=!1;a.indexOf(":")>-1&&(a=a.split(":")[0],c=!0),b=Dialog.dialogButton(a),c&&(b.isDefault=!0)}f.add(b)})):f=new List(Dialog.BUTTONS_ACCEPT);var g={title:b,text:c,type:a,image:this._dialogImages[a],buttons:f},h=new DialogViewDefinition({handle:"standarddialog:"+a,position:Dialog.MODAL,url:this._URL_STANDARDDIALOG,handler:e,argument:g});StageBinding.presentViewDefinition(h)}};var Dialog=new _Dialog;_Commands.prototype={_URL_ABOUTDIALOG:"${root}/content/dialogs/about/about.aspx",_URL_PREFERENCES:"${root}/content/dialogs/preferences/preferences.aspx",_construct:function(){var a=this;EventBroadcaster.subscribe(BroadcastMessages.SAVE_ALL,{handleBroadcast:function(b,c){a.saveAll(c)}})},about:function(){this._dialog(this._URL_ABOUTDIALOG)},preferences:function(){this._dialog(this._URL_PREFERENCES)},_dialog:function(a){Client.hasTransitions?setTimeout(function(){Dialog.invokeModal(a)},Animation.DEFAULT_TIME):Dialog.invokeModal(a)},close:function(){EventBroadcaster.broadcast(BroadcastMessages.CLOSE_CURRENT)},closeAll:function(){this.saveAll(!0)},save:function(){EventBroadcaster.broadcast(BroadcastMessages.SAVE_CURRENT)},saveAll:function(a){var b=this,c=Application.getDirtyDockTabsTabs();c.hasEntries()?Dialog.invokeModal("${root}/content/dialogs/save/saveall.aspx",{handleDialogResponse:function(c,d){switch(c){case Dialog.RESPONSE_ACCEPT:b._handleSaveAllResult(d,a);break;case Dialog.RESPONSE_CANCEL:EventBroadcaster.broadcast(BroadcastMessages.SAVE_ALL_DONE)}}},c):a&&EventBroadcaster.broadcast(BroadcastMessages.CLOSE_ALL)},_handleSaveAllResult:function(a,b){var c=!1,d=new List;if(a.each(function(a,b){0!=b&&d.add(b)}),d.hasEntries()){c=!0;var e=d.getLength(),f={handleBroadcast:function(a,c){0==--e&&(EventBroadcaster.unsubscribe(BroadcastMessages.DOCKTAB_CLEAN,this),EventBroadcaster.broadcast(BroadcastMessages.SAVE_ALL_DONE),b&&EventBroadcaster.broadcast(BroadcastMessages.CLOSE_ALL))}};EventBroadcaster.subscribe(BroadcastMessages.DOCKTAB_CLEAN,f),d.each(function(a){a.saveContainedEditor()})}else EventBroadcaster.broadcast(BroadcastMessages.SAVE_ALL_DONE);return c},systemLog:function(){if(Application.isOperational)StageBinding.handleViewPresentation("Composite.Management.SystemLog");else{var a=window.open(Constants.APPROOT+"/content/views/dev/systemlog/systemlogoutput.html");a.onload=function(){EventBroadcaster.broadcast(BroadcastMessages.SYSTEMLOG_OPENED,this)}}},help:function(){var a="Composite.Management.Help";StageBinding.isViewOpen(a)||StageBinding.handleViewPresentation(a)}};var Commands=new _Commands;_Prism.prototype={_logger:SystemLogger.getLogger("Prism"),clearCache:function(){this._logger.fine("Clearing the cache"),this._dispatchToPrism("contenttochrome-clearcache")},disableCache:function(){this._logger.fine("Disabling cache"),this._dispatchToPrism("contenttochrome-cache-disable")},enableCache:function(){this._logger.fine("Enabling cache"),this._dispatchToPrism("contenttochrome-cache-enable")},_dispatchToPrism:function(a){if(Client.isPrism){var b=document.createEvent("Events");b.initEvent(a,!0,!0),window.dispatchEvent(b)}else this._logger.warn("Prism methods should only be invoked in Prism! ("+a+")")}};var Prism=new _Prism;Uri.isMedia=function(a){return new Uri(a).isMedia},Uri.prototype.getPath=function(){return this.path},Uri.prototype.getQueryString=function(){return new Map(this.queryString)},Uri.prototype.hasParam=function(a){return null!=this.queryString[a]},Uri.prototype.getParam=function(a){return this.queryString[a]},Uri.prototype.setParam=function(a,b){void 0==b?delete this.queryString[a]:this.queryString[a]=b},Uri.prototype.toString=function(){var a=this.path,b=[];for(var c in this.queryString)b.push(c+"="+this.queryString[c]);return b.length>0&&(a+="?"+b.join("&")),a},ViewDefinition.DEFAULT_URL="${root}/blank.aspx",ViewDefinition.clone=function(a,b){var c=null,d=ViewDefinitions[a];if(!d.isMutable)throw"Cannot clone non-mutable definition";var e=null;if(e=d instanceof DialogViewDefinition?DialogViewDefinition:HostedViewDefinition,null==b||null==e)throw"Cannot clone without newhandle";var f=new e;for(var g in d)f[g]=ViewDefinition.cloneProperty(d[g]);return f.handle=b,c=f},ViewDefinition.cloneProperty=function(a){if(null==a)return a;if("object"==typeof a){var b=a.constructor===Array?[]:{};for(var c in a)b[c]=ViewDefinition.cloneProperty(a[c]);return b}return a},ViewDefinition.prototype={url:ViewDefinition.DEFAULT_URL,argument:null,handle:null,entityToken:null,flowHandle:null,label:null,image:null,toolTip:null},SystemViewDefinition.prototype=new ViewDefinition,SystemViewDefinition.prototype.constructor=SystemViewDefinition,SystemViewDefinition.superclass=ViewDefinition.prototype,SystemViewDefinition.DEFAULT_URL="${root}/content/views/systemview/systemview.aspx",HostedViewDefinition.prototype=new ViewDefinition,HostedViewDefinition.prototype.constructor=HostedViewDefinition,HostedViewDefinition.superclass=ViewDefinition.prototype,HostedViewDefinition.POSTBACK_URL="${root}/postback.aspx",DialogViewDefinition.prototype=new ViewDefinition,DialogViewDefinition.prototype.constructor=HostedViewDefinition,DialogViewDefinition.superclass=ViewDefinition.prototype,Binding.prototype.constructor=Binding,Binding.CALLBACKID="callbackid",Binding.CALLBACKARG="callbackarg",Binding.CLASSNAME_CLEARFLOAT="clearfix",Binding.CLASSNAME_FOCUSED="focused",Binding.SNOOZE=1==Client.isMozilla?125:250,Binding.ACTION_DRAG="bindingdrag",Binding.ACTION_DROP="bindingdrop",Binding.ACTION_DIRTY="bindingdirty",Binding.ACTION_VALID="bindingvalid",Binding.ACTION_UPDATED="bindingupdated",Binding.ACTION_INVALID="bindinginvalid",Binding.ACTION_RESIZED="bindingresized",Binding.ACTION_FOCUSED="bindingfocused",Binding.ACTION_BLURRED="bindingblurred",Binding.ACTION_ATTACHED="bindingattached",Binding.ACTION_DETACHED="bindingdetached",Binding.ACTION_DISPOSED="bindingdisposed",Binding.ACTION_MOVETOTOP="bindingmovetotop",Binding.ACTION_ACTIVATED="bindingactivated",Binding.ACTION_REGISTERED="bindingregistered",Binding.ACTION_MOVEDONTOP="bindingmovedontop",Binding.ACTION_INITIALIZED="bindinginitialized",Binding.ACTION_FORCE_REFLEX="bindingforcereflex",Binding.ACTION_DIMENSIONCHANGED="bindingdimensionchanged",Binding.ACTION_VISIBILITYCHANGED="bindingvisibilitychanged",Binding.ABSTRACT_METHOD=function(){throw SystemDebug.stack(arguments),this.toString()+" abstract method not implemented"},Binding.evaluate=function(a,b){var c=null,d=b.bindingWindow.WindowManager;if(null!=d){var e=Binding.parseScriptStatement(a,b.key);c=d.evaluate(e)}return c},Binding.parseScriptStatement=function(a,b){if(null!=a&&null!=b){var c='UserInterface.getBindingByKey ( "'+b+'" )';a=a.replace(/(\W|^)this(,| +|\)|;)/g,c),a=a.replace(/(\W|^)this(\.)/g,c+".")}return a},Binding.exists=function(a){var b=!1;try{a&&a.bindingElement&&a.bindingElement.nodeType&&0==a.isDisposed&&(b=!0)}catch(a){b=!1}finally{return b}},Binding.destroy=function(a){if(!a.isDisposed){null!=a.acceptor&&a.acceptor.dispose(),null!=a.dragger&&a.disableDragging(),null!=a.boxObject&&a.boxObject.dispose(),null!=a._domEventHandlers&&DOMEvents.cleanupEventListeners(a);for(var b in a.shadowTree){var c=a.shadowTree[b];c instanceof Binding&&Binding.exists(c)&&c.dispose(!0),a.shadowTree[b]=null}a.isDisposed=!0,a=null}},Binding.dotnetify=function(a,b){var c=a.getCallBackID();if(null==c)throw a.toString()+": Missing callback ID";var d=DOMUtil.createElementNS(Constants.NS_XHTML,"input",a.bindingDocument);d.type="hidden",d.id=c,d.name=c,d.value=null!=b?b:"",a.bindingElement.appendChild(d),a.shadowTree.dotnetinput=d},Binding.imageProfile=function(a){var b=a.getProperty("image"),c=a.getProperty("image-hover"),d=a.getProperty("image-active"),e=a.getProperty("image-disabled");null==a.imageProfile&&(null==a.image&&null!=b&&(a.image=b),null==a.imageHover&&null!=c&&(a.imageHover=c),null==a.imageActive&&null!=d&&(a.imageActive=d),null==a.imageDisabled&&null!=e&&(a.imageDisabled=e),(a.image||a.imageHover||a.imageActive||a.imageDisabled)&&(a.imageProfile=new ImageProfile(a)))},Binding.prototype.toString=function(){return"[Binding]"},Binding.prototype.onBindingRegister=function(){this.isRegistered||(this.bindingElement=UserInterface.getElement(this),this.bindingDocument=this.bindingElement.ownerDocument,this.bindingWindow=DOMUtil.getParentWindow(this.bindingDocument),this.shadowTree={},this.actionListeners={},this.propertyMethodMap={},this.isRegistered=!0,this._subscriptions=new Map,this._updateBindingMap(!0),this.getProperty("lazy")&&(this.isLazy=!0))},Binding.prototype.onBindingAttach=function(){this.isAttached||(this.bindingElement.parentNode?(this.boxObject=new BindingBoxObject(this),this._initializeBindingTestFeatures(),this._initializeBindingPersistanceFeatures(),this._initializeBindingGeneralFeatures(),this._initializeBindingDragAndDropFeatures(),this._updateBindingMap(!0),this.isAttached=!0):alert(this+" onBindingAttach: Binding must be positioned in document structure before attachment can be invoked."))},Binding.prototype.onBindingInitialize=function(){if(null!=this.dependentBindings)for(var a in this.dependentBindings){var b=this.dependentBindings[a];b.onMemberInitialize(this)}this.isInitialized=!0},Binding.prototype.onMemberInitialize=function(a){if(!a)throw new Error(this+" onMemberInitialize: Expected argument.");this.memberDependencies[a.key]=!0;var b=!0;for(var c in this.memberDependencies)if(0==this.memberDependencies[c]){b=!1;break}b&&this.onBindingInitialize()},Binding.prototype.attach=function(){return this.isAttached||(this.onBindingAttach(),null==this.memberDependencies&&this.onBindingInitialize()),this},Binding.prototype.attachRecursive=function(){this.bindingWindow.DocumentManager.attachBindings(this.bindingElement)},Binding.prototype.detachRecursive=function(a){null==a&&(a=!1),this.bindingWindow.DocumentManager.detachBindings(this.bindingElement,!a)},Binding.prototype.addMember=function(a){if(!this.isAttached)throw"Cannot add members to unattached binding";return a.isInitialized||(this.memberDependencies||(this.memberDependencies={}),this.memberDependencies[a.key]=!1,a.registerDependentBinding(this)),a},Binding.prototype.addMembers=function(a){for(;a.hasNext();){var b=a.getNext();b.isInitialized||this.addMember(b)}return a},Binding.prototype.registerDependentBinding=function(a){this.dependentBindings||(this.dependentBindings={}),this.dependentBindings[a.key]=a},Binding.prototype._initializeBindingTestFeatures=function(){if(Application.isTestEnvironment){var a=this.getProperty("label");a&&a.indexOf&&a.indexOf("${string:")>-1&&this.setProperty("data-qa",a)}},Binding.prototype._initializeBindingPersistanceFeatures=function(){var a=this.getProperty("persist");if(a&&Persistance.isEnabled){var b=this.bindingElement.id;if(KeyMaster.hasKey(b))throw"Persistable bindings must have a specified ID.";this._persist={};for(var c=new List(a.split(" "));c.hasNext();){var d=c.getNext(),e=Persistance.getPersistedProperty(b,d);null!=e?(this._persist[d]=e,this.setProperty(d,e)):(e=this.getProperty(d),null!=e&&(this._persist[d]=e))}}},Binding.prototype._initializeBindingGeneralFeatures=function(){var a=this.getProperty("disabled"),b=this.getProperty("contextmenu"),c=this.getProperty("observes"),d=this.getProperty("onattach"),e=this.getProperty("hidden"),f=this.getProperty("blockactionevents");if(1==e&&1==this.isVisible&&this.hide(),a&&null!=this.logger&&this.logger.error("The 'disabled' property has been renamed 'isdisbaled'"),b&&this.setContextMenu(b),c&&this.observe(this.getBindingForArgument(c)),1==f&&(this.isBlockingActions=!0),1==this.isActivationAware){var g=UserInterface.getBinding(this.bindingDocument.body);g.makeActivationAware(this),this._hasActivationAwareness=!0}null!=d&&Binding.evaluate(d,this)},Binding.prototype._initializeBindingDragAndDropFeatures=function(){var a=this.getProperty("draggable"),b=this.getProperty("dragtype"),c=this.getProperty("dragaccept"),d=this.getProperty("dragreject");if(null!=a&&(this.isDraggable=a),null!=b&&(this.dragType=b,0!=a&&(this.isDraggable=!0)),null!=c&&(this.dragAccept=c),null!=d&&(this.dragReject=d),this.isDraggable&&this.enableDragging(),null!=this.dragger&&null!=this.dragType&&this.dragger.registerHandler(Application),null!=this.dragAccept&&1==this.dragReject)throw new Error("Binding cannot both accept and reject "+this);null==this.dragAccept&&null==this.dragReject||(this.acceptor=new BindingAcceptor(this))},Binding.prototype._updateBindingMap=function(a){try{if(null!=this.bindingWindow){var b=this.bindingElement.id,c=this.bindingWindow.bindingMap,d=null;if(a)if(d=c[b],null!=d&&d!=this){var e=this.toString()+" duplicate binding ID: "+b;if(this.logger.error(e),Application.isDeveloperMode)throw e}else c[b]=this;else d=c[b],null!=d&&d==this&&delete c[b]}else{var f=new String("Binding#_updateBindingMap odd dysfunction: "+this.toString()+": "+a);1==Application.isDeveloperMode?alert(f):this.logger.error(f)}}catch(a){this.logger.error(a)}},Binding.prototype.handleEvent=function(a){},Binding.prototype.handleAction=function(a){},Binding.prototype.handleBroadcast=function(a,b){},Binding.prototype.handleElement=function(a){return!1},Binding.prototype.updateElement=function(a){return!1},Binding.prototype.getBindingForArgument=function(a){var b=null;switch(typeof a){case"object":b=a;break;case"string":b=this.bindingDocument.getElementById(a),null==b&&(b=Binding.evaluate(a,this))}return null!=b&&null!=b.nodeType&&(b=UserInterface.getBinding(b)),b},Binding.prototype.serialize=function(){var a={},b=this.bindingElement.id;b&&b!=this.key&&(a.id=b);var c=this.getProperty("binding");return c&&(a.binding=c),a},Binding.prototype.serializeToString=function(){var a=null;if(!this.isAttached)throw"cannot serialize unattached binding";return a=(new BindingSerializer).serializeBinding(this)},Binding.prototype.subTreeFromString=function(a){this.detachRecursive(),this.bindingElement.innerHTML=Client.fixUI(a),this.attachRecursive()},Binding.prototype.getProperty=function(a){var b=this.bindingElement.getAttribute(a.toLowerCase());return b&&(b=Types.castFromString(b)),b},Binding.prototype.setProperty=function(a,b){if(null!=b){if(b=b.toString(),String(this.bindingElement.getAttribute(a.toLowerCase()))!=b&&(this.bindingElement.setAttribute(a.toLowerCase(),b),1==this.isAttached)){Persistance.isEnabled&&null!=b&&null!=this._persist&&this._persist[a]&&(this._persist[a]=b,Persistance.setPersistedProperty(this.bindingElement.id,a,b));var c=this.propertyMethodMap[a];c&&c.call(this,this.getProperty(a))}}else this.deleteProperty(a)},Binding.prototype.deleteProperty=function(a){this.bindingElement.removeAttribute(a.toLowerCase())},Binding.prototype.getID=function(){var a=null;return Binding.exists(this)?a=this.bindingElement.id:SystemDebug.stack(arguments),a},Binding.prototype.attachClassName=function(a){CSSUtil.attachClassName(this.bindingElement,a)},Binding.prototype.detachClassName=function(a){CSSUtil.detachClassName(this.bindingElement,a)},Binding.prototype.hasClassName=function(a){return CSSUtil.hasClassName(this.bindingElement,a)},Binding.prototype.addActionListener=function(a,b){if(b=null!=b?b:this,Action.isValid(a)){if(!Interfaces.isImplemented(IActionListener,b))throw new Error("Could not add action-event listener. Method handleAction not implemented.");this.actionListeners[a]||(this.actionListeners[a]=[]),this.actionListeners[a].push(b)}else alert(this+"\nCould not add undefined Action ("+b+")")},Binding.prototype.removeActionListener=function(a,b){if(b=b?b:this,Action.isValid(a)){var c=this.actionListeners[a];if(c)for(var d,e=0;null!=(d=c[e]);){if(d==b){c.splice(e,1);break}e++}}},Binding.prototype.addEventListener=function(a,b){b=b?b:this,DOMEvents.addEventListener(this.bindingElement,a,b)},Binding.prototype.removeEventListener=function(a,b){b=b?b:this,DOMEvents.removeEventListener(this.bindingElement,a,b)},Binding.prototype.subscribe=function(a){this.hasSubscription(a)?this.logger.error("Dubplicate subscription aborted:"+a):(this._subscriptions.set(a,!0),EventBroadcaster.subscribe(a,this))},Binding.prototype.unsubscribe=function(a){this.hasSubscription(a)&&(this._subscriptions.del(a),EventBroadcaster.unsubscribe(a,this))},Binding.prototype.hasSubscription=function(a){return this._subscriptions.has(a)},Binding.prototype.observe=function(a,b){a.addObserver(this,b)},Binding.prototype.unObserve=function(a,b){a.removeObserver(this,b)},Binding.prototype.handleContextEvent=function(a){var b=this,c=this.contextMenuBinding;if(1==Interfaces.isImplemented(IActionListener,b)){var d={handleAction:function(){c.removeActionListener(MenuItemBinding.ACTION_COMMAND,b),c.removeActionListener(PopupBinding.ACTION_HIDE,d)}};c.addActionListener(MenuItemBinding.ACTION_COMMAND,b),c.addActionListener(PopupBinding.ACTION_HIDE,d)}c.snapToMouse(a)},Binding.prototype.setContextMenu=function(a){if(this.contextMenuBinding=this.getBindingForArgument(a),!this.contextMenuBinding)throw"No such contextmenu: "+a;var b=this;if(Client.isPad){var c=!1,d=!1;this.addEventListener(DOMEvents.TOUCHSTART,{handleEvent:function(a){d=setTimeout(function(){b.handleContextEvent(a)},800),c=!0}}),this.addEventListener(DOMEvents.TOUCHMOVE,{handleEvent:function(a){c&&(clearTimeout(d),c=!1)}}),this.addEventListener(DOMEvents.TOUCHEND,{handleEvent:function(a){c&&(clearTimeout(d),c=!1)}})}else this.addEventListener(DOMEvents.CONTEXTMENU,{handleEvent:function(a){b.handleContextEvent(a)}})},Binding.prototype.getContextMenu=function(){return this.contextMenuBinding},Binding.prototype.dispatchAction=function(a){var b=null,c=null,d=!1;if(a instanceof Action?b=a:Action.isValid(a)&&(b=new Action(this,a),d=!0),null!=b&&1==Action.isValid(b.type))if(1==b.isConsumed)c=b;else{var e=this.actionListeners[b.type];if(null!=e){b.listener=this;for(var f,g=0;null!=(f=e[g++]);)f&&f.handleAction&&f.handleAction(b)}var h=!0;if(1==this.isBlockingActions)switch(b.type){case Binding.ACTION_FOCUSED:case Binding.ACTION_BLURRED:case Binding.ACTION_ACTIVATED:case Binding.ACTION_FORCE_REFLEX:case DockTabBinding.ACTION_UPDATE_VISUAL:case PageBinding.ACTION_DOPOSTBACK:break;default:d||(h=!1)}c=h?this.migrateAction(b):b}return c},Binding.prototype.migrateAction=function(a){var b=null,c=null,d=this.getMigrationParent();if(d){for(;d&&!b&&d.nodeType!=Node.DOCUMENT_NODE;)b=UserInterface.getBinding(d),d=d.parentNode;c=b?b.dispatchAction(a):a}return c},Binding.prototype.reflex=function(a){1==Application.isOperational&&FlexBoxBinding.reflex(this,a)},Binding.prototype.getMigrationParent=function(){var a=null;try{var b=this.bindingElement.parentNode;null!=b&&(a=b)}catch(b){this.logger.error("Binding#getMigrationParent exception"),SystemDebug.stack(arguments),a=null}return a},Binding.prototype.add=function(a){if(a.bindingDocument!=this.bindingDocument)throw"Could not add "+a.toString()+" of different document origin.";return this.bindingElement.appendChild(a.bindingElement),a},Binding.prototype.addFirst=function(a){if(a.bindingDocument!=this.bindingDocument)throw"Could not add "+a.toString()+" of different document origin.";return this.bindingElement.insertBefore(a.bindingElement,this.bindingElement.firstChild),a},Binding.prototype.getAncestorBindingByLocalName=function(a,b){return BindingFinder.getAncestorBindingByLocalName(this,a,b)},Binding.prototype.getAncestorBindingByType=function(a,b){return BindingFinder.getAncestorBindingByType(this,a,b)},Binding.prototype.getChildBindingByType=function(a){return BindingFinder.getChildBindingByType(this,a)},Binding.prototype.getChildElementsByLocalName=function(a){return BindingFinder.getChildElementsByLocalName(this,a)},Binding.prototype.getChildElementByLocalName=function(a){return this.getChildElementsByLocalName(a).getFirst()},Binding.prototype.getDescendantElementsByLocalName=function(a){return new List(DOMUtil.getElementsByTagName(this.bindingElement,a))},Binding.prototype.getChildBindingsByLocalName=function(a){return this.getDescendantBindingsByLocalName(a,!0)},Binding.prototype.getChildBindingByLocalName=function(a){return this.getChildBindingsByLocalName(a).getFirst()},Binding.prototype.getDescendantBindingsByLocalName=function(a,b){return BindingFinder.getDescendantBindingsByLocalName(this,a,b)},Binding.prototype.getDescendantBindingByLocalName=function(a){return this.getDescendantBindingsByLocalName(a,!1).getFirst()},Binding.prototype.getDescendantBindingsByType=function(a,b){return BindingFinder.getDescendantBindingsByType(this,a,b)},Binding.prototype.getDescendantBindingByType=function(a){return BindingFinder.getDescendantBindingByType(this,a)},Binding.prototype.getNextBindingByLocalName=function(a){return BindingFinder.getNextBindingByLocalName(this,a)},Binding.prototype.getPreviousBindingByLocalName=function(a){return BindingFinder.getPreviousBindingByLocalName(this,a)},Binding.prototype.getBindingElement=function(){return this.bindingDocument.getElementById(this.bindingElement.id)},Binding.prototype.getOrdinalPosition=function(a){return DOMUtil.getOrdinalPosition(this.bindingElement,a)},Binding.prototype.isFirstBinding=function(a){return 0==this.getOrdinalPosition(a)},Binding.prototype.isLastBinding=function(a){return DOMUtil.isLastElement(this.bindingElement,a)},Binding.prototype.hasCallBackID=function(){return null!=this.getProperty(Binding.CALLBACKID)},Binding.prototype.getCallBackID=function(){return this.getProperty(Binding.CALLBACKID)},Binding.prototype.setCallBackID=function(a){this.setProperty(Binding.CALLBACKID,a)},Binding.prototype.hasCallBackArg=function(){return null!=this.getCallBackArg()},Binding.prototype.getCallBackArg=function(){return this.getProperty(Binding.CALLBACKARG)},Binding.prototype.setCallBackArg=function(a){this.setProperty(Binding.CALLBACKARG,a)},Binding.prototype.dispose=function(a){if(!this.isDisposed)if(a){if(this._subscriptions.hasEntries()){var b=this,c=new List;this._subscriptions.each(function(a){c.add(a)}),c.each(function(a){b.unsubscribe(a)})}this.onBindingDispose(),UserInterface.unRegisterBinding(this)}else{this.bindingWindow.DocumentManager.detachBindings(this.bindingElement);var d=this.bindingDocument.getElementById(this.bindingElement.id);d&&(Client.isExplorer?d.outerHTML="":d.parentNode.removeChild(d))}},Binding.prototype.onBindingDispose=function(){if(this._hasActivationAwareness){var a=UserInterface.getBinding(this.bindingDocument.body);a.makeActivationAware(this,!1),this._hasActivationAwareness=!1}this._updateBindingMap(!1)},Binding.prototype.enableDragging=function(){null==this.dragger&&(this.dragger=new BindingDragger(this),this.addEventListener(DOMEvents.MOUSEDOWN,this.dragger),this.addEventListener(DOMEvents.MOUSEMOVE,this.dragger),this.addEventListener(DOMEvents.MOUSEUP,this.dragger)),this.isDraggable=!0},Binding.prototype.disableDragging=function(){null!=this.dragger&&(this.removeEventListener(DOMEvents.MOUSEDOWN,this.dragger),this.removeEventListener(DOMEvents.MOUSEMOVE,this.dragger),this.removeEventListener(DOMEvents.MOUSEUP,this.dragger),this.dragger.dispose(),this.dragger=null),this.isDraggable=!1},Binding.prototype.show=function(){this.isVisible||(this.bindingElement.style.display="block",this.setProperty("hidden",!0),this.isVisible=!0)},Binding.prototype.hide=function(){1==this.isVisible&&(this.bindingElement.style.display="none",this.deleteProperty("hidden"),this.isVisible=!1)},Binding.prototype.wakeUp=function(a,b){if(b=b?b:Binding.SNOOZE,1==this.isLazy){this.deleteProperty("lazy"),this.isLazy=!1,Application.lock(this),this.dispatchAction(FocusBinding.ACTION_UPDATE);var c=this;setTimeout(function(){c.attachRecursive(),setTimeout(function(){"string"==typeof a?c[a]():"function"==typeof a&&a(),LazyBindingBinding.wakeUp(c),Application.unlock(c)},b)},0)}},Binding.prototype.handleCrawler=function(a){if(null==a.response&&1==this.isLazy&&(a.id==DocumentCrawler.ID&&a.mode==DocumentCrawler.MODE_REGISTER?a.response=NodeCrawler.NORMAL:a.response=NodeCrawler.SKIP_CHILDREN),null==a.response&&null!=this.crawlerFilters&&this.crawlerFilters.has(a.id)&&(a.response=NodeCrawler.SKIP_CHILDREN),null==a.response)switch(a.id){case FlexBoxCrawler.ID:case FocusCrawler.ID:this.isVisible||(a.response=NodeCrawler.SKIP_CHILDREN)}},Binding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:binding",a);return UserInterface.registerBinding(b,Binding)},DataBinding.prototype=new Binding,DataBinding.prototype.constructor=DataBinding,DataBinding.superclass=Binding.prototype,DataBinding.AUTOGENERATED="autogenerateddatabindingname",DataBinding.TYPE_NUMBER="number",DataBinding.TYPE_INTEGER="integer",DataBinding.TYPE_STRING="string",DataBinding.CLASSNAME_INVALID="invalid",DataBinding.CLASSNAME_INFOBOX="infobox",DataBinding.CLASSNAME_WARNING="warning",DataBinding.CLASSNAME_FOCUSED="focused",DataBinding.CLASSNAME_DISABLED="disabled",EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_LOGIN,{handleBroadcast:function(){var a=new List(ConfigurationService.GetValidatingRegularExpressions("dummy"));a.each(function(a){DataBinding.expressions[a.Key]=new RegExp(a.Value)});var b={required:StringBundle.getString("ui","Validation.Required"),number:StringBundle.getString("ui","Validation.InvalidField.Number"),integer:StringBundle.getString("ui","Validation.InvalidField.Integer"),programmingidentifier:StringBundle.getString("ui","Validation.InvalidField.ProgrammingIdentifier"),programmingnamespace:StringBundle.getString("ui","Validation.InvalidField.ProgrammingNamespace"),url:StringBundle.getString("ui","Validation.InvalidField.Url"),minlength:StringBundle.getString("ui","Validation.StringLength.Min"),maxlength:StringBundle.getString("ui","Validation.StringLength.Max"),currency:StringBundle.getString("ui","Validation.InvalidField.Currency"),email:StringBundle.getString("ui","Validation.InvalidField.Email"),guid:StringBundle.getString("ui","Validation.InvalidField.Guid")};for(var c in b)DataBinding.warnings[c]=b[c]}}),DataBinding.expressions={},DataBinding.warnings={required:"Required",number:"Numbers only",integer:"Integers only",
programmingidentifier:"Invalid identifier",programmingnamespace:"Invalid namespace",url:"Invalid URL",minlength:"{0} characters minimum",maxlength:"{0} characters maximum",currency:"Invalid notation",email:"Invalid e-mail",guid:"Invalid GUID"},DataBinding.errors={programmingidentifier:"An identifier must not contain spaces or special characters. Only characters a-z, A-Z, 0-9 and '_' are allowed. An identifier must begin with a letter (not a number).",programmingnamespace:"A namespace must take the form Example.Name.Space where only characters a-z, A-Z, 0-9, '_' and dots (.) are allowed. Each part of the namespace must begin with a letter (not a number).",url:"A valid URL must begin with a forward slash, designating the site root, or an URL scheme name such as http://. Simpliefied addresses such as www.example.com cannot be resolved reliably by the browser. Relative URLs are not supported."},DataBinding.getAssociatedLabel=function(a){var b=null,c=a.getAncestorBindingByLocalName("field");if(c&&c instanceof FieldBinding){var d=c.getDescendantBindingByLocalName("fielddesc");d&&d instanceof FieldDescBinding&&(b=d.getLabel())}return b},DataBinding.prototype.toString=function(){return"[DataBinding]"},DataBinding.prototype.onBindingRegister=function(){DataBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.isdisabled=this.setDisabled;var a=this._name?this._name:this.getProperty("name");null==a&&(a=DataBinding.AUTOGENERATED+KeyMaster.getUniqueKey()),this.setName(a)},DataBinding.prototype.onBindingAttach=function(){DataBinding.superclass.onBindingAttach.call(this),this.getProperty("error")&&(this.error=this.getProperty("error"))},DataBinding.prototype.onBindingDispose=function(){DataBinding.superclass.onBindingDispose.call(this),1==this.isFocused&&this.blur();var a=this.bindingWindow.DataManager;a.unRegisterDataBinding(this._name)},DataBinding.prototype.setName=function(a){var b=this.bindingWindow.DataManager;b.getDataBinding(a)&&b.unRegisterDataBinding(a),b.registerDataBinding(a,this),this.setProperty("name",a),this._name=a},DataBinding.prototype.getName=function(){return this._name},DataBinding.prototype.focus=function(){this.isFocusable&&!this.isFocused&&(this.isFocused=!0,this.dispatchAction(Binding.ACTION_FOCUSED),this.attachClassName(DataBinding.CLASSNAME_FOCUSED))},DataBinding.prototype.blur=function(){this.isFocused&&(this.isFocused=!1,this.dispatchAction(Binding.ACTION_BLURRED),this.detachClassName(DataBinding.CLASSNAME_FOCUSED))},DataBinding.prototype.dirty=function(){this.bindingWindow.DataManager.dirty(this)},DataBinding.prototype.clean=function(){this.bindingWindow.DataManager.clean(this)},DataBinding.prototype.validate=Binding.ABSTRACT_METHOD,DataBinding.prototype.manifest=Binding.ABSTRACT_METHOD,DataBinding.prototype.getValue=Binding.ABSTRACT_METHOD,DataBinding.prototype.setValue=Binding.ABSTRACT_METHOD,DataBinding.prototype.getResult=Binding.ABSTRACT_METHOD,DataBinding.prototype.setResult=Binding.ABSTRACT_METHOD,RootBinding.prototype=new Binding,RootBinding.prototype.constructor=RootBinding,RootBinding.superclass=Binding.prototype,RootBinding.ACTION_PHASE_1="root init phase 1",RootBinding.ACTION_PHASE_2="root init phase 2",RootBinding.ACTION_PHASE_3="root init phase 3",RootBinding.ACTION_ACTIVATED="root activated",RootBinding.ACTION_DEACTIVATED="root deactivated",RootBinding.CLASSNAME_WEBKIT_DESKTOP="webkit-d",RootBinding.prototype.toString=function(){return"[RootBinding]"},RootBinding.prototype.onBindingRegister=function(){RootBinding.superclass.onBindingRegister.call(this),this.logger=SystemLogger.getLogger(this.bindingDocument.title.toString()),this.bindingWindow.WindowManager&&this.subscribe(this.bindingWindow.WindowManager.WINDOW_EVALUATED_BROADCAST),this._activationawares=new List,this.isActivated=!1,this._setupActivationAwareness(!0),Localization.isUIRtl&&(this.setProperty("dir","rtl"),this.attachClassName("rtl")),Client.isWebKit&&!Client.isPad&&this.attachClassName(RootBinding.CLASSNAME_WEBKIT_DESKTOP)},RootBinding.prototype.onBindingDispose=function(){RootBinding.superclass.onBindingDispose.call(this),this._setupActivationAwareness(!1),EventBroadcaster.unsubscribe(this.bindingWindow.WindowManager.WINDOW_EVALUATED_BROADCAST,this)},RootBinding.prototype.handleBroadcast=function(a,b){RootBinding.superclass.handleBroadcast.call(this,a,b);var c=this.bindingWindow.WindowManager.WINDOW_EVALUATED_BROADCAST;switch(a){case c:this.dispatchAction(RootBinding.ACTION_PHASE_1),this.dispatchAction(RootBinding.ACTION_PHASE_2),this.dispatchAction(RootBinding.ACTION_PHASE_3),this.unsubscribe(c)}},RootBinding.prototype.onActivate=function(){this._onActivationChanged(!0)},RootBinding.prototype.onDeactivate=function(){this._onActivationChanged(!1)},RootBinding.prototype._onActivationChanged=function(a){var b=a?RootBinding.ACTION_ACTIVATED:RootBinding.ACTION_DEACTIVATED;if(a!=this.isActivated){this.isActivated=a,this.dispatchAction(b);var c=new List,d=this;this._activationawares.each(function(b){if(b.isActivationAware)try{a?b.isActivated||b.onActivate():b.isActivated&&b.onDeactivate()}catch(a){d.logger.error(a),c.add(b)}}),c.each(function(a){this._activationawares.del(a)}),c.dispose()}else{var e="Activation dysfunction: "+this.bindingDocument.title;1==Application.isDeveloperMode?this.logger.error(e):this.logger.error(e)}},RootBinding.prototype.makeActivationAware=function(a,b){1==Interfaces.isImplemented(IActivationAware,a,!0)?0==b?this._activationawares.del(a):(this._activationawares.add(a),1==this.isActivated&&a.onActivate()):1==Application.isDeveloperMode&&alert("RootBinding: IActivationAware not implemented ("+a+")")},RootBinding.prototype._setupActivationAwareness=function(a){var b=this.getMigrationParent();if(null!=b){var c=b.ownerDocument.body,d=UserInterface.getBinding(c);null!=d&&d.makeActivationAware(this,a)}},RootBinding.prototype.handleCrawler=function(a){RootBinding.superclass.handleCrawler.call(this,a),a.type==NodeCrawler.TYPE_ASCENDING&&(a.nextNode=this.bindingWindow.frameElement)},RootBinding.prototype.getMigrationParent=function(){var a=null;try{this.bindingWindow.parent&&(a=this.bindingWindow.frameElement)}catch(a){}return a},StyleBinding.prototype=new Binding,StyleBinding.prototype.constructor=StyleBinding,StyleBinding.superclass=Binding.prototype,StyleBinding.prototype.toString=function(){return"[StyleBinding]"},StyleBinding.prototype.onBindingAttach=function(){StyleBinding.superclass.onBindingAttach.call(this),console.log("StyleBinding.prototype.onBindingAttach"),this.href=this.getProperty("link"),this.style=document.createElement("link"),this.style.rel="stylesheet",this.style.type="text/css",this.style.href=Resolver.resolve(this.href),this.bindingDocument.getElementsByTagName("head")[0].appendChild(this.style)},StyleBinding.prototype.handleElement=function(a){return!0},StyleBinding.prototype.updateElement=function(a){var b=a.getAttribute("link");return this.href!=b&&this.style&&(this.href=b,this.style.href=Resolver.resolve(this.href)),!0},StyleBinding.prototype.onBindingDispose=function(){StyleBinding.superclass.onBindingDispose.call(this),this.style&&this.style.parentNode&&this.style.parentNode.removeChild(this.style),this.href=null,this.style=null},FlexBoxBinding.prototype=new Binding;FlexBoxBinding.prototype.constructor=FlexBoxBinding;FlexBoxBinding.superclass=Binding.prototype,FlexBoxBinding.CLASSNAME="flexboxelement",FlexBoxBinding.TIMEOUT=250,FlexBoxBinding.reflex=function(a,b){var c=new List,d=new FlexBoxCrawler;d.mode=b?FlexBoxCrawler.MODE_FORCE:FlexBoxCrawler.MODE_NORMAL,d.startBinding=a,d.crawl(a.bindingElement,c),c.each(function(a){a.flex()}),Client.isExplorer&&setTimeout(function(){c.each(function(a){Binding.exists(a)&&a.flex()})},.5*FlexBoxBinding.TIMEOUT),setTimeout(function(){c.each(function(a){Binding.exists(a)&&(a.isFlexSuspended=!1)}),c.dispose()},FlexBoxBinding.TIMEOUT),d.dispose()},FlexBoxBinding.prototype.toString=function(){return"[FlexBoxBinding]"},FlexBoxBinding.prototype.onBindingRegister=function(){FlexBoxBinding.superclass.onBindingRegister.call(this),0==this.getProperty("flex")&&(this.isFlexible=!1),this.isFlexible&&(this.attachClassName(FlexBoxBinding.CLASSNAME),Client.isPad&&(this.bindingElement.style.overflow="auto"))},FlexBoxBinding.prototype.onBindingAttach=function(){FlexBoxBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_UPDATED)},FlexBoxBinding.prototype.handleAction=function(a){switch(FlexBoxBinding.superclass.handleAction.call(this,a),a.type){case Binding.ACTION_UPDATED:this.isFit=!1}},FlexBoxBinding.prototype._getSiblingsSpan=function(a){for(var b=0,c=new List(this.bindingElement.parentNode.childNodes);c.hasNext();){var d=c.getNext();if(d.nodeType==Node.ELEMENT_NODE&&d!=this.bindingElement&&!this._isOutOfFlow(d)){var e=d.getBoundingClientRect();a?height+=e.right-e.left:b+=e.bottom-e.top}}return b},FlexBoxBinding.prototype._isOutOfFlow=function(a){var b=CSSComputer.getPosition(a),c=CSSComputer.getFloat(a);return"absolute"==b||"none"!=c},FlexBoxBinding.prototype._getCalculatedHeight=function(){var a=this.bindingElement.parentNode,b=a.getBoundingClientRect(),c=b.bottom-b.top,d=CSSComputer.getPadding(a),e=CSSComputer.getBorder(a);c-=d.top+d.bottom,c-=e.top+e.bottom;var f=CSSComputer.getMargin(this.bindingElement);return c-=f.top+f.bottom},FlexBoxBinding.prototype._getCalculatedWidth=function(){var a=this.bindingElement.parentNode,b=a.getBoundingClientRect(),c=b.right-b.left,d=CSSComputer.getPadding(a),e=CSSComputer.getBorder(a);return c-=d.left+d.right,c-=e.left+e.right},FlexBoxBinding.prototype.setFlexibility=function(a){a!=this.isFlexible&&(a?(this.attachClassName(FlexBoxBinding.CLASSNAME),Client.isPad&&(this.bindingElement.style.overflow="auto"),this.deleteProperty("flex")):(this.detachClassName(FlexBoxBinding.CLASSNAME),Client.isPad&&this.bindingElement.style.removeProperty("overflow"),this.setProperty("flex",!1)),this.isFlexible=a)},FlexBoxBinding.prototype.flex=function(){if(Binding.exists(this)&&1==this.isFlexible){var a=this._getSiblingsSpan();a=this._getCalculatedHeight()-a,!isNaN(a)&&a>=0&&(this.bindingElement.style.height=String(a)+"px")}},FlexBoxBinding.prototype.fit=function(a){if(!this.isFit||a){var b=0;new List(this.bindingElement.childNodes).each(function(a){if(a.nodeType==Node.ELEMENT_NODE&&!this._isOutOfFlow(a)){var c=a.getBoundingClientRect();b+=c.bottom-c.top}},this),this._setFitnessHeight(b),this.isFit=!0}},FlexBoxBinding.prototype._setFitnessHeight=function(a){var b=CSSComputer.getPadding(this.bindingElement),c=CSSComputer.getBorder(this.bindingElement);a+=b.top+b.bottom,a+=c.top+c.bottom,this.bindingElement.style.height=a+"px"},ScrollBoxBinding.prototype=new FlexBoxBinding,ScrollBoxBinding.prototype.constructor=ScrollBoxBinding,ScrollBoxBinding.superclass=FlexBoxBinding.prototype,ScrollBoxBinding.prototype.toString=function(){return"[ScrollBoxBinding]"},ScrollBoxBinding.prototype.onBindingRegister=function(){ScrollBoxBinding.superclass.onBindingRegister.call(this),this.addActionListener(BalloonBinding.ACTION_INITIALIZE)},ScrollBoxBinding.prototype.handleAction=function(a){switch(ScrollBoxBinding.superclass.handleAction.call(this,a),a.type){case BalloonBinding.ACTION_INITIALIZE:a.consume()}},ScrollBoxBinding.prototype.setPosition=function(a){this.bindingElement.scrollLeft=a.x,this.bindingElement.scrollTop=a.y},ScrollBoxBinding.prototype.getPosition=function(){return new Point(this.bindingElement.scrollLeft,this.bindingElement.scrollTop)},LabelBinding.prototype=new Binding,LabelBinding.prototype.constructor=LabelBinding,LabelBinding.superclass=Binding.prototype,LabelBinding.DIALOG_INDECATOR_SUFFIX=String.fromCharCode(8230),LabelBinding.DEFAULT_IMAGE="blank",LabelBinding.SPRITE_PATH="${root}/images/sprite.svg",LabelBinding.CLASSNAME_GRAYTEXT="graytext",LabelBinding.CLASSNAME_FLIPPED="flipped",LabelBinding.DOCKTABLABEL_OVERFLOWED_CLASSNAME="overflowed",LabelBinding.DOCKTABLABEL_WIDTH=110,LabelBinding.sprites=null,LabelBinding.spritesQueue=new Map,LabelBinding.spriteLoading=!1,LabelBinding.spriteLoad=function(){function a(){var a=this,b=document.createElement("x");b.innerHTML=a.responseText;for(var c=b.querySelectorAll("use"),d=0;d<c.length;++d){var e=c[d],f=e.parentNode,g=e.getAttribute("xlink:href").split("#")[1],h=b.querySelector("#"+g);if(h){var i=h.cloneNode(!0);i.id=f.id,f.parentNode.replaceChild(i,f)}}LabelBinding.sprites=b,LabelBinding.spriteLoading=!1,LabelBinding.spritesQueue.each(function(a,b){var c=UserInterface.getBindingByKey(a);null!=c&&LabelBinding.setImageSvg(c,b)}),LabelBinding.spritesQueue.empty()}if(!LabelBinding.spriteLoading){LabelBinding.spriteLoading=!0;var b=new XMLHttpRequest;b.open("GET",Resolver.resolve(LabelBinding.SPRITE_PATH)),b.onload=a,b.send()}},LabelBinding.setImageSvg=function(a,b){if(b&&"string"==typeof b&&/^[A-Za-z]+[\w\-\.]*$/.test(b)){if(a.shadowTree.labelBody)if(b)if(LabelBinding.sprites){var c=b.toLowerCase().indexOf("-disabled")>0;b=b.toLowerCase().replace("-disabled","");var d=LabelBinding.sprites.querySelector("#"+b);if(d){var e="http://www.w3.org/2000/svg";a.shadowTree.svg||(a.shadowTree.svg=a.bindingDocument.createElementNS(e,"svg"),a.shadowTree.labelBody.insertBefore(a.shadowTree.svg,a.shadowTree.labelBody.firstChild));var f=a.shadowTree.svg;f.setAttribute("viewBox","0 0 24 24"),c&&f.setAttribute("class","disabled");var g=d.getAttribute("viewBox"),h=document.createDocumentFragment(),i=d.cloneNode(!0);for(g&&f.setAttribute("viewBox",g),h.appendChild(i);f.lastChild;)f.removeChild(f.lastChild);f.appendChild(h)}}else LabelBinding.spritesQueue.set(a.getID(),b),LabelBinding.spriteLoad();else;}else{var f=a.shadowTree.svg;f&&(f.parentNode&&f.parentNode.removeChild(f),a.shadowTree.svg=null)}},LabelBinding.prototype.toString=function(){return"[LabelBinding]"},LabelBinding.prototype.onBindingRegister=function(){LabelBinding.superclass.onBindingRegister.call(this),this.isBindingBuild?this.shadowTree.labelBody=this._getBuildElement("labelbody"):(this.shadowTree.labelBody=DOMUtil.createElementNS(Constants.NS_UI,"ui:labelbody",this.bindingDocument),this.bindingElement.appendChild(this.shadowTree.labelBody))},LabelBinding.prototype.onBindingAttach=function(){if(LabelBinding.superclass.onBindingAttach.call(this),this.isBindingBuild){var a=this._getBuildElement("labeltext");a&&(this.shadowTree.labelText=a,this.shadowTree.text=a.firstChild,this.hasLabel=!0)}else{var b=this.getProperty("label"),c=this.getProperty("image"),d=this.getProperty("tooltip");b&&this.setLabel(b,!1),c&&this.setImage(c,!1),d&&this.setToolTip(d),this.buildClassName()}},LabelBinding.prototype.setLabel=function(a,b){a=null!=a?a:"",this.hasLabel||this.buildLabel(),this.shadowTree.text.data=Resolver.resolve(a),this.setProperty("label",a),b||this.buildClassName();var c=this.getAncestorBindingByType(DockTabBinding,!0);if(null!=c){var d=this.shadowTree.labelText,e=CSSComputer.getWidth(d);d.style.width="auto";var f=d.clientWidth,g=Number(e.replace(/[^\d\.\-]/g,""));f>g&&this.attachClassName(LabelBinding.DOCKTABLABEL_OVERFLOWED_CLASSNAME),d.style.width=e}},LabelBinding.prototype.getLabel=function(){return this.getProperty("label")},LabelBinding.prototype.setImage=function(a,b){if(0!=a&&void 0!=a){a=a?a:LabelBinding.DEFAULT_IMAGE;var c=Resolver.resolve(a);c.classes?(this.setAlphaTransparentBackdrop(),this.setImageSvg(),this.setImageClasses(c.classes)):"string"==typeof c&&"/"==c[0]?(this.setAlphaTransparentBackdrop(c),this.setImageSvg(),this.setImageClasses()):(this.setAlphaTransparentBackdrop(),this.setImageSvg(c),this.setImageClasses()),"string"==typeof c&&this.setProperty("image",a),this.hasImage=!0,b||this.buildClassName()}else this.setImageSvg(),this.setImageClasses(),this.deleteProperty("image"),this.hasImage=!1,this.buildClassName()},LabelBinding.prototype.setImageClasses=function(a){this.shadowTree.labelBody&&(a?(this.shadowTree.icon||(this.shadowTree.icon=DOMUtil.createElementNS(Constants.NS_UI,"ui:icon",this.bindingDocument),this.shadowTree.labelBody.insertBefore(this.shadowTree.icon,this.shadowTree.labelBody.firstChild)),this.shadowTree.icon.className=a):this.shadowTree.icon&&(this.shadowTree.labelBody.removeChild(this.shadowTree.icon),this.shadowTree.icon=null))},LabelBinding.prototype.setImageSvg=function(a){LabelBinding.setImageSvg(this,a)},LabelBinding.prototype.setDefaultImage=function(a){this.setImage(LabelBinding.DEFAULT_IMAGE)},LabelBinding.prototype.setAlphaTransparentBackdrop=function(a){this.shadowTree.labelBody&&(a?(a=Resolver.resolve(a),this.shadowTree.labelBody.style.backgroundImage="url('"+a+"')"):this.shadowTree.labelBody.style.removeProperty("background-image"))},LabelBinding.prototype.getImage=function(){return this.getProperty("image")},LabelBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),a!=this.getLabel()&&this.setProperty("title",Resolver.resolve(a))},LabelBinding.prototype.getToolTip=function(a){return this.getProperty("tooltip")},LabelBinding.prototype.flip=function(a){a=null==a||a;var b=LabelBinding.CLASSNAME_FLIPPED;Client.isExplorer6||(this.isFlipped=a,a?this.attachClassName(b):this.detachClassName(b))},LabelBinding.prototype.buildLabel=function(){this.hasLabel||(this.shadowTree.labelText=DOMUtil.createElementNS(Constants.NS_UI,"ui:labeltext",this.bindingDocument),this.shadowTree.text=this.bindingDocument.createTextNode(""),this.shadowTree.labelText.appendChild(this.shadowTree.text),this.shadowTree.labelBody.appendChild(this.shadowTree.labelText),this.hasLabel=!0)},LabelBinding.prototype.buildClassName=function(){var a="textonly",b="imageonly",c="image-and-text";this.hasLabel&&this.hasImage?(this.detachClassName(a),this.detachClassName(b),this.attachClassName(c)):this.hasLabel?(this.detachClassName(c),this.detachClassName(b),this.attachClassName(a)):this.hasImage&&(this.detachClassName(c),this.detachClassName(a),this.attachClassName(b))},LabelBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:labelbox",a);return UserInterface.registerBinding(b,LabelBinding)},TextBinding.prototype=new Binding,TextBinding.prototype.constructor=TextBinding,TextBinding.superclass=Binding.prototype,TextBinding.prototype.toString=function(){return"[TextBinding]"},TextBinding.prototype.onBindingAttach=function(){TextBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("label");a||(a=DOMUtil.getTextContent(this.bindingElement));var b=this.bindingDocument.createTextNode(Resolver.resolve(a));this.bindingElement.parentNode.replaceChild(b,this.bindingElement),this.dispose()},TextBinding.prototype.setLabel=function(a){this.setProperty("label",a)},TextBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:text",a);return UserInterface.registerBinding(b,TextBinding)},BroadcasterSetBinding.prototype=new Binding,BroadcasterSetBinding.prototype.constructor=BroadcasterSetBinding,BroadcasterSetBinding.superclass=Binding.prototype,BroadcasterSetBinding.prototype.toString=function(){return"[BroadcasterSetBinding]"},BroadcasterBinding.prototype=new Binding,BroadcasterBinding.prototype.constructor=BroadcasterBinding,BroadcasterBinding.superclass=Binding.prototype,BroadcasterBinding.prototype.toString=function(){return"[BroadcasterBinding]"},BroadcasterBinding.prototype.onBindingRegister=function(){BroadcasterBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.isdisabled=this.setDisabled,this._observers=new List},BroadcasterBinding.prototype.setProperty=function(a,b){function c(c){c&&c.each(function(c){c.setProperty(a,b)})}BroadcasterBinding.superclass.setProperty.call(this,a,b),null!=this._observers["*"]&&c(this._observers["*"]);var d=this._observers[a];d&&c(d)},BroadcasterBinding.prototype.deleteProperty=function(a){function b(b){b&&b.each(function(b){b.deleteProperty(a)})}BroadcasterBinding.superclass.deleteProperty.call(this,a),null!=this._observers["*"]&&b(this._observers["*"]);var c=this._observers[a];c&&b(c)},BroadcasterBinding.prototype.addObserver=function(a,b){for(b=b?b:"*",b=new List(b.split(" "));b.hasNext();){var c=b.getNext();switch(c){case"*":this._setAllProperties(a);break;default:var d=this.getProperty(c);a.setProperty(c,d)}this._observers[c]||(this._observers[c]=new List),this._observers[c].add(a)}},BroadcasterBinding.prototype._setAllProperties=function(a){for(var b=new List(this.bindingElement.attributes);b.hasNext();){var c=b.getNext();if(c.specified){var d=c.nodeName;switch(d){case"id":case"key":break;default:var e=this.getProperty(d);a.setProperty(d,e)}}}},BroadcasterBinding.prototype.removeObserver=function(a,b){for(b=b?b:"*",b=new List(b.split(" "));b.hasNext();){var c=this._observers[b.getNext()];if(c)for(;c.hasNext();){var d=c.getNext();d==a&&c.del(d)}}},BroadcasterBinding.prototype.disable=function(){this.setDisabled(!0)},BroadcasterBinding.prototype.enable=function(){this.setDisabled(!1)},BroadcasterBinding.prototype.setDisabled=function(a){this.setProperty("isdisabled",a)},BroadcasterBinding.prototype.isDisabled=function(){return 1==this.getProperty("isdisabled")},ButtonBinding.prototype=new Binding,ButtonBinding.prototype.constructor=ButtonBinding,ButtonBinding.superclass=Binding.prototype,ButtonBinding.ACTION_COMMAND="buttoncommand",ButtonBinding.ACTION_RADIOBUTTON_ATTACHED="radiobutton attached",ButtonBinding.TYPE_CHECKBUTTON="checkbox",ButtonBinding.TYPE_RADIOBUTTON="radio",ButtonBinding.CLASSNAME_FOCUSABLE="focusable",ButtonBinding.CLASSNAME_FOCUSED="focused",ButtonBinding.CLASSNAME_DEFAULT="primary",ButtonBinding.prototype.toString=function(){return"[ButtonBinding]"},ButtonBinding.prototype.onBindingRegister=function(){ButtonBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.isdisabled=this.setDisabled},ButtonBinding.prototype.onBindingAttach=function(){ButtonBinding.superclass.onBindingAttach.call(this),this.parseDOMProperties(),this.buildDOMContent(),1==this.isRadioButton&&this.dispatchAction(ButtonBinding.ACTION_RADIOBUTTON_ATTACHED)},ButtonBinding.prototype.onBindingDispose=function(){ButtonBinding.superclass.onBindingDispose.call(this),null!=this._stateManager&&(this._stateManager.dispose(),this._stateManager=null);var a=this.getProperty("callbackid");null!=a&&this.bindingWindow.DataManager.unRegisterDataBinding(a)},ButtonBinding.prototype.parseDOMProperties=function(){Binding.imageProfile(this)},ButtonBinding.prototype.buildDOMContent=function(){var a=(this.shadowTree,this.getProperty("width")),b=this.getProperty("label"),c=this.getProperty("type"),d=this.getProperty("popup"),e=this.getProperty("tooltip"),f=this.getProperty("isdisabled"),g=this.getProperty("response"),h=this.getProperty("oncommand"),i=this.getProperty("value"),j=this.getProperty("ischecked"),k=this.getProperty("callbackid"),l=this.getProperty("focusable"),m=this.getProperty("focused"),n=this.getProperty("default"),o=this.getProperty("url"),p=this.getProperty("flip");this.labelBinding=LabelBinding.newInstance(this.bindingDocument),this.add(this.labelBinding),this.labelBinding.attach(),this.shadowTree.labelBinding=this.labelBinding,p&&this.flip(!0),this._stateManager||(this._stateManager=new ButtonStateManager(this)),null!=this.imageProfile&&null!=this.imageProfile.getDefaultImage()&&this.setImage(this.imageProfile.getDefaultImage()),null!=b&&this.setLabel(b),null!=c&&this.setType(c),null!=e&&this.setToolTip(e),null!=a&&this.setWidth(a),null!=d&&this.setPopup(d),null!=g&&(this.response=g),1==j&&(this.isCheckButton||this.isRadioButton)&&this.check(!0),null!=h&&null==this.oncommand&&(this.oncommand=function(){Binding.evaluate(h,this)}),(l||this.isFocusable)&&(this._makeFocusable(),(n||this.isDefault)&&(this.isDefault=!0),m&&this.focus()),1==f&&this.disable(),null!=o&&this.setURL(o),null!=k&&(this.bindingWindow.DataManager.registerDataBinding(k,this),null!=i&&Binding.dotnetify(this,i),null==this.oncommand&&(this.oncommand=function(){this.dirty(),1==this.getProperty("validate")?this.dispatchAction(PageBinding.ACTION_DOVALIDATEDPOSTBACK):this.dispatchAction(PageBinding.ACTION_DOPOSTBACK)}))},ButtonBinding.prototype._makeFocusable=function(){this.isFocusable=!0,this.attachClassName(ButtonBinding.CLASSNAME_FOCUSABLE),this._isFocusableButton=!0},ButtonBinding.prototype.setImage=function(a){this.isAttached&&this.labelBinding.setImage(a),this.setProperty("image",a)},ButtonBinding.prototype.getImage=function(){return this.getProperty("image")},ButtonBinding.prototype.setLabel=function(a){this.isAttached&&this.labelBinding.setLabel(a),this.setProperty("label",a)},ButtonBinding.prototype.getLabel=function(){return this.getProperty("label")},ButtonBinding.prototype.setType=function(a){switch(a){case ButtonBinding.TYPE_CHECKBUTTON:this.isCheckButton=!0;break;case ButtonBinding.TYPE_RADIOBUTTON:this.isRadioButton=!0}this.setProperty("type",a)},ButtonBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),1==this.isAttached&&this.setProperty("title",Resolver.resolve(a))},ButtonBinding.prototype.getToolTip=function(){return this.getProperty("tooltip")},ButtonBinding.prototype.setImageProfile=function(a){this.imageProfile=new a(this)},ButtonBinding.prototype.setPopup=function(a){if(this.popupBinding=this.getBindingForArgument(a),this.popupBinding){this.setType(ButtonBinding.TYPE_CHECKBUTTON),this.popupBindingTargetElement||(this.popupBindingTargetElement=this.bindingElement);var b=this;this.popupBinding.addActionListener(PopupBinding.ACTION_HIDE,{handleAction:function(){1==b.isChecked&&b.uncheck(!0)}})}},ButtonBinding.prototype.setURL=function(a){if(1==this.isAttached){if(!this.shadowTree.buttonurl){var b=this.bindingDocument.createElement("a");b.className="buttonurl",b.target="_blank",this.shadowTree.buttonurl=b,this.bindingElement.appendChild(b)}this.shadowTree.buttonurl.href=a}this.setProperty("url",a)},ButtonBinding.prototype.getURL=function(){return this.getProperty("url")},ButtonBinding.prototype.flip=function(a){a=null==a||a,this.isFlipped=a,this.setProperty("flip",a),this.isAttached&&this.labelBinding.flip(a)},ButtonBinding.prototype.fireCommand=function(){this.isDisabled||(null!=this.oncommand&&this.oncommand(),this.dispatchAction(this.commandAction),this.invokePopup())},ButtonBinding.prototype.invokePopup=function(){this.isDisabled||this.popupBinding&&(!this.isCheckButton||this.isChecked?(this.popupBinding.snapTo(this.popupBindingTargetElement),this.popupBinding.show(),this.popupBinding.grabKeyboard()):(this.popupBinding.hide(),this.popupBinding.releaseKeyboard()))},ButtonBinding.prototype.oncommand=null,ButtonBinding.prototype.invoke=function(){this.isCheckButton?this.isChecked?this.uncheck():this.check():this.fireCommand()},ButtonBinding.prototype.check=function(a){!this.isCheckButton&&!this.isRadioButton||this.isChecked||(1==this.isAttached?(this._check(),1==!a&&this.fireCommand()):this.setProperty("ischecked",!0))},ButtonBinding.prototype._check=function(a){this.isActive=!0,this.isChecked=!0,a||this._stateManager.invokeActiveState(),this.setProperty("ischecked",!0)},ButtonBinding.prototype.uncheck=function(a){(this.isCheckButton||this.isRadioButton)&&this.isChecked&&(1!=this.isAttached||this.isDisposed?this.setProperty("ischecked",!1):(this._uncheck(),1==!a&&this.fireCommand()))},ButtonBinding.prototype._uncheck=function(a){this.isActive=!1,this.isChecked=!1,a||this._stateManager.invokeNormalState(),this.setProperty("ischecked",!1)},ButtonBinding.prototype.setChecked=function(a,b){if(this.isCheckButton||this.isRadioButton)switch(a){case!0:this.check(b);break;case!1:this.uncheck(b)}},ButtonBinding.prototype.setDisabled=function(a){switch(null==a&&(a=!1),this.isDisabled=a,a){case!0:this.bindingElement.setAttribute("title",""),this.setProperty("isdisabled",!0),null!=this._stateManager&&this._stateManager.invokeDisabledState();break;case!1:this.deleteProperty("isdisabled");var b=this.getProperty("tooltip");b&&this.setToolTip(b),null!=this._stateManager&&this._stateManager.invokeNormalState()}1==this._isFocusableButton&&(this.isFocusable=!this.isDisabled,this.dispatchAction(FocusBinding.ACTION_UPDATE))},ButtonBinding.prototype.disable=function(){this.setDisabled(!0)},ButtonBinding.prototype.enable=function(){this.setDisabled(!1)},ButtonBinding.prototype.focus=function(){this.isFocusable&&!this.isFocused&&(this.isFocused=!0,FocusBinding.focusElement(this.bindingElement),this.dispatchAction(Binding.ACTION_FOCUSED))},ButtonBinding.prototype.blur=function(){this.isFocusable&&this.isFocused&&(this.isFocused=!1,this.dispatchAction(Binding.ACTION_BLURRED))},ButtonBinding.prototype.onMouseDown=function(){EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,this),this.dispatchAction(Binding.ACTION_ACTIVATED)},ButtonBinding.prototype.onMouseUp=function(){EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEUP,this)},ButtonBinding.prototype.getEqualSizeWidth=function(){var a=null;if(1!=this.isAttached)throw"ButtonBinding: getEqualSizeWidth failed for non-attached button.";return this.labelBinding.shadowTree.labelBody.style.marginLeft="0",this.labelBinding.shadowTree.labelBody.style.marginRight="0",a=this.labelBinding.bindingElement.offsetWidth,a},ButtonBinding.prototype.setEqualSizeWidth=function(a){if(1==this.isAttached){var b=this.getEqualSizeWidth();if(a>b){var c=a-b,d=Math.floor(.5*c);this.labelBinding.shadowTree.labelBody.style.setProperty("margin-left",d+"px","important"),this.labelBinding.shadowTree.labelBody.style.setProperty("margin-right",d+"px","important")}}},ButtonBinding.prototype.getWidth=function(){return this.bindingElement.offsetWidth},ButtonBinding.prototype.setWidth=function(a){a>=0&&(this.bindingElement.style.width=new String(a+"px")),this.setProperty("width",a)},ButtonBinding.prototype.validate=function(){return!0},ButtonBinding.prototype.manifest=function(){},ButtonBinding.prototype.dirty=DataBinding.prototype.dirty,ButtonBinding.prototype.clean=DataBinding.prototype.clean,ButtonBinding.prototype.getName=function(){},ButtonBinding.prototype.getValue=function(){return this.shadowTree.dotnetinput.value},ButtonBinding.prototype.setValue=function(a){this.shadowTree.dotnetinput.value=a},ButtonBinding.prototype.getResult=function(){return this.getValue()},ButtonBinding.prototype.setResult=function(a){this.setValue(a)},ButtonStateManager.STATE_NORMAL=0,ButtonStateManager.STATE_HOVER=1,ButtonStateManager.STATE_ACTIVE=2,ButtonStateManager.RIGHT_BUTTON=2,ButtonStateManager.prototype.assignDOMEvents=function(a){var b=a?"addEventListener":"removeEventListener";this.binding[b](DOMEvents.MOUSEENTER,this),this.binding[b](DOMEvents.MOUSELEAVE,this),this.binding[b](DOMEvents.MOUSEDOWN,this),this.binding[b](DOMEvents.MOUSEUP,this)},ButtonStateManager.prototype.dispose=function(){this.assignDOMEvents(!1),this.binding=null,this.imageProfile=null},ButtonStateManager.prototype.handleEvent=function(a){if(Binding.exists(this.binding)&&!this.binding.isDisabled&&!BindingDragger.isDragging){var b=!1,c=!1,d=null;if(a.button==ButtonStateManager.RIGHT_BUTTON);else if(this.binding.isCheckBox)switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:d=ButtonStateManager.STATE_HOVER;break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:d=this.binding.isChecked?ButtonStateManager.STATE_ACTIVE:ButtonStateManager.STATE_NORMAL;break;case DOMEvents.MOUSEDOWN:d=ButtonStateManager.STATE_HOVER;break;case DOMEvents.MOUSEUP:this.binding.isChecked=!this.binding.isChecked,d=this.binding.isChecked?ButtonStateManager.STATE_ACTIVE:ButtonStateManager.STATE_NORMAL,d==ButtonStateManager.STATE_ACTIVE?this.binding._check(!0):this.binding._uncheck(!0),b=!0}else if(this.binding.isComboButton)switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:d=ButtonStateManager.STATE_HOVER;break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:d=ButtonStateManager.STATE_NORMAL;break;case DOMEvents.MOUSEDOWN:d=ButtonStateManager.STATE_ACTIVE;break;case DOMEvents.MOUSEUP:d=ButtonStateManager.STATE_NORMAL;var e=UserInterface.getBinding(a.target?a.target:a.srcElement);e instanceof ComboBoxBinding?(this.binding.isChecked=!this.binding.isChecked,d=this.binding.isChecked?ButtonStateManager.STATE_ACTIVE:ButtonStateManager.STATE_NORMAL,
d==ButtonStateManager.STATE_ACTIVE?this.binding._check(!0):this.binding._uncheck(!0),c=!0):(this.binding.isChecked&&this.binding._uncheck(!0),d=ButtonStateManager.STATE_NORMAL,b=!0)}else if(this.binding.isCheckButton||this.binding.isRadioButton)switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:this.binding.isChecked||(d=ButtonStateManager.STATE_HOVER);break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:this.binding.isChecked||(d=ButtonStateManager.STATE_NORMAL);break;case DOMEvents.MOUSEDOWN:d=ButtonStateManager.STATE_ACTIVE;break;case DOMEvents.MOUSEUP:!this.binding.isCheckButton&&this.binding.isChecked||(this.binding.isChecked=!this.binding.isChecked,d=this.binding.isChecked?ButtonStateManager.STATE_ACTIVE:ButtonStateManager.STATE_NORMAL,d==ButtonStateManager.STATE_ACTIVE?this.binding._check(!0):this.binding._uncheck(!0),b=!0)}else switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:d=ButtonStateManager.STATE_HOVER;break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:d=ButtonStateManager.STATE_NORMAL;break;case DOMEvents.MOUSEDOWN:d=ButtonStateManager.STATE_ACTIVE;break;case DOMEvents.MOUSEUP:d=ButtonStateManager.STATE_NORMAL,b=!0}switch(d){case ButtonStateManager.STATE_NORMAL:this.invokeNormalState();break;case ButtonStateManager.STATE_HOVER:this.invokeHoverState();break;case ButtonStateManager.STATE_ACTIVE:this.invokeActiveState()}if(b&&this.binding.fireCommand(),c&&this.binding.invokePopup(),1==Binding.exists(this.binding))switch(DOMEvents.stopPropagation(a),a.type){case DOMEvents.MOUSEDOWN:this.binding.onMouseDown();break;case DOMEvents.MOUSEUP:this.binding.onMouseUp()}}},ButtonStateManager.prototype.invokeNormalState=function(){this.binding.detachClassName("hover"),this.binding.detachClassName("active"),this.binding.detachClassName("isdisabled")},ButtonStateManager.prototype.invokeHoverState=function(){this.binding.attachClassName("hover"),this.binding.detachClassName("active")},ButtonStateManager.prototype.invokeActiveState=function(){this.binding.attachClassName("active"),this.binding.detachClassName("hover")},ButtonStateManager.prototype.invokeDisabledState=function(){this.binding.detachClassName("hover"),this.binding.detachClassName("active"),this.binding.attachClassName("isdisabled")},ClickButtonBinding.prototype=new ButtonBinding,ClickButtonBinding.prototype.constructor=ClickButtonBinding,ClickButtonBinding.superclass=ButtonBinding.prototype,ClickButtonBinding.prototype.toString=function(){return"[ClickButtonBinding]"},ClickButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:clickbutton",a);return UserInterface.registerBinding(b,ClickButtonBinding)},RadioButtonBinding.prototype=new ButtonBinding,RadioButtonBinding.prototype.constructor=RadioButtonBinding,RadioButtonBinding.superclass=ButtonBinding.prototype,RadioButtonBinding.prototype.toString=function(){return"[RadioButtonBinding]"},RadioButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:radiobutton",a);return UserInterface.registerBinding(b,RadioButtonBinding)},CheckButtonBinding.prototype=new ButtonBinding,CheckButtonBinding.prototype.constructor=CheckButtonBinding,CheckButtonBinding.superclass=ButtonBinding.prototype,CheckButtonBinding.prototype.toString=function(){return"[CheckButtonBinding]"},CheckButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:checkbutton",a);return UserInterface.registerBinding(b,CheckButtonBinding)},ViewButtonBinding.prototype=new ButtonBinding,ViewButtonBinding.prototype.constructor=ViewButtonBinding,ViewButtonBinding.superclass=ButtonBinding.prototype,ViewButtonBinding.prototype.toString=function(){return"[ViewButtonBinding]"},ViewButtonBinding.prototype.oncommand=function(){alert(this)},ControlGroupBinding.prototype=new Binding,ControlGroupBinding.prototype.constructor=ControlGroupBinding,ControlGroupBinding.superclass=Binding.prototype,ControlGroupBinding.prototype.toString=function(){return"[ControlGroupBinding]"},ControlGroupBinding.prototype.onBindingAttach=function(){ControlGroupBinding.superclass.onBindingAttach.call(this),this.assignDOMEvents()},ControlGroupBinding.prototype.assignDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEUP)},ControlGroupBinding.prototype.onActivate=function(){var a=this.getDescendantBindingsByLocalName("control");a.each(function(a){a.setControlType(a.controlType)})},ControlGroupBinding.prototype.onDeactivate=ControlGroupBinding.prototype.onActivate,ControlGroupBinding.prototype.handleEvent=function(a){switch(ControlGroupBinding.superclass.handleEvent.call(this,a),DOMEvents.stopPropagation(a),a.type){case DOMEvents.MOUSEDOWN:EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,a),this.dispatchAction(Binding.ACTION_ACTIVATED);break;case DOMEvents.MOUSEUP:EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEUP,a)}},ControlGroupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:controlgroup",a);return UserInterface.registerBinding(b,ControlGroupBinding)},ControlBinding.prototype=new ButtonBinding,ControlBinding.prototype.constructor=ControlBinding,ControlBinding.superclass=ButtonBinding.prototype,ControlBinding.ACTION_COMMAND="controlcommand",ControlBinding.TYPE_MINIMIZE="minimize",ControlBinding.TYPE_MAXIMIZE="maximize",ControlBinding.TYPE_UNMAXIMIZE="unmaximize",ControlBinding.TYPE_UNMINIMIZE="unminimize",ControlBinding.TYPE_CLOSE="close",ControlBinding.TOOLTIP={minimize:"${string:Website.App.ToolTipMinimize}",maximize:"${string:Website.App.ToolTipMaximize}",unmaximize:"${string:Website.App.ToolTipUnMaximize}",unminimize:"${string:Website.App.ToolTipUnMinimize}",close:"${string:Website.App.ToolTipClose}"},ControlBinding.prototype.toString=function(){return"[ControlBinding]"},ControlBinding.prototype.onBindingAttach=function(){if(this.controlType=this.getProperty("controltype"),this.setProperty("tooltip",ControlBinding.TOOLTIP[this.controlType]),!this.isAttached){if(!this.controlType)throw"ControlBinding: type not specified.";this.containingControlBoxBinding=this.getAncestorBindingByType(ControlBoxBinding),this.containingControlBoxBinding&&this.containingControlBoxBinding.addActionListener(ControlBoxBinding.ACTION_STATECHANGE,this),ControlBinding.superclass.onBindingAttach.call(this),this.addEventListener(DOMEvents.MOUSEDOWN)}},ControlBinding.prototype.handleEvent=function(a){switch(ControlBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.MOUSEDOWN:DOMEvents.stopPropagation(a)}},ControlBinding.prototype.setControlType=function(a){this.controlType=a,this.setProperty("controltype",a),this.setToolTip(ControlBinding.TOOLTIP[a])},ControlBinding.prototype.handleAction=function(a){switch(ControlBinding.superclass.handleAction.call(this,a),a.type){case ControlBoxBinding.ACTION_STATECHANGE:this._handleStateChange()}},ControlBinding.prototype._handleStateChange=function(){switch(this.containingControlBoxBinding.getState()){case ControlBoxBinding.STATE_MAXIMIZED:this.controlType==ControlBinding.TYPE_MAXIMIZE&&this.setControlType(ControlBinding.TYPE_UNMAXIMIZE),this.controlType==ControlBinding.TYPE_UNMINIMIZE&&this.setControlType(ControlBinding.TYPE_MINIMIZE);break;case ControlBoxBinding.STATE_MINIMIZED:this.controlType==ControlBinding.TYPE_MINIMIZE&&this.setControlType(ControlBinding.TYPE_UNMINIMIZE),this.controlType==ControlBinding.TYPE_UNMAXIMIZE&&this.setControlType(ControlBinding.TYPE_MAXIMIZE);break;case ControlBoxBinding.STATE_NORMAL:this.controlType==ControlBinding.TYPE_UNMAXIMIZE&&this.setControlType(ControlBinding.TYPE_MAXIMIZE),this.controlType==ControlBinding.TYPE_UNMINIMIZE&&this.setControlType(ControlBinding.TYPE_MINIMIZE)}},ControlBinding.prototype.onMouseDown=function(){},ControlBinding.prototype.onMouseUp=function(){},ControlBoxBinding.prototype=new FlexBoxBinding,ControlBoxBinding.prototype.constructor=ControlBoxBinding;ControlBoxBinding.superclass=FlexBoxBinding.prototype;ControlBoxBinding.STATE_NORMAL="normal",ControlBoxBinding.STATE_MAXIMIZED="maximized",ControlBoxBinding.STATE_MINIMIZED="minimized",ControlBoxBinding.ACTION_NORMALIZE="controlbox normalizeaction",ControlBoxBinding.ACTION_MAXIMIZE="controlbox maximizeaction",ControlBoxBinding.ACTION_MINIMIZE="controlbox minimizeaction",ControlBoxBinding.ACTION_STATECHANGE="controlbox statechangeacton",ControlBoxBinding.prototype.toString=function(){return"[ControlBoxBinding]"},ControlBoxBinding.prototype.onBindingAttach=function(){ControlBoxBinding.superclass.onBindingAttach.call(this),this.addActionListener(ControlBinding.ACTION_COMMAND,this),this.attachClassName(ControlBoxBinding.STATE_NORMAL)},ControlBoxBinding.prototype.handleAction=function(a){switch(ControlBoxBinding.superclass.handleAction.call(this,a),a.type){case ControlBinding.ACTION_COMMAND:var b=a.target;Application.lock(this);var c=this;setTimeout(function(){c.handleInvokedControl(b),Application.unlock(c)},0),a.consume()}},ControlBoxBinding.prototype.handleInvokedControl=function(a){switch(a.controlType){case ControlBinding.TYPE_MAXIMIZE:this.maximize();break;case ControlBinding.TYPE_MINIMIZE:this.minimize();break;case ControlBinding.TYPE_UNMAXIMIZE:case ControlBinding.TYPE_UNMINIMIZE:this.normalize()}},ControlBoxBinding.prototype.maximize=function(){this.dispatchAction(ControlBoxBinding.ACTION_MAXIMIZE),this.setState(ControlBoxBinding.STATE_MAXIMIZED),this.isNormalized=!1,this.isMaximized=!0,this.isMinimized=!1},ControlBoxBinding.prototype.minimize=function(){this.dispatchAction(ControlBoxBinding.ACTION_MINIMIZE),this.setState(ControlBoxBinding.STATE_MINIMIZED),this.isNormalized=!1,this.isMaximized=!1,this.isMinimized=!0},ControlBoxBinding.prototype.normalize=function(){this.dispatchAction(ControlBoxBinding.ACTION_NORMALIZE),this.setState(ControlBoxBinding.STATE_NORMAL),this.isNormalized=!0,this.isMaximized=!1,this.isMinimized=!1},ControlBoxBinding.prototype.setState=function(a){var b=this.getState();this.setProperty("state",a),this.detachClassName(b),this.attachClassName(a),this.dispatchAction(ControlBoxBinding.ACTION_STATECHANGE)},ControlBoxBinding.prototype.getState=function(){var a=this.getProperty("state");return a||(a=ControlBoxBinding.STATE_NORMAL),a},MenuContainerBinding.prototype=new Binding,MenuContainerBinding.prototype.constructor=MenuContainerBinding,MenuContainerBinding.superclass=Binding.prototype,MenuContainerBinding.prototype.toString=function(){return"[MenuContainerBinding]"},MenuContainerBinding.prototype.isOpen=function(a){var b=null;return b=a?a==this._openElement:this._isOpen},MenuContainerBinding.prototype.setOpenElement=function(a){a?(this._openElement&&this._openElement.hide(),this._openElement=a,this._isOpen=!0):(this._openElement=null,this._isOpen=!1)},MenuContainerBinding.prototype.getMenuContainerBinding=function(){return this.menuContainerBinding||(this.menuContainerBinding=this.getAncestorBindingByType(MenuContainerBinding)),this.menuContainerBinding},MenuContainerBinding.prototype.getMenuPopupBinding=function(){var a=this.getChildBindingByLocalName("menupopup");return a&&a!=this.menuPopupBinding&&(this.menuPopupBinding=a,this.menuPopupBinding.addActionListener(PopupBinding.ACTION_HIDE,this)),this.menuPopupBinding},MenuContainerBinding.prototype.show=function(){var a=this.getMenuContainerBinding();a.setOpenElement(this);var b=this.getMenuPopupBinding();b.snapTo(this.bindingElement),b.show()},MenuContainerBinding.prototype.hide=function(){this.reset(),this.getMenuPopupBinding().hide(),this._isOpen&&this._openElement.hide()},MenuContainerBinding.prototype.reset=Binding.ABSTRACT_METHOD,MenuContainerBinding.prototype.handleAction=function(a){if(MenuContainerBinding.superclass.handleAction.call(this,a),a.type==PopupBinding.ACTION_HIDE){var b=this.getMenuContainerBinding();b.setOpenElement(!1),this.reset(),a.consume()}},MenuBarBinding.prototype=new MenuContainerBinding,MenuBarBinding.prototype.constructor=MenuBarBinding,MenuBarBinding.superclass=MenuContainerBinding.prototype,MenuBarBinding.prototype.toString=function(){return"[MenuBarBinding]"},MenuBarBinding.prototype.onBindingRegister=function(){MenuBarBinding.superclass.onBindingRegister.call(this),this.addActionListener(MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT)},MenuBarBinding.prototype.handleAction=function(a){switch(MenuBarBinding.superclass.handleAction.call(this,a),a.type){case MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY:for(var b=a.target,c=this.getChildBindingsByLocalName("menu");c.hasNext();){c.getNext()}switch(b.arrowKey){case KeyEventCodes.VK_LEFT:this.logger.debug("LEFTG");break;case KeyEventCodes.VK_RIGHT:this.logger.debug("RIGHT")}}},MenuBinding.prototype=new MenuContainerBinding,MenuBinding.prototype.constructor=MenuBinding,MenuBinding.superclass=MenuContainerBinding.prototype,MenuBinding.prototype.toString=function(){return"[MenuBinding]"},MenuBinding.prototype.onBindingAttach=function(){MenuBinding.superclass.onBindingAttach.call(this),this.buildDOMContent(),this.assignDOMEvents()},MenuBinding.prototype.buildDOMContent=function(){var a=this.getProperty("image"),b=this.getProperty("label"),c=this.getProperty("tooltip");this.labelBinding=LabelBinding.newInstance(this.bindingDocument),this.labelBinding.attachClassName("menulabel"),this.add(this.labelBinding),b&&this.setLabel(b),a&&this.setImage(a),c&&this.setToolTip(c)},MenuBinding.prototype.reset=function(){this.detachClassName("hover")},MenuBinding.prototype.setImage=function(a){this.setProperty("image",a),this.isAttached&&this.labelBinding.setImage(a)},MenuBinding.prototype.setLabel=function(a){this.setProperty("label",a),this.isAttached&&this.labelBinding.setLabel(Resolver.resolve(a))},MenuBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),this.isAttached&&this.labelBinding.setToolTip(Resolver.resolve(a))},MenuBinding.prototype.getImage=function(){return this.getProperty("image")},MenuBinding.prototype.getLabel=function(){return this.getProperty("label")},MenuBinding.prototype.getToolTip=function(){return this.getProperty("tooltip")},MenuBinding.prototype.assignDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEOVER),this.addEventListener(DOMEvents.MOUSEOUT),this.addEventListener(DOMEvents.MOUSEUP)},MenuBinding.prototype.handleEvent=function(a){MenuBinding.superclass.handleEvent.call(this,a);var b=this.getMenuContainerBinding();if(!BindingDragger.isDragging)switch(a.type){case DOMEvents.MOUSEDOWN:b.isOpen(this)&&DOMEvents.stopPropagation(a);break;case DOMEvents.MOUSEOVER:b.isOpen()&&!b.isOpen(this)&&(this.show(),this.menuPopupBinding.grabKeyboard()),this.attachClassName("hover"),this.isFocused=!0;break;case DOMEvents.MOUSEOUT:b.isOpen()||this.hide(),this.isFocused=!1;break;case DOMEvents.MOUSEUP:b.isOpen(this)||(this.show(),this.menuPopupBinding.grabKeyboard()),DOMEvents.stopPropagation(a)}DOMEvents.stopPropagation(a)},MenuBodyBinding.prototype=new Binding,MenuBodyBinding.prototype.constructor=MenuBodyBinding,MenuBodyBinding.superclass=Binding.prototype,MenuBodyBinding.CLASSNAME_CHECKBOXED="checkboxed",MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY="menubody unhandled arrowkey",MenuBodyBinding.activeInstance=null,MenuBodyBinding.handleBroadcast=function(a,b){var c=MenuBodyBinding.activeInstance,d=b;if(c)switch(a){case BroadcastMessages.KEY_ARROW:c.handleArrowKey(d);break;case BroadcastMessages.KEY_ENTER:c.handleEnterKey()}},EventBroadcaster.subscribe(BroadcastMessages.KEY_ARROW,MenuBodyBinding),EventBroadcaster.subscribe(BroadcastMessages.KEY_ENTER,MenuBodyBinding),EventBroadcaster.subscribe(BroadcastMessages.KEY_ESCAPE,MenuBodyBinding),MenuBodyBinding.prototype.toString=function(){return"[MenuBodyBinding]"},MenuBodyBinding.prototype.onBindingAttach=function(){MenuBodyBinding.superclass.onBindingAttach.call(this),this._focused={},this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEOVER),this.addEventListener(DOMEvents.MOUSEOUT),this.addEventListener(DOMEvents.MOUSEUP),this.addEventListener(DOMEvents.KEYDOWN),this.addEventListener(DOMEvents.TOUCHSTART);var a=this;this.addActionListener(MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY,{handleAction:function(b){switch(b.target){case a:a.releaseKeyboard(),a._containingPopupBinding.hide();break;default:;a._lastFocused.focus(),a.grabKeyboard(),b.consume()}}}),this._containingPopupBinding=UserInterface.getBinding(this.bindingElement.parentNode),this._containingPopupBinding.addActionListener(PopupBinding.ACTION_HIDE,{handleAction:function(){a.resetFocusedItems(!0),a.releaseKeyboard()}})},MenuBodyBinding.prototype.onBindingDispose=function(){MenuBodyBinding.superclass.onBindingDispose.call(this),MenuBodyBinding.activeInstance==this&&(MenuBodyBinding.activeInstance=null)},MenuBodyBinding.prototype.handleEvent=function(a){switch(MenuBodyBinding.superclass.handleEvent.call(this,a),a.type==DOMEvents.MOUSEOUT&&this.resetFocusedItems(),a.type){case DOMEvents.MOUSEDOWN:case DOMEvents.MOUSEOVER:case DOMEvents.MOUSEOUT:case DOMEvents.MOUSEUP:case DOMEvents.TOUCHSTART:DOMEvents.stopPropagation(a);break;case DOMEvents.KEYDOWN:switch(a.keyCode){case KeyEventCodes.VK_DOWN:case KeyEventCodes.VK_UP:case KeyEventCodes.VK_LEFT:case KeyEventCodes.VK_RIGHT:DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a),this.handleArrowKey(a.keyCode)}}},MenuBodyBinding.prototype.handleFocusedItem=function(a){for(var b in this._focused)if(b!=a.key){var c=this._focused[b];c.blur()}this._focused[a.key]=a,this._lastFocused=a,MenuBodyBinding.activeInstance!=this&&this.grabKeyboard()},MenuBodyBinding.prototype.handleBlurredItem=function(a){delete this._focused[a.key]},MenuBodyBinding.prototype.resetFocusedItems=function(a){for(var b in this._focused){var c=this._focused[b];c.blur(a)}a&&(this._lastFocused=null)},MenuBodyBinding.prototype.refreshMenuGroups=function(){if(!this.isAttached)throw"refreshMenuGroups: MenuBodyBinding not attached!";for(var a=this.getChildBindingsByLocalName("menugroup"),b=null,c=null;a.hasNext();){var d=a.getNext();d.isDefaultContent||(d.setLayout(MenuGroupBinding.LAYOUT_DEFAULT),!b&&d.isVisible&&(b=d),d.isVisible&&(c=d))}b&&c&&(b.setLayout(MenuGroupBinding.LAYOUT_FIRST),c.setLayout(MenuGroupBinding.LAYOUT_LAST))},MenuBodyBinding.prototype.grabKeyboard=function(a){if(MenuBodyBinding.activeInstance=this,a){var b=this._getMenuItems().getFirst();b&&b.focus()}},MenuBodyBinding.prototype.releaseKeyboard=function(){MenuBodyBinding.activeInstance==this&&(MenuBodyBinding.activeInstance=null)},MenuBodyBinding.prototype.handleEnterKey=function(){var a=this._lastFocused;null==a||a.isMenuContainer||(a.fireCommand(),EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN))},MenuBodyBinding.prototype.handleArrowKey=function(a){this.arrowKey=a;var b=this._getMenuItems(),c=null,d=null;if(this._lastFocused)switch(c=this._lastFocused,a){case KeyEventCodes.VK_UP:d=b.getPreceding(c);break;case KeyEventCodes.VK_DOWN:d=b.getFollowing(c);break;case KeyEventCodes.VK_LEFT:this.dispatchAction(MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY);break;case KeyEventCodes.VK_RIGHT:this._lastFocused.isMenuContainer?(this.releaseKeyboard(),this._lastFocused.show(),this._lastFocused.menuPopupBinding.grabKeyboard(!0)):this.dispatchAction(MenuBodyBinding.ACTION_UNHANDLED_LEFTRIGHTKEY)}else d=b.getFirst();d&&d.focus()},MenuBodyBinding.prototype._getMenuItems=function(){if(!this._menuItemsList||this.isDirty){var a=new List,b=null;this.getChildBindingsByLocalName("menugroup").each(function(c){b=c.getChildBindingsByLocalName("menuitem"),b.each(function(b){a.add(b)})}),b=this.getChildBindingsByLocalName("menuitem"),b.each(function(b){a.add(b)}),this._menuItemsList=a,this.isDirty=!1}return this._menuItemsList},MenuBodyBinding.prototype.invokeCheckBoxLayout=function(){this.hasClassName(MenuBodyBinding.CLASSNAME_CHECKBOXED)||this.attachClassName(MenuBodyBinding.CLASSNAME_CHECKBOXED)},MenuBodyBinding.prototype.invokeImageLayout=function(){this._hasImageLayout||(this.detachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this._hasImageLayout=!0)},MenuBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menubody",a);return UserInterface.registerBinding(b,MenuBodyBinding)},MenuGroupBinding.prototype=new Binding,MenuGroupBinding.prototype.constructor=MenuGroupBinding,MenuGroupBinding.superclass=Binding.prototype,MenuGroupBinding.LAYOUT_DEFAULT=0,MenuGroupBinding.LAYOUT_FIRST=1,MenuGroupBinding.LAYOUT_LAST=2,MenuGroupBinding.prototype.toString=function(){return"[MenuGroupBinding]"},MenuGroupBinding.prototype.setLayout=function(a){switch(a){case MenuGroupBinding.LAYOUT_DEFAULT:this.detachClassName("first"),this.detachClassName("last");break;case MenuGroupBinding.LAYOUT_FIRST:this.attachClassName("first");break;case MenuGroupBinding.LAYOUT_LAST:this.attachClassName("last")}},MenuGroupBinding.prototype.show=function(){this.isVisible||(this.bindingElement.style.display="block",this.bindingElement.style.visibility="visible",this.isVisible=!0)},MenuGroupBinding.prototype.hide=function(){this.isVisible&&(this.bindingElement.style.display="none",this.bindingElement.style.visibility="hidden",this.isVisible=!1)},MenuGroupBinding.prototype.empty=function(){this.detachRecursive(),this.bindingElement.innerHTML=""},MenuGroupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menugroup",a);return UserInterface.registerBinding(b,MenuGroupBinding)},MenuItemBinding.prototype=new MenuContainerBinding,MenuItemBinding.prototype.constructor=MenuItemBinding,MenuItemBinding.superclass=MenuContainerBinding.prototype,MenuItemBinding.ACTION_COMMAND="menuitemcommand",MenuItemBinding.TYPE_CHECKBOX="checkbox",MenuItemBinding.TYPE_MENUCONTAINER="menucontainer",MenuItemBinding.CLASSNAME_CHECKBOX="checkboxindicator",MenuItemBinding.CLASSNAME_HOVER="hover",MenuItemBinding.CHAR_CHECKBOX="V",MenuItemBinding.TIMEOUT=150,MenuItemBinding.prototype.toString=function(){return"[MenuItemBinding]"},MenuItemBinding.prototype.onBindingRegister=function(){MenuItemBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.isdisabled=this.setDisabled,this.type&&this.setProperty("type",this.type)},MenuItemBinding.prototype.onBindingAttach=function(){MenuItemBinding.superclass.onBindingAttach.call(this),this._containingMenuBodyBinding=this.getAncestorBindingByLocalName("menubody"),this._containingMenuBodyBinding.isDirty=!0,this.parseDOMProperties(),this.buildDOMContent(),this.assignDOMEvents(),this.dispatchAction(Binding.ACTION_ATTACHED)},MenuItemBinding.prototype.parseDOMProperties=function(){var a=this.getProperty("image"),b=this.getProperty("image-hover"),c=this.getProperty("image-active"),d=this.getProperty("image-disabled");!this.image&&a&&(this.image=a),!this.imageHover&&b&&(this.imageHover=a),!this.imageActive&&c&&(this.imageActive=c),!this.imageDisabled&&d&&(this.imageDisabled=d)},MenuItemBinding.prototype.buildDOMContent=function(){var a=this.getProperty("label"),b=this.getProperty("tooltip"),c=this.getProperty("type"),d=this.getProperty("isdisabled"),e=this.getProperty("image"),f=this.getProperty("image-hover"),g=this.getProperty("image-active"),h=this.getProperty("image-disabled"),i=this.getProperty("hasaction");this.labelBinding=LabelBinding.newInstance(this.bindingDocument),this.labelBinding.attachClassName("menuitemlabel"),this.add(this.labelBinding);var j=this.getMenuPopupBinding();j&&(this.isMenuContainer=!0,this.setType(MenuItemBinding.TYPE_MENUCONTAINER),this.hasAction=i===!0),this.imageProfile||(!this.image&&e&&(this.image=e),!this.imageHover&&f&&(this.imageHover=e),!this.imageActive&&g&&(this.imageActive=g),!this.imageDisabled&&h&&(this.imageDisabled=h),(this.image||this.imageHover||this.imageActive||this.imageDisabled)&&(this.imageProfile=new ImageProfile(this))),this.imageProfile?this.setImage(this.imageProfile.getDefaultImage()):this.setImage(null),null!=a&&this.setLabel(a),b&&this.setToolTip(b),c&&this.setType(c),this.type==MenuItemBinding.TYPE_CHECKBOX&&1==this.getProperty("ischecked")&&this.check(!0),1==d&&this.disable();var k=this.getProperty("oncommand");k&&(this.oncommand=function(){this.bindingWindow.eval(k)})},MenuItemBinding.prototype.assignDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEOVER),this.addEventListener(DOMEvents.MOUSEUP)},MenuItemBinding.prototype.handleEvent=function(a){if(MenuItemBinding.superclass.handleEvent.call(this,a),!this.isDisabled&&!BindingDragger.isDragging)switch(a.type){case DOMEvents.MOUSEOVER:this.focus(a);break;case DOMEvents.MOUSEUP:DOMEvents.stopPropagation(a),this.hasAction&&(this.type==MenuItemBinding.TYPE_CHECKBOX?this.setChecked(!this.isChecked):this.fireCommand(),EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,this),EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEUP,this))}},MenuItemBinding.prototype.fireCommand=function(){this.hasAction&&(this.oncommand&&this.oncommand(),this.dispatchAction(MenuItemBinding.ACTION_COMMAND))},MenuItemBinding.prototype.setImage=function(a){a=a?a:LabelBinding.DEFAULT_IMAGE,this.setProperty("image",a),this.isAttached&&this.labelBinding.setImage(a)},MenuItemBinding.prototype.setLabel=function(a){this.setProperty("label",a),this.isAttached&&this.labelBinding.setLabel(Resolver.resolve(a))},MenuItemBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),this.isAttached&&this.labelBinding.setToolTip(Resolver.resolve(a))},MenuItemBinding.prototype.reset=function(){this.labelBinding.hasClassName("hover")&&this.labelBinding.detachClassName("hover")},MenuItemBinding.prototype.setType=function(a){if(this.isAttached){if(this.isTypeSet)throw new Error("MenuItemBinding: Cannot set type twice.");switch(a){case MenuItemBinding.TYPE_CHECKBOX:if(!this.hasAction)throw new Error("MenuItemBinding: checkboxes cannot contain menus");this._containingMenuBodyBinding.invokeCheckBoxLayout();var b=this.bindingDocument.createElement("div");b.className=MenuItemBinding.CLASSNAME_CHECKBOX,b.appendChild(this.bindingDocument.createTextNode(MenuItemBinding.CHAR_CHECKBOX));var c=this.labelBinding.bindingElement;c.insertBefore(b,c.firstChild),b.style.display="none",this.shadowTree.checkBoxIndicator=b;break;case MenuItemBinding.TYPE_MENUCONTAINER:}this.type=a,this.isTypeSet=!0}this.setProperty("type",a)},MenuItemBinding.prototype.getImage=function(){return this.getProperty("image")},MenuItemBinding.prototype.getLabel=function(){return this.getProperty("label")},MenuItemBinding.prototype.getToolTip=function(){return this.getProperty("tooltip")},MenuItemBinding.prototype.disable=function(){this.setDisabled(!0)},MenuItemBinding.prototype.enable=function(){this.setDisabled(!1)},MenuItemBinding.prototype.setDisabled=function(a){if(this.isDisabled=a,this.isDisabled?this.setProperty("isdisabled",!0):this.deleteProperty("isdisabled"),this.isAttached)if(this.isDisabled){if(this.labelBinding.detachClassName("hover"),this.attachClassName("isdisabled"),this.imageProfile){var b=this.imageProfile.getDisabledImage();b&&this.setImage(b)}}else if(this.detachClassName("isdisabled"),this.imageProfile){var b=this.imageProfile.getDefaultImage();b&&this.setImage(b)}},MenuItemBinding.prototype.focus=function(a){this.labelBinding.attachClassName(MenuItemBinding.CLASSNAME_HOVER);var b=this.getMenuContainerBinding();if(b.isOpen()&&!b.isOpen(this)&&(b._openElement.hide(),b.setOpenElement(!1)),this.isMenuContainer&&a&&a.type==DOMEvents.MOUSEOVER){var b=this.getMenuContainerBinding();if(!b.isOpen(this)){var c=this;this._showSubMenuTimeout=window.setTimeout(function(){c.show(),c._showSubMenuTimeout=null},MenuItemBinding.TIMEOUT)}}if((!a||a.type!=DOMEvents.MOUSEOVER)&&this.bindingElement.tabIndex!=-1)if(Client.isMozilla)FocusBinding.focusElement(this.bindingElement);else{var c=this;setTimeout(function(){FocusBinding.focusElement(c.bindingElement)},0)}this.isFocused=!0,this._containingMenuBodyBinding.handleFocusedItem(this)},MenuItemBinding.prototype.blur=function(a){if(this._showSubMenuTimeout&&(window.clearTimeout(this._showSubMenuTimeout),this._showSubMenuTimeout=null),this.isFocused){var b=this.getMenuContainerBinding();b&&b.isOpen(this)&&!a||(this.labelBinding.detachClassName(MenuItemBinding.CLASSNAME_HOVER),this.isFocused=!1,this._containingMenuBodyBinding.handleBlurredItem(this))}},MenuItemBinding.prototype.check=function(a){this.setChecked(!0,a)},MenuItemBinding.prototype.uncheck=function(a){this.setChecked(!1,a)},MenuItemBinding.prototype.show=function(){this.menuPopupBinding.position=PopupBinding.POSITION_RIGHT,MenuItemBinding.superclass.show.call(this)},MenuItemBinding.prototype.setChecked=function(a,b){this.setProperty("ischecked",a),this.isAttached&&this.type==MenuItemBinding.TYPE_CHECKBOX&&this.isChecked!=a&&(this.isChecked=a,this.shadowTree.checkBoxIndicator.style.display=a?"block":"none",b||this.fireCommand())},MenuItemBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menuitem",a);return UserInterface.registerBinding(b,MenuItemBinding),UserInterface.getBinding(b)},PopupSetBinding.prototype=new MenuContainerBinding,PopupSetBinding.prototype.constructor=PopupSetBinding,PopupSetBinding.superclass=MenuContainerBinding.prototype,PopupSetBinding.getPopupSet=function(a,b){var c=UserInterface.getBinding(a.body),d=null;return c.getDescendantBindingsByType(PopupSetBinding).each(function(a){return a.getProperty("rel")!==b||(d=a,!1)}),null==d&&(d=c.addFirst(PopupSetBinding.newInstance(a)),d.setProperty("rel",b),d.attach()),d},PopupSetBinding.prototype.toString=function(){return"[PopupSetBinding]"},PopupSetBinding.prototype.onBindingAttach=function(){PopupSetBinding.superclass.onBindingAttach.call(this),"body"!==this.bindingElement.parentNode.nodeName.toLowerCase()&&this.bindingDocument.body.appendChild(this.bindingElement)},PopupSetBinding.prototype.getPopupByRel=function(a){var b=null;return this.getDescendantBindingsByType(PopupBinding).each(function(c){return c.getProperty("rel")!==a||(b=c,!1)}),b},PopupSetBinding.prototype.createNewPopupByRel=function(a){var b=this.getPopupByRel(a);return b?b.empty():(b=this.add(PopupBinding.newInstance(this.bindingDocument)),b.add(MenuBodyBinding.newInstance(this.bindingDocument)),b.setProperty("rel",a),b.attachRecursive()),b},PopupSetBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:popupset",a);return UserInterface.registerBinding(b,PopupSetBinding)},PopupBinding.prototype=new Binding,PopupBinding.prototype.constructor=PopupBinding,PopupBinding.superclass=Binding.prototype,PopupBinding.ACTION_SHOW="popupshow",PopupBinding.ACTION_HIDE="popuphide",PopupBinding.POSITION_TOP="top",PopupBinding.POSITION_RIGHT="right",PopupBinding.POSITION_BOTTOM="bottom",PopupBinding.POSITION_LEFT="left",PopupBinding.TYPE_NORMAL="normal",PopupBinding.TYPE_FIXED="fixed",PopupBinding.FIXED_MAX=7,PopupBinding.CLASSNAME_OVERFLOW="overflow",PopupBinding.CLASSNAME_TEXTONLY="textonly",PopupBinding.activeInstances=new Map,PopupBinding.hasActiveInstances=function(){return PopupBinding.activeInstances.hasEntries()},PopupBinding.handleBroadcast=function(a,b){switch(a){case BroadcastMessages.MOUSEEVENT_MOUSEDOWN:case BroadcastMessages.TOUCHEVENT_TOUCHSTART:if(PopupBinding.activeInstances.hasEntries()){var c=new List;PopupBinding.activeInstances.each(function(a){var d=PopupBinding.activeInstances.get(a),e=b&&b instanceof ButtonBinding&&b.popupBinding==d;e||c.add(d)}),c.each(function(a){a.hide()})}break;case BroadcastMessages.KEY_ESCAPE:PopupBinding.activeInstances.hasEntries()&&PopupBinding.activeInstances.each(function(a){var b=PopupBinding.activeInstances.get(a);b.hide()})}},EventBroadcaster.subscribe(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,PopupBinding),EventBroadcaster.subscribe(BroadcastMessages.TOUCHEVENT_TOUCHSTART,PopupBinding),EventBroadcaster.subscribe(BroadcastMessages.KEY_ESCAPE,PopupBinding),PopupBinding.prototype.toString=function(){return"[PopupBinding]"},PopupBinding.prototype.onBindingAttach=function(){
PopupBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_ATTACHED),this.geometry={x:0,y:0,w:0,h:0},this.buildDOMContent(),this.parseDOMProperties(),this.assignDOMEvents()},PopupBinding.prototype.onBindingDispose=function(){PopupBinding.superclass.onBindingDispose.call(this),PopupBinding.activeInstances.has(this.key)&&PopupBinding.activeInstances.del(this.key)},PopupBinding.prototype.buildDOMContent=function(){var a=DOMUtil.getElementsByTagName(this.bindingElement,"menubody").item(0),b=DOMUtil.getElementsByTagName(this.bindingElement,"popupbody").item(0);if(a)this._bodyBinding=UserInterface.getBinding(a);else if(b)this._bodyBinding=UserInterface.getBinding(b);else{if(this.bindingElement.childElementCount>0)throw new Error(this+": DOM structure invalid.");this._bodyBinding=this.add(MenuBodyBinding.newInstance(this.bindingDocument)).attach()}},PopupBinding.prototype.parseDOMProperties=function(){if(!this.position){var a=this.getProperty("position");this.position=a?a:PopupBinding.POSITION_BOTTOM}},PopupBinding.prototype.assignDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEUP)},PopupBinding.prototype.add=function(a){var b=null;return this._bodyBinding?(this._bodyBinding.add(a),b=a):b=PopupBinding.superclass.add.call(this,a),b},PopupBinding.prototype.addFirst=function(a){var b=null;return this._bodyBinding?(this._bodyBinding.addFirst(a),b=a):b=PopupBinding.superclass.addFirst.call(this,a),b},PopupBinding.prototype.handleAction=function(a){PopupBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case Binding.ACTION_ATTACHED:b instanceof MenuItemBinding&&(this._count(!0),a.consume());break;case Binding.ACTION_DETACHED:b instanceof MenuItemBinding&&(this._count(!1),a.consume())}},PopupBinding.prototype._count=function(a){this.type==PopupBinding.TYPE_FIXED&&(this._menuItemCount=this._menuItemCount+(a?1:-1),this._isOverflow?this._menuItemCount<PopupBinding.FIXED_MAX&&(this.bindingElement.style.height="auto",this.detachClassName(PopupBinding.CLASSNAME_OVERFLOW),this._isOverflow=!1):this._menuItemCount>=PopupBinding.FIXED_MAX&&(this.bindingElement.style.height="",this.attachClassName(PopupBinding.CLASSNAME_OVERFLOW),this._isOverflow=!0))},PopupBinding.prototype.snapTo=function(a){var b=this._getElementPosition(a);switch(this.position){case PopupBinding.POSITION_TOP:b.y-=this.bindingElement.offsetHeight;break;case PopupBinding.POSITION_RIGHT:b.x+=a.offsetWidth;break;case PopupBinding.POSITION_BOTTOM:b.y+=a.offsetHeight;break;case PopupBinding.POSITION_LEFT:b.x-=this.bindingElement.offsetWidth}this.targetElement=a,this.bindingElement.style.display="block",this.setPosition(b.x,b.y)},PopupBinding.prototype.snapToMouse=function(a){this.snapToPoint(this._getMousePosition(a))},PopupBinding.prototype.snapToPoint=function(a){this.bindingElement.style.display="block",this.setPosition(a.x,a.y),this.show()},PopupBinding.prototype.setPosition=function(a,b){this.geometry.x=a,this.geometry.y=b,this.bindingElement.style.left=this.geometry.x+"px",this.bindingElement.style.top=this.geometry.y+"px"},PopupBinding.prototype.getPosition=function(a,b){return new Point(this.geometry.x,this.geometry.y)},PopupBinding.prototype.getDimension=function(){return new Dimension(this.bindingElement.offsetWidth,this.bindingElement.offsetHeight)},PopupBinding.prototype._getElementPosition=function(a){return a.ownerDocument==this.bindingDocument?DOMUtil.getGlobalPosition(a):DOMUtil.getUniversalPosition(a)},PopupBinding.prototype._getMousePosition=function(a){var b=DOMEvents.getTarget(a);return b.ownerDocument==this.bindingDocument?DOMUtil.getGlobalMousePosition(a):DOMUtil.getUniversalMousePosition(a)},PopupBinding.prototype.show=function(){1==this.isVisible&&this.hide(),this.isVisible||(PopupBinding.activeInstances.set(this.key,this),this.bindingElement.style.display="block",this.dispatchAction(PopupBinding.ACTION_SHOW),this.fitOnScreen(),this._makeVisible(!0),this._bodyBinding instanceof MenuBodyBinding&&(this._bodyBinding.refreshMenuGroups(),this.isManaged||(this._bodyBinding.grabKeyboard(),this._bodyBinding.bindingElement.tabIndex="-1",this._bodyBinding.bindingElement.focus())),this._enableTab(!0))},PopupBinding.prototype._makeVisible=function(a){var b=this.bindingElement;a?b.style.visibility="visible":(b.style.visibility="hidden",b.style.display="none"),this.isVisible=a},PopupBinding.prototype._enableTab=function(a){var b=this,c=this.getDescendantBindingsByLocalName("menuitem");setTimeout(function(){1==Binding.exists(b)&&c.each(function(b){b.bindingElement.tabIndex=a?0:-1})},0)},PopupBinding.prototype.hide=function(){if(this.releaseKeyboard(),this.isVisible){this._makeVisible(!1),this.targetElement=null,this.dispatchAction(Binding.ACTION_VISIBILITYCHANGED),this.dispatchAction(PopupBinding.ACTION_HIDE),this._enableTab(!1);var a=this;setTimeout(function(){a.isVisible||PopupBinding.activeInstances.del(a.key)},0)}},PopupBinding.prototype.fitOnScreen=function(){var a=this.bindingElement.offsetLeft,b=this.bindingElement.offsetTop,c=this.bindingElement.offsetWidth,d=this.bindingElement.offsetHeight,e=this.bindingWindow.WindowManager.getWindowDimensions(),f=this.boxObject.getGlobalPosition();if(null!=this.targetElement){if(f.y+d>=e.h)switch(CSSComputer.getPosition(this.bindingElement.offsetParent)){case"absolute":b=b-d-this.targetElement.offsetHeight,b<0&&(b=0);break;case"relative":b=b-d+this.targetElement.offsetHeight+9;var g=DOMUtil.getGlobalPosition(this.targetElement);b+g.y<0&&(b=-g.y)}if(f.x+c>=e.w)switch(a-=c,this.position){case PopupBinding.POSITION_RIGHT:a-=this.targetElement.offsetWidth;break;case PopupBinding.POSITION_BOTTOM:a+=this.targetElement.offsetWidth}}else f.y+d>=e.h&&(b-=d,b<0&&(b=0)),f.x+c>=e.w&&(a-=c,a<0&&(a=0));this.setPosition(a,b)},PopupBinding.prototype.handleEvent=function(a){PopupBinding.superclass.handleEvent.call(this,a),DOMEvents.stopPropagation(a)},PopupBinding.prototype.empty=function(){this._bodyBinding.detachRecursive(),this._bodyBinding.bindingElement.innerHTML=""},PopupBinding.prototype.grabKeyboard=function(a){},PopupBinding.prototype.releaseKeyboard=function(){null!=this._bodyBinding&&this._bodyBinding instanceof MenuBodyBinding&&this._bodyBinding.releaseKeyboard()},PopupBinding.prototype._indexMenuContent=function(){this._menuItems={},this._menuGroups={};for(var a=this.getDescendantBindingsByLocalName("menugroup");a.hasNext();){var b=a.getNext(),c=b.getProperty("rel");c&&(this._menuGroups[c]||(this._menuGroups[c]=new List),this._menuGroups[c].add(b))}for(a=this.getDescendantBindingsByLocalName("menuitem");a.hasNext();){var b=a.getNext(),d=b.getProperty("cmd");this._menuItems[d]=b}},PopupBinding.prototype.getMenuItemForCommand=function(a){var b=null;if(!this._menuItems)throw"Must invoke _indexMenuContent method first!";if(!this._menuItems[a])throw"PopupBinding.getMenuItemForCommand: No binding for command "+a;return b=this._menuItems[a]},PopupBinding.prototype.showTextOnly=function(){this._bodyBinding&&(this._bodyBinding.attachClassName(PopupBinding.CLASSNAME_TEXTONLY),this.hasImages=!1)},PopupBinding.prototype.showBoth=function(){this._bodyBinding&&(this._bodyBinding.detachClassName(PopupBinding.CLASSNAME_TEXTONLY),this.hasImages=!0)},PopupBinding.prototype.clear=function(){var a=this._bodyBinding;a&&(a.detachRecursive(),a.bindingElement.innerHTML=""),this.bindingElement.style.height="auto",this.detachClassName(PopupBinding.CLASSNAME_OVERFLOW),this._isOverflow=!1,this._menuItemCount=0},PopupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:popup",a);return UserInterface.registerBinding(b,PopupBinding)},PopupBodyBinding.prototype=new Binding,PopupBodyBinding.prototype.constructor=PopupBodyBinding,PopupBodyBinding.superclass=Binding.prototype,PopupBodyBinding.prototype.toString=function(){return"[PopupBodyBinding]"},PopupBodyBinding.prototype.setDimension=function(a){this.getBindingElement().style.width=new String(a.w)+"px"},PopupBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:popupbody",a);return UserInterface.registerBinding(b,PopupBodyBinding)},MenuPopupBinding.prototype=new PopupBinding,MenuPopupBinding.prototype.constructor=MenuPopupBinding,MenuPopupBinding.superclass=PopupBinding.prototype,MenuPopupBinding.prototype.toString=function(){return"[MenuPopupBinding]"},MenuPopupBinding.prototype._getElementPosition=function(a){return new Point(a.offsetLeft,0)},MenuPopupBinding.prototype.fitOnScreen=function(){switch(this.position){case PopupBinding.POSITION_BOTTOM:var a=this.bindingElement.offsetLeft,b=this.bindingElement.offsetTop,c=this.bindingElement.offsetWidth,d=(this.bindingElement.offsetHeight,this.bindingWindow.WindowManager.getWindowDimensions());this.boxObject.getGlobalPosition();a=this.targetElement.offsetLeft+this.targetElement.offsetWidth/2-this.bindingElement.offsetWidth/2,this.detachClassName("bottomright"),a+c>=d.w&&(a=this.targetElement.offsetLeft+this.targetElement.offsetWidth-this.bindingElement.offsetWidth,this.attachClassName("bottomright")),this.setPosition(a,b);break;default:MenuPopupBinding.superclass.fitOnScreen.call(this)}},MenuPopupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menupopup",a);return UserInterface.registerBinding(b,MenuPopupBinding)},DialogBinding.prototype=new ControlBoxBinding,DialogBinding.prototype.constructor=DialogBinding;DialogBinding.superclass=ControlBoxBinding.prototype;DialogBinding.MODE_DRAGGING="dialogdragging",DialogBinding.MODE_RESIZING="dialogresizing",DialogBinding.ACTION_OPEN="dialogopen",DialogBinding.ACTION_CLOSE="dialogclose",DialogBinding.DEFAULT_WIDTH=540,DialogBinding.DEFAULT_HEIGHT=100,DialogBinding.prototype.toString=function(){return"[DialogBinding]"},DialogBinding.prototype.onBindingRegister=function(){DialogBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_DRAG,this),this.addActionListener(FocusBinding.ACTION_ACTIVATED),this.subscribe(this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST),this.buildDescendantBindings()},DialogBinding.prototype.onBindingAttach=function(){DialogBinding.superclass.onBindingAttach.call(this),this.geometry=this.computeDefaultGeometry(),this.parseDOMProperties(),this.buildControlBindings(),this.buildBorderBindings(),this.attachRecursive(),this._isResizable&&this.attachClassName("resizable"),this._hasTransitions&&(this.bindingElement.style.opacity="0"),this.setPosition(new Point(0,0)),this.setDimension(new Dimension(DialogBinding.DEFAULT_WIDTH,DialogBinding.DEFAULT_HEIGHT)),this.getProperty("open")&&this.open()},DialogBinding.prototype.buildDescendantBindings=function(){this._head=DialogHeadBinding.newInstance(this.bindingDocument),this._titlebar=DialogTitleBarBinding.newInstance(this.bindingDocument),this.addFirst(this._head),this._head.add(this._titlebar);var a=DOMUtil.getElementsByTagName(this.bindingElement,"dialogbody").item(0);a?this._body=UserInterface.getBinding(a):(this._body=DialogBodyBinding.newInstance(this.bindingDocument),this.add(this._body))},DialogBinding.prototype.buildBorderBindings=function(){for(var a=new List([DialogBorderBinding.TYPE_NORTH,DialogBorderBinding.TYPE_SOUTH,DialogBorderBinding.TYPE_EAST,DialogBorderBinding.TYPE_WEST]);a.hasNext();){var b=DialogBorderBinding.newInstance(this.bindingDocument);b.setType(a.getNext()),this.add(b)}},DialogBinding.prototype.buildControlBindings=function(){var a=this.getProperty("controls");if(a)for(var b=new List(a.split(" "));b.hasNext();){var c=b.getNext();switch(c){case ControlBinding.TYPE_MAXIMIZE:case ControlBinding.TYPE_MINIMIZE:case ControlBinding.TYPE_CLOSE:var d=DialogControlBinding.newInstance(this.bindingDocument);d.setControlType(c),this._titlebar.addControl(d),this.controlBindings[c]=d;break;default:throw new Error("DialogBinding: Control not added: "+c)}}},DialogBinding.prototype.buildDialogCoverBinding=function(){this._cover=DialogCoverBinding.newInstance(this.bindingDocument),this.getAncestorBindingByLocalName("dialogset").add(this._cover),this._cover.cover(this)},DialogBinding.prototype.parseDOMProperties=function(){var a=this.getProperty("image"),b=this.getProperty("label"),c=this.getProperty("draggable"),d=this.getProperty("resizable"),e=this.getProperty("modal");a&&this.setImage(a),b&&this.setLabel(b),0==c&&(this.isDialogDraggable=!1),0==d&&(this.isPanelResizable=!1),1==e&&this.setModal(!0)},DialogBinding.prototype.setModal=function(a){this.isModal=a},DialogBinding.prototype.setLabel=function(a){this.setProperty("label",a),1==this.isAttached&&this._titlebar.setLabel(Resolver.resolve(a))},DialogBinding.prototype.getLabel=function(){return this.getProperty("label")},DialogBinding.prototype.setImage=function(a){this.setProperty("image",a),this.isAttached&&this._titlebar.setImage(Resolver.resolve(a))},DialogBinding.prototype.handleAction=function(a){switch(DialogBinding.superclass.handleAction.call(this,a),a.type){case Binding.ACTION_DRAG:var b=a.target;if(this.getState()==ControlBoxBinding.STATE_NORMAL)switch(b.constructor){case DialogTitleBarBinding:this.mode=DialogBinding.MODE_DRAGGING,b.dragger.registerHandler(this);break;case DialogBorderBinding:this._isResizable&&(this.mode=DialogBinding.MODE_RESIZING,this._border=b,b.dragger.registerHandler(this))}a.consume();break;case Binding.ACTION_ACTIVATED:this.isActive||this.activate(),a.consume()}},DialogBinding.prototype.handleBroadcast=function(a,b){switch(DialogBinding.superclass.handleBroadcast.call(this,a,b),a){case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:this.startPoint=this.getPosition(),this._setComputedPosition(new Point(0,0))}},DialogBinding.prototype.handleInvokedControl=function(a){switch(DialogBinding.superclass.handleInvokedControl.call(this,a),a.controlType){case ControlBinding.TYPE_CLOSE:this.close()}},DialogBinding.prototype.open=function(a){this.isModal&&null==this._cover&&this.buildDialogCoverBinding(),this.isVisible||(this.setProperty("open","true"),this.isVisible=!0,this.isActivatable=!0,this.activate(),a||(this.centerOnScreen(),this.reflex(!0)),this.bindingElement.style.marginTop="0",this.dispatchAction(DialogBinding.ACTION_OPEN),this.dispatchAction(Binding.ACTION_VISIBILITYCHANGED),this._hasTransitions&&(this.bindingElement.style.opacity="1"))},DialogBinding.prototype.close=function(){function a(){b.dispatchAction(DialogBinding.ACTION_CLOSE),b.isVisible=!1,b.deleteProperty("open"),b.bindingElement.style.marginTop="-10000px"}if(this.isVisible){this.isActivatable=!1,this.deActivate();var b=this;if(this._hasTransitions){var c=b.bindingElement;setTimeout(function(){c.style.opacity="0",setTimeout(function(){a()},Animation.DEFAULT_TIME)},Animation.DEFAULT_TIME)}else setTimeout(function(){a()},0)}},DialogBinding.prototype.activate=function(){this.isActive||(this.isActive=!0,this.attachClassName("active"),this.moveToTop(),this._titlebar.onActivate(),Application.activate(this))},DialogBinding.prototype.deActivate=function(){1==this.isActive&&(this.isActive=!1,this.detachClassName("active"),this._titlebar.onDeactivate(),Application.deActivate(this))},DialogBinding.prototype.moveToTop=function(){this.dispatchAction(Binding.ACTION_MOVETOTOP),this.dispatchAction(Binding.ACTION_MOVEDONTOP)},DialogBinding.prototype.getZIndex=function(){return CSSComputer.getZIndex(this.bindingElement)},DialogBinding.prototype.setZIndex=function(a){this.bindingElement.style.zIndex=new String(a)},DialogBinding.prototype.onDragStart=function(a){switch(this.mode){case DialogBinding.MODE_DRAGGING:case DialogBinding.MODE_RESIZING:this.startPoint=new Point(this.bindingElement.offsetLeft,this.bindingElement.offsetTop),this.startDimension=new Dimension(this.bindingElement.offsetWidth,this.bindingElement.offsetHeight)}},DialogBinding.prototype.onDrag=function(a){switch(this.mode){case DialogBinding.MODE_DRAGGING:this._setComputedPosition(a);break;case DialogBinding.MODE_RESIZING:switch(this._border.getType()){case DialogBorderBinding.TYPE_NORTH:this.resizeNorth(a);break;case DialogBorderBinding.TYPE_SOUTH:this.resizeSouth(a);break;case DialogBorderBinding.TYPE_EAST:this.resizeEast(a);break;case DialogBorderBinding.TYPE_WEST:this.resizeWest(a)}this.reflex(!0)}},DialogBinding.prototype.onDragStop=function(a){switch(this.mode){case DialogBinding.MODE_DRAGGING:this._setComputedPosition(a);break;case DialogBinding.MODE_RESIZING:}this.mode=null},DialogBinding.prototype.resizeNorth=function(a){this.setPosition(new Point(this.startPoint.x,this.startPoint.y+a.y)),this.setDimension(new Dimension(this.startDimension.w,this.startDimension.h-a.y))},DialogBinding.prototype.resizeSouth=function(a){this.setDimension(new Dimension(this.startDimension.w,this.startDimension.h+a.y))},DialogBinding.prototype.resizeEast=function(a){this.setDimension(new Dimension(this.startDimension.w+a.x,this.startDimension.h))},DialogBinding.prototype.resizeWest=function(a){this.setPosition(new Point(this.startPoint.x+a.x,this.startPoint.y)),this.setDimension(new Dimension(this.startDimension.w-a.x,this.startDimension.h))},DialogBinding.prototype._setComputedPosition=function(a){var b=this.bindingWindow.WindowManager.getWindowDimensions(),c=this.getDimension(),d=this.startPoint.x+a.x,e=this.startPoint.y+a.y;d=d<0?0:d+c.w>b.w?b.w-c.w:d,e=e<0?0:e+c.h>b.h?b.h-c.h:e,this.setPosition(new Point(d,e))},DialogBinding.prototype.setPosition=function(a){var b=a.x,c=a.y;b=Math.round(b),this.bindingElement.style.left=b+"px",this.geometry.x=b,c=Math.round(c),this.bindingElement.style.top=c+"px",this.geometry.y=c},DialogBinding.prototype.getPosition=function(){return new Point(this.geometry.x,this.geometry.y)},DialogBinding.prototype.setDimension=function(a){a||SystemDebug.stack(arguments);var b=a.w,c=a.h;b=Math.round(b),this.bindingElement.style.width=b+"px",this.geometry.w=b,c=Math.round(c),this.bindingElement.style.height=c+"px",this.geometry.h=c},DialogBinding.prototype.getDimension=function(){return new Dimension(this.geometry.w,this.geometry.h)},DialogBinding.prototype.setResizable=function(a){this._isResizable!=a&&(a?this.attachClassName("resizable"):this.detachClassName("resizable"),this._isResizable=a)},DialogBinding.prototype.computeDefaultGeometry=function(){var a=null,b=this.bindingDocument.body.offsetWidth,c=this.bindingDocument.body.offsetHeight;return a={x:.125*b,y:.125*c,w:.75*b,h:.5*c}},DialogBinding.prototype.centerOnScreen=function(){var a=this.bindingWindow.WindowManager.getWindowDimensions(),b=this.getDimension();this.setPosition(new Point(.5*(a.w-b.w),.5*(a.h-b.h)))},DialogBinding.prototype.alert=function(){function a(){c%2==0?b.detachClassName("active"):b.attachClassName("active"),c++<7&&setTimeout(a,50)}var b=this,c=0;a()},DialogBinding.prototype.setControls=function(a){for(var b in this.controlBindings)this.controlBindings[b].dispose();for(var c="";a.hasNext();){var b=a.getNext();c+=b+a.hasNext()?" ":""}this.setProperty("controls",c),this.isAttached&&this.buildControlBindings()},DialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialog",a);return UserInterface.registerBinding(b,DialogBinding)},DialogHeadBinding.prototype=new Binding,DialogHeadBinding.prototype.constructor=DialogHeadBinding,DialogHeadBinding.superclass=Binding.prototype,DialogHeadBinding.prototype.toString=function(){return"[DialogHeadBinding]"},DialogHeadBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialoghead",a);return UserInterface.registerBinding(b,DialogHeadBinding)},DialogBodyBinding.prototype=new FlexBoxBinding,DialogBodyBinding.prototype.constructor=DialogBodyBinding,DialogBodyBinding.superclass=FlexBoxBinding.prototype,DialogBodyBinding.prototype.toString=function(){return"[DialogBodyBinding]"},DialogBodyBinding.prototype.onBindingAttach=function(){DialogBodyBinding.superclass.onBindingAttach.call(this),this._dialogBinding=UserInterface.getBinding(this.bindingElement.parentNode)},DialogBodyBinding.prototype.getPosition=function(){var a=this._dialogBinding.getPosition();return new Position(a.x+this.offsetLeft+DialogBorderBinding.DIMENSION,a.y+this.offsetTop)},DialogBodyBinding.prototype.getDimension=function(){var a=this.boxObject.getDimension();return new Dimension(a.w-2*DialogBorderBinding.DIMENSION,a.h-DialogBorderBinding.DIMENSION)},DialogBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialogbody",a);return UserInterface.registerBinding(b,DialogBodyBinding)},DialogSetBinding.prototype=new Binding,DialogSetBinding.prototype.constructor=DialogSetBinding,DialogSetBinding.superclass=Binding.prototype,DialogSetBinding.prototype.toString=function(){return"[DialogSetBinding]"},DialogSetBinding.prototype.onBindingAttach=function(){DialogSetBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_MOVETOTOP,this),this.addActionListener(Binding.ACTION_MOVEDONTOP,this)},DialogSetBinding.prototype.handleAction=function(a){DialogSetBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case Binding.ACTION_MOVETOTOP:b instanceof DialogBinding&&this._moveToTop(b);break;case Binding.ACTION_MOVEDONTOP:a.consume()}},DialogSetBinding.prototype._moveToTop=function(a){var b=0,c=this.getChildBindingsByLocalName("dialog");c.each(function(a){var c=a.getZIndex();b=c>b?c:b}),a.setZIndex(b+2)},DialogBorderBinding.prototype=new Binding,DialogBorderBinding.prototype.constructor=DialogBorderBinding,DialogBorderBinding.superclass=Binding.prototype,DialogBorderBinding.TYPE_NORTH="n",DialogBorderBinding.TYPE_SOUTH="s",DialogBorderBinding.TYPE_EAST="e",DialogBorderBinding.TYPE_WEST="w",DialogBorderBinding.DIMENSION=4,DialogBorderBinding.prototype.toString=function(){return"[DialogBorderBinding]"},DialogBorderBinding.prototype.setType=function(a){this.attachClassName(a),this._type=a},DialogBorderBinding.prototype.getType=function(){return this._type},DialogBorderBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialogborder",a);return UserInterface.registerBinding(b,DialogBorderBinding)},DialogCoverBinding.prototype=new Binding,DialogCoverBinding.prototype.constructor=DialogCoverBinding,DialogCoverBinding.superclass=Binding.prototype,DialogCoverBinding.prototype.toString=function(){return"[DialogCoverBinding]"},DialogCoverBinding.prototype.cover=function(a){this._dialogBinding=a,this._dialogBinding.addActionListener(DialogBinding.ACTION_OPEN,this),this._dialogBinding.addActionListener(DialogBinding.ACTION_CLOSE,this),this._dialogBinding.addActionListener(Binding.ACTION_MOVEDONTOP,this),this.addEventListener(DOMEvents.MOUSEDOWN)},DialogCoverBinding.prototype.handleEvent=function(a){DialogCoverBinding.superclass.handleEvent.call(this,a),this._dialogBinding.alert()},DialogCoverBinding.prototype.handleAction=function(a){DialogCoverBinding.superclass.handleAction.call(this,a);var b=a.target;if(this._dialogBinding.isModal)switch(a.type){case DialogBinding.ACTION_OPEN:this.show();break;case DialogBinding.ACTION_CLOSE:this.hide();break;case Binding.ACTION_MOVEDONTOP:b==this._dialogBinding&&(this.bindingElement.style.zIndex=new String(b.getZIndex()-1))}},DialogCoverBinding.prototype.handleBroadcast=function(a,b){switch(DialogCoverBinding.superclass.handleBroadcast.call(this,a,b),a){case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:this._max()}},DialogCoverBinding.prototype._max=function(){var a=this.bindingWindow.WindowManager.getWindowDimensions();this.bindingElement.style.width=a.w+"px",this.bindingElement.style.height=a.h+"px"},DialogCoverBinding.prototype.show=function(){this._max();var a=this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST;this.subscribe(a),DialogCoverBinding.superclass.show.call(this)},DialogCoverBinding.prototype.hide=function(){var a=this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST;this.unsubscribe(a),DialogCoverBinding.superclass.hide.call(this)},DialogCoverBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialogcover",a);return UserInterface.registerBinding(b,DialogCoverBinding)},DialogTitleBarBinding.prototype=new Binding,DialogTitleBarBinding.prototype.constructor=DialogTitleBarBinding,DialogTitleBarBinding.superclass=Binding.prototype,DialogTitleBarBinding.prototype.toString=function(){return"[DialogTitleBarBinding]"},DialogTitleBarBinding.prototype.onBindingRegister=function(){DialogTitleBarBinding.superclass.onBindingRegister.call(this),this.bodyBinding=this.add(DialogTitleBarBodyBinding.newInstance(this.bindingDocument)),this.labelBinding=this.bodyBinding.add(LabelBinding.newInstance(this.bindingDocument)),this.labelBinding.attachClassName("dialogtitle")},DialogTitleBarBinding.prototype.onBindingAttach=function(){DialogTitleBarBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("image");a&&this.setImage(a);var b=this.getProperty("label");b&&this.setLabel(b)},DialogTitleBarBinding.prototype.setLabel=function(a){this.isAttached&&this.labelBinding.setLabel(a),this.setProperty("label",a)},DialogTitleBarBinding.prototype.setImage=function(a){this.labelBinding.setImage(a),this.setProperty("image",a)},DialogTitleBarBinding.prototype.addControl=function(a){this._controlGroupBinding||(this._controlGroupBinding=this.bodyBinding.addFirst(ControlGroupBinding.newInstance(this.bindingDocument))),this._controlGroupBinding.add(a)},DialogTitleBarBinding.prototype.onActivate=function(){this._controlGroupBinding&&this._controlGroupBinding.onActivate()},DialogTitleBarBinding.prototype.onDeactivate=function(){this._controlGroupBinding&&this._controlGroupBinding.onDeactivate()},DialogTitleBarBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:titlebar",a);return UserInterface.registerBinding(b,DialogTitleBarBinding)},DialogTitleBarBodyBinding.prototype=new Binding,DialogTitleBarBodyBinding.prototype.constructor=DialogTitleBarBodyBinding,DialogTitleBarBodyBinding.superclass=Binding.prototype,DialogTitleBarBodyBinding.prototype.toString=function(){return"[DialogTitleBarBodyBinding]"},DialogTitleBarBodyBinding.prototype.onBindingRegister=function(){DialogTitleBarBodyBinding.superclass.onBindingRegister.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT)},DialogTitleBarBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:titlebarbody",a);return UserInterface.registerBinding(b,DialogTitleBarBodyBinding)},DialogControlBinding.prototype=new ControlBinding,DialogControlBinding.prototype.constructor=DialogControlBinding,DialogControlBinding.superclass=ControlBinding.prototype,DialogControlBinding.CLASSNAME="dialogcontrol",DialogControlBinding.prototype.toString=function(){return"[DialogControlBinding]"},DialogControlBinding.prototype.onBindingRegister=function(){DialogControlBinding.superclass.onBindingRegister.call(this),this.attachClassName(DialogControlBinding.CLASSNAME)},DialogControlBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:control",a);return UserInterface.registerBinding(b,DialogControlBinding)},DialogTitleBarPopupBinding.prototype=new PopupBinding,DialogTitleBarPopupBinding.prototype.constructor=DialogTitleBarPopupBinding,DialogTitleBarPopupBinding.superclass=PopupBinding.prototype,DialogTitleBarPopupBinding.CMD_RESTORE="restore",DialogTitleBarPopupBinding.CMD_MINIMIZE="minimize",DialogTitleBarPopupBinding.CMD_MAXIMIZE="maximize",DialogTitleBarPopupBinding.CMD_REFRESH="refreshview",DialogTitleBarPopupBinding.CMD_CLOSE="closedialog",DialogTitleBarPopupBinding.CMD_VIEWSOURCE="viewsource",DialogTitleBarPopupBinding.CMD_VIEWGENERATED="viewgenerated",DialogTitleBarPopupBinding.CMD_VIEWSERIALIZED="viewserialized",DialogTitleBarPopupBinding.prototype.toString=function(){return"[DialogTitleBarPopupBinding]"},DialogTitleBarPopupBinding.prototype.onBindingAttach=function(){DialogTitleBarPopupBinding.superclass.onBindingAttach.call(this),this._indexMenuContent()},WindowBindingHighlightNodeCrawler.prototype=new NodeCrawler,WindowBindingHighlightNodeCrawler.prototype.constructor=WindowBindingHighlightNodeCrawler,WindowBindingHighlightNodeCrawler.superclass=NodeCrawler.prototype,WindowBindingHighlightNodeCrawler.CLASSNAME_HIGHLIGHT="compositec1generatedhighlight",WindowBindingHighlightNodeCrawler.prototype._construct=function(){ElementCrawler.superclass._construct.call(this),this.addFilter(function(a,b){var c=null;if(a.nodeType==Node.ELEMENT_NODE){var d=a.nodeName.toLowerCase();switch(d){case"script":case"style":case"textarea":c=NodeCrawler.SKIP_NODE+NodeCrawler.SKIP_CHILDREN}}return c});var a=this;this.addFilter(function(b,c){if(b.nodeType==Node.TEXT_NODE){var d=b.nodeValue.toLowerCase();a._map.each(function(c,e){var f=!0;return e.test(d)&&(a._textnodes.add(b),f=!1),f})}})},WindowBindingHighlightNodeCrawler.prototype.crawl=function(a,b){this._textnodes=new List,WindowBindingHighlightNodeCrawler.superclass.crawl.call(this,a,b)},WindowBindingHighlightNodeCrawler.prototype.setKeys=function(a){for(a.reset(),this._map.empty();a.hasNext();){var b=a.getNext(),c=b.toLowerCase().replace(/ /g,"\\W"),d=new RegExp("("+c+")");this._map.set(b,d)}},WindowBindingHighlightNodeCrawler.prototype.onCrawlStop=function(){var a=this;this._textnodes.hasEntries()&&this._textnodes.each(function(b){var c=a.contextDocument.createElement("div"),d=a.contextDocument.createDocumentFragment();for(c.innerHTML=a._getMarkup(b.nodeValue);c.hasChildNodes();)d.appendChild(c.firstChild);b.parentNode.replaceChild(d,b)})},WindowBindingHighlightNodeCrawler.prototype._getMarkup=function(a){function b(a){var g=-1,h=null;if(f._map.each(function(b,c){var d=a.toLowerCase(),e=d.search(c);e>-1&&(g==-1&&(g=e),e<=g&&(g=e,h=b))}),g>-1&&null!=h){var i=a.substring(0,g),j=a.substring(g,g+h.length),k=a.substring(g+h.length,a.length);c+=i+d+j+e,b(k)}else c+=a}var c="",d='<span class="'+WindowBindingHighlightNodeCrawler.CLASSNAME_HIGHLIGHT+'" style="background-color:yellow;color:black;">',e="</span>",f=this;return b(a),c},WindowBindingHighlightNodeCrawler.prototype.reset=function(a){var b=new List(a.getElementsByTagName("span"));b.each(function(b){if(b.className==WindowBindingHighlightNodeCrawler.CLASSNAME_HIGHLIGHT){var c=a.ownerDocument.createTextNode(DOMUtil.getTextContent(b));b.parentNode.replaceChild(c,b)}})},WindowBinding.prototype=new FlexBoxBinding,WindowBinding.prototype.constructor=WindowBinding,WindowBinding.superclass=FlexBoxBinding.prototype,WindowBinding.ACTION_LOADED="window loaded",WindowBinding.ACTION_ONLOAD="alien window loaded",WindowBinding.DEFAULT_URL="${root}/blank.aspx",WindowBinding.DEFAULT_TITLE="Composite.Management.Blank",WindowBinding.POSTBACK_URL="${root}/postback.aspx",WindowBinding.POSTBACK_TITLE="Composite.Management.DefaultPostBack",WindowBinding.getMarkup=function(a){var b=null;if(a.isAttached){var c=a.getContentDocument();null!=c&&(b=Client.isAnyExplorer?c.documentElement.outerHTML:(new XMLSerializer).serializeToString(c))}return b},WindowBinding.highlightKeywords=function(a,b){if(null==WindowBinding._highlightcrawler&&(WindowBinding._highlightcrawler=new WindowBindingHighlightNodeCrawler),a.isAttached){var c=a.getContentDocument();if(null!=c){var d=WindowBinding._highlightcrawler;d.reset(c.body),null!=b&&(d.setKeys(b),d.crawl(c.body))}}},WindowBinding._highlightcrawler=null,WindowBinding.prototype.toString=function(){return"[WindowBinding]"},WindowBinding.prototype.serialize=function(){var a=WindowBinding.superclass.serialize.call(this);return a&&(a.url=this.getURL()),a},WindowBinding.prototype.onBindingRegister=function(){WindowBinding.superclass.onBindingRegister.call(this),this.addActionListener(RootBinding.ACTION_PHASE_3),this.addActionListener(PageBinding.ACTION_INITIALIZED),this.addActionListener(RootBinding.ACTION_ACTIVATED),this.addActionListener(RootBinding.ACTION_DEACTIVATED)},WindowBinding.prototype.onBindingAttach=function(){this.getProperty("native")&&(this._native=this.getProperty("native")),this.buildDOMContent(),WindowBinding.superclass.onBindingAttach.call(this),
this.setURL(this.getURL())},WindowBinding.prototype.onBindingDispose=function(){WindowBinding.superclass.onBindingDispose.call(this),this._disposeContentDocument()},WindowBinding.prototype._disposeContentDocument=function(){if(null!=this._pageBinding){var a=this.getContentWindow();if(null!=a){var b=this.getContentWindow().DocumentManager;null!=b&&(b.detachAllBindings(),this._pageBinding=null)}}},WindowBinding.prototype.handleAction=function(a){WindowBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case RootBinding.ACTION_PHASE_3:b.bindingDocument==this.getContentDocument()&&(1==this._isReloading&&(this._isReloading=!1,1==Client.isPrism&&Prism.enableCache()),this.dispatchAction(WindowBinding.ACTION_LOADED));break;case PageBinding.ACTION_INITIALIZED:this._onPageInitialize(b);break;case RootBinding.ACTION_ACTIVATED:case RootBinding.ACTION_DEACTIVATED:a.consume()}},WindowBinding.prototype.fit=function(a){this.isFit&&!a||null!=this._pageBinding&&(this.setHeight(this._pageBinding.getHeight()),this.isFit=!0)},WindowBinding.prototype._onPageInitialize=function(a){null==this._pageBinding&&a.bindingWindow==this.getContentWindow()&&(this._pageBinding=a)},WindowBinding.prototype.buildDOMContent=function(){this.shadowTree.iframe=DOMUtil.createElementNS(Constants.NS_XHTML,"iframe",this.bindingDocument),this.shadowTree.iframe.setAttribute("frameborder","0"),this.shadowTree.iframe.frameBorder=0,this.shadowTree.iframe.id=KeyMaster.getUniqueKey(),this.shadowTree.iframe.name=this.shadowTree.iframe.id,this.bindingElement.appendChild(this.shadowTree.iframe),this._registerOnloadListener(!0)},WindowBinding.prototype._registerOnloadListener=function(a){var b=this.shadowTree.iframe,c=a?"addEventListener":"removeEventListener";if(null==this._onloadHandler){var d=this;this._onloadHandler={handleEvent:function(a){var c=!0;Client.isExplorer&&(c="complete"==b.readyState),1==c&&d.getURL()!=WindowBinding.DEFAULT_URL&&(d._hasLoadActionFired||d.onWindowLoaded(d.getContentWindow()))}}}DOMEvents[c](this.shadowTree.iframe,1==Client.isExplorer?"readystatechange":DOMEvents.LOAD,this._onloadHandler)},WindowBinding.prototype._registerUnloadListener=function(a){var b=a?"addEventListener":"removeEventListener";if(null==this._unloadHandler){var c=this;this._unloadHandler={handleEvent:function(){c._disposeContentDocument(),c._hasLoadActionFired=!1}}}DOMEvents[b](this.getContentWindow(),DOMEvents.UNLOAD,this._unloadHandler)},WindowBinding.prototype.onWindowLoaded=function(a){null==a?this.logger.error("WindowBinding#onWindowLoaded: Bad argument: "+this.getURL()):this.getURL()!=WindowBinding.DEFAULT_URL&&!this._hasLoadActionFired&&this.hasAccess(a)&&(null!=a&&null!=a.document&&null!=a.document.body&&(a.document.body.style.border="none",void 0!=a.WindowManager||this._native||Application.framework(a.document),1==this._isReloading&&(this._isReloading=!1,Client.isPrism&&Prism.enableCache())),this._registerUnloadListener(!0),this.dispatchAction(WindowBinding.ACTION_ONLOAD),this._hasLoadActionFired=!0,this.fitContentWindow())},WindowBinding.prototype.setURL=function(a,b){if(this.setProperty("url",a),this._hasLoadActionFired=!1,1==this.isAttached){if(this._disposeContentDocument(),a.length>1900){var c=new Uri(Resolver.resolve(a));b||(b=new Map),c.getQueryString().each(function(a,d){d.length>512&&(b.set(a,d),c.setParam(a,null))}),a=c.toString()}if(b){var d=this,e=this.getFrameElement();"undefined"==typeof this.shadowTree.form&&(this.shadowTree.form=DOMUtil.createElementNS(Constants.NS_XHTML,"form",this.bindingDocument),this.shadowTree.form.style.display="none",this.shadowTree.form.enctype="application/x-www-form-urlencoded",this.shadowTree.form.method="POST",this.bindingElement.appendChild(this.shadowTree.form));var f=this.shadowTree.form;for(f.action=a,f.target=e.id,f.setAttribute("target",e.id);f.firstChild;)f.removeChild(f.firstChild);b.each(function(a,b){var c=d.bindingDocument.createElement("input");c.name=a,c.value=b,c.type="hidden",f.appendChild(c)}),f.submit()}else this.getFrameElement().src=Resolver.resolve(a)}},WindowBinding.prototype.getURL=function(){var a=WindowBinding.DEFAULT_URL,b=this.getProperty("url");return b&&(a=b),a},WindowBinding.prototype.reload=function(a){this._disposeContentDocument(),Client.isPrism&&Prism.disableCache(),this._isReloading=!0,this.getContentDocument().location.reload()},WindowBinding.prototype.getFrameElement=function(){var a=null;return null!=this.shadowTree.iframe&&(a=this.shadowTree.iframe),a},WindowBinding.prototype.hasAccess=function(a){var b=!1;if(a)try{b=null!=a.document}catch(a){}return b},WindowBinding.prototype.getContentWindow=function(){var a=null,b=this.getFrameElement();if(null!==b)try{a=b.contentWindow}catch(a){this.logger.error("WindowBinding#getContentWindow: strange IE9 error")}return a},WindowBinding.prototype.getContentDocument=function(){var a=null,b=this.getContentWindow();return this.hasAccess(b)&&(a=b.document),a},WindowBinding.prototype.getRootBinding=function(){var a=null,b=this.getContentDocument();return b&&b.body&&(a=UserInterface.getBinding(b.body)),a},WindowBinding.prototype.getPageBinding=function(){return this._pageBinding},WindowBinding.prototype.setHeight=function(a){this.bindingElement.style.height=a+"px"},WindowBinding.prototype.hide=function(){1==this.isVisible&&(this.bindingElement.style.visibility="hidden",this.isVisible=!1)},WindowBinding.prototype.show=function(){this.isVisible||(this.bindingElement.style.visibility="visible",this.isVisible=!0)},WindowBinding.prototype.handleCrawler=function(a){if(WindowBinding.superclass.handleCrawler.call(this,a),a.type==NodeCrawler.TYPE_DESCENDING){var b=this.getRootBinding();null!=b?a.nextNode=b.bindingElement:a.response=NodeCrawler.SKIP_CHILDREN}},WindowBinding.prototype.post=function(a,b){var c=this.getContentWindow();if(!c.isPostBackDocument)throw"Post aborted";c.submit(a,b)},WindowBinding.prototype.flex=function(){this.fitContentWindow(),WindowBinding.superclass.flex.call(this)},WindowBinding.prototype.fitContentWindow=function(){if(Client.isPad){var a=this.getContentWindow();null!=a&&null!=a.document&&null!=a.document.body&&(this.bindingElement.offsetHeight&&(a.document.body.style.height=this.bindingElement.offsetHeight+"px"),this.bindingElement.offsetWidth&&(a.document.body.style.width=this.bindingElement.offsetWidth+"px"))}},WindowBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:window",a),c=UserInterface.registerBinding(b,WindowBinding);return c},PreviewWindowBinding.prototype=new WindowBinding,PreviewWindowBinding.prototype.constructor=PreviewWindowBinding,PreviewWindowBinding.superclass=WindowBinding.prototype,PreviewWindowBinding.URL_FULL_STOP="${root}/content/misc/preview/stop.aspx",PreviewWindowBinding.URL_ERROR="${root}/content/misc/preview/error.aspx",PreviewWindowBinding.ACTION_RETURN="return",PreviewWindowBinding.TIMEOUT_RETURN=parseInt(2300),PreviewWindowBinding.prototype.toString=function(){return"[PreviewWindowBinding]"},PreviewWindowBinding.prototype.onBindingAttach=function(){PreviewWindowBinding.superclass.onBindingAttach.call(this),this.bindingElement.style.backgroundColor="white",this._coverBinding=this.add(CoverBinding.newInstance(this.bindingDocument)),this._coverBinding.attach()},PreviewWindowBinding.prototype.onWindowLoaded=function(a){if(this.getURL()!=WindowBinding.DEFAULT_URL)if(this.hasAccess(a)){if(!this._hasFullStop&&(a.isPostBackDocument?this._isReturning&&(a.submit(this._postBackList,this._postBackURL),this._isReturning=!1):this._coverBinding.hide(),!a.isDefaultDocument)){var b=this;this._loadhandler={handleEvent:function(c){a.isPostBackDocument?(b._postBackList=a.postBackList,b._postBackURL=a.postBackURL):a.isDefaultDocument||b._fullStop()}},DOMEvents.addEventListener(a,DOMEvents.BEFOREUNLOAD,this._loadhandler)}}else this._coverBinding.hide();PreviewWindowBinding.superclass.onWindowLoaded.call(this,a)},PreviewWindowBinding.prototype._fullStop=function(){this._coverBinding.show(),null==this._windowBinding?(this._windowBinding=this._getWindowBinding(),this._windowBinding.setURL(PreviewWindowBinding.URL_FULL_STOP),this._windowBinding.hide(),this._windowBinding.attach(),this._windowBinding.addActionListener(WindowBinding.ACTION_LOADED,{handleAction:function(a){a.target.show(),a.consume()}})):this._windowBinding.show(),this._hasFullStop=!0,this.addActionListener(PreviewWindowBinding.ACTION_RETURN),this.setURL(WindowBinding.DEFAULT_URL);var a=this;this._timeout=setTimeout(function(){a._return()},PreviewWindowBinding.TIMEOUT_RETURN)},PreviewWindowBinding.prototype.error=function(){this._coverBinding.show(),null==this._errorBinding?(this._errorBinding=this._getWindowBinding(),this._errorBinding.setURL(PreviewWindowBinding.URL_ERROR),this._errorBinding.hide(),this._errorBinding.attach(),this._errorBinding.addActionListener(WindowBinding.ACTION_LOADED,{handleAction:function(a){a.target.show(),a.consume()}})):this._errorBinding.show(),this._hasError=!0,this.setURL(WindowBinding.DEFAULT_URL)},PreviewWindowBinding.prototype._getWindowBinding=function(){var a=this._coverBinding.add(WindowBinding.newInstance(this.bindingDocument));return a.isFlexible=!1,a.bindingElement.style.position="absolute",a.bindingElement.style.width="100%",a.bindingElement.style.height="100%",a},PreviewWindowBinding.prototype.handleAction=function(a){switch(PreviewWindowBinding.superclass.handleAction.call(this,a),a.type){case PreviewWindowBinding.ACTION_RETURN:this._return()}},PreviewWindowBinding.prototype._return=function(){clearTimeout(this._timeout),this._timeout=null,this.removeActionListener(PreviewWindowBinding.ACTION_RETURN),this._windowBinding.hide(),this._hasFullStop=!1,this._isReturning=!0,this.setURL(WindowBinding.POSTBACK_URL)},PreviewWindowBinding.prototype.reset=function(){if(null!=this._timeout&&(clearTimeout(this._timeout),this._timeout=null),null!=this._errorBinding&&this._errorBinding.isVisible&&this._errorBinding.hide(),null!=this._windowBinding&&this._windowBinding.isVisible&&this._windowBinding.hide(),null!=this._loadhandler&&this.getURL()!=WindowBinding.DEFAULT_URL){var a=this.getContentWindow();this.hasAccess(a)&&DOMEvents.removeEventListener(a,DOMEvents.BEFOREUNLOAD,this._loadhandler),this._loadhandler=null}this._hasError=!1,this._hasFullStop=!1,this._isReturning=!1,this.setURL(WindowBinding.DEFAULT_URL)},RadioGroupBinding.prototype=new Binding,RadioGroupBinding.prototype.constructor=RadioGroupBinding,RadioGroupBinding.superclass=Binding.prototype,RadioGroupBinding.ACTION_SELECTIONCHANGED="radiogroupselectionchanged";RadioGroupBinding.prototype.toString=function(){return"[RadioGroupBinding]"};RadioGroupBinding.prototype.onBindingRegister=function(){RadioGroupBinding.superclass.onBindingRegister.call(this),this.addActionListener(ButtonBinding.ACTION_RADIOBUTTON_ATTACHED,this),this.addActionListener(ButtonBinding.ACTION_COMMAND,this)},RadioGroupBinding.prototype.onBindingInitialize=function(){var a=null;this._getRadioButtonBindings().each(function(b){return!b.getProperty("ischecked")||(a=b,!1)}),a&&(this._checkedRadioBinding=a),RadioGroupBinding.superclass.onBindingInitialize.call(this)},RadioGroupBinding.prototype.handleAction=function(a){RadioGroupBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case ButtonBinding.ACTION_RADIOBUTTON_ATTACHED:this._isUpToDate=!1,a.consume();break;case ButtonBinding.ACTION_COMMAND:b.isRadioButton&&!b.isDisabled&&(this._checkedRadioBinding&&this._unCheckRadioBindingsExcept(b),this._checkedRadioBinding=b,this.dispatchAction(RadioGroupBinding.ACTION_SELECTIONCHANGED),a.consume())}},RadioGroupBinding.prototype.setCheckedButtonBinding=function(a,b){if(a instanceof RadioDataBinding&&(a=a.getButton()),a.isRadioButton)switch(b){case!0:this._unCheckRadioBindingsExcept(a),this._checkedRadioBinding=a,a.check(!0);break;default:a.check()}},RadioGroupBinding.prototype.getCheckedButtonBinding=function(){return this._checkedRadioBinding},RadioGroupBinding.prototype._unCheckRadioBindingsExcept=function(a){var b=this._getRadioButtonBindings();b.each(function(b){b.isChecked&&b!=a&&b.uncheck(!0)})},RadioGroupBinding.prototype._getRadioButtonBindings=function(){if(null===this._radioButtonBindings||!this._isUpToDate){var a=new Crawler,b=new List;a.addFilter(function(a){var c=!0,d=UserInterface.getBinding(a);return d instanceof RadioGroupBinding?c=NodeCrawler.SKIP_CHILDREN:d instanceof ButtonBinding&&d.isRadioButton&&b.add(d),c}),a.crawl(this.bindingElement),this._radioButtonBindings=b}return this._radioButtonBindings},RadioGroupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:radiogroup",a);return UserInterface.registerBinding(b,RadioGroupBinding)},DataBindingMap.prototype=new Map,DataBindingMap.prototype.constructor=DataBindingMap,DataBindingMap.superclass=Map.prototype,DataBindingMap.TYPE_VALUE="databindingmap valuetype",DataBindingMap.TYPE_RESULT="databindingmap resulttype",DataInputBinding.prototype=new DataBinding,DataInputBinding.prototype.constructor=DataInputBinding,DataInputBinding.superclass=DataBinding.prototype,DataInputBinding.prototype.toString=function(){return"[DataInputBinding]"},DataInputBinding.prototype.onBindingRegister=function(){DataInputBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.value=this.setValue},DataInputBinding.prototype.onBindingAttach=function(){DataInputBinding.superclass.onBindingAttach.call(this),this._parseDOMProperties(),this._buildDOMContent(),this._attachDOMEvents()},DataInputBinding.prototype.onBindingDispose=function(){DataInputBinding.superclass.onBindingDispose.call(this),this._dirtyinterval&&window.clearInterval(this._dirtyinterval),this._isValid||this.dispatchAction(Binding.ACTION_VALID)},DataInputBinding.prototype._parseDOMProperties=function(){this.type=this.getProperty("type"),this.isRequired=this.getProperty("required"),this.isPassword=1==this.getProperty("password"),this.minlength=this.getProperty("minlength"),this.maxlength=this.getProperty("maxlength"),this._isAutoPost=1==this.getProperty("autopost"),this.spellcheck=this.getProperty("spellcheck")!==!1,"programmingidentifier"==this.type&&(this.spellcheck=!1),"programmingnamespace"==this.type&&(this.spellcheck=!1);var a=this.getProperty("regexrule");null!=a&&(this.expression=new RegExp(a));var b=this.getProperty("onbindingblur");null!=b&&(this.onblur=function(){Binding.evaluate(b,this)});var c=this.getProperty("onvaluechange");if(null!=c&&(this.onValueChange=function(){Binding.evaluate(c,this)}),null==this.error&&null!=this.type){var d=DataBinding.errors[this.type];null!=d&&(this.error=d)}},DataInputBinding.prototype._buildDOMContent=function(){this.shadowTree.input=this._getInputElement(),this.shadowTree.box=DOMUtil.createElementNS(Constants.NS_UI,"ui:box",this.bindingDocument),1==Client.isExplorer&&(this.bindingElement.hideFocus=!0);var a=this.getProperty("value");null!=a&&this.setValue(String(a));var b=this.getProperty("name");null!=b&&this.setName(b);var c=this.getProperty("isdisabled");1==c&&this.setDisabled(!0);var d=this.getProperty("readonly");1==d&&this.setReadOnly(!0);var e=this.getProperty("autoselect");1==e&&(this._isAutoSelect=!0),this.shadowTree.box.appendChild(this.shadowTree.input),this.bindingElement.appendChild(this.shadowTree.box);var f=this.getProperty("placeholder");if(f&&this.shadowTree.input.setAttribute("placeholder",Resolver.resolve(f)),this.spellcheck&&Client.hasSpellcheck){var g=Localization.currentLang(),h=null;null!=this.shadowTree.input.parentNode&&null!=this.shadowTree.input.parentNode.parentElement&&(h=this.shadowTree.input.parentNode.parentElement.getAttribute("lang")),null!=h?(this.shadowTree.input.setAttribute("spellcheck","true"),this.shadowTree.input.setAttribute("lang",h)):null!=g?(this.shadowTree.input.setAttribute("spellcheck","true"),this.shadowTree.input.setAttribute("lang",Localization.currentLang())):this.shadowTree.input.setAttribute("spellcheck","false")}else this.shadowTree.input.setAttribute("spellcheck","false");Localization.isRtl!==Localization.isUIRtl&&this.shadowTree.input.setAttribute("dir",Localization.isRtl?"rtl":"ltr"),this.hasCallBackID()||this._isAutoPost&&this.logger.warn("Autopost "+this.toString()+" without a callbackid?")},DataInputBinding.prototype._getInputElement=function(){var a=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);return a.type=1==this.isPassword?"password":"text",a.tabIndex=-1,a},DataInputBinding.prototype._attachDOMEvents=function(){DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.FOCUS,this),DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.BLUR,this),DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.KEYDOWN,this),DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.KEYPRESS,this),DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.DRAGOVER,this),DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.DROP,this)},DataInputBinding.prototype.handleEvent=function(a){if(DataInputBinding.superclass.handleEvent.call(this,a),1==this.isFocusable)switch(a.type){case DOMEvents.DRAGOVER:DOMEvents.preventDefault(a);break;case DOMEvents.DROP:a.dataTransfer&&(this.setValue(a.dataTransfer.getData("Text")),this.checkDirty(),this.validate(!0)),DOMEvents.preventDefault(a);break;case DOMEvents.FOCUS:case DOMEvents.BLUR:this._handleFocusAndBlur(a.type==DOMEvents.FOCUS);break;case DOMEvents.KEYPRESS:switch(a.keyCode){case KeyEventCodes.VK_BACK:case KeyEventCodes.VK_INSERT:case KeyEventCodes.VK_DELETE:this._testDirty()}break;case DOMEvents.KEYDOWN:switch(this._testDirty(),a.keyCode){case KeyEventCodes.VK_ENTER:this._handleEnterKey(a);break;case KeyEventCodes.VK_ESCAPE:DOMEvents.preventDefault(a)}if(this.isFocusable&&this._isAutoPost){null!=this._timeout&&top.window.clearTimeout(this._timeout);var b=this;this._timeout=top.window.setTimeout(function(){Binding.exists(b)&&b.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},this._time)}}},DataInputBinding.prototype._handleFocusAndBlur=function(a){a?(this.focus(!0),this.bindingWindow.standardEventHandler.enableNativeKeys()):(this.blur(!0),this.bindingWindow.standardEventHandler.disableNativeKeys())},DataInputBinding.prototype._handleEnterKey=function(a){DOMEvents.preventDefault(a),DOMEvents.stopPropagation(a),EventBroadcaster.broadcast(BroadcastMessages.KEY_ENTER)},DataInputBinding.prototype.focus=function(a){if(!this.isFocused&&!this.isReadOnly&&!this.isDisabled&&(DataInputBinding.superclass.focus.call(this),1==this.isFocused)){if(this._focus(),1==this._isAutoSelect)if(a){var b=this,c=this.bindingElement,d={handleEvent:function(){b.select(),DOMEvents.removeEventListener(c,DOMEvents.MOUSEUP,this)}};DOMEvents.addEventListener(c,DOMEvents.MOUSEUP,d)}else this.select();if(this.onfocus(),!a){var e=this.shadowTree.input;setTimeout(function(){FocusBinding.focusElement(e)},0)}}},DataInputBinding.prototype.select=function(){var a=this.shadowTree.input;setTimeout(function(){if(1==Client.isExplorer){var b=a.createTextRange();b.moveStart("character",0),b.moveEnd("character",a.value.length),b.select()}else a.setSelectionRange(0,a.value.length)},0)},DataInputBinding.prototype.blur=function(a){1==this.isFocused&&(DataInputBinding.superclass.blur.call(this),a||this.shadowTree.input.blur(),this._blur())},DataInputBinding.prototype._focus=function(){this._isValid||(this.isPassword?Client.isMozilla&&(this.shadowTree.input.type="password",this.setValue(this._value)):this.setValue(this._value),this.shadowTree.input.className=""),this._sessionResult=this.getResult();var a=this;this._dirtyinterval=window.setInterval(function(){1==Binding.exists(a)?(a.checkDirty(),a._isValid||a.validate(!0)):(window.clearInterval(a._dirtyinterval),a._dirtyinterval=null)},500)},DataInputBinding.prototype._blur=function(){this._dirtyinterval&&(window.clearInterval(this._dirtyinterval),this._dirtyinterval=null),this.checkDirty(),this._isValid=!0,this._normalizeToValid(),this.validate(!0),Types.isFunction(this.onblur)&&this.onblur(),this._isValid&&this.getResult()!=this._sessionResult&&this.onValueChange()},DataInputBinding.prototype.onfocus=function(){},DataInputBinding.prototype.onblur=function(){},DataInputBinding.prototype.checkDirty=function(){this.isDirty||this.getResult()!=this._sessionResult&&this.dirty()},DataInputBinding.prototype._testDirty=function(){var a=this.getValue(),b=this;setTimeout(function(){Binding.exists(b)&&b.getValue()!=a&&b.dirty()},0)},DataInputBinding.prototype.onValueChange=function(){},DataInputBinding.prototype.validate=function(a){if(1==a||this._isValid){var b=this.isValid();if(b!=this._isValid)if(this._isValid=b,b)this._normalizeToValid();else if(this.attachClassName(DataBinding.CLASSNAME_INVALID),this._value=this.getValue(),this.dispatchAction(Binding.ACTION_INVALID),!this.isFocused){var c=null;1==this._isInvalidBecauseRequired?c=DataBinding.warnings.required:1==this._isInvalidBecauseMinLength?(c=DataBinding.warnings.minlength,c=c.replace("{0}",String(this.minlength))):1==this._isInvalidBecauseMaxLength?(c=DataBinding.warnings.maxlength,c=c.replace("{0}",String(this.maxlength))):c=DataBinding.warnings[this.type],this.shadowTree.input.className=DataBinding.CLASSNAME_WARNING,null!=c&&(this.isPassword?Client.isMozilla&&(this.shadowTree.input.type="text",this.setValue(c)):this.setValue(c))}}return this._isValid},DataInputBinding.prototype._normalizeToValid=function(){this._isValid&&(this.hasClassName(DataBinding.CLASSNAME_INVALID)&&this.detachClassName(DataBinding.CLASSNAME_INVALID),this.shadowTree.input.className="",this.dispatchAction(Binding.ACTION_VALID))},DataInputBinding.prototype.isValid=function(){var a=!0;this._isInvalidBecauseRequired=!1,this._isInvalidBecauseMinLength=!1,this._isInvalidaBecuaseMaxLength=!1;var b=this.getValue();if(""==b)1==this.isRequired&&(a=!1,this._isInvalidBecauseRequired=!0);else if(null!=this.type){var c=DataBinding.expressions[this.type];c.test(b)||(a=!1)}else null!=this.expression&&(this.expression.test(b)||(a=!1));return a&&null!=this.minlength&&b.length<this.minlength&&(this._isInvalidBecauseMinLength=!0,a=!1),a&&null!=this.maxlength&&b.length>this.maxlength&&(this._isInvalidBecauseMaxLength=!0,a=!1),a},DataInputBinding.prototype.setDisabled=function(a){if(a!=this.isDisabled){a?this.attachClassName("isdisabled"):this.detachClassName("isdisabled");var b=this.shadowTree.input;a?(this._disabledHandler={handleEvent:function(a){DOMEvents.preventDefault(a),DOMEvents.stopPropagation(a)}},DOMEvents.addEventListener(b,DOMEvents.MOUSEDOWN,this._disabledHandler)):(DOMEvents.removeEventListener(b,DOMEvents.MOUSEDOWN,this._disabledHandler),this._disabledHandler=null),Client.isExplorer&&(this.shadowTree.input.disabled=a,this.shadowTree.input.unselectable=a?"on":"off"),this.isDisabled=a,this.isFocusable=!a,this.dispatchAction(FocusBinding.ACTION_UPDATE)}},DataInputBinding.prototype.setReadOnly=function(a){a!=this.isReadOnly&&(a?this.attachClassName("readonly"):this.detachClassName("readonly"),this.shadowTree.input&&(this.shadowTree.input.readOnly=a),this.isReadOnly=a)},DataInputBinding.prototype.disable=function(){this.isDisabled||this.setDisabled(!0)},DataInputBinding.prototype.enable=function(){this.isDisabled&&this.setDisabled(!1)},DataInputBinding.prototype.handleElement=function(a){return!0},DataInputBinding.prototype.updateElement=function(a){var b=a.getAttribute("value"),c=a.getAttribute("type"),d=a.getAttribute("maxlength"),e=a.getAttribute("minlength"),f="true"===a.getAttribute("required"),g="true"===a.getAttribute("readonly");null==b&&(b=""),this.isReadOnly!=g&&this.setReadOnly(g);var h=this.bindingWindow.UpdateManager;return this.getValue()!=b&&(h.report('Property [value] updated on binding "'+this.getID()+'"'),this.setValue(b)),this.type!=c&&(h.report('Property [type] updated on binding "'+this.getID()+'"'),this.type=c),this.maxlength!=d&&(h.report('Property [maxlength] updated on binding "'+this.getID()+'"'),this.maxlength=d),this.minlength!=e&&(h.report('Property [minlength] updated on binding "'+this.getID()+'"'),this.minlength=e),this.isRequired!=f&&(h.report('Property [required] updated on binding "'+this.getID()+'"'),this.isRequired=f),!0},DataInputBinding.prototype.manifest=function(){null!=this._timeout&&top.window.clearTimeout(this._timeout),this._isValid||(this.setValue(""),this._isValid=!0,this._normalizeToValid())},DataInputBinding.prototype.clean=function(){DataInputBinding.superclass.clean.call(this),this._sessionResult=this.getResult()},DataInputBinding.prototype.setValue=function(a){null===a&&(a=""),a!=this.getValue()&&(this.setProperty("value",a),null!=this.shadowTree.input&&(this.shadowTree.input.value=String(a)))},DataInputBinding.prototype.getValue=function(){var a=null;return a=null!=this.shadowTree.input?this.shadowTree.input.value:this.getProperty("value")},DataInputBinding.prototype.setName=function(a){DataInputBinding.superclass.setName.call(this,a),1==this.isAttached&&(this.shadowTree.input.name=a)},DataInputBinding.prototype.getResult=function(){var a=this.getValue();switch(this.type){case DataBinding.TYPE_NUMBER:case DataBinding.TYPE_INTEGER:a=Number(a)}return a},DataInputBinding.prototype.setResult=DataInputBinding.prototype.setValue,DataInputBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:datainput",a);return UserInterface.registerBinding(b,DataInputBinding)},TextBoxBinding.prototype=new DataInputBinding,TextBoxBinding.prototype.constructor=TextBoxBinding,TextBoxBinding.superclass=DataInputBinding.prototype,TextBoxBinding.prototype.toString=function(){return"[TextBoxBinding]"},TextBoxBinding.prototype._buildDOMContent=function(){var a=DOMUtil.getElementsByTagName(this.bindingElement,"textarea").item(0);null!=a&&(this.setValue(a.value),a.parentNode.removeChild(a)),TextBoxBinding.superclass._buildDOMContent.call(this),this._hasWordWrap||this.shadowTree.input.setAttribute("wrap","off")},TextBoxBinding.prototype._getInputElement=function(){var a;if(Client.isExplorer||Client.isExplorer11){var b=this.bindingDocument.createElement("div");b.innerHTML="<textarea></textarea>",a=b.firstChild}else a=DOMUtil.createElementNS(Constants.NS_XHTML,"textarea",this.bindingDocument);return a.tabIndex=-1,a},TextBoxBinding.prototype.handleElement=function(a){return!0},TextBoxBinding.prototype.updateElement=function(a){var b,c=a.getElementsByTagName("textarea").item(0);null!=c&&c.hasChildNodes()&&(b=DOMUtil.getTextContent(c)),null==b&&(b="");var d=this.bindingWindow.UpdateManager;this.getValue()!=b&&(d.report('Property [value] updated on binding "'+this.getID()+'"'),this.setValue(b));var e=a.getAttribute("type");return this.type!=e&&(d.report('Property [type] updated on binding "'+this.getID()+'"'),this.type=e),!0},TextBoxBinding.prototype._handleEnterKey=function(a){DOMEvents.stopPropagation(a)},EditorTextBoxBinding.prototype=new TextBoxBinding,EditorTextBoxBinding.prototype.constructor=EditorTextBoxBinding,EditorTextBoxBinding.superclass=TextBoxBinding.prototype,EditorTextBoxBinding.prototype.toString=function(){return"[EditorTextBoxBinding]"},EditorTextBoxBinding.prototype.handleEvent=function(a){if(1==this.isFocusable)switch(a.type){case DOMEvents.FOCUS:case DOMEvents.BLUR:this._handleFocusAndBlur(a.type==DOMEvents.FOCUS);break;case DOMEvents.KEYDOWN:this._handleKeyEvent(a)}},EditorTextBoxBinding.prototype._handleKeyEvent=function(a){switch(a.keyCode){case KeyEventCodes.VK_TAB:this._handleTabKey(a.shiftKey),DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a);break;case KeyEventCodes.VK_ENTER:this._handleEnterKey(),DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a);break;case KeyEventCodes.VK_ESCAPE:DOMEvents.preventDefault(a)}},EditorTextBoxBinding.prototype._handleTabKey=Binding.ABSTRACT_METHOD,EditorTextBoxBinding.prototype._handleEnterKey=Binding.ABSTRACT_METHOD,IEEditorTextBoxBinding.prototype=new EditorTextBoxBinding,IEEditorTextBoxBinding.prototype.constructor=IEEditorTextBoxBinding,IEEditorTextBoxBinding.superclass=EditorTextBoxBinding.prototype,IEEditorTextBoxBinding.prototype.toString=function(){return"[IEEditorTextBoxBinding]"},IEEditorTextBoxBinding.prototype._handleTabKey=function(a){var b=this.bindingDocument.selection.createRange(),c=""==b.text;if(c&&!a)b.text="\t";else{for(var d="",e=b.text.length;b.moveStart("word",-1)&&"\n"!=b.text.charAt(1););b.moveStart("character",1);for(var f,g=0,h=0,i=b.text.split("\n");null!=(f=i[h++]);)a?(f=f.replace(/^(\s)/gm,""),g++):f=f.replace(/^(.)/gm,"\t$1"),d+=f+(i[h+1]?"\n":"");b.text=d,b.moveStart("character",-e),a&&b.moveStart("character",2*i.length-2),b.select()}},IEEditorTextBoxBinding.prototype._handleEnterKey=function(){for(var a=this.bindingDocument.selection.createRange(),b=a.duplicate();b.moveStart("word",-1)&&b.text.indexOf("\n")==-1;);b.moveStart("character",1),a.text="\n"+b.text.match(/^(\s)*/)[0]+"!",a.moveStart("character",-1),a.select(),a.text="",a.select()},MozEditorTextBoxBinding.prototype=new EditorTextBoxBinding,MozEditorTextBoxBinding.prototype.constructor=MozEditorTextBoxBinding,MozEditorTextBoxBinding.superclass=EditorTextBoxBinding.prototype,MozEditorTextBoxBinding.prototype.toString=function(){return"[MozEditorTextBoxBinding]"},MozEditorTextBoxBinding.prototype._handleTabKey=function(a){var b,c,d,e,f,g,h=this._getSelectedText(),i=this.shadowTree.input;if(b=i.scrollLeft,c=i.scrollTop,h.match(/\n/)){for(d=i.selectionStart,e=i.selectionEnd,g=0,f=d-1;f>=0;f--)if("\n"==i.value.charAt(f)){d=f+1,g=1;break}for(0==g&&(d=0),g=0,f=e;f<i.value.length;f++)if("\n"==i.value.charAt(f)){e=f,g=1;break}0==g&&(e=i.value.length),i.selectionStart=d,i.selectionEnd=e,h=this._getSelectedText(),a?ntext=h.replace(/^(\s)/gm,""):ntext=h.replace(/^(.)/gm,"\t$1"),i.value=i.value.substr(0,i.selectionStart)+ntext+i.value.substr(i.selectionEnd),i.selectionStart=d,i.selectionEnd=e+(ntext.length-h.length)}else d=i.selectionStart,i.value=i.value.substr(0,i.selectionStart)+"\t"+i.value.substr(i.selectionEnd),i.selectionStart=d+1,i.selectionEnd=d+1;i.scrollLeft=b,i.scrollTop=c},MozEditorTextBoxBinding.prototype._handleEnterKey=function(){var a,b,c,d,e=this.shadowTree.input;a=e.scrollLeft,b=e.scrollTop,c=e.selectionStart,d=e.selectionEnd;var f=e.value.substr(0,e.selectionStart),g=f.split(/\r|\n/g),h=g[g.length-1].match(/^(\s)*/);e.value=e.value.substr(0,e.selectionStart)+"\n"+h[0]+e.value.substr(e.selectionEnd),e.selectionStart=c+1+h[0].length,e.selectionEnd=c+1+h[0].length,e.scrollLeft=a,e.scrollTop=b},MozEditorTextBoxBinding.prototype._getSelectedText=function(){var a=this.shadowTree.input.value,b=this.shadowTree.input.selectionStart,c=this.shadowTree.input.selectionEnd;return a.substr(b,c-b)},SelectorBinding.prototype=new DataBinding,SelectorBinding.prototype.constructor=SelectorBinding,SelectorBinding.superclass=DataBinding.prototype,SelectorBinding.ACTION_SELECTIONCHANGED="selectorselectionchanged",SelectorBinding.ACTION_COMMAND="selectorcommand",SelectorBinding.CLASSNAME_POPUP="selectorpopup",SelectorBinding.prototype.toString=function(){return"[SelectorBinding]"},SelectorBinding.prototype.onBindingAttach=function(){SelectorBinding.superclass.onBindingAttach.call(this),this.selections=new List,this.parseDOMProperties(),this.buildDOMContent(),this.addEventListener(DOMEvents.FOCUS),this.addEventListener(DOMEvents.KEYPRESS),this.addEventListener(DOMEvents.KEYDOWN),this.addActionListener(ButtonBinding.ACTION_COMMAND);var a=this.getProperty("isdisabled");(this.isDisabled||a)&&this.disable()},SelectorBinding.prototype.onBindingDispose=function(){SelectorBinding.superclass.onBindingDispose.call(this),this._popupBinding&&Binding.exists(this._popupBinding)&&this._popupBinding.dispose(),1==this._hasKeyboard&&this._releaseKeyboard()},SelectorBinding.prototype.parseDOMProperties=function(){var a=this.getProperty("type"),b=this.getProperty("label"),c=this.getProperty("value"),d=this.getProperty("width"),e=this.getProperty("onchange"),f=1==this.getProperty("required"),g=this.getProperty("local");!this.type&&a&&(this.type=a),this.label||null==b||(this.label=b),this.value||null==c||(this.value=c),
!this.width&&d&&(this.width=d),f&&(this.isRequired=!0),g&&(this._isLocal=!0),e&&(this.onValueChange=function(){Binding.evaluate(e,this)}),this._computeImageProfile()},SelectorBinding.prototype._computeImageProfile=function(){Binding.imageProfile(this)},SelectorBinding.prototype.buildDOMContent=function(){this.buildButton(),this.buildPopup(),this.buildSelections(),this.bindingElement.tabIndex=0,Client.isExplorer===!0&&(this.bindingElement.hideFocus=!0)},SelectorBinding.prototype.buildFormField=function(){var a=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);a.name=this.getName(),a.value=this.getValue(),a.type="hidden",this.hasCallBackID()&&(a.id=this.getCallBackID()),this.shadowTree.input=a,this.bindingElement.appendChild(a)},SelectorBinding.prototype.buildButton=function(){var a=this.BUTTON_IMPLEMENTATION,b=this.add(a.newInstance(this.bindingDocument));null!=this.imageProfile&&(b.imageProfile=this.imageProfile),null!=this.width&&b.setWidth(this.width),this._buttonBinding=b,this.shadowTree.button=b,b.attach()},SelectorBinding.prototype.buildPopup=function(){var a;if(this._isLocal)if(this.bindingWindow.bindingMap.selectorpopupset)a=this.bindingWindow.bindingMap.selectorpopupset;else{var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:popupset",this.bindingDocument);b.id="selectorpopupset",a=UserInterface.registerBinding(b,PopupSetBinding),this.bindingDocument.body.appendChild(a.bindingElement)}else a=top.app.bindingMap.selectorpopupset;var c=a.bindingDocument,d=a.add(PopupBinding.newInstance(c)),e=this.getProperty("popupclass");e&&d.setProperty("class",e);var f=d.add(MenuBodyBinding.newInstance(c));this._popupBinding=d,this._menuBodyBinding=f,this._popupBinding.attachClassName(SelectorBinding.CLASSNAME_POPUP),this._popupBinding.attachRecursive(),this.getProperty("textonly")===!0&&this._popupBinding.showTextOnly(),this._popupBinding.type=PopupBinding.TYPE_FIXED,d.attachClassName("selectorpopup"),d.addActionListener(PopupBinding.ACTION_SHOW,this),d.addActionListener(MenuItemBinding.ACTION_COMMAND,this),d.addActionListener(PopupBinding.ACTION_HIDE,this),this._buttonBinding.setPopup(d),this._popupBinding.isManaged=!0},SelectorBinding.prototype.buildSelections=function(){null==this.defaultSelection&&(this.label||this.value)&&(this.defaultSelection=new SelectorBindingSelection(this.label,this.value,!0,null));var a=this._getSelectionsList();this.populateFromList(a)},SelectorBinding.prototype._getSelectionsList=function(){var a=new List,b=DOMUtil.getElementsByTagName(this.bindingElement,"selection");return new List(b).each(function(b){var c=b.getAttribute("label"),d=b.getAttribute("value"),e=b.getAttribute("selected"),f=b.getAttribute("image"),g=b.getAttribute("image-hover"),h=b.getAttribute("image-active"),i=b.getAttribute("image-disabled"),j=null;(f||g||h||i)&&(j=new ImageProfile({image:f,imageHover:g,imageActive:h,imageDisabled:i})),a.add(new SelectorBindingSelection(c?c:null,d?d:null,e&&"true"==e,j))}),a},SelectorBinding.prototype.populateFromList=function(a){if(!this.isAttached)throw"Could not populate unattached selector";if(this.clear(),a.hasEntries()){for(var b=null;a.hasNext();){var c=a.getNext(),d=this.addSelection(c);c.isSelected&&this.select(d,!0),b||(b=d)}this._selectedItemBinding||this.select(b,!0)}},SelectorBinding.prototype.addSelection=function(a,b){var c=this.MENUITEM_IMPLEMENTATION,d=this._menuBodyBinding,e=d.bindingDocument,f=c.newInstance(e);return f.imageProfile=a.imageProfile,f.setLabel(a.label),null!=a.tooltip&&f.setToolTip(a.tooltip),f.selectionValue=a.value,a.menuItemBinding=f,b?(d.addFirst(f),this.selections.addFirst(a)):(d.add(f),this.selections.add(a)),this._isUpToDate=!1,f},SelectorBinding.prototype.addSelectionFirst=function(a){return this.addSelection(a,!0)},SelectorBinding.prototype.clear=function(a){if(this._selectedItemBinding=null,this._popupBinding&&(this._popupBinding.clear(),this.selections.clear(),!a&&null!=this.defaultSelection)){var b=this.addSelection(this.defaultSelection);this.select(b,!0)}},SelectorBinding.prototype.clearAll=function(){this.clear(!0)},SelectorBinding.prototype.disable=function(){this.setDisabled(!0)},SelectorBinding.prototype.enable=function(){this.setDisabled(!1)},SelectorBinding.prototype.focus=function(){this.isFocused||(DataBinding.prototype.focus.call(this),1==this.isFocused&&(FocusBinding.focusElement(this.bindingElement),this._grabKeyboard()))},SelectorBinding.prototype.blur=function(){1==this.isFocused&&(DataBinding.prototype.blur.call(this),this._releaseKeyboard(),this._popupBinding.isVisible&&this._popupBinding.hide())},SelectorBinding.prototype._grabKeyboard=function(){this._hasKeyboard||(this.subscribe(BroadcastMessages.KEY_ARROW),this._hasKeyboard=!0)},SelectorBinding.prototype._releaseKeyboard=function(){1==this._hasKeyboard&&(this.unsubscribe(BroadcastMessages.KEY_ARROW),this._hasKeyboard=!1)},SelectorBinding.prototype.setDisabled=function(a){if(1==this.isAttached){var b=this._buttonBinding;b.setDisabled(a)}a?this.setProperty("isdisabled",!0):this.deleteProperty("isdisabled")},SelectorBinding.prototype.reset=function(a){null!=this.defaultSelection&&this.selectByValue(this.defaultSelection.value,a)},SelectorBinding.prototype.handleAction=function(a){switch(SelectorBinding.superclass.handleAction.call(this,a),a.type){case ButtonBinding.ACTION_COMMAND:this._onButtonCommand(),a.consume();break;case PopupBinding.ACTION_SHOW:this._onPopupShowing(),a.consume();break;case MenuItemBinding.ACTION_COMMAND:this._onMenuItemCommand(a.target),a.consume();break;case PopupBinding.ACTION_HIDE:var b=this;setTimeout(function(){b.isFocused&&b._grabKeyboard()},0),this._clearSearchSelection&&this._clearSearchSelection(),a.consume()}},SelectorBinding.prototype._onButtonCommand=function(){this.focus(),this._attachSelections(),this._restoreSelection(),this.dispatchAction(SelectorBinding.ACTION_COMMAND)},SelectorBinding.prototype._onPopupShowing=function(){this._fitMenuToSelector(),this._releaseKeyboard()},SelectorBinding.prototype._onMenuItemCommand=function(a){this.select(a),FocusBinding.focusElement(this.bindingElement),this._grabKeyboard()},SelectorBinding.prototype._restoreSelection=function(){this._selectedItemBinding&&this._selectedItemBinding.focus()},SelectorBinding.prototype._fitMenuToSelector=function(){var a=this._buttonBinding.bindingElement.offsetWidth+"px",b=this._popupBinding.bindingElement;b.style.minWidth=a},SelectorBinding.prototype.handleEvent=function(a){switch(SelectorBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.FOCUS:this.focus();break;case DOMEvents.KEYDOWN:var b=Client.isExplorer?a.keyCode:a.which;8==b&&this._popSearchSelection();break;case DOMEvents.KEYPRESS:var b=Client.isExplorer?a.keyCode:a.which;if(b>=32){this._buttonBinding.check();var c=String.fromCharCode(b);this._pushSearchSelection(c)}}},SelectorBinding.prototype._pushSearchSelection=function(a){this._searchString+=a.toLowerCase(),this._applySearchSelection()},SelectorBinding.prototype._popSearchSelection=function(a){this._searchString=this._searchString.substring(0,this._searchString.length-1),this._applySearchSelection()},SelectorBinding.prototype._clearSearchSelection=function(){null!=this._searchString&&""!=this._searchString&&(this._searchString="",this._applySearchSelection())},SelectorBinding.prototype._applySearchSelection=function(){if(this.isSearchSelectionEnabled){var a=this._menuBodyBinding;if(null!=a){var b=this.MENUITEM_IMPLEMENTATION,c=a.bindingDocument,d=this._getSelectionsList();if(null!=this._searchString&&""!=this._searchString){if(this._popupBinding.clear(),this._buttonBinding.setLabel(this._searchString),d.hasEntries())for(;d.hasNext();){var e=d.getNext();e.label.toLowerCase().indexOf(this._searchString)>-1&&this.addSelection(e)}this._attachSelections();var f=new RegExp(this._searchString.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"gi"),g=a.getDescendantBindingsByType(b);if(g.hasEntries()){for(;g.hasNext();){var h=g.getNext(),i=h.labelBinding;null!=i&&null!=i.shadowTree&&null!=i.shadowTree.labelText&&(i.shadowTree.labelText.innerHTML=i.shadowTree.labelText.innerHTML.replace(f,"<b>$&</b>"))}g.getFirst().focus(),this.attachClassName(DataBinding.CLASSNAME_INFOBOX),this.detachClassName(DataBinding.CLASSNAME_INVALID)}else i=LabelBinding.newInstance(c),i.setLabel(StringBundle.getString("ui","AspNetUiControl.Selector.NoMatchesFor").replace("{0}",this._searchString?this._searchString.replace(/\$/g,"$$$$"):"")),a.add(i),this._attachSelections(),this.detachClassName(DataBinding.CLASSNAME_INFOBOX),this.attachClassName(DataBinding.CLASSNAME_INVALID)}else{if(this._popupBinding.clear(),this._buttonBinding.setLabel(this._selectionLabel),d.hasEntries())for(;d.hasNext();){var e=d.getNext(),j=this.addSelection(e);this._selectionValue==e.value&&(this._selectedItemBinding=j)}this._attachSelections(),this._restoreSelection(),this.detachClassName(DataBinding.CLASSNAME_INFOBOX),this.detachClassName(DataBinding.CLASSNAME_INVALID)}this._bodyBinding instanceof MenuBodyBinding&&this._bodyBinding.refreshMenuGroups(),this._popupBinding._enableTab(!0),this._popupBinding.snapTo(this._buttonBinding.bindingElement),this._popupBinding.fitOnScreen()}}},SelectorBinding.prototype.handleBroadcast=function(a,b){switch(SelectorBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_ARROW:this.logger.debug(this._buttonBinding.getLabel()),this._handleArrowKey(b)}},SelectorBinding.prototype._handleArrowKey=function(a){if(!this._popupBinding.isVisible)switch(a){case KeyEventCodes.VK_DOWN:case KeyEventCodes.VK_UP:this._buttonBinding.check()}},SelectorBinding.prototype.select=function(a,b){var c=!1;if(a!=this._selectedItemBinding){this._selectedItemBinding=a,c=!0;var d=this._buttonBinding;this._selectionValue=a.selectionValue,this._selectionLabel=a.getLabel(),d.setLabel(a.getLabel()),null!=a.imageProfile&&(d.imageProfile=a.imageProfile),null!=d.imageProfile&&d.setImage(1==this.isDisabled?d.imageProfile.getDisabledImage():d.imageProfile.getDefaultImage()),this._updateImageLayout(),b||(this.onValueChange(),this.dispatchAction(SelectorBinding.ACTION_SELECTIONCHANGED),this.dirty()),(!this._isValid||this.isRequired&&!b)&&this.validate()}return c},SelectorBinding.prototype._relate=function(){var a=this.getProperty("relate");if(a){var b=this.bindingDocument.getElementById(a);if(b){var c=UserInterface.getBinding(b);c&&(this.isChecked?c.show():c.hide())}}},SelectorBinding.prototype._updateImageLayout=function(){null==this._buttonBinding.getImage()?1==this._isImageLayout&&(this._buttonBinding.attachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this._isImageLayout=!1):this._isImageLayout||(this._buttonBinding.detachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this._isImageLayout=!0)},SelectorBinding.prototype.onValueChange=function(){},SelectorBinding.prototype.selectByValue=function(a,b){for(var c=!1,d=this._menuBodyBinding,e=d.getDescendantElementsByLocalName("menuitem");e.hasNext();){var f=UserInterface.getBinding(e.getNext());if(f.selectionValue==a){c=this.select(f,b);break}}return c},SelectorBinding.prototype.getValue=function(){var a=this._selectionValue;return null!=a&&(a=String(a)),a},SelectorBinding.prototype.setValue=function(a){this.selectByValue(String(a),!0)},SelectorBinding.prototype.getResult=function(){var a=this._selectionValue;if("null"==a&&(a=null),a)switch(this.type){case DataBinding.TYPE_NUMBER:case DataBinding.TYPE_INTEGER:a=Number(a)}return a},SelectorBinding.prototype.setResult=function(a){this.selectByValue(a,!0)},SelectorBinding.prototype.validate=function(){var a=!0;if(1==this.isRequired&&null!=this.defaultSelection){var b=this.getValue();b==this.defaultSelection.value&&(a=!1),a!=this._isValid&&(a?(this.dispatchAction(Binding.ACTION_VALID),this.detachClassName(DataBinding.CLASSNAME_INVALID)):(this.dispatchAction(Binding.ACTION_INVALID),this.attachClassName(DataBinding.CLASSNAME_INVALID),this._buttonBinding.setLabel(DataBinding.warnings.required))),this._isValid=a}return a},SelectorBinding.prototype.manifest=function(){1==this.isAttached&&(this.getResult()?(this.shadowTree.input||this.buildFormField(),this.shadowTree.input.value=this.getValue()):this.shadowTree.input&&(this.shadowTree.input.parentNode.removeChild(this.shadowTree.input),this.shadowTree.input=null))},SelectorBinding.prototype._attachSelections=function(){var a=this._popupBinding;this._isUpToDate||(a.attachRecursive(),this._isUpToDate=!0)},SelectorBinding.prototype.handleElement=function(){return!0},SelectorBinding.prototype.updateElement=function(a,b){return this.bindingWindow.UpdateManager.addUpdate(new this.bindingWindow.ReplaceUpdate(this.getID(),a)),!0},SelectorBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:selector",a);return UserInterface.registerBinding(b,SelectorBinding)},SimpleSelectorBinding.prototype=new DataBinding,SimpleSelectorBinding.prototype.constructor=SimpleSelectorBinding,SimpleSelectorBinding.superclass=DataBinding.prototype,SimpleSelectorBinding.prototype.toString=function(){return"[SimpleSelectorBinding]"},SimpleSelectorBinding.prototype.onBindingRegister=function(){SimpleSelectorBinding.superclass.onBindingRegister.call(this);var a=this.getProperty("name");null!=a&&this.setName(a)},SimpleSelectorBinding.prototype.onBindingAttach=function(){SimpleSelectorBinding.superclass.onBindingAttach.call(this),this._select=this.getChildElementByLocalName("select");var a=this.getName();null!=a&&(this._select.name=a),this._parseDOMProperties(),this._buildDOMContent()},SimpleSelectorBinding.prototype._parseDOMProperties=function(){var a=this.getProperty("onchange");this.isRequired=1==this.getProperty("required"),this.hasCallBackID()&&(this._select.id=this.getCallBackID()),a&&(this.onValueChange=function(){Binding.evaluate(a,this)})},SimpleSelectorBinding.prototype._buildDOMContent=function(){this.bindingElement.tabIndex=0,1==Client.isExplorer&&(this.bindingElement.hideFocus=!0);var a=this;this._select.onchange=function(){a.onValueChange(),a.dirty(),a._isValid||a.validate()},this._select.onfocus=function(){a.focus(!0)},Client.isExplorer&&this._buildDOMContentIE()},SimpleSelectorBinding.prototype._buildDOMContentIE=function(){if(Client.isExplorer){this.bindingElement.style.height=this.bindingElement.offsetHeight+"px",this._cachewidth=this._select.offsetWidth,this._select.style.position="absolute";var a=this;this._select.onmouseover=function(){a.isFocused||a._hack(!0)},this._select.onmouseout=function(){a.isFocused||a._hack(!1)}}},SimpleSelectorBinding.prototype.onValueChange=function(){},SimpleSelectorBinding.prototype.focus=function(a){SimpleSelectorBinding.superclass.focus.call(this),this.isFocused&&(a||(FocusBinding.focusElement(this._select),Client.isExplorer&&this._hack(!0)),this.bindingWindow.standardEventHandler.enableNativeKeys(!1))},SimpleSelectorBinding.prototype.blur=function(){SimpleSelectorBinding.superclass.blur.call(this),this.isFocused||(this._select.blur(),this.bindingWindow.standardEventHandler.disableNativeKeys(),Client.isExplorer&&this._hack(!1),this.isRequired&&this.validate())},SimpleSelectorBinding.prototype._hack=function(a){Client.isExplorer&&(this._select.style.width=a?"auto":this._cachewidth+"px",a&&this._select.offsetWidth<=this._cachewidth&&this._hack(!1))},SimpleSelectorBinding.prototype.validate=function(){var a=!0;if(this.isRequired&&null==this.getValue()&&(a=!1),a!=this._isValid){if(a)this.detachClassName(DataBinding.CLASSNAME_INVALID);else{this.attachClassName(DataBinding.CLASSNAME_INVALID);var b=this._select,c=b.options[b.selectedIndex],d=DOMUtil.getTextContent(c);b.blur(),b.style.color="#A40000",b.style.fontWeight="bold",Client.isExplorer6||DOMUtil.setTextContent(c,DataBinding.warnings.required),b.onfocus=function(){this.style.color="black",this.style.fontWeight="normal",this.onfocus=null,Client.isExplorer6||DOMUtil.setTextContent(c,d)}}this._isValid=a}return a},SimpleSelectorBinding.prototype.manifest=function(){},SimpleSelectorBinding.prototype.getValue=function(){var a=null,b=this._select,c=b.options[b.selectedIndex],d=!0;if(Client.isExplorer){var e=c.outerHTML.toLowerCase();e.indexOf("value=")==-1&&(d=!1)}return d&&(a=c.getAttribute("value")),a},SimpleSelectorBinding.prototype.setValue=function(a){},SimpleSelectorBinding.prototype.getResult=function(){return this.getValue()},SimpleSelectorBinding.prototype.setResult=function(a){this.setValue(a)},SimpleSelectorBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_XHTML,"select",a);return UserInterface.registerBinding(b,SimpleSelectorBinding)},SelectorBindingSelection.prototype={label:null,value:null,tooltip:null,isSelected:null,imageProfile:null,menuItemBinding:null,_init:function(a,b,c,d,e){null!=a&&(this.label=String(a)),null!=b&&(this.value=String(b)),null!=d&&(this.imageProfile=d),null!=e&&(this.tooltip=e),this.isSelected=!!c}},DataInputSelectorBinding.prototype=new DataInputBinding,DataInputSelectorBinding.prototype.constructor=DataInputSelectorBinding,DataInputSelectorBinding.superclass=DataInputBinding.prototype,DataInputSelectorBinding.INDICATOR_IMAGE="popup",DataInputSelectorBinding.ACTION_SELECTIONCHANGED="datainputselectorselectionchanged",DataInputSelectorBinding.prototype.toString=function(){return"[DataInputSelectorBinding]"},DataInputSelectorBinding.prototype.onBindingDispose=SelectorBinding.prototype.onBindingDispose,DataInputSelectorBinding.prototype._buildDOMContent=function(){DataInputSelectorBinding.superclass._buildDOMContent.call(this),this.buildButton(),this.buildPopup(),this.buildSelections()},DataInputSelectorBinding.prototype.onBindingAttach=function(){DataInputSelectorBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("image");a&&this.setImage(a);var b=this;DOMEvents.addEventListener(this.shadowTree.input,DOMEvents.DOUBLECLICK,{handleEvent:function(a){b.isReadOnly&&(b.shadowTree.input.value=b.value,b.setReadOnly(!1),b.focus())}})},DataInputSelectorBinding.prototype.buildButton=function(){var a=this.addFirst(ToolBarButtonBinding.newInstance(this.bindingDocument));a.popupBindingTargetElement=this.shadowTree.box,a.setImage(DataInputSelectorBinding.INDICATOR_IMAGE),a.attach();var b=this;a.oncommand=function(){b._attachSelections()},this._buttonBinding=a},DataInputSelectorBinding.prototype.buildPopup=SelectorBinding.prototype.buildPopup,DataInputSelectorBinding.prototype.buildSelections=function(){var a=new List,b=DOMUtil.getElementsByTagName(this.bindingElement,"selection");new List(b).each(function(b){if(b.getAttribute("label"))throw"label not supported - use value property!";var c=b.getAttribute("value"),d=b.getAttribute("selected"),e=b.getAttribute("tooltip");a.add({value:c?c:null,toolTip:e?e:null,isSelected:!(!d||"true"!=d)})}),this.populateFromList(a)},DataInputSelectorBinding.prototype.populateFromList=function(a){for(var b=this._menuBodyBinding,c=b.bindingDocument;b.bindingElement.hasChildNodes();){var d=b.bindingElement.lastChild;d.nodeType==Node.ELEMENT_NODE&&UserInterface.hasBinding(d)?UserInterface.getBinding(d).dispose():b.removeChild(d)}if(a.hasEntries()){this._isUpToDate=!1,this._buttonBinding.isVisible||this._buttonBinding.show();var e=this.getProperty("emptyentrylabel");if(e){var f=MenuItemBinding.newInstance(c);f.setLabel(e),f.selectionValue="",b.add(f)}for(;a.hasNext();){var g=a.getNext(),f=MenuItemBinding.newInstance(c);f.setLabel(g.label?g.label:g.value),f.selectionValue=g.value,g.image&&f.setImage(g.image),g.toolTip&&f.setToolTip(g.toolTip),g.isSelected?this.select(_selectedItemBinding,!0):g.value&&g.value===this.getValue()&&(this._selectedItemBinding=f),b.add(f)}}else this._buttonBinding.hide()},DataInputSelectorBinding.prototype.handleAction=SelectorBinding.prototype.handleAction,DataInputSelectorBinding.prototype._onButtonCommand=function(){this.focus(),this._restoreSelection(),this.dispatchAction(SelectorBinding.ACTION_COMMAND)},DataInputSelectorBinding.prototype._onPopupShowing=function(){this._fitMenuToSelector(),this._restoreSelection(),this._releaseKeyboard()},DataInputSelectorBinding.prototype._onMenuItemCommand=function(a){this.select(a),FocusBinding.focusElement(this.bindingElement),this._grabKeyboard()},DataInputSelectorBinding.prototype.handleBroadcast=function(a,b){switch(SelectorBinding.prototype.handleBroadcast.call(this,a,b),a){case BroadcastMessages.MOUSEEVENT_MOUSEDOWN:b!=this._buttonBinding&&DataInputSelectorBinding.superclass.handleBroadcast.call(this,a,b)}},DataInputSelectorBinding.prototype._grabKeyboard=SelectorBinding.prototype._grabKeyboard,DataInputSelectorBinding.prototype._releaseKeyboard=SelectorBinding.prototype._releaseKeyboard,DataInputSelectorBinding.prototype._handleArrowKey=SelectorBinding.prototype._handleArrowKey,DataInputSelectorBinding.prototype.focus=function(a){this.isFocused||(DataInputSelectorBinding.superclass.focus.call(this,a),1==this.isFocused&&this._grabKeyboard())},DataInputSelectorBinding.prototype.blur=function(a){1==this.isFocused&&(DataInputSelectorBinding.superclass.blur.call(this,a),this._releaseKeyboard(),this._popupBinding.isVisible&&this._popupBinding.hide())},DataInputSelectorBinding.prototype._fitMenuToSelector=function(){var a=this.bindingElement.offsetWidth+"px",b=this._popupBinding.bindingElement;b.style.minWidth=a},DataInputSelectorBinding.prototype._restoreSelection=function(){this._isUpToDate||this._attachSelections();var a=this._menuBodyBinding.getDescendantBindingsByLocalName("menuitem"),b=this.getValue(),c=null;a.each(function(a){a.getLabel()==b&&(c=a)}),c&&c.focus()},DataInputSelectorBinding.prototype.select=function(a,b){if(a!=this._selectedItemBinding&&(this._selectedItemBinding=a,this.setValue(a.selectionValue),this.validate(!0),!b)){this.dirty();var c=this.getProperty("onselectionchange");c&&Binding.evaluate(c,this),this.dispatchAction(DataInputSelectorBinding.ACTION_SELECTIONCHANGED)}this.shadowTree.input.focus()},DataInputSelectorBinding.prototype._attachSelections=SelectorBinding.prototype._attachSelections,DataInputSelectorBinding.prototype.setResult=DataInputSelectorBinding.prototype.setValue,DataInputSelectorBinding.prototype.onblur=function(){DataInputSelectorBinding.superclass.onblur.call(this),self.isReadOnly||this.setValue(this.getValue())},DataInputSelectorBinding.prototype.setValue=function(a){var b=(this.isReadOnly,null);if(null!=a&&""!=a&&this._menuBodyBinding)for(var c=this._menuBodyBinding.getDescendantBindingsByLocalName("menuitem");c.hasNext();){var d=c.getNext();if(d.selectionValue===a){b=d.getLabel();break}}null!=b?(this.value=a,this.shadowTree.input.value=b,this.isReadOnly||this.setReadOnly(!0)):(DataInputSelectorBinding.superclass.setValue.call(this,a),this.isReadOnly&&this.setReadOnly(!1))},DataInputSelectorBinding.prototype.getValue=function(){return this.isReadOnly?result=this.value:result=DataInputSelectorBinding.superclass.getValue.call(this),result},DataInputSelectorBinding.prototype.setImage=function(a){var b="with-image";if(0!=a){a=a?a:LabelBinding.DEFAULT_IMAGE;var c=LabelBinding.newInstance(this.bindingDocument);c.setImage(a),this.shadowTree.box.appendChild(c.bindingElement),c.attach(),this.setProperty("image",a),this.hasImage=!0,this.attachClassName(b)}else this.deleteProperty("image"),this.hasImage=!1,this.detachClassName(b)},DataInputDialogBinding.prototype=new DataInputBinding,DataInputDialogBinding.prototype.constructor=DataInputDialogBinding,DataInputDialogBinding.superclass=DataInputBinding.prototype,DataInputDialogBinding.prototype.toString=function(){return"[DataInputDialogBinding]"},DataInputDialogBinding.prototype._buildDOMContent=function(){DataInputSelectorBinding.superclass._buildDOMContent.call(this),this.buildButton()};DataInputDialogBinding.prototype.buildButton=function(){var a=ToolBarButtonBinding.newInstance(this.bindingDocument);a.setImage("${icon:popup}"),this.addFirst(a),a.attach();var b=this;a.oncommand=function(){b._isButtonClicked=!0,setTimeout(function(){b._isButtonClicked=!1},1e3);var a=b.getDefinition();if(!(a instanceof DialogViewDefinition))throw"Definition was either undefine or of a non-dialog type.";a.handler={handleDialogResponse:function(a,c){if(b._isButtonClicked=!1,a==Dialog.RESPONSE_ACCEPT){b.logger.debug("Usecase scenario was hardcoded into DataInputDialogBinding#buildButton");var d=c.getFirst();b.setValue(d),b.validate(!0),b.checkDirty()}b.focus()}},a.argument.selectedResult=b.getValue(),StageBinding.presentViewDefinition(a)},DOMEvents.addEventListener(a.getBindingElement(),DOMEvents.MOUSEDOWN,{handleEvent:function(a){b._isButtonClicked=!0}}),this._dialogButtonBinding=a};DataInputDialogBinding.prototype.getDefinition=function(){var a=this.getProperty("handle"),b=ViewDefinition.clone(a,"Generated.ViewDefinition.Handle."+KeyMaster.getUniqueKey());return b},DataInputDialogBinding.prototype.oncommand=function(){var a=this._dialogButtonBinding;null!=a&&a.oncommand()},DataInputDialogBinding.prototype.validate=function(a){var b=!0;return 1==this._isButtonClicked?this._isButtonClicked=!1:b=DataInputDialogBinding.superclass.validate.call(this,a),b},TreeSelectorDialogBinding.prototype=new DataInputDialogBinding,TreeSelectorDialogBinding.prototype.constructor=TreeSelectorDialogBinding,TreeSelectorDialogBinding.superclass=DataInputDialogBinding.prototype,TreeSelectorDialogBinding.prototype.toString=function(){return"[TreeSelectorDialogBinding]"},TreeSelectorDialogBinding.prototype.getDefinition=function(){var a=ViewDefinition.clone("Composite.Management.TreeSelectorDialog","Generated.ViewDefinition.Handle."+KeyMaster.getUniqueKey());return a.argument.selectionProperty=this.getProperty("selection-property"),a.argument.selectionValue=this.getProperty("selection-value"),a.argument.selectionResult=this.getProperty("selection-result"),a.argument.nodes=[{key:this.getProperty("element-provider"),search:this.getProperty("serialized-search-token")}],a},UrlInputDialogBinding.prototype=new DataInputDialogBinding,UrlInputDialogBinding.prototype.constructor=UrlInputDialogBinding,UrlInputDialogBinding.superclass=DataInputDialogBinding.prototype,UrlInputDialogBinding.URL_SELECTED="input link selected",UrlInputDialogBinding.prototype.toString=function(){return"[UrlInputDialogBinding]"},UrlInputDialogBinding.prototype.onBindingRegister=function(){UrlInputDialogBinding.superclass.onBindingRegister.call(this),this.addActionListener(PageBinding.ACTION_DOPOSTBACK)},UrlInputDialogBinding.prototype._buildDOMContent=function(){UrlInputDialogBinding.superclass._buildDOMContent.call(this)},UrlInputDialogBinding.prototype.buildButtonAndLabel=function(){if(null==this.shadowTree.labelInput){this.shadowTree.labelInput=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument),this.shadowTree.box.appendChild(this.shadowTree.labelInput),this.shadowTree.labelInput.style.display="none",this.shadowTree.labelInput.readOnly=!0;var a=this;DOMEvents.addEventListener(this.shadowTree.labelInput,DOMEvents.DOUBLECLICK,{handleEvent:function(b){a.clearLabel(),a.focus()}})}if(null==this.editButtonBinding){var b=ToolBarButtonBinding.newInstance(this.bindingDocument);b.setImage("${icon:editor-sourceview}"),b.bindingElement.style.left="3px",b.bindingElement.style.width="29px",this.addFirst(b),b.attach(),b.hide();var a=this;b.oncommand=function(){a.clearLabel(),a.focus()},this.editButtonBinding=b}},UrlInputDialogBinding.prototype.onblur=function(){UrlInputDialogBinding.superclass.onblur.call(this),this.setValue(this.getValue())},UrlInputDialogBinding.prototype.setValue=function(a){if(UrlInputDialogBinding.superclass.setValue.call(this,a),this.isAttached){if(this.compositeUrl=new Uri(a),this.compositeUrl.isMedia||this.compositeUrl.isPage||this.compositeUrl.isInternalUrl){var b=TreeService.GetCompositeUrlLabel(a);b!=a&&this.setLabel(b)}else this.clearLabel();this.dispatchAction(UrlInputDialogBinding.URL_SELECTED)}},UrlInputDialogBinding.prototype.setLabel=function(a){this.buildButtonAndLabel(),this.shadowTree.labelInput&&(a?(this.setReadOnly(!0),this.editButtonBinding.show(),this.shadowTree.input.style.display="none",this.shadowTree.labelInput.style.display="block",this.shadowTree.labelInput.value=a):(this.setReadOnly(!1),this.editButtonBinding.hide(),this.shadowTree.input.style.display="block",this.shadowTree.labelInput.style.display="none"))},UrlInputDialogBinding.prototype.clearLabel=function(){this.setLabel()},DataInputButtonBinding.prototype=new DataInputBinding,DataInputButtonBinding.prototype.constructor=DataInputButtonBinding,DataInputButtonBinding.superclass=DataInputBinding.prototype,DataInputButtonBinding.prototype.toString=function(){return"[DataInputButtonBinding]"},DataInputButtonBinding.prototype.onBindingAttach=function(){DataInputButtonBinding.superclass.onBindingAttach.call(this),this.hasCallBackID()&&Binding.dotnetify(this)},DataInputButtonBinding.prototype._buildDOMContent=function(){DataInputButtonBinding.superclass._buildDOMContent.call(this),this.buildButton()},DataInputButtonBinding.prototype.buildButton=function(){var a=ToolBarButtonBinding.newInstance(this.bindingDocument),b=this.getProperty("image");null!=b?a.setImage(b):a.setImage("${icon:popup}"),this.addFirst(a),a.attach();var c=this;a.oncommand=function(){c.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},this.isReadOnly&&a.hide(),this._dialogButtonBinding=a},DataInputButtonBinding.prototype.oncommand=function(){var a=this._dialogButtonBinding;null!=a&&a.oncommand()},DataInputButtonBinding.prototype.setReadOnly=function(a){DataInputButtonBinding.superclass.setReadOnly.call(this,a);var b=this._dialogButtonBinding;null!=b&&(a?b.hide():b.show())},DataDialogBinding.prototype=new DataBinding,DataDialogBinding.prototype.constructor=DataDialogBinding,DataDialogBinding.superclass=DataBinding.prototype,DataDialogBinding.ACTION_COMMAND="datadialog command",DataDialogBinding.prototype.toString=function(){return"[DataDialogBinding]"},DataDialogBinding.prototype.onBindingRegister=function(){DataDialogBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.image=this.setImage,this.propertyMethodMap.label=this.setLabel,this.propertyMethodMap.tooltip=this.setToolTip,this.propertyMethodMap.handle=this.setHandle,this.propertyMethodMap.url=this.setURL,this.propertyMethodMap.value=this.setValue},DataDialogBinding.prototype.parseDOMProperties=function(){var a=1==this.getProperty("required");a&&(this.isRequired=!0)},DataDialogBinding.prototype.onBindingAttach=function(){DataDialogBinding.superclass.onBindingAttach.call(this),Binding.imageProfile(this),this._buildButton(),this.parseDOMProperties(),(null!=this.getProperty("handle")||this.getProperty("url"))&&(this._buttonBinding.setImage("${icon:popup}"),this._buttonBinding.labelBinding.attachClassName("flipped")),this.bindingElement.tabIndex=0,Client.isExplorer&&(this.bindingElement.hideFocus=!0)},DataDialogBinding.prototype._buildButton=function(){var a=this.getProperty("label"),b=this.getProperty("tooltip");this._buttonBinding=this.add(ClickButtonBinding.newInstance(this.bindingDocument)),null!=a&&(null!=this.getProperty("handle")||null!=this.getProperty("url")?this._buttonBinding.setLabel(a+LabelBinding.DIALOG_INDECATOR_SUFFIX):this._buttonBinding.setLabel(a)),this.imageProfile&&(this._buttonBinding.imageProfile=this.imageProfile),null!=b&&this._buttonBinding.setToolTip(b),this._buttonBinding.addActionListener(ButtonBinding.ACTION_COMMAND,this),this._buttonBinding.attach()},DataDialogBinding.prototype._buildIndicator=function(){var a="http://www.w3.org/2000/svg";this.shadowTree.indicatorimage=this.bindingDocument.createElementNS(a,"svg"),this.shadowTree.indicatorimage.setAttribute("viewBox","0 0 24 24"),this.shadowTree.indicatorimage.setAttribute("class","dialogindicatorimage");var b=KickStart.sprites.querySelector("#popup");if(b){var c=b.getAttribute("viewBox"),d=document.createDocumentFragment(),e=b.cloneNode(!0);c&&this.shadowTree.indicatorimage.setAttribute("viewBox",c),d.appendChild(e),this.shadowTree.indicatorimage.appendChild(d)}this._buttonBinding.bindingElement.appendChild(this.shadowTree.indicatorimage);
},DataDialogBinding.prototype.handleAction=function(a){DataDialogBinding.superclass.handleAction.call(this,a);var b=a.target,c=this;switch(a.type){case ButtonBinding.ACTION_COMMAND:null==this._handler&&(this._handler={handleDialogResponse:function(a,b){if(a==Dialog.RESPONSE_ACCEPT){if(!(b instanceof DataBindingMap))throw"Invalid dialog result";c._map=b}}}),b==this._buttonBinding&&(a.consume(),this.focus(),this.fireCommand())}},DataDialogBinding.prototype.handleBroadcast=function(a,b){switch(DataDialogBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_SPACE:this.fireCommand()}},DataDialogBinding.prototype.fireCommand=function(a){this.dispatchAction(this.constructor.ACTION_COMMAND);var b=this.getProperty("handle"),c=this.getURL(),d=null;null!=b||null!=a?(d=null!=a?a:ViewDefinitions[b],d instanceof DialogViewDefinition&&(d.handler=this._handler,null!=this._map&&(d.argument=this._map),StageBinding.presentViewDefinition(d))):null!=c&&(d=Dialog.invokeModal(c,this._handler,this._map)),null!=d&&(this._dialogViewHandle=d.handle,this._releaseKeyboard())},DataDialogBinding.prototype.setLabel=function(a){this.setProperty("label",a),this.isAttached&&this._buttonBinding.setLabel(a+LabelBinding.DIALOG_INDECATOR_SUFFIX)},DataDialogBinding.prototype.getLabel=function(){return this.getProperty("label")},DataDialogBinding.prototype.setImage=function(a){this.setProperty("image",a),null!=this.imageProfile&&(this.imageProfile.setDefaultImage(a),null!=this._buttonBinding&&(this._buttonBinding.imageProfile=this.imageProfile,this._buttonBinding.setImage(this._buttonBinding.imageProfile.getDefaultImage())))},DataDialogBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),this.isAttached&&this._buttonBinding.setToolTip(a)},DataDialogBinding.prototype.setHandle=function(a){this.setProperty("handle",a)},DataDialogBinding.prototype.setURL=function(a){this.setProperty("url",a)},DataDialogBinding.prototype.getURL=function(){return this.getProperty("url")},DataDialogBinding.prototype.setHandler=function(a){this._handler=a},DataDialogBinding.prototype.focus=function(){this.isFocused||(DataBinding.prototype.focus.call(this),FocusBinding.focusElement(this.bindingElement),this.isFocused&&this._grabKeyboard())},DataDialogBinding.prototype.blur=function(){this.isFocused&&(DataBinding.prototype.blur.call(this),this._hasKeyboard&&this._releaseKeyboard())},DataDialogBinding.prototype._grabKeyboard=function(){this._hasKeyboard||(this.subscribe(BroadcastMessages.KEY_SPACE),this._hasKeyboard=!0)},DataDialogBinding.prototype._releaseKeyboard=function(){this._hasKeyboard&&(this.unsubscribe(BroadcastMessages.KEY_SPACE),this._hasKeyboard=!1)},DataDialogBinding.prototype.validate=function(){var a=!0;if(1==this.isRequired){var b=this.getValue();null!=b&&""!=b||(a=!1),a!=this._isValid&&(a?(this.dispatchAction(Binding.ACTION_VALID),this.detachClassName(DataBinding.CLASSNAME_INVALID)):(this.dispatchAction(Binding.ACTION_INVALID),this.attachClassName(DataBinding.CLASSNAME_INVALID),this._buttonBinding.setLabel(DataBinding.warnings.required))),this._isValid=a}return a},DataDialogBinding.prototype.manifest=function(){},DataDialogBinding.prototype.getValue=function(){return null},DataDialogBinding.prototype.getResult=function(){return this._map},DataDialogBinding.prototype.setResult=function(a){if(!(a instanceof DataBindingMap))throw"Invalid argument";this._map=a},DataDialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:datadialog",a);return UserInterface.registerBinding(b,DataDialogBinding)},PostBackDataDialogBinding.prototype=new DataDialogBinding,PostBackDataDialogBinding.prototype.constructor=PostBackDataDialogBinding,PostBackDataDialogBinding.superclass=DataDialogBinding.prototype,PostBackDataDialogBinding.ACTION_COMMAND="postbackdialog command",PostBackDataDialogBinding.prototype.onBindingAttach=function(){PostBackDataDialogBinding.superclass.onBindingAttach.call(this),Binding.dotnetify(this);var a=this;this._handler={handleDialogResponse:function(b,c){b==Dialog.RESPONSE_ACCEPT?a._onDialogAccept(c):a._onDialogCancel()}}},PostBackDataDialogBinding.prototype._onDialogAccept=function(a){a=new String(a),this.dirty(),this.setValue(encodeURIComponent(a)),this.validate(!0);var b=this;setTimeout(function(){null!=b.ondialogaccept&&b.ondialogaccept(),b.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},0)},PostBackDataDialogBinding.prototype._onDialogCancel=function(){null!=this.ondialogcancel&&this.ondialogcancel()},PostBackDataDialogBinding.prototype.getURL=function(){var a=this.getProperty("url"),b=this.getValue();return null==b&&(b=this.getProperty("defaultValue")),new String(a+b)},PostBackDataDialogBinding.prototype.manifest=function(){var a=this.getValue();null==a&&(a=""),this.shadowTree.dotnetinput.value=a},PostBackDataDialogBinding.prototype.setValue=function(a){this.setProperty("value",a)},PostBackDataDialogBinding.prototype.getValue=function(){return this.getProperty("value")},PostBackDataDialogBinding.prototype.getResult=function(){return null},PostBackDataDialogBinding.prototype.setResult=function(a){},PostBackDataDialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:postbackdialog",a);return UserInterface.registerBinding(b,PostBackDataDialogBinding)},ViewDefinitionPostBackDataDialogBinding.prototype=new PostBackDataDialogBinding,ViewDefinitionPostBackDataDialogBinding.prototype.constructor=ViewDefinitionPostBackDataDialogBinding,ViewDefinitionPostBackDataDialogBinding.superclass=PostBackDataDialogBinding.prototype,ViewDefinitionPostBackDataDialogBinding.prototype.toString=function(){return"[ViewDefinitionPostBackDataDialogBinding]"},ViewDefinitionPostBackDataDialogBinding.prototype.fireCommand=function(){var a=this.getProperty("dialoglabel"),b=this.getProperty("providersearch"),c=this.getProperty("providerkey"),d=this.getProperty("handle"),e=this.getProperty("selectedtoken");if(null==d)throw'Attribute "handle" required.';var f=ViewDefinition.clone(d,"Generated.ViewDefinition.Handle."+KeyMaster.getUniqueKey());null!=a&&(null==f.argument&&(f.argument={}),f.argument.label=a),null!=b&&(null==f.argument&&(f.argument={}),null==f.argument.nodes&&(f.argument.nodes=[]),f.argument.nodes[0].search=b),null!=c&&(null==f.argument&&(f.argument={}),null==f.argument.nodes&&(f.argument.nodes=[]),f.argument.nodes[0].key=c),null!=e&&(null==f.argument&&(f.argument={}),f.argument.selectedToken=e),ViewDefinitionPostBackDataDialogBinding.superclass.fireCommand.call(this,f)},ViewDefinitionPostBackDataDialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:postbackdialog",a);return UserInterface.registerBinding(b,ViewDefinitionPostBackDataDialogBinding)},NullPostBackDataDialogBinding.prototype=new DataBinding,NullPostBackDataDialogBinding.prototype.constructor=NullPostBackDataDialogBinding,NullPostBackDataDialogBinding.superclass=DataBinding.prototype,NullPostBackDataDialogBinding.LABEL_NULL="(No selection)",NullPostBackDataDialogBinding.LABEL_DEFAULT="Select",NullPostBackDataDialogBinding.VALUE_NULL="null",NullPostBackDataDialogBinding.VALUE_SELECTED="selected",NullPostBackDataDialogBinding.ACTION_COMMAND="nullpostbackdatadialog command",NullPostBackDataDialogBinding.prototype.toString=function(){return"[NullPostBackDataDialogBinding]"},NullPostBackDataDialogBinding.prototype.onBindingAttach=function(){NullPostBackDataDialogBinding.superclass.onBindingAttach.call(this),this.propertyMethodMap.label=this.setLabel;var a=this;this.propertyMethodMap.value=function(b){a._datathing.setValue(b)},this.propertyMethodMap.selectorlabel=function(){Application.isDeveloperMode&&alert("Selectorlabel property not supported yet!")},this.addActionListener(PageBinding.ACTION_DOPOSTBACK),this._buildDataDialog(),this._buildSelector()},NullPostBackDataDialogBinding.prototype._buildDataDialog=function(){this._datathing=this.add(ViewDefinitionPostBackDataDialogBinding.newInstance(this.bindingDocument)),new List(["callbackid","handle","name","providersearch","providerkey","value"]).each(function(a){this._datathing.setProperty(a,this.getProperty(a)),this.setProperty(a,null)},this);var a=this;this._datathing.ondialogcancel=function(){var b=a.getValue();""==b||null==b?a._selector.setLabel(NullPostBackDataDialogBinding.LABEL_NULL):a._selector.setLabel(a.getLabel())},this._datathing.hide(),this._datathing.attach()},NullPostBackDataDialogBinding.prototype._buildSelector=function(){this._selector=this.add(NullPostBackDataDialogSelectorBinding.newInstance(this.bindingDocument));var a=this.getProperty("value"),b=this.getProperty("selectorlabel");null==b&&(b=NullPostBackDataDialogBinding.LABEL_DEFAULT);var c=new List;c.add(new SelectorBindingSelection(NullPostBackDataDialogBinding.LABEL_NULL,NullPostBackDataDialogBinding.VALUE_NULL,null==a)),c.add(new SelectorBindingSelection(b+LabelBinding.DIALOG_INDECATOR_SUFFIX,NullPostBackDataDialogBinding.VALUE_SELECTED,null!=a,new ImageProfile({image:"${icon:popup}"}))),this._selector.master=this,this._selector.attach(),this._selector.populateFromList(c);var a=this.getValue();""==a||null==a?this._selector.setLabel(NullPostBackDataDialogBinding.LABEL_NULL):this._selector.setLabel(this.getLabel())},NullPostBackDataDialogBinding.prototype.handleAction=function(a){switch(NullPostBackDataDialogBinding.superclass.handleAction.call(this,a),a.type){case PageBinding.ACTION_DOPOSTBACK:if(a.target==this._datathing){var b=this.getProperty("label");this._selector.setLabel(""),this.dispatchAction(PageBinding.ACTION_DOPOSTBACK);var c=this;setTimeout(function(){c.getProperty("label")==b&&c._selector.setLabel(b)},500),a.consume()}}},NullPostBackDataDialogBinding.prototype.getLabel=function(){return this.getProperty("label")},NullPostBackDataDialogBinding.prototype.setLabel=function(a){this.setProperty("label",a),null!=this._selector&&this._selector.setLabel(a)},NullPostBackDataDialogBinding.prototype.getValue=function(){return this._datathing.getValue()},NullPostBackDataDialogBinding.prototype.setValue=function(a){this._datathing.setValue(a),this.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},NullPostBackDataDialogBinding.prototype.action=function(){new List(["selectedtoken"]).each(function(a){this._datathing.setProperty(a,this.getProperty(a))},this),this._datathing.fireCommand()},NullPostBackDataDialogBinding.prototype.validate=function(){return!0},NullPostBackDataDialogBinding.prototype.manifest=function(){},NullPostBackDataDialogBinding.prototype.getResult=function(){},NullPostBackDataDialogBinding.prototype.setResult=function(){},NullPostBackDataDialogSelectorBinding.prototype=new SelectorBinding,NullPostBackDataDialogSelectorBinding.prototype.constructor=NullPostBackDataDialogSelectorBinding,NullPostBackDataDialogSelectorBinding.superclass=SelectorBinding.prototype,NullPostBackDataDialogSelectorBinding.prototype.toString=function(){return"[NullPostBackDataDialogSelectorBinding]"},NullPostBackDataDialogSelectorBinding.prototype.select=function(a,b){NullPostBackDataDialogSelectorBinding.superclass.select.call(this,a,!0)&&(this._buttonBinding.setImage(null),this._updateImageLayout(),this._selectionValue==NullPostBackDataDialogBinding.VALUE_SELECTED&&null!=this.master.getValue())},NullPostBackDataDialogSelectorBinding.prototype.setLabel=function(a){this._buttonBinding.setLabel(a)},NullPostBackDataDialogSelectorBinding.prototype.setToolTip=function(a){this._buttonBinding.setToolTip(a)},NullPostBackDataDialogSelectorBinding.prototype.handleAction=function(a){switch(NullPostBackDataDialogSelectorBinding.superclass.handleAction.call(this,a),a.type){case MenuItemBinding.ACTION_COMMAND:var b=a.target,c=this.master;b.selectionValue==NullPostBackDataDialogBinding.VALUE_SELECTED?(this.setLabel(b.getLabel()),setTimeout(function(){c.action()},0)):(c.getValue()&&c.dirty(),c.setValue(""))}},NullPostBackDataDialogSelectorBinding.prototype.manifest=function(){},NullPostBackDataDialogSelectorBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:selector",a);return UserInterface.registerBinding(b,NullPostBackDataDialogSelectorBinding)},MultiSelectorBinding.prototype=new DataBinding,MultiSelectorBinding.prototype.constructor=MultiSelectorBinding,MultiSelectorBinding.superclass=DataBinding.prototype,MultiSelectorBinding.DISPLAY_SELECTED="selected",MultiSelectorBinding.DISPLAY_UNSELECTED="unselected",MultiSelectorBinding.ACTION_COMMAND="multiselector command",MultiSelectorBinding.ACTION_SELECTIONCHANGED="multiselector selection changed",MultiSelectorBinding.prototype.toString=function(){return"[MultiSelectorBinding]"},MultiSelectorBinding.prototype.onBindingAttach=function(){MultiSelectorBinding.superclass.onBindingAttach.call(this),this.selections=this._getSelectionsList(),this.addActionListener(DataDialogBinding.ACTION_COMMAND),this.addActionListener(MultiSelectorDataDialogBinding.ACTION_RESULT),this.addEventListener(DOMEvents.MOUSEDOWN),this._buildDOMContent(),this._parseDOMProperties(),this.populateFromList(this.selections);var a=this._dataDialogBinding;null!=a&&DOMEvents.addEventListener(this.shadowTree.box,DOMEvents.DOUBLECLICK,{handleEvent:function(){a.fireCommand()}})},MultiSelectorBinding.prototype._buildDOMContent=function(){this.shadowTree.box=DOMUtil.createElementNS(Constants.NS_UI,"ui:box",this.bindingDocument),this.bindingElement.appendChild(this.shadowTree.box)},MultiSelectorBinding.prototype._parseDOMProperties=function(){var a=this.getProperty("editable"),b=this.getProperty("selectable"),c=this.getProperty("display");0!=a?this._buildEditorButton():this.isEditable=!1,b&&(this.isSelectable=!0,this._selectionMap=new Map),c&&(this._display=c)},MultiSelectorBinding.prototype._buildEditorButton=function(){if(this.isEditable){var a=MultiSelectorDataDialogBinding.newInstance(this.bindingDocument);a.selections=this.selections,this.add(a),a.attach(),this._dataDialogBinding=a,this.shadowTree.datadialog=a}},MultiSelectorBinding.prototype.populateFromList=function(a){a.reset();var b=!1;for(this.shadowTree.box.innerHTML="";a.hasNext();){var c=a.getNext();switch(this._display){case MultiSelectorBinding.DISPLAY_SELECTED:b=c.isSelected;break;case MultiSelectorBinding.DISPLAY_UNSELECTED:b=1!=c.isSelected}b&&this.shadowTree.box.appendChild(this._getElementForSelection(c))}this.selections=a,this._dataDialogBinding&&(this._dataDialogBinding.selections=this.selections)},MultiSelectorBinding.prototype.cumulateFromList=function(a,b){var c=this.shadowTree.box,d=!1;if(a.hasEntries()){for(a.reverse().reset();a.hasNext();){var e=a.getNext();if(b)e.isSelected=this._display==MultiSelectorBinding.DISPLAY_SELECTED,d=!0;else switch(this._display){case MultiSelectorBinding.DISPLAY_SELECTED:d=e.isSelected;break;case MultiSelectorBinding.DISPLAY_UNSELECTED:d=1!=e.isSelected}if(d){var f=this._getElementForSelection(e);c.insertBefore(f,c.firstChild),CSSUtil.attachClassName(f,"selected"),this._selectionMap.set(e.value,f)}}this.dispatchAction(MultiSelectorBinding.ACTION_SELECTIONCHANGED)}},MultiSelectorBinding.prototype._getElementForSelection=function(a){var b=DOMUtil.createElementNS(Constants.NS_XHTML,"div",this.bindingDocument);return b.appendChild(this.bindingDocument.createTextNode(a.label)),b.setAttribute("label",a.label),b.setAttribute("value",a.value),b},MultiSelectorBinding.prototype.hasHighlight=function(){return this._selectionMap&&this._selectionMap.hasEntries()},MultiSelectorBinding.prototype.handleEvent=function(a){switch(MultiSelectorBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.MOUSEDOWN:if(this.isFocused||this.focus(),this.isSelectable){var b=DOMEvents.getTarget(a),c=DOMUtil.getLocalName(b);"div"==c&&(this._handleMouseDown(b),this.dispatchAction(MultiSelectorBinding.ACTION_SELECTIONCHANGED))}}},MultiSelectorBinding.prototype._handleMouseDown=function(a){if(Keyboard.isShiftPressed&&this._lastSelectedElement)for(var b=this._getElements(),c=a.getAttribute("value"),d=this._lastSelectedElement.getAttribute("value"),e=!1;b.hasNext();){var f=b.getNext();switch(f.getAttribute("value")){case c:case d:e=!e}e?this._hilite(f):this._unhilite(f),this._hilite(this._lastSelectedElement),this._hilite(a)}else if(Keyboard.isControlPressed&&this._isHilited(a)?this._unhilite(a):this._hilite(a),!Keyboard.isControlPressed){var g=this;this._getElements().each(function(b){b!=a&&g._unhilite(b)})}this._lastSelectedElement=a},MultiSelectorBinding.prototype._hilite=function(a){var b=a.getAttribute("value");this._selectionMap.has(b)||(CSSUtil.attachClassName(a,"selected"),this._selectionMap.set(b,a))},MultiSelectorBinding.prototype._unhilite=function(a){var b=a.getAttribute("value");this._selectionMap.has(b)&&(CSSUtil.detachClassName(a,"selected"),this._selectionMap.del(b))},MultiSelectorBinding.prototype._isHilited=function(a){return CSSUtil.hasClassName(a,"selected")},MultiSelectorBinding.prototype.handleAction=function(a){MultiSelectorBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case DataDialogBinding.ACTION_COMMAND:b==this._dataDialogBinding&&(this.isFocused||this.focus(),this.dispatchAction(MultiSelectorBinding.ACTION_COMMAND),a.consume());break;case MultiSelectorDataDialogBinding.ACTION_RESULT:this.populateFromList(b.result),this.dirty(),b.result=null,a.consume()}},MultiSelectorBinding.prototype.extractSelected=function(){var a=null;if(this.isSelectable&&(a=new List,this._selectionMap&&this._selectionMap.hasEntries())){var b=this;this._getElements().each(function(c){b._isHilited(c)&&(c.parentNode.removeChild(c),a.add(new SelectorBindingSelection(c.getAttribute("label"),c.getAttribute("value"),!0)))}),this._selectionMap=new Map,this.dispatchAction(MultiSelectorBinding.ACTION_SELECTIONCHANGED)}return a},MultiSelectorBinding.prototype.reposition=function(a){var b=this._getElements();a||b.reverse();for(var c=!0;c&&b.hasNext();){var d=b.getNext();if(this._isHilited(d))switch(a){case!0:d.previousSibling?d.parentNode.insertBefore(d,d.previousSibling):c=!1;break;case!1:d.nextSibling?d.parentNode.insertBefore(d,d.nextSibling.nextSibling):c=!1}}},MultiSelectorBinding.prototype.toSelectionList=function(){var a=new List,b=this._display==MultiSelectorBinding.DISPLAY_SELECTED,c=this;return this._getElements().each(function(d){var e=new SelectorBindingSelection(d.getAttribute("label"),d.getAttribute("value"),b);e.isHighlighted=c._isHilited(d),a.add(e)}),a},MultiSelectorBinding.prototype._getElements=function(){return this.shadowTree.box?new List(DOMUtil.getElementsByTagName(this.shadowTree.box,"div")):new List},MultiSelectorBinding.prototype._getSelectionsList=SelectorBinding.prototype._getSelectionsList,MultiSelectorBinding.prototype.validate=function(){return!0},MultiSelectorBinding.prototype.manifest=function(){var a=new List(DOMUtil.getElementsByTagName(this.bindingElement,"input"));for(a.hasEntries()&&a.each(function(a){a.parentNode.removeChild(a)}),this.selections.reset();this.selections.hasNext();){var b=this.selections.getNext();if(b.isSelected){var c=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);c.name=this._name,c.value=b.value,this.bindingElement.appendChild(c)}}},MultiSelectorBinding.prototype.getValue=function(){return"HEJ!"},MultiSelectorBinding.prototype.setValue=function(a){alert(a)},MultiSelectorBinding.prototype.getResult=function(){return alert("TODO: MultiSelectorBinding#getResult"),new Array},MultiSelectorBinding.prototype.setResult=function(a){alert("TODO: MultiSelectorBinding#setResult")},HierarchicalSelectorBinding.prototype=new DataBinding,HierarchicalSelectorBinding.prototype.constructor=HierarchicalSelectorBinding,HierarchicalSelectorBinding.superclass=DataBinding.prototype,HierarchicalSelectorBinding.DISPLAY_SELECTED="selected",HierarchicalSelectorBinding.DISPLAY_UNSELECTED="unselected",HierarchicalSelectorBinding.ACTION_COMMAND="HierarchicalSelector command",HierarchicalSelectorBinding.ACTION_SELECTIONCHANGED="HierarchicalSelector selection changed",HierarchicalSelectorBinding.prototype.toString=function(){return"[HierarchicalSelectorBinding]"},HierarchicalSelectorBinding.prototype.onBindingAttach=function(){HierarchicalSelectorBinding.superclass.onBindingAttach.call(this),this.addActionListener(CheckTreeNodeBinding.ACTION_COMMAND),this._buildDOMContent(),this._parseDOMProperties(),this._populate();var a=UserInterface.getBinding(this.bindingElement.parentNode);null!=a&&a instanceof DialogPageBodyBinding&&1===a.bindingElement.children.length&&a.attachClassName(DialogPageBodyBinding.FILLED_CLASSNAME),this.updateCounter()},HierarchicalSelectorBinding.prototype.onBindingInitialize=function(){HierarchicalSelectorBinding.superclass.onBindingInitialize.call(this),this.shadowTree.tree.attachRecursive()},HierarchicalSelectorBinding.prototype._buildDOMContent=function(){this.shadowTree.box=DOMUtil.createElementNS(Constants.NS_UI,"ui:box",this.bindingDocument),this.bindingElement.appendChild(this.shadowTree.box)},HierarchicalSelectorBinding.prototype._parseDOMProperties=function(){this.autoSelectChildren=this.getProperty("autoselectchildren")===!0,this.autoSelectParents=this.getProperty("autoselectparents")===!0,this.isRequired=this.getProperty("required")===!0,this.hasCounter=this.getProperty("hascounter")===!0},HierarchicalSelectorBinding.prototype._populate=function(){this.shadowTree.tree=CheckTreeBinding.newInstance(this.bindingDocument),this.shadowTree.box.appendChild(this.shadowTree.tree.bindingElement),this._populateFromSelections(this.shadowTree.tree,this.bindingElement),this.shadowTree.tree.attachRecursive(),this.shadowTree.tree.addActionListener(TreeNodeBinding.ACTION_OPEN,this)},HierarchicalSelectorBinding.prototype._populateFromSelections=function(a,b){var c=DOMUtil.getChildElementsByLocalName(b,"selection"),d=null;c.each(function(b){d=CheckTreeNodeBinding.newInstance(this.bindingDocument);var c=b.getAttribute("label"),e=b.getAttribute("value"),f="true"===b.getAttribute("selected"),g=b.getAttribute("image"),h="true"===b.getAttribute("selectable"),i="true"===b.getAttribute("readonly");d.setLabel(c),d.setImage(g),d.imageProfile=new ImageProfile({image:g,imageHover:null,imageActive:null,imageDisabled:null}),d.setProperty("selected",f),d.selectionElement=b,d.selectionValue=e,d.isSelectable=h,d.isReadOnly=i,d.isContainer=b.hasChildNodes(),a.add(d)},this),a instanceof CheckTreeBinding&&1===c.getLength()&&(d.setProperty("open",!0),d.setProperty("pin",!0),this._populateFromSelections(d,d.selectionElement),d.hasBeenOpened=!0)},HierarchicalSelectorBinding.prototype.handleAction=function(a){HierarchicalSelectorBinding.superclass.handleAction.call(this,a);a.target;switch(a.type){case CheckTreeNodeBinding.ACTION_COMMAND:this.dirty();var b=a.target,c=b.isChecked();if(b.selectionElement.setAttribute("selected",c),(this.autoSelectChildren||this.autoSelectParents&&!c)&&(this.checkChildrenLazySelections(b,c),b.getDescendantBindingsByType(CheckTreeNodeBinding).each(function(a){a.isSelectable&&!a.isReadOnly&&(a.setChecked(c,!0),a.selectionElement.setAttribute("selected",c),this.checkChildrenLazySelections(a,c))},this)),this.autoSelectParents&&c)for(var d=b;(d=UserInterface.getBinding(d.bindingElement.parentNode))&&d instanceof CheckTreeNodeBinding;)d.isSelectable&&!d.isReadOnly&&(d.setChecked(c,!0),d.selectionElement.setAttribute("selected",c));this.hasClassName(DataBinding.CLASSNAME_INVALID)&&this.detachClassName(DataBinding.CLASSNAME_INVALID),this.updateCounter(),a.consume();break;case TreeNodeBinding.ACTION_OPEN:var e=a.target;e.hasBeenOpened||(this._populateFromSelections(e,e.selectionElement),e.attachRecursive()),a.consume()}},HierarchicalSelectorBinding.prototype.updateCounter=function(){if(this.hasCounter){var a=0,b=DOMUtil.getElementsByTagName(this.bindingElement,"selection");new List(b).each(function(b){var c="true"===b.getAttribute("selectable"),d="true"===b.getAttribute("selected"),e="true"===b.getAttribute("readonly");c&&!e&&d&&a++},this),this.setCounter(a),console.log(a)}},HierarchicalSelectorBinding.prototype.setCounter=function(a){if(this.hasCounter){null==this.shadowTree.countLabelBinding&&(this.shadowTree.countLabelBinding=LabelBinding.newInstance(this.bindingDocument),this.add(this.shadowTree.countLabelBinding));var b=StringBundle.getString("ui","Selector.Count");if(!b)return;this.shadowTree.countLabelBinding.setLabel(b.replace("{0}",a))}},HierarchicalSelectorBinding.prototype.checkChildrenLazySelections=function(a,b){if(a.isContainer&&!a.hasBeenOpened){var c=DOMUtil.getElementsByTagName(a.selectionElement,"selection");new List(c).each(function(a){var c="true"===a.getAttribute("selectable"),d="true"===a.getAttribute("readonly");c&&!d&&a.setAttribute("selected",b)})}},HierarchicalSelectorBinding.prototype.handleElement=function(a){return!0},HierarchicalSelectorBinding.prototype.updateElement=function(a){return!0},HierarchicalSelectorBinding.prototype.validate=function(){var a=!0;return this.isRequired&&(a=!1,this.getDescendantBindingsByType(CheckTreeNodeBinding).each(function(b){return!(b.isSelectable&&!b.isReadOnly&&b.isChecked())||(a=!0,!1)}),a===!1&&this.attachClassName(DataBinding.CLASSNAME_INVALID)),a},HierarchicalSelectorBinding.prototype.manifest=function(){var a=new List(DOMUtil.getElementsByTagName(this.bindingElement,"input"));a.hasEntries()&&a.each(function(a){a.parentNode.removeChild(a)});var b=DOMUtil.getElementsByTagName(this.bindingElement,"selection");new List(b).each(function(a){var b="true"===a.getAttribute("selectable"),c="true"===a.getAttribute("selected"),d=a.getAttribute("value");if(b&&c){var e=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);e.name=this._name,e.value=d,this.bindingElement.appendChild(e)}},this)},HierarchicalSelectorBinding.prototype.getValue=function(){return null},HierarchicalSelectorBinding.prototype.setValue=function(a){},HierarchicalSelectorBinding.prototype.getResult=function(){return new Array},HierarchicalSelectorBinding.prototype.setResult=function(a){},HTMLDataDialogBinding.prototype=new PostBackDataDialogBinding,HTMLDataDialogBinding.prototype.constructor=HTMLDataDialogBinding,HTMLDataDialogBinding.superclass=PostBackDataDialogBinding.prototype,HTMLDataDialogBinding.prototype.toString=function(){return"[HTMLDataDialogBinding]"},HTMLDataDialogBinding.prototype.onBindingAttach=function(){null==this.getProperty("label")&&this.setProperty("label","Edit HTML"),HTMLDataDialogBinding.superclass.onBindingAttach.call(this)},HTMLDataDialogBinding.prototype.fireCommand=function(){this.dispatchAction(DataDialogBinding.ACTION_COMMAND);var a={label:DataBinding.getAssociatedLabel(this),value:decodeURIComponent(this.getValue()),configuration:{formattingconfiguration:this.getProperty("formattingconfiguration"),embedablefieldstypenames:this.getProperty("embedablefieldstypenames"),previewtemplateid:this.getProperty("previewtemplateid"),previewplaceholder:this.getProperty("previewplaceholder"),previewpageid:this.getProperty("previewpageid")}},b=ViewDefinitions["Composite.Management.VisualEditorDialog"];b.handler=this._handler,b.argument=a,StageBinding.presentViewDefinition(b,this),this._releaseKeyboard()},HTMLDataDialogBinding.prototype.getContextContainer=function(){var a=null;if(void 0!=this.getProperty("containerclasses")){var b=ContextContainer.getAncestorContextContainer(this);a=null==b?new ContextContainer:b.clone(),a.setContainerClasses(this.getProperty("containerclasses"))}return a},MultiSelectorDataDialogBinding.prototype=new DataDialogBinding,MultiSelectorDataDialogBinding.prototype.constructor=MultiSelectorDataDialogBinding,MultiSelectorDataDialogBinding.superclass=DataDialogBinding.prototype,MultiSelectorDataDialogBinding.ACTION_RESULT="multiselectordatadialog result",MultiSelectorDataDialogBinding.prototype.toString=function(){return"[MultiSelectorDataDialogBinding]"},MultiSelectorDataDialogBinding.prototype.onBindingAttach=function(){this.setProperty("label",StringBundle.getString("ui","Website.Misc.MultiSelector.LabelEditSelections")),MultiSelectorDataDialogBinding.superclass.onBindingAttach.call(this)},MultiSelectorDataDialogBinding.prototype.fireCommand=function(){this.dispatchAction(DataDialogBinding.ACTION_COMMAND);var a={label:DataBinding.getAssociatedLabel(this),selections:this.selections},b=this,c={handleDialogResponse:function(a,c){a==Dialog.RESPONSE_ACCEPT&&(b.result=c,b.dispatchAction(MultiSelectorDataDialogBinding.ACTION_RESULT))}},d=ViewDefinitions[this._dialogViewHandle];d.handler=c,d.argument=a,StageBinding.presentViewDefinition(d)},MultiSelectorDataDialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:datadialog",a);return UserInterface.registerBinding(b,MultiSelectorDataDialogBinding)},LazyBindingSetBinding.prototype=new Binding,LazyBindingSetBinding.prototype.constructor=LazyBindingSetBinding,LazyBindingSetBinding.superclass=Binding.prototype,LazyBindingSetBinding.prototype.toString=function(){return"[LazyBindingSetBinding]"},LazyBindingBinding.prototype=new DataBinding,LazyBindingBinding.prototype.constructor=LazyBindingBinding,LazyBindingBinding.superclass=DataBinding.prototype,LazyBindingBinding.ID_APPENDIX="lazybinding",LazyBindingBinding.wakeUp=function(a){var b=a.bindingElement.id+LazyBindingBinding.ID_APPENDIX,c=a.bindingDocument.getElementById(b);if(null!=c){var d=UserInterface.getBinding(c);d.setResult(!0)}},LazyBindingBinding.prototype.toString=function(){return"[LazyBindingBinding]"},LazyBindingBinding.prototype.onBindingRegister=function(){LazyBindingBinding.superclass.onBindingRegister.call(this);var a=this.getProperty("bindingid");if(null!=a){var b=this.bindingDocument.getElementById(a);if(null!=b){var c=UserInterface.getBinding(b);c&&!c.isAttached?c.isLazy=!0:b.setAttribute("lazy",!0)}}},LazyBindingBinding.prototype.validate=function(){return!0},LazyBindingBinding.prototype.manifest=function(){this.isAttached&&(null==this.shadowTree.input&&(this.shadowTree.input=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument),this.shadowTree.input.type="hidden",this.shadowTree.input.name=this.getName(),this.bindingElement.appendChild(this.shadowTree.input)),this.shadowTree.input.value=this.getValue())},LazyBindingBinding.prototype.getValue=function(){return String(this._isLazy)};LazyBindingBinding.prototype.setValue=function(){throw"Not implemented"};LazyBindingBinding.prototype.getResult=function(){return this._isLazy},LazyBindingBinding.prototype.setResult=function(a){this._isLazy=a},EditorDataBinding.prototype=new WindowBinding,EditorDataBinding.prototype.constructor=EditorDataBinding,EditorDataBinding.superclass=WindowBinding.prototype,EditorDataBinding.prototype.toString=function(){return"[EditorDataBinding]"},EditorDataBinding.prototype.onBindingRegister=function(){EditorDataBinding.superclass.onBindingRegister.call(this),DataBinding.prototype.onBindingRegister.call(this),this._coverBinding=this.add(CoverBinding.newInstance(this.bindingDocument)).attach();var a=this._url,b=this.getProperty("stateprovider"),c=this.getProperty("handle");a=null!=b&&null!=c?a.replace("${stateprovider}",b).replace("${handle}",c):a.split("?")[0],this.logger.debug("Loading URL: "+a),this.setURL(a)},EditorDataBinding.prototype.onBindingAttach=function(){EditorDataBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_DIRTY),Application.lock(this)},EditorDataBinding.prototype._onPageInitialize=function(a){EditorDataBinding.superclass._onPageInitialize.call(this,a),null!=this._pageBinding&&(Application.unlock(this),this._coverBinding.hide())},EditorDataBinding.prototype.setName=DataBinding.prototype.setName,EditorDataBinding.prototype.validate=function(){return this._pageBinding.validateAllDataBindings()},EditorDataBinding.prototype.handleAction=function(a){switch(EditorDataBinding.superclass.handleAction.call(this,a),a.type){case Binding.ACTION_DIRTY:a.target!=this&&(this.isDirty||this.dirty(),a.consume())}},EditorDataBinding.prototype.manifest=function(){},EditorDataBinding.prototype.dirty=function(){this.isDirty||(this.isDirty=!0,
this.dispatchAction(Binding.ACTION_DIRTY))},EditorDataBinding.prototype.clean=function(){this._pageBinding.cleanAllDataBindings(),DataBinding.prototype.clean.call(this)},EditorDataBinding.prototype.focus=function(){},EditorDataBinding.prototype.blur=function(){},EditorDataBinding.prototype.getName=function(){},EditorDataBinding.prototype.getValue=function(){},EditorDataBinding.prototype.setValue=function(a){},EditorDataBinding.prototype.getResult=function(){return null},EditorDataBinding.prototype.setResult=function(a){},FunctionEditorDataBinding.prototype=new EditorDataBinding,FunctionEditorDataBinding.prototype.constructor=FunctionEditorDataBinding,FunctionEditorDataBinding.superclass=EditorDataBinding.prototype,FunctionEditorDataBinding.prototype.toString=function(){return"[FunctionEditorDataBinding]"},FunctionEditorDataBinding.prototype.onBindingAttach=function(){FunctionEditorDataBinding.superclass.onBindingAttach.call(this),this.getProperty("hasbasic")&&(this.hasBasic=this.getProperty("hasbasic"))},FunctionEditorDataBinding.prototype._onPageInitialize=function(a){if(FunctionEditorDataBinding.superclass._onPageInitialize.call(this,a),this.hasBasic===!1){var b=this.getContentWindow().bindingMap.basicgroup;b&&b.hide()}},ParameterEditorDataBinding.prototype=new EditorDataBinding,ParameterEditorDataBinding.prototype.constructor=ParameterEditorDataBinding,ParameterEditorDataBinding.superclass=EditorDataBinding.prototype,ParameterEditorDataBinding.prototype.toString=function(){return"[ParameterEditorDataBinding]"},ParameterEditorDataBinding.prototype.getValue=function(){return Math.random()},FilePickerBinding.prototype=new DataBinding,FilePickerBinding.prototype.constructor=FilePickerBinding,FilePickerBinding.superclass=DataBinding.prototype,FilePickerBinding.prototype.toString=function(){return"[FilePickerBinding]"},FilePickerBinding.prototype.onBindingAttach=function(){FilePickerBinding.superclass.onBindingAttach.call(this);var a=this.getDescendantElementsByLocalName("input").getLast(),b=this.getDescendantBindingByLocalName("datainput");b.isFocusable=!1;var c=this;a.onchange=function(){var a=this.value;a.indexOf("/")>-1?a=a.substring(a.lastIndexOf("/")+1):a.indexOf("\\")>-1&&(a=a.substring(a.lastIndexOf("\\")+1)),b.setValue(a),c.dirty(),c._isValid||c.validate()}},FilePickerBinding.prototype.validate=function(){var a=!0;if(this.getProperty("required")){var b=this.getDescendantBindingByLocalName("datainput");a=""!=b.getValue()}return!a&&this._isValid?(this._isValid=!1,this.dispatchAction(Binding.ACTION_INVALID)):a&&!this._isValid&&this.dispatchAction(Binding.ACTION_VALID),a},FilePickerBinding.prototype.focus=function(){if(FilePickerBinding.superclass.focus.call(this),this.isFocused){var a=this.getDescendantBindingByLocalName("datainput");null!=a&&a.attachClassName(DataBinding.CLASSNAME_FOCUSED)}},FilePickerBinding.prototype.blur=function(){if(FilePickerBinding.superclass.blur.call(this),!this.isFocused){var a=this.getDescendantBindingByLocalName("datainput");null!=a&&a.detachClassName(DataBinding.CLASSNAME_FOCUSED)}},FilePickerBinding.prototype.manifest=function(){},FilePickerBinding.prototype.getValue=function(){},FilePickerBinding.prototype.setValue=function(){},FilePickerBinding.prototype.getResult=function(){},FilePickerBinding.prototype.setResult=function(){},RequestBinding.prototype=new Binding,RequestBinding.prototype.constructor=RequestBinding,RequestBinding.superclass=Binding.prototype,RequestBinding.CALLBACK_ID="__REQUEST",RequestBinding.INPUT_ID="__CONSOLEID",RequestBinding.VIEW_ID="__VIEWID",RequestBinding.prototype.toString=function(){return"[RequestBinding]"},RequestBinding.prototype.onBindingAttach=function(){RequestBinding.superclass.onBindingAttach.call(this),this.setCallBackID(RequestBinding.CALLBACK_ID),Binding.dotnetify(this);var a=this.bindingDocument.getElementById(RequestBinding.INPUT_ID);if(null!=a&&(a.value=Application.CONSOLE_ID),a=this.bindingDocument.getElementById(RequestBinding.VIEW_ID),null!=a){var b=this.getAncestorBindingByType(ViewBinding,!0);null!=b&&b.getHandle&&(a.value=b.getHandle())}},RequestBinding.prototype.postback=function(a){a=null!=a?a:EditorPageBinding.message,this.shadowTree.dotnetinput.value=a,this.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},FieldGroupBinding.prototype=new Binding,FieldGroupBinding.prototype.constructor=FieldGroupBinding,FieldGroupBinding.superclass=Binding.prototype,FieldGroupBinding.ACTION_HIDE="fieldgrouphide",FieldGroupBinding.CLASSNAME_NOLABEL="nolabel",FieldGroupBinding.CLASSNAME_FIRST="first",FieldGroupBinding.prototype.toString=function(){return"[FieldGroupBinding]"},FieldGroupBinding.prototype.onBindingRegister=function(){FieldGroupBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.label=this.setLabel,this._buildDOMContent()},FieldGroupBinding.prototype._buildDOMContent=function(){var a=this.getProperty("label");a?this.setLabel(a):this.attachClassName(FieldGroupBinding.CLASSNAME_NOLABEL);var b=this.bindingElement.getElementsByTagName("field");b.length||(b=this.bindingElement.getElementsByTagName("ui:field"));var c=b[0];c&&(c.className+=" first")},FieldGroupBinding.prototype.setLabel=function(a){if(this.setProperty("label",a),null==this.shadowTree.labelBinding){var b=LabelBinding.newInstance(this.bindingDocument);this.shadowTree[FieldGroupBinding.NORTH];b.attachClassName("fieldgrouplabel"),this.bindingElement.insertBefore(b.bindingElement,this.bindingElement.firstChild),b.attach(),this.shadowTree.labelBinding=b,this.shadowTree.labelBinding.bindingElement.appendChild(DOMUtil.createElementNS(Constants.NS_XHTML,"div",this.bindingDocument))}this.shadowTree.labelBinding.setLabel(Resolver.resolve(a))},FieldGroupBinding.prototype.getLabel=function(){return this.getProperty("label")},FieldBinding.prototype=new Binding,FieldBinding.prototype.constructor=FieldBinding,FieldBinding.superclass=Binding.prototype,FieldBinding.prototype.toString=function(){return"[FieldBinding]"},FieldBinding.prototype.onBindingRegister=function(){FieldBinding.superclass.onBindingRegister.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT);var a=this.getProperty("relation");null!=a&&(this.bindingRelation=a,this.subscribe(BroadcastMessages.BINDING_RELATE),this.hide())},FieldBinding.prototype.handleBroadcast=function(a,b){switch(FieldBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.BINDING_RELATE:b.relate==this.bindingRelation&&b.origin==this.bindingDocument&&(1==b.result?this.isVisible||(this.show(),this.dispatchAction(Binding.ACTION_UPDATED)):this.isVisible&&(this.hide(),this.dispatchAction(Binding.ACTION_UPDATED)))}},FieldBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:field",a);return UserInterface.registerBinding(b,FieldBinding)},FieldsBinding.prototype=new Binding,FieldsBinding.prototype.constructor=FieldsBinding,FieldsBinding.superclass=Binding.prototype,FieldsBinding.ACTION_LAYOUT_UPDATED="fieldslayoutupdated",FieldsBinding.prototype.toString=function(){return"[FieldsBinding]"},FieldsBinding.prototype.onBindingRegister=function(){FieldsBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_INVALID),this.addActionListener(Binding.ACTION_VALID),this.addActionListener(FieldGroupBinding.ACTION_HIDE),this._invalidFieldLabels=new Map},FieldsBinding.prototype.onBindingInitialize=function(){FieldsBinding.superclass.onBindingInitialize.call(this),this.bindingElement.style.display="block";var a=this.getDescendantBindingByLocalName("fieldgroup");if(null!=a&&a.attachClassName(FieldGroupBinding.CLASSNAME_FIRST),Client.isEdge){var b=this.getAncestorBindingByType(EditorPageBinding);if(b&&this.bindingElement.childElementCount>0){var c=430;this.bindingElement.style.maxWidth=(this.bindingElement.childElementCount+1)*c-1+"px"}}},FieldsBinding.prototype.onBindingDispose=function(){FieldsBinding.superclass.onBindingDispose.call(this),this._invalidCount>0&&this.dispatchAction(Binding.ACTION_VALID)},FieldsBinding.prototype.validate=function(){for(var a=!0,b=this.getDescendantBindingsByLocalName("*");b.hasNext();){var c=b.getNext();if(Interfaces.isImplemented(IData,c)){var d=c.validate();a&&!d&&(a=!1)}}return a},FieldsBinding.prototype.handleAction=function(a){FieldsBinding.superclass.handleAction.call(this,a);var b=a.target;if(b!=this)switch(a.type){case Binding.ACTION_INVALID:var c=DataBinding.getAssociatedLabel(b);c&&this._invalidFieldLabels.set(b.key,c),b.error&&(b.isInvalidBecauseRequired||ErrorBinding.presentError({text:b.error},b)),0==this._invalidCount&&this.dispatchAction(Binding.ACTION_INVALID),this._invalidCount++,a.consume();break;case Binding.ACTION_VALID:this._invalidFieldLabels.has(b.key)&&this._invalidFieldLabels.del(b.key),this._invalidCount--,0==this._invalidCount&&this.dispatchAction(Binding.ACTION_VALID),a.consume()}},FieldsBinding.prototype.getInvalidLabels=function(){var a=null;return this._invalidFieldLabels.hasEntries()&&(a=this._invalidFieldLabels.toList()),a},FieldsBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:fields",a);return UserInterface.registerBinding(b,FieldsBinding)},FieldDescBinding.prototype=new Binding,FieldDescBinding.prototype.constructor=FieldDescBinding,FieldDescBinding.superclass=Binding.prototype,FieldDescBinding.prototype.toString=function(){return"[FieldDescBinding]"},FieldDescBinding.prototype.onBindingAttach=function(){Binding.prototype.onBindingAttach.call(this),this.buildDOMContent(),this.attachDOMEvents()},FieldDescBinding.prototype.buildDOMContent=function(){var a=this.getProperty("image");a&&this.setImage(a);var b=this.getProperty("tooltip");b&&this.setToolTip(b);var c=this.getProperty("label");c&&this.setLabel(c)},FieldDescBinding.prototype.attachDOMEvents=function(){this.addEventListener(DOMEvents.CLICK)},FieldDescBinding.prototype.handleEvent=function(a){switch(FieldDescBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.CLICK:var b=this.getAncestorBindingByLocalName("field");if(b){var c=!0;b.getDescendantBindingsByLocalName("*").each(function(a){return Interfaces.isImplemented(IData,a)&&(a.focus(),c=!1),c})}}},FieldDescBinding.prototype.setLabel=function(a){this.setProperty("label",a),this.isAttached&&(this.bindingElement.innerHTML=Resolver.resolve(a))},FieldDescBinding.prototype.getLabel=function(){var a=this.getProperty("label");if(!a){var b=this.bindingElement.firstChild;b&&b.nodeType==Node.TEXT_NODE&&(a=b.data)}return a},FieldDescBinding.prototype.setImage=function(a){if(this.setProperty("image",a),this.isAttached)throw"FieldDescBinding: Images not suppoerted!"},FieldDescBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",a),this.isAttached&&(this.bindingElement.title=a)},FieldDescBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:fielddesc",a);return UserInterface.registerBinding(b,FieldDescBinding)},FieldDataBinding.prototype=new Binding,FieldDataBinding.prototype.constructor=FieldDataBinding,FieldDataBinding.superclass=Binding.prototype,FieldDataBinding.prototype.toString=function(){return"[FieldDataBinding]"},FieldDataBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:fielddata",a);return UserInterface.registerBinding(b,FieldDataBinding)},FieldHelpBinding.prototype=new Binding,FieldHelpBinding.prototype.constructor=FieldHelpBinding,FieldHelpBinding.superclass=Binding.prototype,FieldHelpBinding.INDICATOR_IMAGE=null,FieldHelpBinding.prototype.toString=function(){return"[FieldHelpBinding]"},FieldHelpBinding.prototype.onBindingAttach=function(){FieldHelpBinding.superclass.onBindingAttach.call(this),this.buildPopupBinding(),this.buildPopupButton()},FieldHelpBinding.prototype.onBindingDispose=function(){FieldHelpBinding.superclass.onBindingDispose.call(this);var a=this._fieldHelpPopupBinding;a&&a.dispose()},FieldHelpBinding.prototype.buildPopupBinding=function(){var a=app.bindingMap.fieldhelpopupset,b=a.bindingDocument,c=a.add(PopupBinding.newInstance(b)),d=c.add(PopupBodyBinding.newInstance(b));if(c.position=PopupBinding.POSITION_RIGHT,c.attachClassName("fieldhelppopup"),this.bindingElement.hasChildNodes())d.bindingElement.innerHTML=this.bindingElement.innerHTML;else{var e=this.getProperty("label");e&&(d.bindingElement.innerHTML=Resolver.resolve(e))}this.bindingElement.innerHTML="",this._fieldHelpPopupBinding=c},FieldHelpBinding.prototype.buildPopupButton=function(){var a=this.getAncestorBindingByLocalName("field");a&&a.attachClassName("fieldhelp");var b=ClickButtonBinding.newInstance(this.bindingDocument);b.attachClassName("fieldhelp"),b.setImage(FieldHelpBinding.INDICATOR_IMAGE),this.add(b),b.attach();var c=this;b.oncommand=function(){c.attachPopupBinding()},b.setPopup(this._fieldHelpPopupBinding),this._fieldHelpButton=b},FieldHelpBinding.prototype.attachPopupBinding=function(){var a=this._fieldHelpPopupBinding;a&&!a.isAttached&&a.attachRecursive()},ResolverContainerBinding.prototype=new Binding,ResolverContainerBinding.prototype.constructor=ResolverContainerBinding,ResolverContainerBinding.superclass=Binding.prototype,ResolverContainerBinding.prototype.toString=function(){return"[ResolverContainerBinding]"},ResolverContainerBinding.prototype.onBindingAttach=function(){ResolverContainerBinding.superclass.onBindingAttach.call(this),new List(this.bindingElement.attributes).each(function(a){if(a.name.startsWith("data-")){var b=this.bindingDocument.getElementsByName(a.value);new List(b).each(function(b){b.setAttribute("data-qa",a.name.substring("data-".length))})}},this)},RadioDataGroupBinding.prototype=new RadioGroupBinding,RadioDataGroupBinding.prototype.constructor=RadioDataGroupBinding,RadioDataGroupBinding.superclass=RadioGroupBinding.prototype,RadioDataGroupBinding.prototype.toString=function(){return"[RadioDataGroupBinding]"},RadioDataGroupBinding.prototype.onBindingRegister=function(){RadioDataGroupBinding.superclass.onBindingRegister.call(this),DataBinding.prototype.onBindingRegister.call(this),this.addActionListener(RadioGroupBinding.ACTION_SELECTIONCHANGED,this)},RadioDataGroupBinding.prototype.onBindingAttach=function(){RadioDataGroupBinding.superclass.onBindingAttach.call(this),this.bindingElement.tabIndex=0,Client.isExplorer&&(this.bindingElement.hideFocus=!0);var a=this;DOMEvents.addEventListener(this.bindingElement,DOMEvents.FOCUS,{handleEvent:function(){a.focus(!0)}});var b=this.getProperty("onchange");b&&(this.onValueChange=function(){Binding.evaluate(b,this)})},RadioDataGroupBinding.prototype.onBindingDispose=function(){RadioDataGroupBinding.superclass.onBindingDispose.call(this),DataBinding.prototype.onBindingDispose.call(this)},RadioDataGroupBinding.prototype.handleAction=function(a){switch(RadioDataGroupBinding.superclass.handleAction.call(this,a),a.type){case RadioGroupBinding.ACTION_SELECTIONCHANGED:this.dirty(),this.onValueChange()}},RadioDataGroupBinding.prototype.handleEvent=function(a){if(RadioDataGroupBinding.superclass.handleEvent.call(this,a),a.type==DOMEvents.KEYDOWN)switch(a.keyCode){case KeyEventCodes.VK_DOWN:case KeyEventCodes.VK_UP:DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a),Keyboard.keyArrow(a.keyCode)}},RadioDataGroupBinding.prototype.handleBroadcast=function(a,b){switch(RadioDataGroupBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_ARROW:var c=null,d=null,e=null;switch(b){case KeyEventCodes.VK_DOWN:case KeyEventCodes.VK_UP:for(e=this.getChildBindingsByLocalName("radio");!c&&e.hasNext();){var f=e.getNext();f.getProperty("ischecked")&&(c=f)}}if(c)switch(b){case KeyEventCodes.VK_DOWN:for(d=e.getFollowing(c);null!=d&&d.isDisabled;)d=e.getFollowing(d);break;case KeyEventCodes.VK_UP:for(d=e.getPreceding(c);null!=d&&d.isDisabled;)d=e.getPreceding(d)}null!=d&&this.setCheckedButtonBinding(d)}},RadioDataGroupBinding.prototype.setName=DataBinding.prototype.setName,RadioDataGroupBinding.prototype.getName=DataBinding.prototype.getName,RadioDataGroupBinding.prototype.dirty=DataBinding.prototype.dirty,RadioDataGroupBinding.prototype.clean=DataBinding.prototype.clean,RadioDataGroupBinding.prototype.focus=function(a){this.isFocused||(DataBinding.prototype.focus.call(this),this.isFocused&&(a||FocusBinding.focusElement(this.bindingElement),this.addEventListener(DOMEvents.KEYDOWN),this.subscribe(BroadcastMessages.KEY_ARROW)))},RadioDataGroupBinding.prototype.blur=function(){this.isFocused&&(DataBinding.prototype.blur.call(this),this.removeEventListener(DOMEvents.KEYDOWN),this.unsubscribe(BroadcastMessages.KEY_ARROW))},RadioDataGroupBinding.prototype.validate=function(){return!0},RadioDataGroupBinding.prototype.manifest=function(){if(this.isAttached){if(!this.shadowTree.input){var a=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);a.type="hidden",a.name=this._name,this.bindingElement.appendChild(a),this.shadowTree.input=a}this.shadowTree.input.value=this.getValue()}},RadioDataGroupBinding.prototype.getValue=function(){for(var a=null,b=this.getChildBindingsByLocalName("radio");!a&&b.hasNext();){var c=b.getNext();c.isChecked&&(a=c.getProperty("value"))}return a},RadioDataGroupBinding.prototype.getResult=RadioDataGroupBinding.prototype.getValue,RadioDataGroupBinding.prototype.setValue=function(a){},RadioDataGroupBinding.prototype.setResult=function(a){},RadioDataGroupBinding.prototype.onValueChange=function(){},RadioDataBinding.prototype=new Binding,RadioDataBinding.prototype.constructor=RadioDataBinding,RadioDataBinding.superclass=Binding.prototype,RadioDataBinding.prototype.toString=function(){return"[RadioDataBinding]"},RadioDataBinding.prototype.onBindingRegister=function(){RadioDataBinding.superclass.onBindingRegister.call(this),this._buttonBinding=this.add(RadioButtonBinding.newInstance(this.bindingDocument)),this._hack(),1==this.getProperty("ischecked")&&this.check(!0)},RadioDataBinding.prototype.onBindingAttach=function(){RadioDataBinding.superclass.onBindingAttach.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT),this._buttonBinding.attach(),this._buildDOMContent()},RadioDataBinding.prototype._buildDOMContent=function(){var a=this.getProperty("relate"),b=this.getProperty("oncommand"),c=this.getProperty("isdisabled");a&&(this.bindingRelate=a,this.relate()),b&&(this.oncommand=function(){Binding.evaluate(b,this)}),1==c&&this.disable(),this.hasCallBackID()&&Binding.dotnetify(this),this._buildLabelText()},RadioDataBinding.prototype.relate=function(){null!=this.bindingRelate&&(this.logger.warn("Relations not properly implemented!"),EventBroadcaster.broadcast(BroadcastMessages.BINDING_RELATE,{relate:this.bindingRelate,origin:this.bindingDocument,result:this.isChecked}))},RadioDataBinding.prototype.getButton=function(){return this._buttonBinding},RadioDataBinding.prototype._hack=function(){var a=this;this.getCallBackID();this._buttonBinding.check=function(b){RadioButtonBinding.prototype.check.call(this,b),a.setProperty("ischecked",!0),a.isChecked=!0,a.relate()},this._buttonBinding.uncheck=function(b){RadioButtonBinding.prototype.uncheck.call(this,b),a.deleteProperty("ischecked"),a.isChecked=!1,a.relate()},this._buttonBinding.oncommand=function(){a.isChecked=this.isChecked,a.setProperty("ischecked",a.isChecked),a.relate(),Types.isFunction(a.oncommand)&&a.oncommand()}},RadioDataBinding.prototype.setChecked=function(a,b){this._buttonBinding.setChecked(a,b),null!=this.bindingRelate&&this.relate(),this.setProperty("ischecked",a)},RadioDataBinding.prototype.check=function(a){this.setChecked(!0,a)},RadioDataBinding.prototype.uncheck=function(a){this.setChecked(!1,a)},RadioDataBinding.prototype.setDisabled=function(a){a!=this.isDisabled&&(this.isDisabled=a,this._buttonBinding.setDisabled(a),a?this.attachClassName(DataBinding.CLASSNAME_DISABLED):this.detachClassName(DataBinding.CLASSNAME_DISABLED))},RadioDataBinding.prototype.disable=function(){this.isDisabled||this.setDisabled(!0)},RadioDataBinding.prototype.enable=function(){this.isDisabled&&this.setDisabled(!1)},RadioDataBinding.prototype.handleEvent=function(a){if(RadioDataBinding.superclass.handleEvent.call(this,a),a.type==DOMEvents.CLICK){var b=DOMEvents.getTarget(a);switch(b){case this.shadowTree.labelText:this.isChecked||this.isDisabled||this.check()}}},RadioDataBinding.prototype._buildLabelText=function(){var a=this.getProperty("label");a&&(this.shadowTree.labelText=DOMUtil.createElementNS(Constants.NS_UI,"ui:datalabeltext",this.bindingDocument),this.shadowTree.labelText.appendChild(this.bindingDocument.createTextNode(Resolver.resolve(a))),DOMEvents.addEventListener(this.shadowTree.labelText,DOMEvents.CLICK,this),this.bindingElement.appendChild(this.shadowTree.labelText))},RadioDataBinding.prototype.setLabel=function(a){null!=this.shadowTree.labelText&&(this.shadowTree.labelText.firstChild.data=a),this.setProperty("label",a)},RadioDataBinding.prototype.handleElement=function(a){return!0},RadioDataBinding.prototype.updateElement=function(a){var b="true"===a.getAttribute("ischecked");return this.isChecked!=b&&this.setChecked(b,!0),!0},CheckBoxBinding.prototype=new Binding,CheckBoxBinding.prototype.constructor=CheckBoxBinding,CheckBoxBinding.superclass=Binding.prototype,CheckBoxBinding.ACTION_COMMAND="checkbox command",CheckBoxBinding.prototype.toString=function(){return"[CheckBoxBinding]"},CheckBoxBinding.prototype.onBindingRegister=function(){CheckBoxBinding.superclass.onBindingRegister.call(this),DataBinding.prototype.onBindingRegister.call(this),this._buildButtonBinding()},CheckBoxBinding.prototype.onBindingAttach=function(){CheckBoxBinding.superclass.onBindingAttach.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT),this.bindingElement.tabIndex=0,Client.isExplorer&&(this.bindingElement.hideFocus=!0),this._buildDOMContent()},CheckBoxBinding.prototype.onBindingDispose=function(){CheckBoxBinding.superclass.onBindingRegister.call(this),DataBinding.prototype.onBindingDispose.call(this)},CheckBoxBinding.prototype._buildDOMContent=RadioDataBinding.prototype._buildDOMContent,CheckBoxBinding.prototype.handleEvent=function(a){if(CheckBoxBinding.superclass.handleEvent.call(this,a),a.type==DOMEvents.CLICK){var b=DOMEvents.getTarget(a);switch(b){case this.shadowTree.labelText:this.setChecked(!this.isChecked)}}},CheckBoxBinding.prototype.relate=RadioDataBinding.prototype.relate,CheckBoxBinding.prototype.handleBroadcast=function(a,b){switch(CheckBoxBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_SPACE:this.setChecked(!this.isChecked)}},CheckBoxBinding.prototype._buildButtonBinding=function(){this._buttonBinding=this.add(CheckButtonBinding.newInstance(this.bindingDocument));var a=this;this._buttonBinding.addActionListener(ButtonBinding.ACTION_COMMAND,{handleAction:function(b){b.consume(),a.dispatchAction(CheckBoxBinding.ACTION_COMMAND)}}),this._hack(),this._buttonBinding.attach(),this.getProperty("ischecked")&&this.check(!0)},CheckBoxBinding.prototype._hack=function(){var a=this,b=this.getCallBackID();this._buttonBinding.check=function(b){ButtonBinding.prototype.check.call(this,b),a.setProperty("ischecked",!0),a.isChecked=!0,a.relate(),b||a.focus()},this._buttonBinding.uncheck=function(b){ButtonBinding.prototype.uncheck.call(this,b),a.setProperty("ischecked",!1),a.isChecked=!1,a.relate()},this._buttonBinding.oncommand=function(){a.isChecked=this.isChecked,a.setProperty("ischecked",a.isChecked),a.focus(),a.relate(),a.oncommand&&a.oncommand(),a.dirty(),null!=b&&a.dispatchAction(PageBinding.ACTION_DOPOSTBACK)}},CheckBoxBinding.prototype.setChecked=RadioDataBinding.prototype.setChecked,CheckBoxBinding.prototype.check=RadioDataBinding.prototype.check,CheckBoxBinding.prototype.uncheck=RadioDataBinding.prototype.uncheck,CheckBoxBinding.prototype._buildLabelText=RadioDataBinding.prototype._buildLabelText,CheckBoxBinding.prototype.setLabel=RadioDataBinding.prototype.setLabel,CheckBoxBinding.prototype.setName=DataBinding.prototype.setName,CheckBoxBinding.prototype.getName=DataBinding.prototype.getName,CheckBoxBinding.prototype.dirty=DataBinding.prototype.dirty,CheckBoxBinding.prototype.clean=DataBinding.prototype.clean,CheckBoxBinding.prototype.focus=function(){this.isFocused||(DataBinding.prototype.focus.call(this),this.isFocused&&(FocusBinding.focusElement(this.bindingElement),this.subscribe(BroadcastMessages.KEY_SPACE)))},CheckBoxBinding.prototype.blur=function(){this.isFocused&&(DataBinding.prototype.blur.call(this),this.unsubscribe(BroadcastMessages.KEY_SPACE))},CheckBoxBinding.prototype.validate=function(){var a=!0,b=this.bindingElement.parentNode;if(b){var c=UserInterface.getBinding(b);c&&c instanceof CheckBoxGroupBinding&&c.isRequired&&(a=!!c.isValid&&c.validate())}return a},CheckBoxBinding.prototype.handleElement=RadioDataBinding.prototype.handleElement,CheckBoxBinding.prototype.updateElement=RadioDataBinding.prototype.updateElement,CheckBoxBinding.prototype.manifest=function(){if(this.isAttached)switch(this.isChecked){case!0:if(!this.shadowTree.input){var a=DOMUtil.createElementNS(Constants.NS_XHTML,"input",this.bindingDocument);a.type="hidden",a.name=this._name,a.style.display="none",this.bindingElement.appendChild(a),this.shadowTree.input=a}this.shadowTree.input.value=this.getValue();break;case!1:this.shadowTree.input&&(this.bindingElement.removeChild(this.shadowTree.input),this.shadowTree.input=null)}},CheckBoxBinding.prototype.getValue=function(){var a=null,b=this.getProperty("value");return this.isChecked&&(a=b?b:"on"),a},CheckBoxBinding.prototype.setValue=function(a){a==this.getValue()||"on"==a?this.check(!0):"on"!=a&&this.setPropety("value",a)},CheckBoxBinding.prototype.getResult=function(){var a=!1;return this.isChecked&&(a=null==this._result||this._result),a},CheckBoxBinding.prototype.setResult=function(a){"boolean"==typeof a?this.setChecked(a,!0):this._result=a},CheckBoxBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:checkbox",a);return UserInterface.registerBinding(b,CheckBoxBinding)},CheckBoxGroupBinding.prototype=new Binding,CheckBoxGroupBinding.prototype.constructor=CheckBoxGroupBinding,CheckBoxGroupBinding.superclass=Binding.prototype,CheckBoxGroupBinding.prototype.toString=function(){return"[CheckBoxGroupBinding]"};CheckBoxGroupBinding.prototype.onBindingAttach=function(){CheckBoxGroupBinding.superclass.onBindingAttach.call(this),this.isRequired=1==this.getProperty("required")};CheckBoxGroupBinding.prototype.validate=function(){var a=!0;if(this.isRequired){var b=this.getDescendantBindingsByLocalName("checkbox");if(b.hasEntries())for(a=!1;b.hasNext()&&!a;)b.getNext().isChecked&&(a=!0);0==a&&(this._showWarning(!0),this.dispatchAction(Binding.ACTION_INVALID),this.addActionListener(CheckBoxBinding.ACTION_COMMAND))}return a},CheckBoxGroupBinding.prototype._showWarning=function(a){if(a){if(!this._labelBinding){var b=LabelBinding.newInstance(this.bindingDocument);b.attachClassName("invalid"),b.setImage("${icon:error}"),b.setLabel("Selection required"),this._labelBinding=this.addFirst(b),this._labelBinding.attach()}}else this._labelBinding&&(this._labelBinding.dispose(),this._labelBinding=null)},CheckBoxGroupBinding.prototype.handleAction=function(a){switch(CheckBoxGroupBinding.superclass.handleAction.call(this,a),a.type){case CheckBoxBinding.ACTION_COMMAND:this._showWarning(!1),this.dispatchAction(Binding.ACTION_VALID),this.removeActionListener(CheckBoxBinding.ACTION_COMMAND)}},CheckBoxGroupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:checkboxgroup",a);return UserInterface.registerBinding(b,CheckBoxGroupBinding)},BalloonSetBinding.prototype=new Binding,BalloonSetBinding.prototype.constructor=BalloonSetBinding,BalloonSetBinding.superclass=Binding.prototype,BalloonSetBinding.prototype.toString=function(){return"[BalloonSetBinding]"},BalloonBinding.prototype=new Binding,BalloonBinding.prototype.constructor=BalloonBinding,BalloonBinding.superclass=Binding.prototype,BalloonBinding.TIMEOUT=parseInt(200),BalloonBinding.OFFSET_X=parseInt(14),BalloonBinding.OFFSET_Y=parseInt(6),BalloonBinding.ACTION_SNAP="balloon snap",BalloonBinding.CLASSNAME_LEFT="left",BalloonBinding.ACTION_INITIALIZE="ballon initialize",BalloonBinding.prototype.toString=function(){return"[BalloonBinding]"},BalloonBinding.prototype.onBindingAttach=function(){BalloonBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_ACTIVATED),this.addActionListener(ControlBinding.ACTION_COMMAND),this._controlGroupBinding=this.add(ControlGroupBinding.newInstance(this.bindingDocument));var a=DialogControlBinding.newInstance(this.bindingDocument);a.setControlType(ControlBinding.TYPE_CLOSE),this._controlGroupBinding.add(a),this._controlGroupBinding.attachRecursive();var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:balloonspeak",this.bindingDocument);this.bindingElement.appendChild(b);var c=this.getLabel();null!=c&&this.setLabel(c)},BalloonBinding.prototype.onBindingDispose=function(){BalloonBinding.superclass.onBindingDispose.call(this),this._updateInterval&&(window.clearInterval(this._updateInterval),this._updateInterval=null);var a=this._snapTargetBinding;1==Binding.exists(a)&&(a.removeActionListener(Binding.ACTION_BLURRED,this),a.removeActionListener(Binding.ACTION_VALID,this))},BalloonBinding.prototype.snapTo=function(a){if(Interfaces.isImplemented(IData,a)){this._snapTargetBinding=a;var b=a.dispatchAction(BalloonBinding.ACTION_INITIALIZE);if(b&&b.isConsumed&&(this._environmentBinding=b.listener),!this._environmentBinding)throw"No environment fit for balloons!";a.addActionListener(Binding.ACTION_BLURRED,this),a.addActionListener(Binding.ACTION_VALID,this),this.subscribe(BroadcastMessages.VIEW_CLOSED);var c=this;this._updateInterval=window.setInterval(function(){1==Binding.exists(a)?c._updatePosition():c.dispose()},BalloonBinding.TIMEOUT),a.dispatchAction(BalloonBinding.ACTION_SNAP)}},BalloonBinding.prototype.isSnapTo=function(a){return a===this._snapTargetBinding},BalloonBinding.prototype._updatePosition=function(){var a=this._snapTargetBinding,b=this._environmentBinding,c=UserInterface.getBinding(a.bindingDocument.body);if(Binding.exists(a)&&Binding.exists(b))if(c.isActivated){if(a.isAttached&&b.isAttached){var d=a.boxObject.getUniversalPosition(),e=b.boxObject.getUniversalPosition();e.y+=b.bindingElement.scrollTop,e.x+=b.bindingElement.scrollLeft;var f=a.boxObject.getDimension(),g=b.boxObject.getDimension(),h=!1;d.y+f.h<e.y?h=!0:d.x+f.w<e.x?h=!0:d.y>e.y+g.h?h=!0:d.x>e.x+g.w&&(h=!0),h?1==this.isVisible&&this.hide():(this._setComputedPosition(d,e,f,g),this.isVisible||this.show())}}else 1==this.isVisible&&this.hide();else this.dispose()},BalloonBinding.prototype._setComputedPosition=function(a,b,c,d){var e=WindowManager.getWindowDimensions(),f=this._getDimension(),g=a,h=!1;a.x+c.w+f.w+BalloonBinding.OFFSET_X>=e.w?h=!0:a.x+c.w>=b.x+d.w&&(h=!0),h?g.x<f.w+BalloonBinding.OFFSET_X?(g.x+=2*BalloonBinding.OFFSET_X,this.detachClassName(BalloonBinding.CLASSNAME_LEFT)):(g.x-=f.w+BalloonBinding.OFFSET_X,this.attachClassName(BalloonBinding.CLASSNAME_LEFT)):(g.x+=c.w+BalloonBinding.OFFSET_X,this.detachClassName(BalloonBinding.CLASSNAME_LEFT)),g.y-=f.h,g.y+=BalloonBinding.OFFSET_Y,g.y=Math.round(g.y),this._setPosition(g)},BalloonBinding.prototype.handleBroadcast=function(a,b){switch(BalloonBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.VIEW_CLOSED:1==this._isAssociatedView(b)&&this.dispose()}},BalloonBinding.prototype._isAssociatedView=function(a){var b=!1;if(this._snapTargetBinding){var c=this._snapTargetBinding.getAncestorBindingByType(ViewBinding,!0);c&&c.getHandle()==a&&(b=!0)}return b},BalloonBinding.prototype._setPosition=function(a){var b=!1,c=this.boxObject.getLocalPosition();null!=this._point&&(c.x==this._point.x&&c.y==this._point.y||(b=!0)),b||(this.bindingElement.style.left=a.x+"px",this.bindingElement.style.top=a.y+"px",this._point=a)},BalloonBinding.prototype._getPosition=function(){return new Point(this.bindingElement.offsetLeft,this.bindingElement.offsetTop)},BalloonBinding.prototype._getDimension=function(){
return new Dimension(this.bindingElement.offsetWidth,this.bindingElement.offsetHeight)},BalloonBinding.prototype.hide=function(){this.isVisible&&(this.bindingElement.style.visibility="hidden",this.isVisible=!1)},BalloonBinding.prototype.show=function(){this.isVisible||(this.bindingElement.style.visibility="visible",this.isVisible=!0)},BalloonBinding.prototype.handleAction=function(a){BalloonBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case Binding.ACTION_ACTIVATED:this._snapTargetBinding&&(this._snapTargetBinding.dispatchAction(Binding.ACTION_ACTIVATED),a.consume());case Binding.ACTION_BLURRED:case Binding.ACTION_VALID:if(b==this._snapTargetBinding){var c=this;setTimeout(function(){if(Binding.exists(b)){if(b.validate()){var d=!0;if(a.type==Binding.ACTION_BLURRED){var e=b.bindingDocument.body;UserInterface.getBinding(e);e.isActivated||(d=!1)}d&&c.dispose()}}else c.dispose()},0)}break;case ControlBinding.ACTION_COMMAND:this.dispose()}},BalloonBinding.prototype.setLabel=function(a){if(this.isAttached){for(this.shadowTree.balloontext||(this.shadowTree.balloontext=DOMUtil.createElementNS(Constants.NS_UI,"ui:balloontext",this.bindingDocument),this.bindingElement.appendChild(this.shadowTree.balloontext));this.shadowTree.balloontext.firstChild;)this.shadowTree.balloontext.removeChild(this.shadowTree.balloontext.firstChild);var b=this.bindingDocument.createTextNode(a);this.shadowTree.balloontext.appendChild(b)}this.setProperty("label",a)},BalloonBinding.prototype.getLabel=function(){return this.getProperty("label")},BalloonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:balloon",a),c=UserInterface.registerBinding(b,BalloonBinding);return c.hide(),c},ErrorBinding.prototype=new Binding,ErrorBinding.prototype.constructor=ErrorBinding,ErrorBinding.superclass=Binding.prototype,ErrorBinding.ACTION_INITIALIZE="error initialize",ErrorBinding.presentError=function(a,b){if(1==Interfaces.isImplemented(IData,b)){var c,d=b.dispatchAction(ErrorBinding.ACTION_INITIALIZE);if(d&&d.isConsumed)switch(d.listener.constructor){case StageBinding:c=!1;break;case StageDialogBinding:c=!0}var e=c?top.app.bindingMap.dialogballoonset:top.app.bindingMap.balloonset,f=null;e.getDescendantBindingsByType(BalloonBinding).each(function(a){return!a.isSnapTo(b)||(f=a,!1)},this),null!=f?f.setLabel(a.text):(f=e.add(BalloonBinding.newInstance(top.app.document)),f.setLabel(a.text),f.snapTo(b),f.attach())}},ErrorBinding.prototype.toString=function(){return"[ErrorBinding]"},ErrorBinding.prototype.onBindingAttach=function(){ErrorBinding.superclass.onBindingAttach.call(this);var a=this.bindingWindow.DataManager,b=this.getProperty("text"),c=this.getProperty("targetname"),d=a.getDataBinding(c);d?ErrorBinding.presentError({text:b},d):window.console&&(console.error("ErrorBinding dysfunction: No such DataBinding!\n"+c),c.indexOf("_")>-1&&console.error("Name contains '_' - replace with '$' ?")),this.dispose()},FocusBinding.prototype=new FlexBoxBinding,FocusBinding.prototype.constructor=FocusBinding,FocusBinding.superclass=FlexBoxBinding.prototype,FocusBinding.MARKER="focusbindingcurrentfocus",FocusBinding.ACTION_ACTIVATED="focusmanager activated",FocusBinding.ACTION_ATTACHED="focusmanager attached",FocusBinding.ACTION_UPDATE="focusmanager update required",FocusBinding.ACTION_FOCUS="focusmanager focus",FocusBinding.ACTION_BLUR="focusmanager blur",FocusBinding.focusElement=function(a){var b=!0;try{a.focus(),Application.focused(!0)}catch(e){var c=UserInterface.getBinding(a),d=SystemLogger.getLogger("FocusBinding.focusElement");d.warn("Could not focus "+(c?c.toString():String(a))),b=!1}return b},FocusBinding.focusedBinding=null,FocusBinding.activeInstance=null,FocusBinding.getCachedFocus=function(a){var b=a.bindingWindow,c=a.bindingElement.id;return{getBinding:function(){var d=null;try{Binding.exists(a)&&(d=b.bindingMap[c])}catch(a){}return d}}},FocusBinding.navigateNext=function(a){Binding.exists(FocusBinding.activeInstance)&&FocusBinding.activeInstance.focusNext(a)},FocusBinding.navigatePrevious=function(){FocusBinding.navigateNext(!0)},FocusBinding.prototype.toString=function(){return"[FocusManangerBinding]"},FocusBinding.prototype.onBindingAttach=function(){if(0==this.getProperty("focusmanager"))this._isFocusManager=!1;else if(0==this.getProperty("strongfocusmanager")&&(this.isStrongFocusManager=!1),this._isFocusManager){var a=this.dispatchAction(FocusBinding.ACTION_ATTACHED);a&&a.isConsumed&&a.listener.isStrongFocusManager&&(this._isFocusManager=!1),this._isFocusManager&&(this.addActionListener(Binding.ACTION_ACTIVATED),this.addActionListener(Binding.ACTION_FOCUSED),this.addActionListener(Binding.ACTION_BLURRED),this.addActionListener(FocusBinding.ACTION_UPDATE),this.addActionListener(FocusBinding.ACTION_FOCUS),this.addActionListener(FocusBinding.ACTION_BLUR),this.addActionListener(FocusBinding.ACTION_ATTACHED))}FocusBinding.superclass.onBindingAttach.call(this)},FocusBinding.prototype.onBindingDispose=function(){FocusBinding.superclass.onBindingDispose.call(this),FocusBinding.activeInstance==this&&(FocusBinding.activeInstance=null)},FocusBinding.prototype.handleAction=function(a){FocusBinding.superclass.handleAction.call(this,a);var b=a.target,c=null;if(this._isFocusManager)switch(a.type){case FocusBinding.ACTION_ATTACHED:b!=this&&(this._isUpToDate=!1),a.consume();break;case FocusBinding.ACTION_UPDATE:b!=this&&(this._isUpToDate=!1,a.consume());break;case FocusBinding.ACTION_BLUR:Application.isOperational&&(c=new FocusCrawler,c.mode=FocusCrawler.MODE_BLUR,c.crawl(b.bindingElement),null!=this._cachedFocus&&(this._cachedFocus=null)),a.consume();break;case FocusBinding.ACTION_FOCUS:Application.isOperational&&b!=this&&(c=new FocusCrawler,c.mode=FocusCrawler.MODE_FOCUS,c.crawl(b.bindingElement)),a.consume();break;case Binding.ACTION_FOCUSED:Interfaces.isImplemented(IFocusable,b)&&(this.claimFocus(),this._onFocusableFocused(b)),a.consume();break;case Binding.ACTION_BLURRED:Interfaces.isImplemented(IFocusable,b)&&this._onFocusableBlurred(b),a.consume()}},FocusBinding.prototype.focusNext=function(a){var b=null,c=this._getFocusableList();if(c.reset().hasEntries()){for(;null==b&&c.hasNext();){var d=c.getNext();this._cachedFocus&&d==this._cachedFocus.getBinding()&&(b=d)}if(null!=b)if(d.isFocused){var e=a?c.getPreceding(b):c.getFollowing(b);e||(e=a?c.getLast():c.getFirst()),e.focus()}else b.focus();else c.getFirst().focus()}},FocusBinding.prototype.claimFocus=function(){FocusBinding.activeInstance=this},FocusBinding.prototype._getFocusableList=function(){if(!this._isUpToDate){var a=new FocusCrawler,b=new List;a.mode=FocusCrawler.MODE_INDEX,a.crawl(this.bindingElement,b),this._focusableList=b,this._isUpToDate=!0}return this._focusableList},FocusBinding.prototype._focusFirstFocusable=function(){if(this._isFocusManager&&this.isActivated){var a=this._getFocusableList();null!=a?a.hasEntries()&&a.getFirst().focus():this.logger.warn("Could not compute focusable list.")}},FocusBinding.prototype._focusPreviouslyFocused=function(){if(this._cachedFocus){var a=this._cachedFocus.getBinding();a&&!a.isFocused&&a.focus()}},FocusBinding.prototype._onFocusableFocused=function(a){a!=FocusBinding.focusedBinding&&(null!=FocusBinding.focusedBinding&&Binding.exists(FocusBinding.focusedBinding)&&FocusBinding.focusedBinding.blur(),FocusBinding.focusedBinding=a,a.setProperty(FocusBinding.MARKER,!0),this._cachedFocus=FocusBinding.getCachedFocus(a))},FocusBinding.prototype._onFocusableBlurred=function(a){a.deleteProperty(FocusBinding.MARKER),a==FocusBinding.focusedBinding&&(FocusBinding.focusedBinding=null)},TabsButtonBinding.prototype=new ButtonBinding,TabsButtonBinding.prototype.constructor=TabsButtonBinding,TabsButtonBinding.superclass=ButtonBinding.prototype,TabsButtonBinding.RESERVED_SPACE=36,TabsButtonBinding.NODENAME_TABBOX="tabbox",TabsButtonBinding.CHAR_INDICATOR=String.fromCharCode(187),TabsButtonBinding.prototype.toString=function(){return"[TabsButtonBinding]"},TabsButtonBinding.prototype.onBindingRegister=function(){TabsButtonBinding.superclass.onBindingRegister.call(this),this.hiddenTabBindings=new List,this.menuItemBindings=new List},TabsButtonBinding.prototype.buildDOMContent=function(){TabsButtonBinding.superclass.buildDOMContent.call(this),this.containingTabBoxBinding=this.getAncestorBindingByLocalName(this.constructor.NODENAME_TABBOX);var a=this.bindingDocument.createElement("span");a.appendChild(this.bindingDocument.createTextNode(TabsButtonBinding.CHAR_INDICATOR)),a.className="arrow",this.labelBinding.bindingElement.appendChild(a)},TabsButtonBinding.prototype.show=function(a){this.bindingElement.style.left=a+"px",this.setLabel(this.hiddenTabBindings.getLength().toString()),TabsButtonBinding.superclass.show.call(this)},TabsButtonBinding.prototype.reset=function(){if(this.menuItemBindings.hasEntries())for(;this.menuItemBindings.hasNext();)this.menuItemBindings.getNext().dispose();this.hiddenTabBindings.clear(),this.menuItemBindings.clear(),this.selectedTabBinding=null,this.isPopulated=!1},TabsButtonBinding.prototype.registerHiddenTabBinding=function(a){this.hiddenTabBindings.add(a)},TabsButtonBinding.prototype.fireCommand=function(){if(this.isChecked&&!this.isPopulated){for(this.hiddenTabBindings.reset();this.hiddenTabBindings.hasNext();){var a=this.hiddenTabBindings.getNext(),b=MenuItemBinding.newInstance(this.popupBinding.bindingDocument);b.setLabel(a.getLabel()),b.setImage(a.getImage()),b.associatedTabBinding=a;var c=this;b.oncommand=function(){c.selectedTabBinding=this.associatedTabBinding},this.popupBinding.add(b),this.menuItemBindings.add(b),this.popupBinding.attachRecursive()}this.isPopulated=!0}this.popupBinding.addActionListener(PopupBinding.ACTION_HIDE,this),TabsButtonBinding.superclass.fireCommand.call(this)},TabsButtonBinding.prototype.handleAction=function(a){switch(TabsButtonBinding.superclass.handleAction.call(this,a),a.type){case PopupBinding.ACTION_HIDE:this.popupBinding.removeActionListener(PopupBinding.ACTION_HIDE,this);var b=this.selectedTabBinding;b&&(this.containingTabBoxBinding.moveToOrdinalPosition(b,0),this.containingTabBoxBinding.select(b)),a.consume()}},TabsButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbutton",a);return b.setAttribute("type","checkbox"),b.setAttribute("popup","app.bindingMap.tabsbuttonpopup"),b.className="tabbutton",UserInterface.registerBinding(b,TabsButtonBinding)},TabBoxBinding.prototype=new FlexBoxBinding,TabBoxBinding.prototype.constructor=TabBoxBinding,TabBoxBinding.superclass=FlexBoxBinding.prototype,TabBoxBinding.ASSOCIATION_KEY="tabboxkey",TabBoxBinding.ACTION_ATTACHED="tabbox attached",TabBoxBinding.ACTION_SELECTED="tabbox selected",TabBoxBinding.ACTION_UNSELECTED="tabbox unselected",TabBoxBinding.ACTION_UPDATED="tabbox updated",TabBoxBinding.UPDATE_ORDINAL="tabbox ordinalupdate",TabBoxBinding.UPDATE_ATTACH="tabbox attachupdate",TabBoxBinding.UPDATE_DETACH="tabbox detachupdate",TabBoxBinding.INVALID_TAB_IMAGE="${icon:error}",TabBoxBinding.BALLOON_TAB_IMAGE="${icon:balloon}",EventBroadcaster.subscribe(BroadcastMessages.KEY_TAB,{handleBroadcast:function(){if(Keyboard.isControlPressed){var a=TabBoxBinding.currentActiveInstance;null!=a&&Binding.exists(a)}}}),TabBoxBinding.currentActiveInstance=null,TabBoxBinding.prototype.toString=function(){return"[TabBoxBinding]"},TabBoxBinding.prototype.onBindingRegister=function(){TabBoxBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_ATTACHED),this.addActionListener(Binding.ACTION_DETACHED),this.addActionListener(Binding.ACTION_ACTIVATED),this.addActionListener(Binding.ACTION_FOCUSED),this.addActionListener(PageBinding.ACTION_INITIALIZED),DOMEvents.addEventListener(this.bindingDocument.documentElement,DOMEvents.AFTERUPDATE,this),DOMEvents.addEventListener(this.bindingElement,DOMEvents.AFTERUPDATE,this)},TabBoxBinding.prototype.onBindingAttach=function(){TabBoxBinding.superclass.onBindingAttach.call(this),TabBoxBinding.currentActiveInstance=this,this._tabsElement=this.getTabsElement(),this._tabPanelsElement=this.getTabPanelsElement();var a=this.getTabElements().getLength(),b=this.getTabPanelElements().getLength();if(!this._tabsElement||!this._tabPanelsElement)throw new Error(this.toString()+" DOM subtree invalid.");if(a!=b)throw new Error(this.toString()+" DOM subtree invalid.");"boxed"==this.getProperty("type")&&(this.setFlexibility(!1),this.attachClassName("boxed")),this.buildDOMContent(),this._TEMPNAME(),1==this.getProperty("equalsize")?(this.dispatchAction(PageBinding.ACTION_BLOCK_INIT),this.setFlexibility(!1),this.attachClassName("equalsize"),this.isEqualSize=!0,this.addMembers(this.getDescendantBindingsByLocalName("*"))):(this.addMember(this.getTabsBinding()),this.addMember(this.getTabPanelsBinding()),this.addMembers(this.getTabBindings()),this.addMembers(this.getTabPanelBindings()))},TabBoxBinding.prototype.onBindingInitialize=function(){for(var a=this.getTabPanelElements();a.hasNext();)this._setupWarningSystem(UserInterface.getBinding(a.getNext()));this.isEqualSize&&(this.enforceEqualSize(),this.dispatchAction(PageBinding.ACTION_UNBLOCK_INIT)),this.dispatchAction(TabBoxBinding.ACTION_ATTACHED),TabBoxBinding.superclass.onBindingInitialize.call(this)},TabBoxBinding.prototype.buildDOMContent=function(){var a=DOMUtil.getOrdinalPosition(this._tabsElement),b=DOMUtil.getOrdinalPosition(this._tabPanelsElement),c=a>b?"tabsbelow":"tabsontop";this.attachClassName(c)},TabBoxBinding.prototype._TEMPNAME=function(){var a=this.getTabElements(),b=this.getTabPanelElements(),c=null,d=this.getProperty("selectedindex");if(null!=d&&d>a.getLength()-1)throw"Selectedindex out of range";if(a.hasEntries()){for(var e=0;a.hasNext();){var f=a.getNext(),g=b.getNext();this.registerTabBoxPair(f,g),d&&e==d?f.setAttribute("selected","true"):"true"==f.getAttribute("selected")&&(c=f),e++}c||(c=a.getFirst(),c.setAttribute("selected","true"))}},TabBoxBinding.prototype.enforceEqualSize=function(a){var b=null,c=null;if(this.isEqualSize){var d=CSSComputer.getPadding(this._tabPanelsElement),e=0,f=this.getTabPanelElements();f.each(function(a){e=a.offsetHeight>e?a.offsetHeight:e}),c=e+d.top+d.bottom,a&&null!=this._tabPanelsElement.style.height&&(b=this._tabPanelsElement.offsetHeight),(null!=b||c>b)&&(this._tabPanelsElement.style.height=c+"px")}},TabBoxBinding.prototype._setupWarningSystem=function(a){a._invalidCount=0,a.addActionListener(Binding.ACTION_INVALID,this),a.addActionListener(Binding.ACTION_VALID,this),a.addActionListener(BalloonBinding.ACTION_SNAP,this)},TabBoxBinding.prototype.handleAction=function(a){TabBoxBinding.superclass.handleAction.call(this,a);var b=a.target,c=a.listener;switch(a.type){case Binding.ACTION_ATTACHED:break;case Binding.ACTION_DETACHED:b.constructor==this._impl_tab&&(this.updateType=TabBoxBinding.UPDATE_DETACH,this.dispatchAction(TabBoxBinding.ACTION_UPDATED),a.consume());break;case PageBinding.ACTION_INITIALIZED:b.isDialogSubPage&&this.isEqualSize&&this.enforceEqualSize();break;case Binding.ACTION_INVALID:if(c._invalidCount++,1==c._invalidCount){var d=this;setTimeout(function(){c.isSelected||d._showWarning(c,!0)},0)}break;case Binding.ACTION_VALID:c._invalidCount>0&&(c._invalidCount--,0==c._invalidCount&&c.isSelected&&this._showWarning(c,!1));break;case BalloonBinding.ACTION_SNAP:this._showBalloon(c,!0);break;case Binding.ACTION_ACTIVATED:case Binding.ACTION_FOCUSED:null==a._tabboxstamp&&(TabBoxBinding.currentActiveInstance=this,a._tabboxstamp="stamped")}},TabBoxBinding.prototype.handleEvent=function(a){switch(TabBoxBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.AFTERUPDATE:var b=DOMEvents.getTarget(a);if(b==this.bindingDocument.documentElement){if(this._hasBastardUpdates){this._hasBastardUpdates=!1;var c=this.getTabElements(),d=this.getTabPanelElements();c.each(function(a,b){if(null==a.getAttribute(TabBoxBinding.ASSOCIATION_KEY)){var c=d.get(b);this.registerTabBoxPair(a,c)}},this);var e=this._tabBoxPairs;for(var f in e){var g=e[f].tab;null==g.parentNode&&this.unRegisterTabBoxPair(g)}}}else if(!this._hasBastardUpdates){var h=DOMUtil.getLocalName(b);switch(b.__updateType){case Update.TYPE_INSERT:switch(h){case this._nodename_tab:case this._nodename_tabpanel:var i=b.parentNode;i!=this._tabsElement&&i!=this._tabPanelsElement||(this._hasBastardUpdates=!0)}break;case Update.TYPE_REMOVE:switch(h){case this._nodename_tabs:case this._nodename_tabpanels:b!=this._tabsElement&&b!=this._tabPanelsElement||(this._hasBastardUpdates=!0)}}}}},TabBoxBinding.prototype.select=function(a,b){var c=this.getBindingForArgument(a);if(null!=c&&!c.isSelected){null!=this._selectedTabBinding&&(this._selectedTabBinding.unselect(),this.getTabPanelBinding(this._selectedTabBinding).unselect()),this.dispatchAction(TabBoxBinding.ACTION_UNSELECTED),c.select(b),this.getTabPanelBinding(c).select(b);var d=this.getProperty("selectedindex");if(null!=d&&this.setProperty("selectedindex",DOMUtil.getOrdinalPosition(c.bindingElement,!0)),this._selectedTabBinding=c,this.dispatchAction(TabBoxBinding.ACTION_SELECTED),this.dispatchAction(FocusBinding.ACTION_UPDATE),c.getImage()==TabBoxBinding.BALLOON_TAB_IMAGE){var e=this.getTabPanelBinding(c);this._showBalloon(e,!1)}}},TabBoxBinding.prototype.registerTabBoxPair=function(a,b){var c=KeyMaster.getUniqueKey();a.setAttribute(TabBoxBinding.ASSOCIATION_KEY,c),b.setAttribute(TabBoxBinding.ASSOCIATION_KEY,c),this._tabBoxPairs[c]={tab:a,tabPanel:b}},TabBoxBinding.prototype.unRegisterTabBoxPair=function(a){var b=a.getAttribute(TabBoxBinding.ASSOCIATION_KEY);delete this._tabBoxPairs[b]},TabBoxBinding.prototype.getTabPanelBinding=function(a){var b=null;try{var c=a.getProperty(TabBoxBinding.ASSOCIATION_KEY),d=this._tabBoxPairs[c].tabPanel;b=UserInterface.getBinding(d)}catch(a){this.logger.error(a),SystemDebug.stack(arguments)}return b},TabBoxBinding.prototype.getTabBinding=function(a){var b=a.getProperty(TabBoxBinding.ASSOCIATION_KEY),c=this._tabBoxPairs[b].tab;return UserInterface.getBinding(c)},TabBoxBinding.prototype.summonTabBinding=function(){return TabBinding.newInstance(this.bindingDocument)},TabBoxBinding.prototype.summonTabPanelBinding=function(){var a=this._impl_tabpanel.newInstance(this.bindingDocument);return this._setupWarningSystem(a),a},TabBoxBinding.prototype.appendTabByBindings=function(a,b){var c=a.bindingElement;a.setProperty("selected",!0);var d=this.summonTabPanelBinding(),e=d.bindingElement;return b&&e.appendChild(b instanceof Binding?b.bindingElement:b),this.registerTabBoxPair(c,e),UserInterface.getBinding(this._tabsElement).add(a),this._tabPanelsElement.appendChild(e),a.attach(),UserInterface.getBinding(e).attachRecursive(),this.updateType=TabBoxBinding.UPDATE_ATTACH,this.dispatchAction(TabBoxBinding.ACTION_UPDATED),a},TabBoxBinding.prototype.importTabBinding=function(a){var b=a.containingTabBoxBinding,c=b.getTabPanelBinding(a),d=c.getBindingElement(),e=a.getBindingElement();b.dismissTabBinding(a),this._tabsElement.appendChild(e),this._tabPanelsElement.appendChild(d),this.registerTabBoxPair(e,d),a.containingTabBoxBinding=this,this.select(a),this.dispatchAction(Binding.ACTION_ACTIVATED),this.dispatchAction(TabBoxBinding.ACTION_UPDATED)},TabBoxBinding.prototype.removeTab=function(a){var b=null;a.isSelected&&(b=this.getBestTab(a),this._selectedTabBinding=null);var c=this.getTabPanelBinding(a);this.unRegisterTabBoxPair(a.bindingElement),a.dispose(),c.dispose(),null!=b&&this.select(b,!0),this.updateType=TabBoxBinding.UPDATE_DETACH,this.dispatchAction(TabBoxBinding.ACTION_UPDATED),this.deActivate()},TabBoxBinding.prototype.dismissTabBinding=function(a){a.isSelected&&this.selectBestTab(a)},TabBoxBinding.prototype.selectBestTab=function(a){var b=this.getBestTab(a);b?this.select(b):this._selectedTabBinding=null},TabBoxBinding.prototype.getBestTab=function(a){var b=null,c=a.getOrdinalPosition(!0),d=this.getTabBindings(),e=d.getLength(),f=e-1;return b=1==e?null:c==f?d.get(c-1):d.get(c+1)},TabBoxBinding.prototype.moveToOrdinalPosition=function(a,b){for(var c=this.bindingDocument.getElementById(a.bindingElement.id),d=this.getTabElements().get(b);d&&"true"===d.getAttribute("pinned");)d=this.getTabElements().get(++b);d&&this._tabsElement.insertBefore(c,d),this.updateType=TabBoxBinding.UPDATE_ORDINAL,this.dispatchAction(TabBoxBinding.ACTION_UPDATED)},TabBoxBinding.prototype.getTabsElement=function(){return DOMUtil.getElementsByTagName(this.bindingElement,this._nodename_tabs).item(0)},TabBoxBinding.prototype.getTabPanelsElement=function(){return DOMUtil.getElementsByTagName(this.bindingElement,this._nodename_tabpanels).item(0)},TabBoxBinding.prototype.getTabElements=function(){for(var a=this._nodename_tab,b=new List(this._tabsElement.childNodes),c=new List;b.hasNext();){var d=b.getNext();d.nodeType==Node.ELEMENT_NODE&&DOMUtil.getLocalName(d)==a&&c.add(d)}return c},TabBoxBinding.prototype.getTabPanelElements=function(){var a=this._nodename_tabpanel,b=new List(this._tabPanelsElement.childNodes),c=new List;return b.each(function(b){b.nodeType==Node.ELEMENT_NODE&&DOMUtil.getLocalName(b)==a&&c.add(b)}),c},TabBoxBinding.prototype.getTabsBinding=function(){return this.getChildBindingByLocalName(this._nodename_tabs)},TabBoxBinding.prototype.getTabPanelsBinding=function(){return this.getChildBindingByLocalName(this._nodename_tabpanels)},TabBoxBinding.prototype.getTabBindings=function(){var a=new List,b=this.getTabElements();return b.each(function(b){a.add(UserInterface.getBinding(b))}),a},TabBoxBinding.prototype.getTabPanelBindings=function(){var a=new List;return this.getTabPanelElements().each(function(b){a.add(UserInterface.getBinding(b))}),a},TabBoxBinding.prototype.getSelectedTabBinding=function(){return this._selectedTabBinding},TabBoxBinding.prototype.getSelectedTabPanelBinding=function(){var a=null;return this._selectedTabBinding&&(a=this.getTabPanelBinding(this._selectedTabBinding)),a},TabBoxBinding.prototype._showWarning=function(a,b){var c=this.getTabBinding(a);b?(c.labelBinding.hasImage&&(c._backupImage=c.getImage()),c.setImage(TabBoxBinding.INVALID_TAB_IMAGE)):c._backupImage?c.setImage(c._backupImage):c.setImage(!1)},TabBoxBinding.prototype._showBalloon=function(a,b){var c=this.getTabBinding(a);(b&&!c.isSelected||!b)&&c.getImage()!=TabBoxBinding.INVALID_TAB_IMAGE&&(b?(c.labelBinding.hasImage&&(c._backupImage=c.getImage()),c.setImage(TabBoxBinding.BALLOON_TAB_IMAGE)):null!=c._backupImage?c.setImage(c._backupImage):c.setImage(!1))},TabBoxBinding.prototype.advanceSelection=function(a){var b=this.getSelectedTabBinding(),c=this.getTabBindings(),d=b.getOrdinalPosition(!0),e=null,f=new List;c.each(function(a){a.isVisible&&f.add(a)}),f.getLength()>1&&(e=0!=d||a?d==f.getLength()-1&&a?f.getFirst():a?b.getNextBindingByLocalName(this._nodename_tab):b.getPreviousBindingByLocalName(this._nodename_tab):f.getLast(),null!=e&&this.select(e))},TabsBinding.prototype=new Binding,TabsBinding.prototype.constructor=TabsBinding,TabsBinding.superclass=Binding.prototype,TabsBinding.NODENAME_TABBOX="tabbox",TabsBinding.TABBUTTON_IMPLEMENTATION=TabsButtonBinding,TabsBinding.prototype.toString=function(){return"[TabsBinding]"},TabsBinding.prototype.onBindingRegister=function(){TabsBinding.superclass.onBindingRegister.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT)},TabsBinding.prototype.onBindingAttach=function(){TabsBinding.superclass.onBindingAttach.call(this),this.containingTabBoxBinding=this.getAncestorBindingByType(TabBoxBinding),this.containingTabBoxBinding.addActionListener(TabBoxBinding.ACTION_UPDATED,this),this.buildDOMContent(),this.dispatchAction(Binding.ACTION_ATTACHED)},TabsBinding.prototype.buildDOMContent=function(){this.shadowTree.tabManager=this.bindingDocument.createElement("div"),this.shadowTree.tabManager.className="tabmanager";var a=this.constructor.TABBUTTON_IMPLEMENTATION;this.tabsButtonBinding=a.newInstance(this.bindingDocument),this.shadowTree.tabsButton=this.tabsButtonBinding,this.add(this.tabsButtonBinding),this.tabsButtonBinding.attach()},TabsBinding.prototype.handleAction=function(a){function b(){c.manage()}switch(TabsBinding.superclass.handleAction.call(this,a),a.type){case TabBoxBinding.ACTION_UPDATED:if(!this.isManaging){var c=this;setTimeout(b,0)}}},TabsBinding.prototype.flex=function(){function a(){if(1==Binding.exists(b)){var a=b.bindingElement.offsetWidth;a!=b._cachedOffsetWidth&&b.manage(),b._cachedOffsetWidth=a}}if(1==this.isAttached){var b=this;setTimeout(a,0)}},TabsBinding.prototype.add=function(a){return a instanceof TabBinding&&this.tabsButtonBinding&&this.tabsButtonBinding.isVisible&&this.tabsButtonBinding.hide(),TabsBinding.superclass.add.call(this,a)},TabsBinding.prototype.manage=function(){if(1==Binding.exists(this)&&this.isVisible){this.isManaging=!0;var a,b,c=!1,d=this.containingTabBoxBinding.getTabElements(),e=this.constructor.TABBUTTON_IMPLEMENTATION,f=this.bindingElement.offsetWidth-e.RESERVED_SPACE,g=null,h=0,i=0,j=!0;if(d.hasEntries()){for(this.tabsButtonBinding.reset();d.hasNext()&&j;)b=d.getNext(),a=UserInterface.getBinding(b),g||(g=a),h+=b.offsetWidth,h>=f?(c=!0,a.isSelected?DOMUtil.isFirstElement(a.bindingElement,!0)||(this.isManaging=!1,g&&(g.hide(),this.tabsButtonBinding.isVisible&&this.tabsButtonBinding.hide()),this.containingTabBoxBinding.moveToOrdinalPosition(a,i-1),j=!1):(a.hide(),this.tabsButtonBinding.registerHiddenTabBinding(a))):(a.show(),g=a,i++);if(j)if(c&&this.tabsButtonBinding.hiddenTabBindings.hasEntries()){var k=g.getBindingElement(),l=k.offsetLeft+k.offsetWidth,m=this.tabsButtonBinding;setTimeout(function(){m.show(l+4)},50)}else this.tabsButtonBinding.hide()}this.isManaging=!1}},TabBinding.prototype=new Binding,TabBinding.prototype.constructor=TabBinding,TabBinding.superclass=Binding.prototype,TabBinding.ACTION_SELECTED="tabselected",TabBinding.ACTION_UNSELECTED="tabunselected",TabBinding.NODENAME_TABBOX="tabbox",TabBinding.prototype.toString=function(){return"[TabBinding]"},TabBinding.prototype.serialize=function(){var a=TabBinding.superclass.serialize.call(this);return a&&(a.label=this.getLabel(),a.image=this.getImage(),a.tooltip=this.getToolTip()),a},TabBinding.prototype.onBindingAttach=function(){TabBinding.superclass.onBindingAttach.call(this),this.defaultElementPosition=DOMUtil.getComputedStyle(this.bindingElement,"position"),this.defaultElementLeft=DOMUtil.getComputedStyle(this.bindingElement,"left"),this.containingTabBoxBinding=this.getAncestorBindingByType(TabBoxBinding),this.buildDOMContent(),this.assignDOMEvents(),this.dispatchAction(Binding.ACTION_ATTACHED),1==this.getProperty("selected")&&this.containingTabBoxBinding.select(this,!0)},TabBinding.prototype.buildDOMContent=function(){var a=this.bindingElement.getAttribute("image"),b=this.bindingElement.getAttribute("label"),c=this.bindingElement.getAttribute("tooltip");this.bindingElement.className="default",this.labelBinding=LabelBinding.newInstance(this.bindingDocument),this.shadowTree.labelBinding=this.labelBinding,this.labelBinding.attachClassName("tablabel"),this.add(this.labelBinding),b&&this.setLabel(b),a&&this.setImage(a),c&&this.setToolTip(c)},TabBinding.prototype.setImage=function(a){this.setProperty("image",a),this.isAttached&&this.labelBinding.setImage(a)},TabBinding.prototype.getImage=function(){return this.getProperty("image")},TabBinding.prototype.setLabel=function(a){null!=a&&(this.setProperty("label",a),this.isAttached&&this.labelBinding.setLabel(a))},TabBinding.prototype.getLabel=function(){return this.getProperty("label")},TabBinding.prototype.setToolTip=function(a){a&&(this.setProperty("tooltip",a),this.isAttached&&this.labelBinding.setToolTip(a))},TabBinding.prototype.getToolTip=function(){return this.getProperty("tooltip")},TabBinding.prototype.assignDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEENTER),this.addEventListener(DOMEvents.MOUSELEAVE)},TabBinding.prototype.handleEvent=function(a){if(TabBinding.superclass.handleEvent.call(this,a),!this.isSelected){var b=!1;if(1==Client.isMozilla,!b)switch(a.type){case DOMEvents.MOUSEENTER:case DOMEvents.MOUSEOVER:this.isSelected||(this.bindingElement.className="hover");break;case DOMEvents.MOUSELEAVE:case DOMEvents.MOUSEOUT:this.isSelected||(this.bindingElement.className="default");break;case DOMEvents.MOUSEDOWN:DOMEvents.isRightButton(a)||this.containingTabBoxBinding.select(this)}}},TabBinding.prototype.select=function(a){this.show(),this.isSelected=!0,this.setProperty("selected",!0),this.bindingElement.className="selected"},TabBinding.prototype.unselect=function(){this.isSelected=!1,this.deleteProperty("selected"),this.bindingElement.className="default"},TabBinding.prototype.highlight=function(a){a?this.shadowTree.labelBinding.attachClassName("highlighted"):this.shadowTree.labelBinding.detachClassName("highlighted")},TabBinding.prototype.hide=function(){this.isVisible&&(this.bindingElement.style.position="absolute",this.bindingElement.style.left="-1000px",this.isVisible=!1)},TabBinding.prototype.show=function(){this.isVisible||(this.bindingElement.style.position=this.defaultElementPosition,this.bindingElement.style.left=this.defaultElementLeft,this.isVisible=!0)},TabBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:tab",a);return UserInterface.registerBinding(b,TabBinding)},TabPanelsBinding.prototype=new FlexBoxBinding,TabPanelsBinding.prototype.constructor=TabPanelsBinding,TabPanelsBinding.superclass=FlexBoxBinding.prototype,TabPanelsBinding.prototype.toString=function(){return"[TabPanelsBinding]"},TabPanelsBinding.prototype.onBindingRegister=function(){TabPanelsBinding.superclass.onBindingRegister.call(this),this._lastKnownDimension=new Dimension(0,0)},TabPanelsBinding.prototype.hasDimensionsChanged=function(){var a=!1,b=this.boxObject.getDimension(),c=this._lastKnownDimension;return null!=c&&Dimension.isEqual(b,c)||(a=!0,this._lastKnownDimension=b),a},TabPanelsBinding.prototype.onBindingAttach=function(){TabPanelsBinding.superclass.onBindingAttach.call(this),this.containingTabBoxBinding=this.getAncestorBindingByType(TabBoxBinding),this.setFlexibility(this.containingTabBoxBinding.isFlexible),this.dispatchAction(Binding.ACTION_ATTACHED)},TabPanelBinding.prototype=new Binding,TabPanelBinding.prototype.constructor=TabPanelBinding,TabPanelBinding.superclass=Binding.prototype,TabPanelBinding.prototype.toString=function(){return"[TabPanelBinding]"},TabPanelBinding.prototype.onBindingAttach=function(){TabPanelBinding.superclass.onBindingAttach.call(this),this.dispatchAction(Binding.ACTION_ATTACHED),this.addActionListener(BalloonBinding.ACTION_INITIALIZE)},TabPanelBinding.prototype.select=function(a){this.isSelected||(this.isLazy?this.wakeUp("select"):(this.isSelected=!0,this.isVisible=!0,this.bindingElement.style.position="static",this._invokeManagedRecursiveFlex(),1!=a&&this.dispatchAction(FocusBinding.ACTION_FOCUS)))},TabPanelBinding.prototype.unselect=function(){this.isSelected&&(this.dispatchAction(FocusBinding.ACTION_BLUR),this.isSelected=!1,this.isVisible=!1,this.bindingElement.style.position="absolute")},TabPanelBinding.prototype._invokeManagedRecursiveFlex=function(){if(1==this.isAttached)this.reflex(!0);else{var a=UserInterface.getBinding(this.bindingElement.parentNode);a.reflex()}},TabPanelBinding.prototype.handleAction=function(a){TabPanelBinding.superclass.handleAction.call(this,a);a.target;switch(a.type){case BalloonBinding.ACTION_INITIALIZE:a.consume()}},TabPanelBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:tabpanel",a);return UserInterface.registerBinding(b,TabPanelBinding),UserInterface.getBinding(b)},SplitBoxBinding.prototype=new FlexBoxBinding,SplitBoxBinding.prototype.constructor=SplitBoxBinding,SplitBoxBinding.superclass=FlexBoxBinding.prototype,SplitBoxBinding.ORIENT_HORIZONTAL="horizontal",SplitBoxBinding.ORIENT_VERTICAL="vertical",SplitBoxBinding.prototype.toString=function(){return"[SplitBoxBinding]"},SplitBoxBinding.prototype.serialize=function(){var a=SplitBoxBinding.superclass.serialize.call(this);
return a&&(a.orient=this.getOrient(),a.layout=this.getLayout()),a},SplitBoxBinding.prototype.onBindingAttach=function(){if(this.isHorizontalOrient()&&Localization.isUIRtl)for(var a=this.bindingElement.childNodes.length;a--;)this.bindingElement.appendChild(this.bindingElement.childNodes[a]);SplitBoxBinding.superclass.onBindingAttach.call(this),this.addActionListener(SplitterBinding.ACTION_DRAGGED,this),this.addActionListener(SplitterBinding.ACTION_COLLAPSE,this),this.addActionListener(SplitterBinding.ACTION_UNCOLLAPSE,this),this._initializeLayout(),this._initializeOrient(),this._initializeSplitters()},SplitBoxBinding.prototype._initializeLayout=function(){this.isLayoutInitialized=!1;var a=this.getSplitPanelElements();if(a.hasEntries()){var b=new List(this.getLayout().split(":"));if(b.getLength()!=a.getLength())throw new Error(this+" DOM subree invalid");a.each(function(a){a.setAttribute("ratio",b.getNext())})}this.isLayoutInitialized=!0},SplitBoxBinding.prototype._initializeOrient=function(){var a=this.getProperty("orient");a&&(this._orient=a),this.attachClassName(this._orient)},SplitBoxBinding.prototype._initializeSplitters=function(){for(var a=this.getSplitterBindings();a.hasNext();){var b=a.getNext();b&&1==b.getProperty("collapsed")&&b.collapse()}};SplitBoxBinding.prototype.handleAction=function(a){switch(SplitBoxBinding.superclass.handleAction.call(this,a),a.type){case SplitterBinding.ACTION_DRAGGED:this.refreshLayout();break;case SplitterBinding.ACTION_COLLAPSE:this.collapse(a.target),a.consume();break;case SplitterBinding.ACTION_UNCOLLAPSE:this.unCollapse(a.target),a.consume()}};SplitBoxBinding.prototype.flex=function(){SplitBoxBinding.superclass.flex.call(this),1==this.isAttached&&this.invokeLayout(!0)},SplitBoxBinding.prototype.collapse=function(a){this._getSplitPanelBindingForSplitter(a).collapse(),this.invokeLayout()},SplitBoxBinding.prototype.unCollapse=function(a){this._getSplitPanelBindingForSplitter(a).unCollapse(),this.invokeLayout()},SplitBoxBinding.prototype._getSplitPanelBindingForSplitter=function(a){var b,c=DOMUtil.getOrdinalPosition(a.bindingElement,!0),d=this.getSplitPanelElements();switch(a.getCollapseDirection()){case SplitterBinding.COLLAPSE_BEFORE:b=d.get(c);break;case SplitterBinding.COLLAPSE_AFTER:b=d.get(c+1)}return UserInterface.getBinding(b)},SplitBoxBinding.prototype.invokeLayout=function(a){var b,c=this.isHorizontalOrient(),d=this.getSplitPanelBindings(),e=this.getSplitterBindings(),f=new List,g=0,h=0;if(d.each(function(a){1==a.isFixed?(d.hasNext()||(h+=a.getFix()),f.add(0),g+=0):(b=a.getRatio(),f.add(b),g+=b)}),0==g&&(this.logger.warn("Division by zero was hacked"),g=1),f.getLength()!=d.getLength())throw new Error(this+" Invalid property (ratio)");var i=c?this.getInnerWidth():this.getInnerHeight();i-=h,e.each(function(a){a.isVisible&&(i-=SplitterBinding.DIMENSION)});var j=i/g,k=0;if(d.each(function(a){var b=0,d=f.getNext();for(a.isFixed?b=a.getFix():(b=Math.floor(j*d),isNaN(b)&&alert("isNaN ( span ) ["+this.getProperty("layout")+"]")),k+=b;k>i;)k--,b--;a.isFixed||(c?a.setWidth(b):a.setHeight(b))}),1!=a&&this.reflex(),this._persist&&this._persist.layout){var l=this.getLayout();l&&this.setProperty("layout",l)}},SplitBoxBinding.prototype.computeLayout=function(){var a=this.isHorizontalOrient(),b=this.getSplitPanelBindings(),c=this.getSplitterBindings(),d=null,e=null,f=null,g=null;b.each(function(b){e||(e=a?b.getWidth():b.getHeight()),g=a?b.getWidth():b.getHeight(),f&&(g-=f,f=null),d=c.getNext(),d&&d.offset&&(f=d.offset,g+=f),b.setRatio(g/e)})},SplitBoxBinding.prototype.refreshLayout=function(){this.computeLayout(),this.invokeLayout()},SplitBoxBinding.prototype.setLayout=function(a){this.logger.debug(a),this.setProperty("layout",a),this._initializeLayout(),this.invokeLayout()},SplitBoxBinding.prototype.getLayout=function(){if(this.isLayoutInitialized){var a="",b=this.getSplitPanelBindings();b.each(function(c){a+=c.getRatio().toString(),a+=b.hasNext()?":":""}),this.setProperty("layout",a)}else this.getProperty("layout")||this.setProperty("layout",this.getDefaultLayout());return new String(this.getProperty("layout"))},SplitBoxBinding.prototype.getDefaultLayout=function(){var a=this.getSplitPanelElements();a.each(function(b){layout+="1"+(a.hasNext()?":":"")}),this.setProperty("layout",layout)},SplitBoxBinding.prototype.setWidth=function(a){this.bindingElement.style.width=a+"px"},SplitBoxBinding.prototype.getInnerWidth=function(){return Client.isFirefox?Math.floor(this.bindingElement.getBoundingClientRect().width):this.bindingElement.offsetWidth},SplitBoxBinding.prototype.setHeight=function(a){this.bindingElement.style.height=a+"px"},SplitBoxBinding.prototype.getInnerHeight=function(){return Client.isFirefox?Math.floor(this.bindingElement.getBoundingClientRect().height):this.bindingElement.offsetHeight},SplitBoxBinding.prototype.getOrient=function(){return this.getProperty("orient")},SplitBoxBinding.prototype.isHorizontalOrient=function(){return this._orient==SplitBoxBinding.ORIENT_HORIZONTAL},SplitBoxBinding.prototype.getSplitPanelElements=function(){var a=this.getChildElementsByLocalName("splitpanel");return this.isHorizontalOrient()&&Localization.isUIRtl&&a.reverse(),a},SplitBoxBinding.prototype.getSplitPanelBindings=function(){return this.getChildBindingsByLocalName("splitpanel")},SplitBoxBinding.prototype.getSplitterElements=function(){return this.getChildElementsByLocalName("splitter")},SplitBoxBinding.prototype.getSplitterBindings=function(){return this.getChildBindingsByLocalName("splitter")},SplitBoxBinding.prototype.fit=function(a){if(!this.isFit||a){if(!this.isHorizontalOrient())throw"SplitBoxBinding enforceFitness not supported vertically!";var b=0,c=this.getSplitPanelBindings();c.each(function(a){var c=a.bindingElement.offsetHeight;b=c>b?c:b}),this._setFitnessHeight(b),this.isFit=!0}},SplitBoxBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:splitbox",a);return UserInterface.registerBinding(b,SplitBoxBinding)},SplitPanelBinding.prototype=new ControlBoxBinding,SplitPanelBinding.prototype.constructor=SplitPanelBinding,SplitPanelBinding.superclass=ControlBoxBinding.prototype,SplitPanelBinding.prototype.toString=function(){return"[SplitPanelBinding]"},SplitPanelBinding.prototype.onBindingAttach=function(){SplitPanelBinding.superclass.onBindingAttach.call(this),this._containingSplitBoxBinding=this.getAncestorBindingByLocalName("splitbox"),this.attachClassName(this._containingSplitBoxBinding.getOrient()),this.parseDOMProperties()},SplitPanelBinding.prototype.parseDOMProperties=function(){var a=this.getProperty("type");a&&this.attachClassName(a);var b=this.getProperty("fix");b&&this.setFix(b);var c=this.getProperty("hidden");c&&this.hide()},SplitPanelBinding.prototype.collapse=function(){this.hide(),this.isCollapsed=!0,this.setProperty("collapsed","true")},SplitPanelBinding.prototype.unCollapse=function(){this.show(),this.isCollapsed=!1,this.deleteProperty("collapsed")},SplitPanelBinding.prototype.hide=function(){1==this.isVisible&&(this.setProperty("ratiocache",this.getRatio()),this.setRatio(0),this.bindingElement.style.display="none",this.setProperty("hidden",!0),this.isVisible=!1)},SplitPanelBinding.prototype.show=function(){if(!this.isVisible){var a=this.getProperty("ratiocache");a?(this.setRatio(a),this.deleteProperty("ratiocache")):this._containingSplitBoxBinding.computeLayout(),this.bindingElement.style.display="block",this.deleteProperty("hidden"),this.isVisible=!0}},SplitPanelBinding.prototype.setWidth=function(a){if(!this.isFixed&&a!=this.getWidth()){a<0&&(a=this.getWidth(),this.logger.warn("SplitPanelBinding#setWidth bug in Internet Explorer!"));try{this.bindingElement.style.width=a+"px"}catch(b){alert("SplitPanelBinding#setWidth: Occult width: "+a),alert(arguments.caller.callee)}}},SplitPanelBinding.prototype.getWidth=function(){var a=null;return a=this.isFixed?this.getFix():this.bindingElement.offsetWidth},SplitPanelBinding.prototype.setHeight=function(a){if(!this.isFixed&&a!=this.getHeight())try{this.bindingElement.style.height=a+"px"}catch(a){alert("SplitPanelBinding.prototype.setHeight"+arguments.caller.callee)}},SplitPanelBinding.prototype.getHeight=function(){var a=null;return a=this.isFixed?this.getFix():this.bindingElement.offsetHeight},SplitPanelBinding.prototype.setRatio=function(a){this.setProperty("ratio",a)},SplitPanelBinding.prototype.getRatio=function(){return this.getProperty("ratio")},SplitPanelBinding.prototype.setFix=function(a){if(a){switch(this._fixedSpan=a,this._containingSplitBoxBinding.getOrient()){case SplitBoxBinding.ORIENT_HORIZONTAL:this.logger.warn("Fix not properly supported on horizontal splitboxes!"),this.setWidth(a);break;case SplitBoxBinding.ORIENT_VERTICAL:this.setHeight(a)}this.isFixed=!0}else this._fixedSpan=null,this.isFixed=!1},SplitPanelBinding.prototype.getFix=function(){return this._fixedSpan},SplitPanelBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:splitpanel",a);return UserInterface.registerBinding(b,SplitPanelBinding)},SplitterBinding.prototype=new Binding,SplitterBinding.prototype.constructor=SplitterBinding,SplitterBinding.superclass=Binding.prototype,SplitterBinding.DIMENSION=0,SplitterBinding.BUFFER=30,SplitterBinding.COLLAPSE_AFTER="after",SplitterBinding.COLLAPSE_BEFORE="before",SplitterBinding.ACTION_DRAGSTART="splitter dragstart",SplitterBinding.ACTION_DRAGGED="splitter dragged",SplitterBinding.ACTION_COLLAPSE="splitter collapse",SplitterBinding.ACTION_UNCOLLAPSE="splitter uncollapse",SplitterBinding.CLASSNAME_ACTIVE="active",SplitterBinding.CLASSNAME_HOVER="hover",SplitterBinding.prototype.toString=function(){return"[SplitterBinding]"},SplitterBinding.prototype.serialize=function(){var a=SplitBoxBinding.superclass.serialize.call(this);return a&&(a.collapse=this.getProperty("collapse"),a.collapsed=this.getProperty("collapsed"),a.disabled=this.getProperty("isdisabled")),a},SplitterBinding.prototype.onBindingAttach=function(){SplitterBinding.superclass.onBindingAttach.call(this),this.addActionListener(Binding.ACTION_DRAG),this._containingSplitBoxBinding=this.getAncestorBindingByLocalName("splitbox"),this.attachClassName(this._containingSplitBoxBinding.getOrient()),this._collapseDirection=this.getProperty("collapse"),this.buildDOMContent(),this.attachDOMEvents();var a=this.getProperty("hidden");a&&this.hide()},SplitterBinding.prototype.buildDOMContent=function(){if(this.shadowTree.splitterBody=DOMUtil.createElementNS(Constants.NS_UI,"ui:splitterbody",this.bindingDocument),this.bindingElement.appendChild(this.shadowTree.splitterBody),1==Client.isMozilla){var a=this.bindingDocument.createTextNode("!");this.bindingElement.appendChild(a)}},SplitterBinding.prototype.attachDOMEvents=function(){this.addEventListener(DOMEvents.MOUSEOVER),this.addEventListener(DOMEvents.MOUSEOUT)},SplitterBinding.prototype.collapse=function(){this.isCollapsed||(this.hide(),this.setProperty("collapsed","true"),this.isCollapsed=!0,this.dispatchAction(SplitterBinding.ACTION_COLLAPSE))},SplitterBinding.prototype.unCollapse=function(){1==this.isCollapsed&&(this.show(),this.deleteProperty("collapsed"),this.isCollapsed=!1,this.dispatchAction(SplitterBinding.ACTION_UNCOLLAPSE))},SplitterBinding.prototype.getCollapseDirection=function(){return this._collapseDirection},SplitterBinding.prototype.setCollapseDirection=function(a){this.setProperty("collapse",a),this._collapseDirection=a},SplitterBinding.prototype.handleAction=function(a){switch(SplitterBinding.superclass.handleAction.call(this,a),a.type){case Binding.ACTION_DRAG:this.dragger.registerHandler(this),a.consume()}},SplitterBinding.prototype.handleEvent=function(a){SplitterBinding.superclass.handleEvent.call(this,a);var b=this;if(!this.isDragging&&!this.isDisabled)switch(a.type){case DOMEvents.MOUSEOVER:window.splitterTimeout=window.setTimeout(function(){b.shadowTree.splitterBody.className=SplitterBinding.CLASSNAME_HOVER},250);break;case DOMEvents.MOUSEOUT:window.splitterTimeout&&window.clearTimeout(window.splitterTimeout),b.shadowTree.splitterBody.className==SplitterBinding.CLASSNAME_HOVER&&(this.shadowTree.splitterBody.className="")}},SplitterBinding.prototype.onDragStart=function(a){this.dispatchAction(SplitterBinding.ACTION_DRAGSTART),this.attachClassName(SplitterBinding.CLASSNAME_ACTIVE),this.shadowTree.splitterBody.className=SplitterBinding.CLASSNAME_ACTIVE,this.isDragging=!0},SplitterBinding.prototype.onDrag=function(a){a=this.getEvaluatedDiff(a),this._containingSplitBoxBinding.isHorizontalOrient()?this.shadowTree.splitterBody.style.left=a.x+"px":this.shadowTree.splitterBody.style.top=a.y+"px"},SplitterBinding.prototype.onDragStop=function(a){a=this.getEvaluatedDiff(a),this.offset=this._containingSplitBoxBinding.isHorizontalOrient()?a.x:a.y,this.dispatchAction(SplitterBinding.ACTION_DRAGGED),this.offset=null,this.detachClassName(SplitterBinding.CLASSNAME_ACTIVE),this.shadowTree.splitterBody.className="",this.isDragging=!1,this._containingSplitBoxBinding.isHorizontalOrient()?this.shadowTree.splitterBody.style.left="0":this.shadowTree.splitterBody.style.top="0"},SplitterBinding.prototype.getEvaluatedDiff=function(a){switch(this._containingSplitBoxBinding.getOrient()){case SplitBoxBinding.ORIENT_HORIZONTAL:var b=this.bindingElement.offsetLeft,c=this.bindingElement.offsetWidth,d=this.bindingElement.parentNode.offsetWidth,e=-b+SplitterBinding.BUFFER,f=d-b-c-SplitterBinding.BUFFER;a.x=a.x<=e?e:a.x,a.x=a.x>=f?f:a.x;break;case SplitBoxBinding.ORIENT_VERTICAL:var g=this.bindingElement.offsetTop,h=this.bindingElement.offsetHeight,d=this.bindingElement.parentNode.offsetHeight,e=-g+SplitterBinding.BUFFER,f=d-g-h-SplitterBinding.BUFFER;a.y=a.y<=e?e:a.y,a.y=a.y>=f?f:a.y}return a},SplitterBinding.prototype.disable=function(){this.isDisabled||(alert("disable"),this.isDisabled=!0,this.disableDragging(),this.setProperty("isdisabled",!0))},SplitterBinding.prototype.enable=function(){1==this.isDisabled&&(this.isDisabled=!1,this.enableDragging(),this.deleteProperty("isdisabled"))},SplitterBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:splitter",a);return UserInterface.registerBinding(b,SplitterBinding)},DecksBinding.prototype=new FlexBoxBinding,DecksBinding.prototype.constructor=DecksBinding,DecksBinding.superclass=FlexBoxBinding.prototype,DecksBinding.ACTION_SELECTED="decks deck selected",DecksBinding.NODENAME_DECK="deck",DecksBinding.prototype.toString=function(){return"[DecksBinding]"},DecksBinding.prototype.onBindingRegister=function(){DecksBinding.superclass.onBindingRegister.call(this),this._lastKnownDimension=new Dimension(0,0),this.attachClassName("deckselement")},DecksBinding.prototype.onBindingAttach=function(){DecksBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("selectedindex"),b=this.getDeckElements();if(b.hasEntries()){for(var c=!1,d=0;b.hasNext();){var e=b.getNext();a&&d==a?(e.setAttribute("selected","true"),c=!0):"true"==e.getAttribute("selected")&&(c=!0),d++}c||b.getFirst().setAttribute("selected","true")}},DecksBinding.prototype.getDeckElements=function(){return this.getChildElementsByLocalName(this.constructor.NODENAME_DECK)},DecksBinding.prototype.select=function(a){var b=this.getBindingForArgument(a);if(null==b)throw"No deck for argument "+a;if(b!=this._selectedDeckBinding){this._selectedDeckBinding&&this._selectedDeckBinding.unselect(),this._selectedDeckBinding=b,b.select();var c=this.getProperty("selectedindex");null!=c&&this.setProperty("selectedindex",DOMUtil.getOrdinalPosition(b.bindingElement,!0)),this.dispatchAction(DecksBinding.ACTION_SELECTED),this.dispatchAction(FocusBinding.ACTION_UPDATE)}},DecksBinding.prototype.hasDimensionsChanged=function(){var a=!1,b=this.boxObject.getDimension(),c=this._lastKnownDimension;return Dimension.isEqual(b,c)||(a=!0,this._lastKnownDimension=b),a},DecksBinding.prototype.getSelectedDeckBinding=function(){return this._selectedDeckBinding},DecksBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:decks",a);return UserInterface.registerBinding(b,DecksBinding)},DeckBinding.prototype=new FlexBoxBinding,DeckBinding.prototype.constructor=DeckBinding,DeckBinding.superclass=FlexBoxBinding.prototype,DeckBinding.ACTION_SELECTED="deck selected",DeckBinding.ACTION_UNSELECTED="deck unselected",DeckBinding.NODENAME_DECKS="decks",DeckBinding.CLASSNAME="deckelement",DeckBinding.prototype.toString=function(){return"[DeckBinding]"},DeckBinding.prototype.onBindingRegister=function(){DeckBinding.superclass.onBindingRegister.call(this),this.addActionListener(BalloonBinding.ACTION_INITIALIZE),this.attachClassName(DeckBinding.CLASSNAME)},DeckBinding.prototype.onBindingAttach=function(){DeckBinding.superclass.onBindingAttach.call(this),this.containingDecksBinding=this.getAncestorBindingByLocalName(this.constructor.NODENAME_DECKS),1==this.getProperty("selected")&&this.containingDecksBinding.select(this)},DeckBinding.prototype.handleAction=function(a){DeckBinding.superclass.handleAction.call(this,a);a.target;switch(a.type){case BalloonBinding.ACTION_INITIALIZE:a.consume()}},DeckBinding.prototype.select=function(){if(!this.isSelected)if(1==this.isLazy)this.wakeUp("select");else{this.isSelected=!0,this.isVisible=!0,this.setProperty("selected","true"),this.bindingElement.style.position="static",this._invokeManagedRecursiveFlex(),this.dispatchAction(DeckBinding.ACTION_SELECTED);var a=UserInterface.getBinding(this.bindingDocument.body);a.isActivated&&this.dispatchAction(FocusBinding.ACTION_FOCUS)}},DeckBinding.prototype.unselect=function(){this.isSelected&&(this.dispatchAction(FocusBinding.ACTION_BLUR),this.deleteProperty("selected"),this.isSelected=!1,this.isVisible=!1,this.bindingElement.style.position="absolute",this.dispatchAction(DeckBinding.ACTION_UNSELECTED))},DeckBinding.prototype._invokeManagedRecursiveFlex=function(){this.reflex(!0)},DeckBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:deck",a);return UserInterface.registerBinding(b,DeckBinding)},ToolBarBinding.prototype=new Binding,ToolBarBinding.prototype.constructor=ToolBarBinding,ToolBarBinding.superclass=Binding.prototype,ToolBarBinding.TYPE_TEXTONLY="textonly",ToolBarBinding.TYPE_IMAGESONLY="imagesonly",ToolBarBinding.TYPE_DEFAULT="imagesandtext",ToolBarBinding.CLASSNAME_TEXTONLY="textonly",ToolBarBinding.CLASSNAME_IMAGESONLY="imagesonly",ToolBarBinding.CLASSNAME_IMAGESIZELARGE="imagesizelarge",ToolBarBinding.CLASSNAME_IMAGESIZEXLARGE="imagesizexlarge",ToolBarBinding.CLASSNAME_ICONSIZE_22="icons-s-22",ToolBarBinding.IMAGESIZE_NORMAL="normal",ToolBarBinding.IMAGESIZE_LARGE="large",ToolBarBinding.ICONSIZE_22="icons-s-22",ToolBarBinding.prototype.toString=function(){return"[ToolBarBinding]"},ToolBarBinding.prototype.onBindingRegister=function(){ToolBarBinding.superclass.onBindingRegister.call(this),this.attachClassName(Binding.CLASSNAME_CLEARFLOAT)},ToolBarBinding.prototype.onBindingAttach=function(){ToolBarBinding.superclass.onBindingAttach.call(this),this.parseDOMProperties(),this.buildDOMContent(),this.addMembers(this.getChildBindingsByLocalName("toolbarbody"))},ToolBarBinding.prototype.onMemberInitialize=function(a){a instanceof ToolBarBodyBinding&&(a.isRightAligned?this._toolBarBodyRight||(this._toolBarBodyRight=a):this._toolBarBodyLeft||(this._toolBarBodyLeft=a)),ToolBarBinding.superclass.onMemberInitialize.call(this,a)},ToolBarBinding.prototype.parseDOMProperties=function(){var a=this.getProperty("imagesize"),b=this.getProperty("type");a&&this.setImageSize(a),b?this.setType(b):this.setType(this.type)},ToolBarBinding.prototype.buildDOMContent=function(){if(1==this._hasDefaultContent&&!this._hasDOMContent){var a=ToolBarGroupBinding.newInstance(this.bindingDocument);a.add(ToolBarButtonBinding.newInstance(this.bindingDocument)),a.isDefaultContent=!0,this.add(a),a.attachRecursive(),this._hasDOMContent=!0}},ToolBarBinding.prototype.flex=function(){var a=this._toolBarBodyLeft,b=this._toolBarBodyRight;null!=a&&a.hasClassName("max")&&this._maxToolBarGroup(a,b),null!=b&&b.hasClassName("max")&&this._maxToolBarGroup(b,a)},ToolBarBinding.prototype._maxToolBarGroup=function(a,b){var c=this.boxObject.getDimension().w,d=CSSComputer.getPadding(this.bindingElement);c-=d.left+d.right,null!=b&&(c-=b.boxObject.getDimension().w,Client.isWindows||(c-=1),Client.isExplorer&&(c-=15)),a.bindingElement.style.width=c+"px"},ToolBarBinding.prototype.getToolBarGroupByIndex=function(a){return this.getDescendantBindingsByLocalName("toolbargroup").get(a)},ToolBarBinding.prototype.addLeft=function(a,b){var c=null;if(null==this._toolBarBodyLeft)throw new Error("No left toolbarbody");return c=this._toolBarBodyLeft.add(a,b)},ToolBarBinding.prototype.addLeftFirst=function(a,b){var c=null;if(!this._toolBarBodyLeft)throw new Error("No left toolbarbody");return c=this._toolBarBodyLeft.addFirst(a,b)},ToolBarBinding.prototype.addRight=function(a){var b=null;if(!this._toolBarBodyRight)throw new Error("No left toolbarbody");return b=this._toolBarBodyRight.add(a)},ToolBarBinding.prototype.empty=function(){this.emptyLeft(),this.emptyRight()},ToolBarBinding.prototype.emptyLeft=function(){this._toolBarBodyLeft&&this._toolBarBodyLeft.empty()},ToolBarBinding.prototype.emptyRight=function(){this._toolBarBodyRight&&this._toolBarBodyRight.empty()},ToolBarBinding.prototype.setImageSize=function(a){switch(a){case ToolBarBinding.IMAGESIZE_LARGE:this.attachClassName(ToolBarBinding.CLASSNAME_IMAGESIZELARGE),this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESIZEXLARGE);break;case ToolBarBinding.IMAGESIZE_XLARGE:this.attachClassName(ToolBarBinding.CLASSNAME_IMAGESIZEXLARGE),this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESIZELARGE);break;case ToolBarBinding.ICONSIZE_22:this.attachClassName(ToolBarBinding.CLASSNAME_ICONSIZE_22);break;default:this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESIZELARGE),this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESIZEXLARGE)}this._imageSize=a,this.setProperty("imagesize",a)},ToolBarBinding.prototype.getImageSize=function(){return this._imageSize},ToolBarBinding.prototype.showImagesOnly=function(){this.detachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this.attachClassName(ToolBarBinding.CLASSNAME_IMAGESONLY),this.hasImages=!0,this.hasText=!1},ToolBarBinding.prototype.showTextOnly=function(){this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESONLY),this.attachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this.hasImages=!1,this.hasText=!0},ToolBarBinding.prototype.showBoth=function(){this.detachClassName(ToolBarBinding.CLASSNAME_IMAGESONLY),this.detachClassName(ToolBarBinding.CLASSNAME_TEXTONLY),this.hasImages=!0,this.hasText=!0},ToolBarBinding.prototype.setType=function(a){switch(a){case ToolBarBinding.TYPE_TEXTONLY:this.showTextOnly();break;case ToolBarBinding.TYPE_IMAGESONLY:this.showImagesOnly();break;default:this.showBoth()}this.setProperty("type",a)},ToolBarBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbar",a);return UserInterface.registerBinding(b,ToolBarBinding)},ToolBarBodyBinding.prototype=new Binding,ToolBarBodyBinding.prototype.constructor=ToolBarBodyBinding,ToolBarBodyBinding.superclass=Binding.prototype,ToolBarBodyBinding.prototype.toString=function(){return"[ToolBarBodyBinding]"},ToolBarBodyBinding.prototype.onBindingAttach=function(){ToolBarBodyBinding.superclass.onBindingAttach.call(this),this.addMembers(this.getChildBindingsByLocalName("toolbargroup")),("right"==this.getProperty("align")||this.isRightAligned)&&this.alignRight()},ToolBarBodyBinding.prototype.onBindingInitialize=function(){this.refreshToolBarGroups(),ToolBarBodyBinding.superclass.onBindingInitialize.call(this)},ToolBarBodyBinding.prototype.alignRight=function(){this.attachClassName("alignright"),this.setProperty("align","right"),this.isRightAligned=!0},ToolBarBodyBinding.prototype.refreshToolBarGroups=function(){var a=this.getDescendantBindingsByLocalName("toolbargroup"),b=new List,c=!0;for(a.each(function(a){a.isVisible&&!a.isDefaultContent&&b.add(a)});b.hasNext();){var d=b.getNext();d.setLayout(ToolBarGroupBinding.LAYOUT_DEFAULT),c&&(d.setLayout(ToolBarGroupBinding.LAYOUT_FIRST),c=!1),b.hasNext()||d.setLayout(ToolBarGroupBinding.LAYOUT_LAST)}this.getProperty("equalsize")&&this.enforceEqualSize()},ToolBarBodyBinding.prototype.enforceEqualSize=function(){for(var a=0,b=this.getDescendantBindingsByLocalName("clickbutton");b.hasNext();){var c=b.getNext(),d=c.getEqualSizeWidth();d>a&&(a=d)}if(0!=a)for(b.reset();b.hasNext();){var c=b.getNext();c.setEqualSizeWidth(a)}},ToolBarBodyBinding.prototype.empty=function(){this.detachRecursive(),this.bindingElement.innerHTML=""},ToolBarBodyBinding.prototype.add=function(a,b){var c=ToolBarBinding.superclass.add.call(this,a);return b||a instanceof ToolBarGroupBinding&&this.isAttached&&this.refreshToolBarGroups(),c},ToolBarBodyBinding.prototype.addFirst=function(a,b){var c=ToolBarBinding.superclass.addFirst.call(this,a);return b||a instanceof ToolBarGroupBinding&&this.isAttached&&this.refreshToolBarGroups(),c},ToolBarBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbody",a);return UserInterface.registerBinding(b,ToolBarBodyBinding)},ToolBarGroupBinding.prototype=new RadioGroupBinding,ToolBarGroupBinding.prototype.constructor=ToolBarGroupBinding,ToolBarGroupBinding.superclass=RadioGroupBinding.prototype,ToolBarGroupBinding.LAYOUT_DEFAULT=0,ToolBarGroupBinding.LAYOUT_FIRST=1,ToolBarGroupBinding.LAYOUT_LAST=2,ToolBarGroupBinding.CLASSNAME_DEFAULTCONTENT="defaultcontent",ToolBarGroupBinding.prototype.toString=function(){return"[ToolBarGroupBinding]"},ToolBarGroupBinding.prototype.onBindingAttach=function(){ToolBarGroupBinding.superclass.onBindingAttach.call(this),this.addMembers(this.getDescendantBindingsByLocalName("toolbarbutton")),this.addMembers(this.getDescendantBindingsByLocalName("toolbarlabel")),this.addMembers(this.getDescendantBindingsByLocalName("clickbutton")),1==this.isDefaultContent&&this.attachClassName(ToolBarGroupBinding.CLASSNAME_DEFAULTCONTENT)},ToolBarGroupBinding.prototype.setLayout=function(a){switch(a){case ToolBarGroupBinding.LAYOUT_DEFAULT:this.detachClassName("first"),this.detachClassName("last");break;case ToolBarGroupBinding.LAYOUT_FIRST:this.attachClassName("first");break;case ToolBarGroupBinding.LAYOUT_LAST:this.attachClassName("last")}},ToolBarGroupBinding.prototype.show=function(){ToolBarGroupBinding.superclass.show.call(this);var a=this.bindingElement.parentNode;"toolbarbody"==DOMUtil.getLocalName(a)&&UserInterface.getBinding(a).refreshToolBarGroups()},ToolBarGroupBinding.prototype.hide=function(){ToolBarGroupBinding.superclass.hide.call(this);var a=this.bindingElement.parentNode;"toolbarbody"==DOMUtil.getLocalName(a)&&UserInterface.getBinding(a).refreshToolBarGroups()},ToolBarGroupBinding.prototype.empty=function(){this.detachRecursive(),this.bindingElement.innerHTML=""},ToolBarGroupBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbargroup",a);return UserInterface.registerBinding(b,ToolBarGroupBinding)},ToolBarButtonBinding.prototype=new ButtonBinding,ToolBarButtonBinding.prototype.constructor=ToolBarButtonBinding,ToolBarButtonBinding.superclass=ButtonBinding.prototype,ToolBarButtonBinding.prototype.toString=function(){return"[ToolBarButtonBinding]"},ToolBarButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbutton",a);return UserInterface.registerBinding(b,ToolBarButtonBinding)},ToolBarLabelBinding.prototype=new Binding,ToolBarLabelBinding.prototype.constructor=ToolBarLabelBinding,ToolBarLabelBinding.superclass=Binding.prototype,ToolBarLabelBinding.prototype.toString=function(){return"[ToolBarLabelBinding]"},ToolBarLabelBinding.prototype.onBindingAttach=function(){ToolBarLabelBinding.superclass.onBindingAttach.call(this),this._labelBinding=this.add(LabelBinding.newInstance(this.bindingDocument)),this.shadowTree.label=this._labelBinding;var a=this.getProperty("label"),b=this.getProperty("image");a&&this.setLabel(a),b&&this.setImage(b)},ToolBarLabelBinding.prototype.setLabel=function(a,b){this.isAttached&&this._labelBinding.setLabel(a,b),this.setProperty("label",a)},ToolBarLabelBinding.prototype.setImage=function(a,b){this.isAttached&&this._labelBinding.setImage(a,b),this.setProperty("image",a)},ToolBarLabelBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarlabel",a);return UserInterface.registerBinding(b,ToolBarLabelBinding)},DialogToolBarBinding.prototype=new ToolBarBinding,DialogToolBarBinding.prototype.constructor=DialogToolBarBinding,DialogToolBarBinding.superclass=ToolBarBinding.prototype,DialogToolBarBinding.prototype.toString=function(){return"[DialogToolBarBinding]"},DialogToolBarBinding.prototype.onBindingRegister=function(){DialogToolBarBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_FOCUSED),this.addActionListener(Binding.ACTION_BLURRED)},DialogToolBarBinding.prototype.onBindingDispose=function(){DialogToolBarBinding.superclass.onBindingDispose.call(this),1==this._isListening&&this.unsubscribe(BroadcastMessages.KEY_ENTER)},DialogToolBarBinding.prototype.onBindingInitialize=function(){this.indexDialogButtons(),DialogToolBarBinding.superclass.onBindingInitialize.call(this)},DialogToolBarBinding.prototype.indexDialogButtons=function(){var a=this.getDescendantBindingsByLocalName("clickbutton");if(a.hasEntries()){for(;a.hasNext();){var b=a.getNext();b.isDefault&&(this._defaultButton=b,b.attachClassName(ButtonBinding.CLASSNAME_DEFAULT)),!this._isListening&&b.isFocusable&&(this.subscribe(BroadcastMessages.KEY_ENTER),this._isListening=!0)}this._buttons=a}},DialogToolBarBinding.prototype.handleBroadcast=function(a,b){switch(DialogToolBarBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_ENTER:if(!PopupBinding.hasActiveInstances()&&!EditorBinding.isActive)if(Binding.exists(this)){var c=this.getAncestorBindingByType(DialogBinding,!0);null!=c&&c.isActive&&(null!=this._focusedButton?this._focusedButton.isDisabled||(this.unsubscribe(BroadcastMessages.KEY_ENTER),this._focusedButton.fireCommand()):this._defaultButton.isDisabled||(this.unsubscribe(BroadcastMessages.KEY_ENTER),this._defaultButton.fireCommand()))}else this.logger.error("Ouch: DialogToolBarBinding#handleBroadcast")}},DialogToolBarBinding.prototype.handleAction=function(a){DialogToolBarBinding.superclass.handleAction.call(this,a);var b=a.target,c=!1,d=this._buttons.reset();if(b instanceof ClickButtonBinding)switch(a.type){case Binding.ACTION_FOCUSED:b.attachClassName(ButtonBinding.CLASSNAME_FOCUSED),this._focusedButton=b,this._defaultButton&&this._defaultButton.detachClassName(ButtonBinding.CLASSNAME_DEFAULT);break;case Binding.ACTION_BLURRED:b.detachClassName(ButtonBinding.CLASSNAME_FOCUSED)}if(this._defaultButton){for(;!c&&d.hasNext();){var e=d.getNext();c=e.isFocused}c||(this._defaultButton.attachClassName(ButtonBinding.CLASSNAME_DEFAULT),this._focusedButton=null)}},ComboBoxBinding.prototype=new Binding,ComboBoxBinding.prototype.constructor=ComboBoxBinding,ComboBoxBinding.superclass=Binding.prototype,ComboBoxBinding.prototype.toString=function(){return"[ComboBoxBinding]"},ComboBoxBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:combobox",a);return UserInterface.registerBinding(b,ComboBoxBinding)},ToolBarComboButtonBinding.prototype=new ToolBarButtonBinding,ToolBarComboButtonBinding.prototype.constructor=ToolBarComboButtonBinding,ToolBarComboButtonBinding.superclass=ToolBarButtonBinding.prototype,ToolBarComboButtonBinding.CLASSNAME_COMBOBUTTON="combobutton",ToolBarComboButtonBinding.STORAGE_PREFFIX="STORAGEBUTTONHANDLE",ToolBarComboButtonBinding.prototype.toString=function(){return"[ToolBarComboButtonBinding]"},ToolBarComboButtonBinding.prototype.onBindingAttach=function(){ToolBarComboButtonBinding.superclass.onBindingAttach.call(this),this.buildCombobox(),this.attachClassName(ToolBarComboButtonBinding.CLASSNAME_COMBOBUTTON),
this.keepState=this.getProperty("keepstate")!==!1},ToolBarComboButtonBinding.prototype.handleBroadcast=function(a,b){ToolBarComboButtonBinding.superclass.handleBroadcast.call(this,a,b)},ToolBarComboButtonBinding.prototype.setPopup=function(a){ToolBarComboButtonBinding.superclass.setPopup.call(this,a);var b=this,c=this.popupBinding.getDescendantBindingsByType(MenuItemBinding);c.each(function(a){var c=a.getProperty("oncommand");a.setProperty("hiddencommand",c),a.deleteProperty("oncommand"),a.oncommand=function(){b.setAndFireButton(this)}},this);var d=null;if(this.keepState){var e=this.getActiveMenuHandle();c.each(function(a){return!(this.getMenuHandle(a)===e&&!a.isDisabled)||(d=a,!1)},this)}null==d&&c.each(function(a){return!!a.isDisabled||(d=a,!1)},this),null!=d&&this.setButton(d),this.updateCombobox(c.getLength()>1)};ToolBarComboButtonBinding.prototype.buildCombobox=function(){this.comboBoxBinding||(this.comboBoxBinding=ComboBoxBinding.newInstance(this.bindingDocument),this.add(this.comboBoxBinding),this.comboBoxBinding.attach(),this.updateCombobox())};ToolBarComboButtonBinding.prototype.updateCombobox=function(a){void 0!=a&&(this.hasPopupItems=a),this.comboBoxBinding&&(this.hasPopupItems?this.comboBoxBinding.show():this.comboBoxBinding.hide())},ToolBarComboButtonBinding.prototype.setButton=function(a){if(a instanceof MenuItemBinding){var b=a.getProperty("label"),c=a.getProperty("image"),d=a.getProperty("hiddencommand");this.setLabel(b?b:""),this.setImage(c),!this.isDisabled&&a.isDisabled?this.setDisabled(!0):this.isDisabled&&!a.isDisabled&&this.setDisabled(!1),a.associatedSystemAction&&(this.associatedSystemAction=a.associatedSystemAction),this.oncommand=function(){Binding.evaluate(d,this)},this.hideActiveItem(a)}},ToolBarComboButtonBinding.prototype.getAssociatedSystemActions=function(){var a=new List;return this.popupBinding.getDescendantBindingsByType(MenuItemBinding).each(function(b){b.associatedSystemAction&&a.add(b.associatedSystemAction)}),a},ToolBarComboButtonBinding.prototype.setAndFireButton=function(a){a instanceof MenuItemBinding&&(this.keepState?(this.setButton(a),this.saveActiveMenuHandle(this.getMenuHandle(a)),this.fireCommand()):this.dispatchAction(new Action(a,this.commandAction)))},ToolBarComboButtonBinding.prototype.hideActiveItem=function(a){this.popupBinding.getDescendantBindingsByType(MenuItemBinding).each(function(b){b===a?Binding.prototype.hide.call(b):Binding.prototype.show.call(b)})},ToolBarComboButtonBinding.prototype.saveActiveMenuHandle=function(a){LocalStorage.set(ToolBarComboButtonBinding.STORAGE_PREFFIX+this.getBundleName(),a)},ToolBarComboButtonBinding.prototype.getActiveMenuHandle=function(){return LocalStorage.get(ToolBarComboButtonBinding.STORAGE_PREFFIX+this.getBundleName())},ToolBarComboButtonBinding.prototype.getMenuHandle=function(a){return a.menuHandle?a.menuHandle:a.getProperty("id")},ToolBarComboButtonBinding.prototype.getBundleName=function(){return this.getProperty("bundle")?this.getProperty("bundle"):this.getProperty("id")},ToolBarComboButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbutton",a);return UserInterface.registerBinding(b,ToolBarComboButtonBinding)},ToolBoxToolBarButtonBinding.prototype=new ToolBarButtonBinding,ToolBoxToolBarButtonBinding.prototype.constructor=ToolBoxToolBarButtonBinding,ToolBoxToolBarButtonBinding.superclass=ToolBarButtonBinding.prototype,ToolBoxToolBarButtonBinding.prototype.toString=function(){return"[ToolBoxToolBarButtonBinding]"},ToolBoxToolBarButtonBinding.prototype.onBindingAttach=function(){if(ToolBoxToolBarButtonBinding.superclass.onBindingAttach.call(this),System.hasActivePerspectives){this.subscribe(BroadcastMessages.PERSPECTIVE_CHANGED);var a=this._views;for(var b in ViewDefinitions){var c=ViewDefinitions[b],d=c.perspective;if(null!=d){a.has(d)||a.set(d,new List);var e=a.get(d);e.add(c)}}}else this.hide()},ToolBoxToolBarButtonBinding.prototype.handleBroadcast=function(a,b){switch(ToolBoxToolBarButtonBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.PERSPECTIVE_CHANGED:var c=b;if(c!=this._lastGeneratedPerspective){this._lastGeneratedPerspective=c;var d=this.bindingWindow.bindingMap.toolboxpopupgroup;if(d.empty(),this._views.has(c)){var e=this._views.get(c);e.each(function(a){var b=d.add(StageViewMenuItemBinding.newInstance(d.bindingDocument));b.setType(MenuItemBinding.TYPE_CHECKBOX),b.setHandle(a.handle),b.setLabel(a.label),b.setImage(a.image),b.setToolTip(a.toolTip),b.attach()}),d.show()}else d.hide()}}},TreeBinding.prototype=new FlexBoxBinding,TreeBinding.prototype.constructor=TreeBinding,TreeBinding.superclass=FlexBoxBinding.prototype,TreeBinding.ACTION_SELECTIONCHANGED="tree selection changed",TreeBinding.ACTION_NOSELECTION="tree selection none",TreeBinding.SELECTIONTYPE_SINGLE="single",TreeBinding.SELECTIONTYPE_MULTIPLE="multiple",TreeBinding.grid=function(a){var b=TreeNodeBinding.HEIGHT,c=(Math.ceil(a),a%b);return c>0&&(a=a-c+b),a+TreeBodyBinding.PADDING_TOP},TreeBinding.prototype.toString=function(){return"[TreeBinding]"},TreeBinding.prototype.onBindingRegister=function(){TreeBinding.superclass.onBindingRegister.call(this),this._treeNodeBindings=new Map,this._treeNodeBuffer=new List,this._focusedTreeNodeBindings=new List},TreeBinding.prototype.onBindingAttach=function(){TreeBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("focusable");if(null!=a&&(this._isFocusable=a),this._treeBodyBinding||0!==this.bindingElement.childElementCount||(this._treeBodyBinding=TreeBodyBinding.newInstance(this.bindingDocument),this.bindingElement.appendChild(this._treeBodyBinding.bindingElement),this._treeBodyBinding.attach()),this._treeBodyBinding||(this._treeBodyBinding=this.addMember(this.getChildBindingByLocalName("treebody"))),this._treeBodyBinding)this.addActionListener(Binding.ACTION_ACTIVATED),this.addActionListener(TreeNodeBinding.ACTION_OPEN),this.addActionListener(TreeNodeBinding.ACTION_CLOSE),this.addActionListener(TreeNodeBinding.ACTION_DISPOSE),this._isFocusable&&(this.addActionListener(TreeNodeBinding.ACTION_ONFOCUS),this.addActionListener(TreeNodeBinding.ACTION_ONMULTIFOCUS),this.addActionListener(TreeNodeBinding.ACTION_BLUR)),this.subscribe(BroadcastMessages.TYPEDRAG_START),this.subscribe(BroadcastMessages.TYPEDRAG_STOP),this.addEventListener(DOMEvents.BEFOREUPDATE),this.addEventListener(DOMEvents.AFTERUPDATE);else{var b="TreeBinding structure invalid. Missing TreeBodyBinding.";this.logger.error(b),Application.isDeveloperMode&&alert(b)}},TreeBinding.prototype.onBindingInitialize=function(){TreeBinding.superclass.onBindingInitialize.call(this),this._setupTreeSelection();var a=this.getProperty("builder");if(a)this._buildFromTextArea(a);else if(this._treeNodeBuffer.hasEntries())for(;this._treeNodeBuffer.hasNext();)this.add(this._treeNodeBuffer.getNext())},TreeBinding.prototype._setupTreeSelection=function(){var a=this.getProperty("selectable"),b=this.getProperty("selectionproperty"),c=this.getProperty("selectionvalue");a&&(this.setSelectable(!0),b&&this.setSelectionProperty(b),c&&this.setSelectionValue(c)),this._positionIndicatorBinding=this.add(TreePositionIndicatorBinding.newInstance(this.bindingDocument)),this.shadowTree.positionIndicator=this._positionIndicatorBinding,this._positionIndicatorBinding.attach()},TreeBinding.prototype._buildFromTextArea=function(a){function b(){e.subTreeFromString(c.value)}var c=this.bindingDocument.getElementById(a);if(null!=c){var d=UserInterface.getBinding(c),e=this._treeBodyBinding;d.addActionListener(Binding.ACTION_UPDATED,{handleAction:function(){b()}}),setTimeout(b,0)}},TreeBinding.prototype.registerTreeNodeBinding=function(a){var b=a.getHandle();if(this._treeNodeBindings.has(b))throw"Duplicate treenodehandles registered: "+a.getLabel();this._treeNodeBindings.set(b,a);var c=this._openTreeNodesBackupMap;null!=c&&c.has(b)&&a.open()},TreeBinding.prototype.unRegisterTreeNodeBinding=function(a){this._treeNodeBindings.del(a.getHandle())},TreeBinding.prototype.getTreeNodeBindingByHandle=function(a){var b=null;if(!this._treeNodeBindings.has(a))throw"No such treenode: "+a;return b=this._treeNodeBindings.get(a)},TreeBinding.prototype.handleAction=function(a){TreeBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case TreeNodeBinding.ACTION_OPEN:a.consume();break;case TreeNodeBinding.ACTION_CLOSE:this._blurDescendantBindings(b),a.consume();break;case TreeNodeBinding.ACTION_ONFOCUS:this._nodePrimary=b,this.focusSingleTreeNodeBinding(b),this.isFocused||this.focus(),a.consume();break;case TreeNodeBinding.ACTION_ONMULTIFOCUS:switch(this._selectionType){case TreeBinding.SELECTIONTYPE_SINGLE:this._nodePrimary=b,this.focusSingleTreeNodeBinding(b);break;case TreeBinding.SELECTIONTYPE_SINGLE:this._nodeSecondary=b,this._nodePrimary&&this._nodeSecondary!=this._nodePrimary?this.focusMultipeTreeNodeBindings(this._getVisibleTreeNodeBindingsInRange(this._nodePrimary,this._nodeSecondary)):(this._nodePrimary=b,this.focusSingleTreeNodeBinding(b))}this.isFocused||this.focus(),a.consume();break;case TreeNodeBinding.ACTION_DISPOSE:b.isFocused&&this.blurSelectedTreeNodes(),a.consume();break;case TreeNodeBinding.ACTION_BLUR:break;case Binding.ACTION_ACTIVATED:this.isFocused||this.focus()}},TreeBinding.prototype._getVisibleTreeNodeBindingsInRange=function(a,b){alert("TreeBinding#_getVisibleTreeNodeBindingsInRange")},TreeBinding.prototype.focusSingleTreeNodeBinding=function(a){null==a||a.isFocused||(this.blurSelectedTreeNodes(),this._focusedTreeNodeBindings.add(a),a.invokeManagedFocus(),this._isSelectable&&this._manageSelections())},TreeBinding.prototype.focusMultipeTreeNodeBindings=function(a){for(this.blurSelectedTreeNodes();a.hasNext();){var b=a.getNext();this._focusedTreeNodeBindings.add(b),b.invokeManagedFocus()}this._isSelectable&&this._manageSelections()},TreeBinding.prototype._manageSelections=function(){var a=this._selectedTreeNodeBindings;this._selectedTreeNodeBindings={};var b=!1,c=null;for(this._focusedTreeNodeBindings.reset();this._focusedTreeNodeBindings.hasNext();){var d=this._focusedTreeNodeBindings.getNext(),e=d.getProperty(this._selectionProperty);if(null!=e&&(!this._selectionValue||this._selectionValue[e])){c=this._selectedTreeNodeBindings[d.key]=d;var f=a[d.key];f&&f==c||(b=!0)}}if(c)b&&this.dispatchAction(TreeBinding.ACTION_SELECTIONCHANGED);else if(a)for(var g in a){this.dispatchAction(TreeBinding.ACTION_NOSELECTION);break}},TreeBinding.prototype.getSelectedTreeNodeBindings=function(){var a=new List;for(var b in this._selectedTreeNodeBindings)a.add(this._selectedTreeNodeBindings[b]);return a},TreeBinding.prototype.blurSelectedTreeNodes=function(){this._focusedTreeNodeBindings.reset().each(function(a){a.blur()}),this._focusedTreeNodeBindings.clear()},TreeBinding.prototype._blurDescendantBindings=function(a){var b=a.getDescendantBindingsByLocalName("treenode"),c=!0,d=this;b.each(function(a){return a.isFocused&&(a.blur(),d._focusedTreeNodeBindings.del(d._focusedTreeNodeBindings.getIndex(a))),c})},TreeBinding.prototype.getFocusedTreeNodeBindings=function(){return this._focusedTreeNodeBindings.reset()},TreeBinding.prototype.focus=function(){this.isFocused||(this.isFocused=!0,FocusBinding.focusElement(this.bindingElement),this.attachClassName(Binding.CLASSNAME_FOCUSED),this.dispatchAction(Binding.ACTION_FOCUSED),this.getFocusedTreeNodeBindings().hasEntries()||this.isFocusable&&this._focusDefault(),this._grabKeyboard())},TreeBinding.prototype._focusDefault=function(){var a=this._treeBodyBinding.getChildBindingByLocalName("treenode");null!=a&&(this.focusSingleTreeNodeBinding(a),a.callback())},TreeBinding.prototype.blur=function(){this.isFocused&&(this.isFocused=!1,this.detachClassName(Binding.CLASSNAME_FOCUSED),this.dispatchAction(Binding.ACTION_BLURRED),this._releaseKeyboard())},TreeBinding.prototype._grabKeyboard=function(){this.subscribe(BroadcastMessages.KEY_ARROW),this.subscribe(BroadcastMessages.KEY_ENTER),this._hasKeyboard=!0},TreeBinding.prototype._releaseKeyboard=function(){this.unsubscribe(BroadcastMessages.KEY_ARROW),this.unsubscribe(BroadcastMessages.KEY_ENTER),this._hasKeyboard=!1},TreeBinding.prototype.add=function(a){var b=null;return this._treeBodyBinding?b=this._treeBodyBinding.add(a):(this._treeNodeBuffer.add(a),b=a),b},TreeBinding.prototype.addFirst=function(a){throw new Error("Not implemented")},TreeBinding.prototype.empty=function(){this._treeBodyBinding.detachRecursive();var a=this._treeBodyBinding.bindingElement;a.innerHTML=""},TreeBinding.prototype.isEmpty=function(){return 0==this._treeNodeBindings.hasEntries()},TreeBinding.prototype.collapse=function(){this.blurSelectedTreeNodes(),this._treeNodeBindings.each(function(a,b){b.isContainer&&b.isOpen&&b.close()})},TreeBinding.prototype.setSelectable=function(a){this._isSelectable=a,a?this._selectedTreeNodeBindings={}:(this._selectedTreeNodeBindings=null,this._selectionProperty=null,this._selectionValue=null)},TreeBinding.prototype.setSelectionProperty=function(a){this._selectionProperty=a},TreeBinding.prototype.setSelectionValue=function(a){if(a){var b=new List(a.split(" "));for(this._selectionValue={};b.hasNext();)this._selectionValue[b.getNext()]=!0}},TreeBinding.prototype.handleBroadcast=function(a,b){switch(TreeBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.TYPEDRAG_START:this.addEventListener(DOMEvents.MOUSEMOVE),this._yposition=this.boxObject.getGlobalPosition().y;break;case BroadcastMessages.TYPEDRAG_STOP:this.removeEventListener(DOMEvents.MOUSEMOVE),this._positionIndicatorBinding.hide(),this._yposition=-1;break;case BroadcastMessages.KEY_ARROW:this._navigateByKey(b);break;case BroadcastMessages.KEY_ENTER:var c=this.getFocusedTreeNodeBindings();if(c.hasEntries()){var d=c.getFirst();d.isContainer?d.isOpen?d.close():d.open():d.fireCommand()}}},TreeBinding.prototype._navigateByKey=function(a){var b=this.getFocusedTreeNodeBindings();if(b.hasEntries()){var c=b.getFirst(),d=null;switch(a){case KeyEventCodes.VK_UP:if(d=c.getPreviousBindingByLocalName("treenode"),null!=d)for(;d.isContainer&&d.hasChildren()&&d.isOpen;)d=d.getChildBindingsByLocalName("treenode").getLast();null==d&&(d=c.getAncestorBindingByLocalName("treenode"));break;case KeyEventCodes.VK_DOWN:if(c.isContainer&&c.hasChildren()&&c.isOpen)d=c.getChildBindingByLocalName("treenode");else if(d=c.getNextBindingByLocalName("treenode"),null==d)for(var e=null;null==d&&null!=(e=c.getAncestorBindingByLocalName("treenode"));)null!=e&&(d=e.getNextBindingByLocalName("treenode")),c=e;break;case KeyEventCodes.VK_RIGHT:c.isContainer&&(c.isOpen?c.hasChildren()&&(d=c.getChildBindingByLocalName("treenode")):c.open());break;case KeyEventCodes.VK_LEFT:c.isContainer&&c.isOpen?c.close():d=c.getAncestorBindingByLocalName("treenode")}null!=d&&this.focusSingleTreeNodeBinding(d)}},TreeBinding.prototype.handleEvent=function(a){TreeBinding.superclass.handleEvent.call(this,a);DOMEvents.getTarget(a);switch(a.type){case DOMEvents.MOUSEMOVE:try{this._updatePositionIndicator(a)}catch(a){throw this.removeEventListener(DOMEvents.MOUSEMOVE),a}break;case DOMEvents.BEFOREUPDATE:var b=new TreeCrawler,c=new List;b.mode=TreeCrawler.MODE_GETOPEN,b.crawl(this.bindingElement,c);var d=new Map;if(c.hasEntries()){for(;c.hasNext();){var e=c.getNext();d.set(e.getHandle(),!0)}this._openTreeNodesBackupMap=d}break;case DOMEvents.AFTERUPDATE:this._openTreeNodesBackupMap=null}},TreeBinding.prototype._updatePositionIndicator=function(a){var b=a.clientY-this._yposition,c=this._acceptingPosition,d=this._acceptingDimension,e=this._positionIndicatorBinding;if(this._acceptingTreeNodeBinding){var f=c.y,g=c.y+d.h;if(b>=f&&b<=g){for(b=b<f+TreeNodeBinding.HEIGHT?f+TreeNodeBinding.HEIGHT:b,b-=TreeNodeBinding.HEIGHT,b=TreeBinding.grid(b);!this._acceptingPositions[b];)b+=TreeNodeBinding.HEIGHT;b!=e.getPosition().y&&e.setPosition(new Point(this._acceptingPosition.x+TreeNodeBinding.INDENT,b)),e.isVisible||e.show()}else e.isVisible&&e.hide()}else e.isVisible&&e.hide()},TreeBinding.prototype.enablePositionIndicator=function(a){this._acceptingTreeNodeBinding=a,this._acceptingPosition=a.boxObject.getLocalPosition(),this._acceptingDimension=a.boxObject.getDimension(),this._acceptingPositions=this._getChildPositions(a)},TreeBinding.prototype.disablePositionIndicator=function(){this._acceptingTreeNodeBinding=null,this._acceptingPosition=null,this._acceptingDimension=null},TreeBinding.prototype._getChildPositions=function(a){var b,c,d,e,f={},g=a.getChildBindingsByLocalName("treenode");for(e=TreeBinding.grid(a.boxObject.getLocalPosition().y),f[e]=!0;g.hasNext();)b=g.getNext(),c=b.boxObject.getLocalPosition(),d=b.boxObject.getDimension(),e=TreeBinding.grid(c.y+d.h)-TreeNodeBinding.HEIGHT,f[e]=!0;return f},TreeBinding.prototype.getDropIndex=function(){var a=this._positionIndicatorBinding.getPosition().y,b=0;for(var c in this._acceptingPositions){if(c==a)break;b++}return Number(b)},TreeBinding.prototype.getRootTreeNodeBindings=function(){return this._treeBodyBinding.getChildBindingsByLocalName("treenode")},TreeBinding.prototype.getTreeBodyBinding=function(){return this._treeBodyBinding},TreeBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:tree",a),c=UserInterface.registerBinding(b,TreeBinding);return c.treeBodyBinding=TreeBodyBinding.newInstance(a),c},TreeBodyBinding.prototype=new FlexBoxBinding,TreeBodyBinding.prototype.constructor=TreeBodyBinding,TreeBodyBinding.superclass=FlexBoxBinding.prototype,TreeBodyBinding.PADDING_TOP=8,TreeBodyBinding.prototype.toString=function(){return"[TreeBodyBinding]"},TreeBodyBinding.prototype.onBindingAttach=function(){TreeBodyBinding.superclass.onBindingAttach.call(this),this.addActionListener(TreeNodeBinding.ACTION_FOCUSED),this.containingTreeBinding=UserInterface.getBinding(this.bindingElement.parentNode)},TreeBodyBinding.prototype.accept=function(a){a instanceof TreeNodeBinding&&this.logger.debug(a)},TreeBodyBinding.prototype.handleAction=function(a){switch(TreeBodyBinding.superclass.handleAction.call(this,a),a.type){case TreeNodeBinding.ACTION_FOCUSED:this._scrollIntoView(a.target),a.consume()}},TreeBodyBinding.prototype._scrollIntoView=function(a){var b=a.labelBinding.bindingElement,c=this.bindingElement.clientHeight,d=this.bindingElement.clientWidth,e=a.boxObject.getGlobalPosition().y-this.boxObject.getGlobalPosition().y,f=DOMUtil.getGlobalPosition(b).x-this.boxObject.getGlobalPosition().x,g=b.offsetHeight,h=100,i=this.bindingElement.scrollTop,j=this.bindingElement.scrollLeft;e-i<0?this.bindingElement.scrollTop=e:e-i+g>c&&(this.bindingElement.scrollTop=e+g-c),f-j<0?this.bindingElement.scrollLeft=f:f-j+h>d&&(this.bindingElement.scrollLeft=f+h-d)},TreeBodyBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:treebody",a);return UserInterface.registerBinding(b,TreeBodyBinding)},TreeNodeBinding.prototype=new Binding,TreeNodeBinding.prototype.constructor=TreeNodeBinding,TreeNodeBinding.superclass=Binding.prototype,TreeNodeBinding.DEFAULT_FOLDER_CLOSED="${icon:folder}",TreeNodeBinding.DEFAULT_FOLDER_OPEN="${icon:folder_active}",TreeNodeBinding.DEFAULT_FOLDER_DISABLED="${icon:default}",TreeNodeBinding.DEFAULT_ITEM="${root}/images/icons/harmony/composite/default_16.png",TreeNodeBinding.DEFAULT_ITEM_DISABLED="${icon:default}",TreeNodeBinding.ACTION_OPEN="treenodeopen",TreeNodeBinding.ACTION_CLOSE="treenodeclose",TreeNodeBinding.ACTION_ONFOCUS="treenodeonfocus",TreeNodeBinding.ACTION_ONMULTIFOCUS="treenodeonmultifocus",TreeNodeBinding.ACTION_FOCUSED="treenodefocused",TreeNodeBinding.ACTION_BLUR="treenodeblur",TreeNodeBinding.ACTION_COMMAND="treenodecommand",TreeNodeBinding.ACTION_DISPOSE="treenodedisposed",TreeNodeBinding.CLASSNAME_DRAGGED="dragged",TreeNodeBinding.HEIGHT=19,TreeNodeBinding.INDENT=34,TreeNodeBinding.prototype.toString=function(){return"[TreeNodeBinding]"},TreeNodeBinding.prototype.serialize=function(){var a=TreeNodeBinding.superclass.serialize.call(this);if(a){a.label=this.getLabel(),a.image=this.getImage();var b=this.getHandle();b&&b!=this.key&&(a.handle=b),this.isOpen&&(a.open=!0),this.isDisabled&&(a.disabled=!0),this.dragType&&(a.dragtype=this.dragType),this.dragAccept&&(a.dragaccept=this.dragAccept)}return a},TreeNodeBinding.prototype.onBindingRegister=function(){TreeNodeBinding.superclass.onBindingRegister.call(this),this.propertyMethodMap.label=this.setLabel,this.propertyMethodMap.image=this.setImage,this.propertyMethodMap.tooltip=this.setToolTip},TreeNodeBinding.prototype.onBindingAttach=function(){TreeBinding.superclass.onBindingAttach.call(this),this.isOpen=!!this.isOpen||this.getProperty("open"),this.isPinned=!!this.isPinned||this.getProperty("pin"),this.isContainer||(this.isContainer=this.hasChildren()),this.buildDOMContent(),this.assignDOMEvents(),this.isDisabled&&this.labelBinding.attachClassName(LabelBinding.CLASSNAME_GRAYTEXT),this.addActionListener(TreeNodeBinding.ACTION_FOCUSED),this.addEventListener(UpdateManager.EVENT_AFTERUPDATE),this._registerWithAncestorTreeBinding()},TreeNodeBinding.prototype.onBindingDispose=function(){this.isAttached&&(null!=this.dragger&&(this.labelBinding.removeEventListener(DOMEvents.MOUSEDOWN,this.dragger),this.labelBinding.removeEventListener(DOMEvents.MOUSEMOVE,this.dragger),this.labelBinding.removeEventListener(DOMEvents.MOUSEUP,this.dragger),this.disableDragging(),this.dragger.dispose()),this.dispatchAction(TreeNodeBinding.ACTION_DISPOSE),this.containingTreeBinding.unRegisterTreeNodeBinding(this),this.labelBinding.dispose()),TreeNodeBinding.superclass.onBindingDispose.call(this)},TreeNodeBinding.prototype._registerWithAncestorTreeBinding=function(){for(var a=this.bindingElement;null!=(a=a.parentNode)&&!this.containingTreeBinding;){var b=UserInterface.getBinding(a);b&&b.containingTreeBinding&&(this.containingTreeBinding=b.containingTreeBinding)}if(!this.containingTreeBinding)throw alert(this.bindingElement.parentNode.nodeName),"TreeNodeBinding attached outside TreeBodyBinding";this.containingTreeBinding.registerTreeNodeBinding(this)},TreeNodeBinding.prototype.getHandle=function(){var a=this.key,b=this.getProperty("handle");return b&&(a=b),a},TreeNodeBinding.prototype.setHandle=function(a){this.setProperty("handle",a)},TreeNodeBinding.prototype.buildDOMContent=function(){var a=this.getProperty("url"),b=this.getProperty("label"),c=this.getProperty("tooltip"),d=this.getProperty("oncommand"),e=this.getProperty("onbindingfocus"),f=this.getProperty("onbindingblur"),g=this.getProperty("focused"),h=this.getProperty("callbackid");if(a){var i=DOMUtil.createElementNS(Constants.NS_XHTML,"a",this.bindingDocument);i.href=a,this.bindingElement.appendChild(i),this.shadowTree.link=i}this.labelBinding=LabelBinding.newInstance(this.bindingDocument),a?this.shadowTree.link.appendChild(this.labelBinding.bindingElement):this.addFirst(this.labelBinding),this.shadowTree.label=this.labelBinding,null!=this.dragger&&(this.removeEventListener(DOMEvents.MOUSEDOWN,this.dragger),this.removeEventListener(DOMEvents.MOUSEMOVE,this.dragger),this.removeEventListener(DOMEvents.MOUSEUP,this.dragger),this.labelBinding.addEventListener(DOMEvents.MOUSEDOWN,this.dragger),this.labelBinding.addEventListener(DOMEvents.MOUSEMOVE,this.dragger),this.labelBinding.addEventListener(DOMEvents.MOUSEUP,this.dragger)),this.isContainer&&!this.dragAccept&&(this.acceptor=new BindingAcceptor(this)),null!=b&&this.setLabel(b),null!=c&&this.setToolTip(c),this.imageProfile||this._computeImageProfile(),this.setImage(this.computeImage()),this.isContainer&&this.updateClassNames();this.bindingWindow.WindowManager;null!=d&&(this.oncommand=function(){Binding.evaluate(d,this)}),null!=e&&(this.onfocus=function(){Binding.evaluate(e,this)}),null!=f&&(this.onblur=function(){Binding.evaluate(f,this)}),1==g&&this.focus(),null!=h&&Binding.dotnetify(this,h)},TreeNodeBinding.prototype.handleAction=function(a){switch(TreeNodeBinding.superclass.handleAction.call(this,a),a.type){case TreeNodeBinding.ACTION_FOCUSED:a.target!=this&&this.isContainer&&!this.isOpen&&this.open(!0)}},TreeNodeBinding.prototype.enableDragging=function(){},TreeNodeBinding.prototype.disableDragging=function(){this.isDraggable=!1},TreeNodeBinding.prototype.accept=function(a,b){var c=!0;if(a instanceof TreeNodeBinding){for(var d=!1,e=this.bindingElement,f=this.containingTreeBinding.bindingElement;!d&&e!=f;)e==a.getBindingElement()?d=!0:e=e.parentNode;d?(Dialog.error("Not Allowed","You cannot move a folder into itself."),c=!1):this.acceptTreeNodeBinding(a,b)}else c=!1;return c},TreeNodeBinding.prototype.acceptTreeNodeBinding=function(a,b){var c=a.serializeToString(),d=new BindingParser(this.bindingDocument),e=d.parseFromString(c).getFirst();b=b?b:this.containingTreeBinding.getDropIndex();var f=this.getChildElementsByLocalName("treenode");this.bindingElement.insertBefore(e,f.get(b)),this.bindingWindow.DocumentManager.attachBindings(this.bindingElement),a.dispose()},TreeNodeBinding.prototype.showAcceptance=function(){this.containingTreeBinding.enablePositionIndicator(this)},TreeNodeBinding.prototype.hideAcceptance=function(){this.containingTreeBinding.disablePositionIndicator()},TreeNodeBinding.prototype._computeImageProfile=function(){var a=this.getProperty("image"),b=this.getProperty("image-active"),c=this.getProperty("image-disabled");b=b?b:this.isContainer?a?a:TreeNodeBinding.DEFAULT_FOLDER_OPEN:a?a:TreeNodeBinding.DEFAULT_ITEM,c=c?c:this.isContainer?a?a:TreeNodeBinding.DEFAULT_FOLDER_DISABLED:a?a:TreeNodeBinding.DEFAULT_ITEM_DISABLED,a=a?a:this.isContainer?TreeNodeBinding.DEFAULT_FOLDER_CLOSED:TreeNodeBinding.DEFAULT_ITEM,this.imageProfile=new ImageProfile({image:a,imageHover:null,imageActive:b,imageDisabled:c})},TreeNodeBinding.prototype.assignDOMEvents=function(){this.labelBinding.addEventListener(DOMEvents.DOUBLECLICK,this),this.labelBinding.addEventListener(DOMEvents.MOUSEDOWN,this),this.labelBinding.addEventListener(DOMEvents.MOUSEOVER,this),this.labelBinding.addEventListener(DOMEvents.MOUSEOUT,this)},TreeNodeBinding.prototype.setImage=function(a){this.setProperty("image",a),this.isAttached&&this.labelBinding.setImage(a)},TreeNodeBinding.prototype.setLabel=function(a){this.setProperty("label",String(a)),this.isAttached&&this.labelBinding.setLabel(String(a))},TreeNodeBinding.prototype.setToolTip=function(a){this.setProperty("tooltip",String(a)),this.isAttached&&this.labelBinding.setToolTip(String(a))},TreeNodeBinding.prototype.getImage=function(){return this.getProperty("image")},TreeNodeBinding.prototype.getLabel=function(){return this.getProperty("label")},TreeNodeBinding.prototype.getToolTip=function(){return this.getProperty("tooltip")},TreeNodeBinding.prototype.computeImage=function(){var a=this.imageProfile.getDefaultImage(),b=this.imageProfile.getActiveImage();return b=b?b:a,this.isOpen?b:a},TreeNodeBinding.prototype.handleEvent=function(a){TreeNodeBinding.superclass.handleEvent.call(this,a);var b=DOMEvents.getTarget(a),c=this.labelBinding.bindingElement,d=this.labelBinding.shadowTree.labelBody,e=this.labelBinding.shadowTree.labelText;switch(a.type){case DOMEvents.MOUSEDOWN:b==c?this._onAction(a):this.isDisabled||this._onFocus(a);break;case DOMEvents.DOUBLECLICK:this._onAction(a);break;case UpdateManager.EVENT_AFTERUPDATE:if(b.parentNode==this.bindingElement&&b.__updateType==Update.TYPE_INSERT){var c=this.labelBinding.bindingElement;"treenode"==DOMUtil.getLocalName(b)&&b==this.bindingElement.firstChild&&this.bindingElement.insertBefore(b,c.nextSibling);break}}if(BindingDragger.isDragging&&this.isContainer&&!this.isOpen)switch(a.type){case DOMEvents.MOUSEOVER:case DOMEvents.MOUSEOUT:switch(b){case c:case d:case e:this._folderDragOverTimeout(a)}}},TreeNodeBinding.prototype._folderDragOverTimeout=function(a){var b=this;switch(a.type){case DOMEvents.MOUSEOVER:this._dragTimeout=this.bindingWindow.setTimeout(function(){b.open()},500);break;case DOMEvents.MOUSEOUT:this.bindingWindow.clearTimeout(this._dragTimeout)}},TreeNodeBinding.prototype._onAction=function(a){var b=!0;if("mousedown"==a.type){var c=a.button==(a.target?0:1);c||(b=!1)}b&&(this.isContainer?this.isOpen?this.close():this.open():this.fireCommand())},TreeNodeBinding.prototype.fireCommand=function(){this.oncommand&&this.oncommand(),this.dispatchAction(TreeNodeBinding.ACTION_COMMAND)},TreeNodeBinding.prototype._onFocus=function(a){var b=!1;null!=a&&(b=a.shiftKey),this.dispatchAction(b?TreeNodeBinding.ACTION_ONMULTIFOCUS:TreeNodeBinding.ACTION_ONFOCUS),null!=a&&this.stopPropagation(a),null!=this.onfocus&&this.onfocus(),null!=a&&this.hasCallBackID()&&this.callback()},TreeNodeBinding.prototype.callback=function(){if(this.hasCallBackID()){var a=this;setTimeout(function(){a.dispatchAction(PageBinding.ACTION_DOPOSTBACK)},0)}},TreeNodeBinding.prototype.invokeManagedFocus=function(){this.isFocused||(this.isFocused=!0,this.setProperty("focused",!0),this.labelBinding.attachClassName("focused"),this.dispatchAction(TreeNodeBinding.ACTION_FOCUSED))},TreeNodeBinding.prototype.focus=function(){this.setProperty("focused",!0),this.isAttached&&this._onFocus()},TreeNodeBinding.prototype.blur=function(){this.isFocused&&(this.isFocused=!1,this.deleteProperty("focused"),this.labelBinding.detachClassName("focused"),this.onblur&&this.onblur(),this.dispatchAction(TreeNodeBinding.ACTION_BLUR))},TreeNodeBinding.prototype.stopPropagation=function(a){"mousedown"==a.type&&(EventBroadcaster.broadcast(BroadcastMessages.MOUSEEVENT_MOUSEDOWN,a),this.dispatchAction(Binding.ACTION_ACTIVATED)),DOMEvents.stopPropagation(a)},TreeNodeBinding.prototype.open=function(){this.isContainer&&!this.isOpen&&(this.isOpen=!0,this.setProperty("open",!0),this.dispatchAction(TreeNodeBinding.ACTION_OPEN),this.setImage(this.computeImage()),this.updateClassNames(),this.hasBeenOpened=!0)},TreeNodeBinding.prototype.close=function(){this.isContainer&&this.isOpen&&!this.isPinned&&(this.isOpen=!1,this.setProperty("open",!1),this.dispatchAction(TreeNodeBinding.ACTION_CLOSE),this.setImage(this.computeImage()),this.updateClassNames())},TreeNodeBinding.prototype.updateClassNames=function(){this.isContainer?(this.hasClassName("container")||this.attachClassName("container"),this.isOpen?(this.detachClassName("closed"),this.attachClassName("open"),this.labelBinding.detachClassName("closed"),this.labelBinding.attachClassName("open")):(this.detachClassName("open"),this.attachClassName("closed"),this.labelBinding.detachClassName("open"),this.labelBinding.attachClassName("closed"))):this.hasClassName("container")&&(this.detachClassName("container"),this.labelBinding.detachClassName("closed"),this.labelBinding.detachClassName("open"))},TreeNodeBinding.prototype.empty=function(){var a=this.getDescendantBindingsByLocalName("treenode");a.each(function(a){a.dispose()})},TreeNodeBinding.prototype.showDrag=function(){this.attachClassName(TreeNodeBinding.CLASSNAME_DRAGGED)},TreeNodeBinding.prototype.hideDrag=function(){this.detachClassName(TreeNodeBinding.CLASSNAME_DRAGGED)},TreeNodeBinding.prototype.hasChildren=function(){return this.bindingElement.hasChildNodes()},TreeNodeBinding.prototype.handleElement=function(a){var b=a.getAttribute("focused");return"true"==b&&(this.isFocused||this.focus()),!1},TreeNodeBinding.prototype.getParent=function(){return this.getAncestorBindingByLocalName("treenode")},TreeNodeBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:treenode",a);return UserInterface.registerBinding(b,TreeNodeBinding)},TreeContentBinding.prototype=new Binding,TreeContentBinding.prototype.constructor=TreeContentBinding,TreeContentBinding.superclass=Binding.prototype,TreeContentBinding.prototype.toString=function(){return"[TreeContentBinding]"},TreeContentBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:treecontent",a);return UserInterface.registerBinding(b,TreeContentBinding)},TreePositionIndicatorBinding.prototype=new Binding,TreePositionIndicatorBinding.prototype.constructor=TreePositionIndicatorBinding,TreePositionIndicatorBinding.superclass=Binding.prototype,TreePositionIndicatorBinding.prototype.toString=function(){
return"[TreePositionIndicatorBinding]"},TreePositionIndicatorBinding.prototype.onBindingAttach=function(){TreePositionIndicatorBinding.superclass.onBindingAttach.call(this),this.hide()},TreePositionIndicatorBinding.prototype.setPosition=function(a){this.bindingElement.style.left=a.x+"px",this.bindingElement.style.top=a.y+"px",this._geometry.x=a.x,this._geometry.y=a.y},TreePositionIndicatorBinding.prototype.getPosition=function(){return new Point(this._geometry.x,this._geometry.y)},TreePositionIndicatorBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:treepositionindicator",a);return UserInterface.registerBinding(b,TreePositionIndicatorBinding)},TreeCrawler.prototype=new BindingCrawler,TreeCrawler.prototype.constructor=TreeCrawler,TreeCrawler.superclass=BindingCrawler.prototype,TreeCrawler.ID="treecrawler",TreeCrawler.MODE_GETOPEN="get open treenodes",TreeCrawler.prototype._construct=function(){TreeCrawler.superclass._construct.call(this);var a=this;this.addFilter(function(a){var b=UserInterface.getBinding(a),c=null,c=null;return!b instanceof TreeNodeBinding&&(c=NodeCrawler.SKIP_NODE),c}),this.addFilter(function(b,c){var d=UserInterface.getBinding(b),e=null;switch(a.mode){case TreeCrawler.MODE_GETOPEN:d.isOpen&&c.add(d)}return e})},CheckTreeBinding.prototype=new TreeBinding,CheckTreeBinding.prototype.constructor=CheckTreeBinding,CheckTreeBinding.superclass=TreeBinding.prototype,CheckTreeBinding.prototype.toString=function(){return"[CheckTreeBinding]"},CheckTreeBinding.prototype._grabKeyboard=function(){this.subscribe(BroadcastMessages.KEY_SPACE),CheckTreeBinding.superclass._grabKeyboard.call(this)},CheckTreeBinding.prototype._releaseKeyboard=function(){this.unsubscribe(BroadcastMessages.KEY_SPACE),CheckTreeBinding.superclass._releaseKeyboard.call(this)},CheckTreeBinding.prototype.handleBroadcast=function(a,b){switch(CheckTreeBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_SPACE:var c=this.getFocusedTreeNodeBindings();if(c.hasEntries()){var d=c.getFirst();d instanceof CheckTreeNodeBinding&&(d.isReadOnly||d.invoke())}}},CheckTreeBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:tree",a),c=UserInterface.registerBinding(b,CheckTreeBinding);return c.treeBodyBinding=TreeBodyBinding.newInstance(a),c},CheckTreeNodeBinding.prototype=new TreeNodeBinding,CheckTreeNodeBinding.prototype.constructor=CheckTreeNodeBinding,CheckTreeNodeBinding.superclass=TreeNodeBinding.prototype,CheckTreeNodeBinding.CLASS_NAME="checkbox",CheckTreeNodeBinding.ACTION_COMMAND="checkbox treenode command",CheckTreeNodeBinding.prototype.toString=function(){return"[CheckTreeNodeBinding]"},CheckTreeNodeBinding.prototype.onBindingRegister=function(){CheckTreeNodeBinding.superclass.onBindingRegister.call(this)},CheckTreeNodeBinding.prototype.onBindingAttach=function(){CheckTreeNodeBinding.superclass.onBindingAttach.call(this),this._parseDOMProperties(),this._buildCheckButtonBinding(),this.isReadOnly&&this.labelBinding.attachClassName(LabelBinding.CLASSNAME_GRAYTEXT)},CheckTreeNodeBinding.prototype._parseDOMProperties=function(){this.isSelectable=!!this.isSelectable||this.getProperty("selectable")},CheckTreeNodeBinding.prototype._buildCheckButtonBinding=function(){if(this.isSelectable){this._buttonBinding=CheckButtonBinding.newInstance(this.bindingDocument),this.bindingElement.insertBefore(this._buttonBinding.bindingElement,this.labelBinding.bindingElement.nextSibling),this.getProperty("selected")===!0&&this._buttonBinding.check(!0),this.isReadOnly&&this._buttonBinding.setDisabled(!0);var a=this;this._buttonBinding.addActionListener(ButtonBinding.ACTION_COMMAND,{handleAction:function(b){b.consume(),a.dispatchAction(CheckTreeNodeBinding.ACTION_COMMAND)}}),this._buttonBinding.attach(),this.attachClassName(CheckTreeNodeBinding.CLASS_NAME)}},CheckTreeNodeBinding.prototype.isChecked=function(){if(this.isSelectable)return this._buttonBinding.isChecked},CheckTreeNodeBinding.prototype.setChecked=function(a,b){this.isSelectable&&this._buttonBinding.setChecked(a,b)},CheckTreeNodeBinding.prototype.invoke=function(){this.isSelectable&&this._buttonBinding.invoke()},CheckTreeNodeBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:treenode",a);return UserInterface.registerBinding(b,CheckTreeNodeBinding)},DockTabsButtonBinding.prototype=new TabsButtonBinding,DockTabsButtonBinding.prototype.constructor=DockTabsButtonBinding,DockTabsButtonBinding.superclass=TabsButtonBinding.prototype,DockTabsButtonBinding.RESERVED_SPACE=50,DockTabsButtonBinding.NODENAME_TABBOX="dock",DockTabsButtonBinding.prototype.toString=function(){return"[DockTabsButtonBinding]"},DockTabsButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbutton",a);return b.setAttribute("type","checkbox"),b.setAttribute("popup","app.bindingMap.tabsbuttonpopup"),b.className="tabbutton",UserInterface.registerBinding(b,DockTabsButtonBinding)},DockBinding.prototype=new TabBoxBinding,DockBinding.prototype.constructor=DockBinding,DockBinding.superclass=TabBoxBinding.prototype,DockBinding.START="start",DockBinding.EXTERNAL="external",DockBinding.EXPLORER="explorer",DockBinding.MAIN="main",DockBinding.BOTTOMLEFT="bottomleft",DockBinding.BOTTOMRIGHT="bottomright",DockBinding.RIGHTTOP="righttop",DockBinding.RIGHTBOTTOM="rightbottom",DockBinding.ABSBOTTOMLEFT="absbottomleft";DockBinding.ABSBOTTOMRIGHT="absbottomright";DockBinding.ABSRIGHTTOP="absrighttop",DockBinding.ABSRIGHTBOTTOM="absrightbottom",DockBinding.SLIDE="slide",DockBinding.TYPE_START="start",DockBinding.TYPE_EXPLORER="explorer",DockBinding.TYPE_EDITORS="editors",DockBinding.TYPE_TOOLS="tools",DockBinding.ACTION_OPENED="dockopened",DockBinding.ACTION_EMPTIED="dockemptied",DockBinding.CLASSNAME_ACTIVE="active",DockBinding.prototype.toString=function(){return"[DockBinding]"},DockBinding.prototype.serialize=function(){var a=DockBinding.superclass.serialize.call(this);return a&&(a.active=!!this.isActive||null,a.collapsed=!!this.isCollapsed||null),a},DockBinding.prototype.onBindingRegister=function(){DockBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_ACTIVATED,this),this.addActionListener(TabBoxBinding.ACTION_UPDATED,this),this.addActionListener(ViewBinding.ACTION_LOADED),this.addActionListener(ViewBinding.ACTION_CLOSED),this._viewBindingList=new List,this.reference=this.getProperty("reference"),this.reference==DockBinding.MAIN&&this.subscribe(BroadcastMessages.SYSTEMTREENODEBINDING_FOCUS)},DockBinding.prototype.onBindingAttach=function(){DockBinding.superclass.onBindingAttach.call(this),this._containingSplitPanelBinding=this.getAncestorBindingByLocalName("splitpanel"),this.getTabBindings().hasEntries()?(this.isEmpty=!1,this.isActivatable=!0):this.dispatchAction(DockBinding.ACTION_EMPTIED)},DockBinding.prototype.buildDOMContent=function(){var a=this.getProperty("type");this.type=a?a:DockBinding.TYPE_TOOLS,this.attachClassName(this.type),1==this.getProperty("active")&&this.activate()},DockBinding.prototype.interceptDisplayChange=function(a){var b=this.getSelectedTabPanelBinding();b&&(b.isVisible=a,b.dispatchAction(Binding.ACTION_VISIBILITYCHANGED))},DockBinding.prototype.prepareNewView=function(a){var b=this._getBindingForDefinition(a),c=DockTabBinding.newInstance(this.bindingDocument);c.setHandle(a.handle),c.setLabel(a.flowHandle?null:a.label),c.setImage(a.image),c.setToolTip(a.toolTip),c.setEntityToken(a.entityToken),c.setAssociatedView(b),a.isPinned&&c.setProperty("pinned",!0),Application.isTestEnvironment&&c.setProperty("data-qa",a.entityToken),this.appendTabByBindings(c,null),this._setupPageBindingListeners(c);var d=this.getTabPanelBinding(c);b.snapToBinding(d,a.isFloating);var e=this.bindingWindow.bindingMap.views;return e.add(b),this.isActive||this.activate(),b.attach(),c},DockBinding.prototype.prepareOpenView=function(a,b){this.logger.debug("DockBinding.prototype.prepareOpenView: _setupDirtyStuff required?"),b.setLabel(a.label),b.setImage(a.image),b.setToolTip(a.toolTip),this._setupPageBindingListeners(b);var c=this.getTabPanelBinding(b),d=this._getBindingForDefinition(a);b.setAssociatedView(d),d.snapToBinding(c,a.isFloating),UserInterface.getBinding(this.bindingDocument.body).add(d),d.attach()},DockBinding.prototype._getBindingForDefinition=function(a){var b=this.bindingWindow.bindingMap.views,c=ViewBinding.newInstance(b.bindingDocument);return c.setDefinition(a),c},DockBinding.prototype._setupPageBindingListeners=function(a){var b=this.getTabPanelBinding(a),c=this,d={handleAction:function(d){var e=d.target;switch(d.type){case PageBinding.ACTION_ATTACHED:TabBoxBinding.currentActiveInstance=c;break;case PageBinding.ACTION_INITIALIZED:e.reflex(!0);var f=a.getAssociatedView();e.bindingWindow==f.getContentWindow()&&(a.updateDisplay(e),EventBroadcaster.broadcast(BroadcastMessages.VIEW_COMPLETED,f.getHandle()),StatusBar.state==StatusBar.BUSY&&StatusBar.clear()),a.onPageInitialize(e),d.consume();break;case PageBinding.ACTION_UPDATED:var f=a.getAssociatedView();e.bindingWindow==f.getContentWindow()&&a.updateDisplay(e);break;case DockTabBinding.ACTION_UPDATE_VISUAL:a.updateDisplay(e),d.consume();break;case DockTabBinding.ACTION_UPDATE_TOKEN:a.updateEntityToken(e),d.consume();break;case EditorPageBinding.ACTION_DIRTY:a.setDirty(!0);break;case EditorPageBinding.ACTION_SAVE:case EditorPageBinding.ACTION_SAVE_AND_PUBLISH:a.onSaveStart();break;case ViewBinding.ACTION_ONCLOSE:c.closeTab(a),d.consume();break;case ViewBinding.ACTION_ONCLOSE_FORCE:c.closeTab(a,!0),d.consume();break;case DockPanelBinding.ACTION_FORCE_SELECT:c.select(a);break;case Binding.ACTION_FORCE_REFLEX:b.reflex(!0),d.consume();break;case DockTabBinding.ACTION_FORCE_CLEAN:case EditorPageBinding.ACTION_CLEAN:a.isDirty&&a.setDirty(!1);break;case WindowBinding.ACTION_ONLOAD:alert("HWEJ")}}};new List([DockTabBinding.ACTION_UPDATE_VISUAL,DockTabBinding.ACTION_UPDATE_TOKEN,PageBinding.ACTION_ATTACHED,PageBinding.ACTION_INITIALIZED,PageBinding.ACTION_UPDATED,EditorPageBinding.ACTION_DIRTY,EditorPageBinding.ACTION_CLEAN,EditorPageBinding.ACTION_SAVE,EditorPageBinding.ACTION_SAVE_AND_PUBLISH,ViewBinding.ACTION_ONCLOSE,ViewBinding.ACTION_ONCLOSE_FORCE,DockPanelBinding.ACTION_FORCE_SELECT,Binding.ACTION_FORCE_REFLEX,DockTabBinding.ACTION_FORCE_CLEAN,WindowBinding.ACTION_ONLOAD]).each(function(a){b.addActionListener(a,d)})},DockBinding.prototype.summonTabPanelBinding=function(){return DockPanelBinding.newInstance(this.bindingDocument)},DockBinding.prototype.handleAction=function(a){DockBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case Binding.ACTION_ACTIVATED:this.isActive||this.activate(),a.consume();break;case TabBoxBinding.ACTION_UPDATED:b instanceof DockBinding&&b.updateType==TabBoxBinding.UPDATE_DETACH&&(this.getTabElements().hasEntries()||(this.isEmpty=!0,this.isActivatable=!1,1==this.isActive&&this.deActivate(),this.dispatchAction(DockBinding.ACTION_EMPTIED)));break;case ViewBinding.ACTION_LOADED:this._viewBindingList.add(b),this.isActive&&b.onActivate();break;case ViewBinding.ACTION_CLOSED:this._viewBindingList.del(b)}},DockBinding.prototype.handleBroadcast=function(a,b){switch(DockBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEMTREENODEBINDING_FOCUS:var c=b;b==this.perspectiveNode?this._highlightTabByEntityToken():c.perspectiveNode&&c.perspectiveNode==this.perspectiveNode&&this._highlightTabByEntityToken(c.node.getEntityToken())}},DockBinding.prototype._highlightTabByEntityToken=function(a){for(var b=this.getTabBindings();b.hasNext();){var c=b.getNext(),d=c.getEntityToken();a&&null!=d&&d==a?c.highlight(!0):c.highlight(!1)}},DockBinding.prototype._selectTabByView=function(a){for(var b=this.getTabBindings(),c=!1;b.hasNext()&&!c;){var d=b.getNext(),e=d.getAssociatedView();null!=e&&e==a&&(d.isSelected||this.select(d,!0),c=!0)}},DockBinding.prototype.collapse=function(a){this._handleCollapse(!0,a)},DockBinding.prototype.unCollapse=function(a){this._handleCollapse(!1,a)},DockBinding.prototype._handleCollapse=function(a,b){var c=this.getChildBindingByLocalName("dockpanels"),d=this.getAncestorBindingByLocalName("splitbox");a?(c.hide(),this.bindingElement.style.height="auto",this.isFlexible=!1,this.isActivatable=!1,this.setProperty("collapsed",!0),b&&d.hasBothPanelsVisible()&&this.setWidth(200)):(c.show(),this.isFlexible=!0,this.isActivatable=!0,this.deleteProperty("collapsed"),b&&this.setWidth(!1)),this.interceptDisplayChange(!a),this.isCollapsed=a},DockBinding.prototype.activate=function(){this.isActive||(this.isActive=!0,this.attachClassName(DockBinding.CLASSNAME_ACTIVE),this.setProperty("active",!0),this._containingSplitPanelBinding&&(this._containingSplitPanelBinding.isActive=!0),this.getTabBindings().each(function(a){a.onActivate()}),this._viewBindingList.each(function(a){a.onActivate()}),Application.activate(this))},DockBinding.prototype.deActivate=function(){1==this.isActive&&(this.isActive=!1,this.detachClassName(DockBinding.CLASSNAME_ACTIVE),this.deleteProperty("active"),this._containingSplitPanelBinding&&(this._containingSplitPanelBinding.isActive=!1),this.getTabBindings().each(function(a){a.onDeactivate()}),this._viewBindingList.each(function(a){a.onDeactivate()}),Application.deActivate(this))},DockBinding.prototype.closeTab=function(a,b){if(!a.isPinned)if(a.isDirty&&!b){var c=Resolver.resolve(a.getLabel()),d=this;Dialog.question(StringBundle.getString("ui","WebSite.Application.DialogSaveResource.Title"),StringBundle.getString("ui","WebSite.Application.DialogSaveResource.Text").replace("${resourcename}",c),Dialog.BUTTONS_YES_NO_CANCEL,{handleDialogResponse:function(b){switch(b){case Dialog.RESPONSE_YES:setTimeout(function(){d.saveContainedEditor(a)},0);break;case Dialog.RESPONSE_NO:d.removeTab(a)}}})}else this.removeTab(a)},DockBinding.prototype.closeTabsExcept=function(a){for(var b=this.getTabBindings();b.hasNext();){var c=b.getNext();c!=a&&this.closeTab(c)}},DockBinding.prototype.saveContainedEditor=function(a){var b=a.getAssociatedView();b.saveContainedEditor();var c=this,d={handleBroadcast:function(e,f){switch(e){case BroadcastMessages.CURRENT_SAVED:f.handle==b.getHandle()&&(EventBroadcaster.unsubscribe(BroadcastMessages.CURRENT_SAVED,d),f.isSuccess&&c.removeTab(a))}}};EventBroadcaster.subscribe(BroadcastMessages.CURRENT_SAVED,d)},DockBinding.prototype.appendTabByBindings=function(a,b){this.isEmpty&&(this.isEmpty=!1,this.isActivatable=!0,this.setWidth(!1),this.dispatchAction(DockBinding.ACTION_OPENED)),DockBinding.superclass.appendTabByBindings.call(this,a,b)},DockBinding.prototype.getHeight=function(){return this.bindingElement.offsetHeight},DockBinding.prototype.getWidth=function(){return this.bindingElement.offsetWidth},DockBinding.prototype.setWidth=function(a){a=a?a+"px":"100%",this.bindingElement.style.width=a},DockBinding.prototype.show=function(){this.isVisible&&(DockBinding.superclass.show.call(this),this.isFlexible=!0)},DockBinding.prototype.hide=function(){this.isVisible||(DockBinding.superclass.hide.call(this),this.isFlexible=!1,this.isActive&&this.deActivate())},DockBinding.prototype.getBestTab=function(){var a=null,b=this.getTabBindings(),c=b.getLength();return a=1==c?null:b.get(0)},DockTabsBinding.prototype=new TabsBinding,DockTabsBinding.prototype.constructor=DockTabsBinding,DockTabsBinding.superclass=TabsBinding.prototype,DockTabsBinding.NODENAME_TABBOX="dock",DockTabsBinding.TABBUTTON_IMPLEMENTATION=DockTabsButtonBinding,DockTabsBinding.prototype.toString=function(){return"[DockTabsBinding]"},DockTabsBinding.prototype.flex=function(){function a(){var a=b.containingTabBoxBinding.getWidth();isNaN(a)||(a=a>0?a-1:0,b.bindingElement.style.width=new String(a)+"px")}if(Client.isExplorer&&null!=this.containingTabBoxBinding){var b=this;setTimeout(a,250),a()}DockTabsBinding.superclass.flex.call(this)},DockTabsBinding.prototype.handleCrawler=function(a){switch(DockTabsBinding.superclass.handleCrawler.call(this,a),a.id){case FlexBoxCrawler.ID:this._explorerFlexHack()}},DockTabsBinding.prototype._explorerFlexHack=function(){function a(){var a=b.containingTabBoxBinding.getWidth();isNaN(a)||(a=a>0?a-1:0,b.bindingElement.style.width=new String(a)+"px")}if(Client.isExplorer&&null!=this.containingTabBoxBinding){var b=this;setTimeout(a,250),a()}},DockTabsBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:docktabs",a);return UserInterface.registerBinding(b,DockTabsBinding)},DockTabBinding.prototype=new TabBinding,DockTabBinding.prototype.constructor=DockTabBinding,DockTabBinding.superclass=TabBinding.prototype,DockTabBinding.ACTION_FORCE_CLEAN="docktab force clean",DockTabBinding.ACTION_UPDATE_VISUAL="docktab update visual",DockTabBinding.ACTION_UPDATE_TOKEN="docktab update token",DockTabBinding.NODENAME_TABBOX="dock",DockTabBinding.LABEL_TABLOADING="${string:Website.App.LabelLoading}",DockTabBinding.LABEL_TABDEFAULT="${string:Website.App.LabelLoaded}",DockTabBinding.LABEL_TABSAVED="${string:Website.App.LabelSaved}",DockTabBinding.LABEL_OVERFLOWED_CLASSNAME="overflowed",DockTabBinding.IMG_TABLOADING="${icon:loading}",DockTabBinding.IMG_TABDEFAULT="${icon:default}",DockTabBinding.prototype.toString=function(){return"[DockTabBinding]"},DockTabBinding.prototype.onBindingAttach=function(){DockTabBinding.superclass.onBindingAttach.call(this),this.subscribe(BroadcastMessages.BIND_TOKEN_TO_VIEW),this.perspectiveNode=this.containingTabBoxBinding.perspectiveNode,this.addActionListener(ControlBinding.ACTION_COMMAND,this),this.containingTabBoxBinding.type!=DockBinding.EXPLORER&&this.setContextMenu(top.app.bindingMap.docktabpopup)},DockTabBinding.prototype.setAssociatedView=function(a){this._viewBinding=a},DockTabBinding.prototype.getAssociatedView=function(){return this._viewBinding},DockTabBinding.prototype.serialize=function(){var a=DockTabBinding.superclass.serialize.call(this);return a&&(a.label=null,a.image=null,a.handle=this.getHandle()),a},DockTabBinding.prototype.setHandle=function(a){this.setProperty("handle",a)},DockTabBinding.prototype.getHandle=function(){return this.getProperty("handle")},DockTabBinding.prototype.setEntityToken=function(a){null==this._entityToken&&this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_LOCKTOEDITOR),this._entityToken=a,this.isAttached&&this.isSelected&&this._updateTree(!0)},DockTabBinding.prototype.getEntityToken=function(){return this._entityToken},DockTabBinding.prototype.buildDOMContent=function(){if(DockTabBinding.superclass.buildDOMContent.call(this),1!=this.getProperty("pinned")){this._controlGroupBinding=this.labelBinding.add(ControlGroupBinding.newInstance(this.bindingDocument));var a=DialogControlBinding.newInstance(this.bindingDocument);a.setControlType(ControlBinding.TYPE_CLOSE),a.attachClassName("closecontrol"),this._controlGroupBinding.add(a),this._controlGroupBinding.attachRecursive()}else this.isPinned=!0},DockTabBinding.prototype.setDirty=function(a){if(this.containingTabBoxBinding.type==DockBinding.TYPE_EDITORS){if(this.isDirty!=a&&(this.isDirty=a,Binding.exists(this.labelBinding))){var b=this.labelBinding.getLabel();null!=b?this.labelBinding.setLabel(a?"*"+b:b.slice(1,b.length)):this.labelBinding.setLabel(a?"*":"")}var c=top.app.bindingMap.broadcasterCurrentTabDirty;1==this.isDirty?(this.subscribe(BroadcastMessages.SAVE_CURRENT),EventBroadcaster.broadcast(BroadcastMessages.DOCKTAB_DIRTY,this),c.enable()):(this.unsubscribe(BroadcastMessages.SAVE_CURRENT),EventBroadcaster.broadcast(BroadcastMessages.DOCKTAB_CLEAN,this),c.disable())}else Dialog.warning("Dirty denied","Only editor docks should invoke the dirty state!")},DockTabBinding.prototype.updateDisplay=function(a){this.setLabel(a.getLabel()),this.setImage(a.getImage()),this.setToolTip(a.getToolTip())},DockTabBinding.prototype.updateEntityToken=function(a){this.setEntityToken(a.getEntityToken())},DockTabBinding.prototype.handleAction=function(a){DockTabBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case ControlBinding.ACTION_COMMAND:b.controlType==ControlBinding.TYPE_CLOSE&&this.close();break;case MenuItemBinding.ACTION_COMMAND:a.listener==this.contextMenuBinding&&this._handleContextMenuItemBinding(b)}},DockTabBinding.prototype._handleContextMenuItemBinding=function(a){var b=a.getProperty("cmd");switch(b){case DockTabPopupBinding.CMD_REFRESH:this.containingTabBoxBinding.type!=DockBinding.TYPE_TOOLS&&this.setLabel(DockTabBinding.LABEL_TABLOADING),this.setImage(DockTabBinding.IMG_TABLOADING),this._viewBinding.reload(Application.isDeveloperMode),this.isDirty=!1;break;case DockTabPopupBinding.CMD_MAKEDIRTY:this.setDirty(!0);break;case DockTabPopupBinding.CMD_VIEWSOURCE:case DockTabPopupBinding.CMD_VIEWGENERATED:case DockTabPopupBinding.CMD_VIEWSERIALIZED:this._viewSource(b);break;case DockTabPopupBinding.CMD_CLOSETAB:this.close();break;case DockTabPopupBinding.CMD_CLOSEOTHERS:this.containingTabBoxBinding.closeTabsExcept(this);break;default:alert("TODO!")}},DockTabBinding.prototype.setLabel=function(a){a||(this.getLabel()?this.getLabel()==DockTabBinding.LABEL_TABLOADING&&(a=DockTabBinding.LABEL_TABDEFAULT):a=DockTabBinding.LABEL_TABLOADING),a=this.isDirty?"*"+a:a,DockTabBinding.superclass.setLabel.call(this,a)},DockTabBinding.prototype.setImage=function(a){a||(this.getImage()?this.getImage()==DockTabBinding.IMG_TABLOADING&&(a=DockTabBinding.IMG_TABDEFAULT):a=DockTabBinding.IMG_TABLOADING),DockTabBinding.superclass.setImage.call(this,a)},DockTabBinding.prototype._viewSource=function(a){var b=ViewDefinitions["Composite.Management.SourceCodeViewer"];b.argument={action:a,doc:this._viewBinding.windowBinding.getContentDocument()};var c=Resolver.resolve(this.getLabel());switch(a){case DockTabPopupBinding.CMD_VIEWSOURCE:b.label="Source: "+c;break;case DockTabPopupBinding.CMD_VIEWGENERATED:b.label="Generated: "+c;break;case DockTabPopupBinding.CMD_VIEWSERIALIZED:b.label="Serialized: "+c}StageBinding.presentViewDefinition(b)},DockTabBinding.prototype.onActivate=function(){this._updateBroadcasters(),this.isSelected&&this._updateTree(),this._controlGroupBinding&&this._controlGroupBinding.onActivate(),this.isSelected&&this._updateGlobalEntityToken()},DockTabBinding.prototype.onDeactivate=function(){this._controlGroupBinding&&this._controlGroupBinding.onDeactivate()},DockTabBinding.prototype.onPageInitialize=function(a){this._updateBroadcasters(),this._isEditorDockTab()&&(this.hasSubscription(BroadcastMessages.CLOSE_ALL)||(this.subscribe(BroadcastMessages.CLOSE_CURRENT),this.subscribe(BroadcastMessages.CLOSE_ALL)))},DockTabBinding.prototype.saveContainedEditor=function(){this._isEditorDockTab()&&1==this.isDirty&&this._viewBinding.saveContainedEditor()},DockTabBinding.prototype.show=function(){if(DockTabBinding.superclass.show.call(this),this.isVisible&&this.isInitiallyHidden&&Binding.exists(this)){this.isInitiallyHidden=!1;var a=this.bindingElement;setTimeout(function(){a.style.bottom="auto"},25)}},DockTabBinding.prototype.handleBroadcast=function(a,b){if(DockTabBinding.superclass.handleBroadcast.call(this,a,b),null!=this._viewBinding){var c=this._viewBinding.getContentDocument().body,d=UserInterface.getBinding(c);switch(a){case BroadcastMessages.SAVE_CURRENT:this.isDirty&&this.isSelected&&d.isActivated&&this.saveContainedEditor();break;case BroadcastMessages.CURRENT_SAVED:b.handle==this.getAssociatedView().getHandle()&&(this.unsubscribe(BroadcastMessages.CURRENT_SAVED),b.isSuccess?this._onSaveSuccess():this._onSaveFailure());break;case BroadcastMessages.CLOSE_CURRENT:this._isEditorDockTab()&&this.isSelected&&d.isActivated&&this.close();break;case BroadcastMessages.CLOSE_ALL:this._isEditorDockTab()&&this.close();break;case BroadcastMessages.SYSTEMTREEBINDING_LOCKTOEDITOR:this.isSelected&&UserInterface.isBindingVisible(this)&&this._updateTree();break;case BroadcastMessages.BIND_TOKEN_TO_VIEW:b.handle==this._viewBinding.getDefinition().handle&&(this.setEntityToken(b.entityToken),this.isSelected&&this._updateTree())}}},DockTabBinding.prototype.onSaveStart=function(){this.subscribe(BroadcastMessages.CURRENT_SAVED)},DockTabBinding.prototype._onSaveSuccess=function(){var a=this._viewBinding.getPageBinding();null!=a&&a instanceof EditorPageBinding&&a.onSaveSuccess()},DockTabBinding.prototype._onSaveFailure=function(){},DockTabBinding.prototype.select=function(a){DockTabBinding.superclass.select.call(this,a),this._updateBroadcasters(),this._updateTree(),this._updateGlobalEntityToken()},DockTabBinding.prototype.close=function(){this.isPinned||this.containingTabBoxBinding.closeTab(this)},DockTabBinding.prototype._updateBroadcasters=function(){if(this.isSelected){var a=top.app.bindingMap.broadcasterCurrentTabDirty,b=top.app.bindingMap.broadcasterCurrentIsEditor;this._isEditorDockTab()?(b.enable(),this.isDirty?a.enable():a.disable()):(b.disable(),a.disable())}},DockTabBinding.prototype._updateTree=function(a){(this._canUpdateTree||a)&&EventBroadcaster.broadcast(BroadcastMessages.DOCKTABBINDING_SELECT,this)},DockTabBinding.prototype._isEditorDockTab=function(){var a=!1;if(null!=this._viewBinding){var b=this._viewBinding.getContentWindow();if(null!=b&&null!=b.bindingMap){var c=b.bindingMap.savebutton;null!=c&&(a=!0)}}return a},DockTabBinding.prototype._updateGlobalEntityToken=function(){StageBinding.entityToken=this._entityToken},DockTabBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:docktab",a);return UserInterface.registerBinding(b,DockTabBinding)},DockPanelsBinding.prototype=new TabPanelsBinding,DockPanelsBinding.prototype.constructor=DockPanelsBinding,DockPanelsBinding.superclass=TabPanelsBinding.prototype,DockPanelsBinding.prototype.toString=function(){return"[DockPanelsBinding]"},DockPanelsBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dockpanels",a);return UserInterface.registerBinding(b,DockPanelsBinding)},DockPanelBinding.prototype=new TabPanelBinding,DockPanelBinding.prototype.constructor=DockPanelBinding,DockPanelBinding.superclass=TabPanelBinding.prototype,DockPanelBinding.ACTION_FORCE_SELECT="dockpanel force select",DockPanelBinding.prototype.toString=function(){return"[DockPanelBinding]"},DockPanelBinding.prototype.onBindingDispose=function(){DockPanelBinding.superclass.onBindingDispose.call(this),this.dispatchAction(Binding.ACTION_DISPOSED)},DockPanelBinding.prototype.select=function(a){DockPanelBinding.superclass.select.call(this,a),this.dispatchAction(Binding.ACTION_VISIBILITYCHANGED)},DockPanelBinding.prototype.unselect=function(){DockPanelBinding.superclass.unselect.call(this),this.dispatchAction(Binding.ACTION_VISIBILITYCHANGED)},DockPanelBinding.prototype.flex=function(){this.dispatchAction(Binding.ACTION_DIMENSIONCHANGED)},DockPanelBinding.prototype.handleCrawler=function(a){DockPanelBinding.superclass.handleCrawler.call(this,a),null==a.response&&a.type==NodeCrawler.TYPE_DESCENDING&&null!=this.viewBinding&&a.id==FocusCrawler.ID&&(a.nextNode=this.viewBinding.bindingElement)},DockPanelBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dockpanel",a);return UserInterface.registerBinding(b,DockPanelBinding)},DockTabPopupBinding.prototype=new PopupBinding,DockTabPopupBinding.prototype.constructor=DockTabPopupBinding,DockTabPopupBinding.superclass=PopupBinding.prototype,DockTabPopupBinding.CMD_RESTORE="restore",DockTabPopupBinding.CMD_MINIMIZE="minimize",DockTabPopupBinding.CMD_MAXIMIZE="maximize",DockTabPopupBinding.CMD_REFRESH="refreshview",DockTabPopupBinding.CMD_MAKEDIRTY="makedirty",DockTabPopupBinding.CMD_CLOSETAB="closetab",DockTabPopupBinding.CMD_CLOSEOTHERS="closeothers",DockTabPopupBinding.CMD_CLOSEALL="closeall",DockTabPopupBinding.CMD_VIEWSOURCE="viewsource",DockTabPopupBinding.CMD_VIEWGENERATED="viewgenerated",DockTabPopupBinding.CMD_VIEWSERIALIZED="viewserialized",DockTabPopupBinding.prototype.toString=function(){return"[DockTabPopupBinding]"},DockTabPopupBinding.prototype.onBindingAttach=function(){DockTabPopupBinding.superclass.onBindingAttach.call(this),this._indexMenuContent()},ViewSetBinding.prototype=new Binding,ViewSetBinding.prototype.constructor=ViewSetBinding,ViewSetBinding.superclass=Binding.prototype,ViewSetBinding.prototype.toString=function(){return"[ViewSetBinding]"},ViewBinding.prototype=new FlexBoxBinding,ViewBinding.prototype.constructor=ViewBinding,ViewBinding.superclass=FlexBoxBinding.prototype,ViewBinding.ACTION_LOADED="view loaded",ViewBinding.ACTION_ONCLOSE="view onclose",ViewBinding.ACTION_ONCLOSE_FORCE="view onclose force",ViewBinding.ACTION_CLOSED="view closed",ViewBinding.ACTION_DETACH="view detach",ViewBinding.HORIZONTAL_ADJUST=1,ViewBinding.VERTICAL_ADJUST=1,ViewBinding.TYPE_EXPLORERVIEW="explorerview",ViewBinding.TYPE_DOCKVIEW="dockview",ViewBinding.TYPE_DIALOGVIEW="dialogview",ViewBinding.CLASSNAME_ACTIVE="active",ViewBinding.TIMEOUT=15,ViewBinding._instances=new Map,ViewBinding.hasInstance=function(a){return ViewBinding._instances.has(ViewBinding.normalizeHandle(a))},ViewBinding.getInstance=function(a){var b=ViewBinding._instances.get(ViewBinding.normalizeHandle(a));return b},ViewBinding.normalizeHandle=function(a){return"Composite.Management.Browser"===a&&StageBinding.perspectiveNode?a+"."+StageBinding.perspectiveNode.getHandle():a},ViewBinding.prototype.toString=function(){return"[ViewBinding]"},ViewBinding.prototype.onBindingRegister=function(){ViewBinding.superclass.onBindingRegister.call(this),this.addActionListener(RootBinding.ACTION_PHASE_1),this.addActionListener(RootBinding.ACTION_PHASE_2),this.addActionListener(RootBinding.ACTION_PHASE_3),this.addActionListener(WindowBinding.ACTION_LOADED),this.addActionListener(WindowBinding.ACTION_ONLOAD),this.addActionListener(PageBinding.ACTION_ATTACHED),this.addActionListener(PageBinding.ACTION_INITIALIZED),this.addActionListener(ViewBinding.ACTION_DETACH),this.addActionListener(WizardPageBinding.ACTION_NAVIGATE_NEXT),this.addActionListener(WizardPageBinding.ACTION_NAVIGATE_PREVIOUS),this.addActionListener(WizardPageBinding.ACTION_FINISH),this.subscribe(BroadcastMessages.CLOSE_VIEW),this.subscribe(BroadcastMessages.APPLICATION_SHUTDOWN)},ViewBinding.prototype.onBindingAttach=function(){ViewBinding.superclass.onBindingAttach.call(this),this.attachClassName(this._type),1==Client.isExplorer&&(this._coverBinding=this.add(CoverBinding.newInstance(this.bindingDocument)),this._coverBinding.attach()),this._viewDefinition&&this._viewDefinition.position==DockBinding.START&&this.setProperty("position",DockBinding.START),this.windowBinding.attach()},ViewBinding.prototype.updatePositionDimension=function(){var a=this._snapBinding,b=!System.hasActivePerspectives&&Client.isExplorer;if(1==this.isFreeFloating&&!b&&1==a.isVisible&&1==a.isAttached){var c=a.boxObject.getGlobalPosition(),d=a.boxObject.getDimension();if(Point.isEqual(c,this._lastknownposition)||(this.setPosition(c),this._lastknownposition=c),Dimension.isEqual(d,this._lastknowndimension))throw"Could not snap to unattached binding!";this.setDimension(d),this._lastknowndimension=d;var e=d.h-ViewBinding.VERTICAL_ADJUST;e=e<0?0:e,this.windowBinding.getBindingElement().style.height=new String(e)+"px",this.windowBinding.reflex()}},ViewBinding.prototype.onBindingDispose=function(){if(ViewBinding.superclass.onBindingDispose.call(this),null!=this._viewDefinition){var a=this._viewDefinition.flowHandle;null!=a&&FlowControllerService.CancelFlow(a)}if(null!=this._viewDefinition){var b=this._viewDefinition.handle;EventBroadcaster.broadcast(BroadcastMessages.VIEW_CLOSED,b),this.logger.fine('ViewBinding closed: "'+b+'"')}this.dispatchAction(ViewBinding.ACTION_CLOSED)},ViewBinding.prototype.setType=function(a){this._type=a},ViewBinding.prototype.getType=function(){return this._type},ViewBinding.prototype.getHandle=function(){var a=null;return null!=this._viewDefinition&&(a=this._viewDefinition.handle),a},ViewBinding.prototype.initialize=function(){if(this._isViewBindingInitialized)throw"Somehow ViewBinding got initialized twice: "+this.getHandle();this._isViewBindingInitialized=!0,
this.windowBinding.setURL(this._viewDefinition.url),EventBroadcaster.broadcast(BroadcastMessages.VIEW_OPENING,this.getHandle())},ViewBinding.prototype.setDefinition=function(a){this._viewDefinition=a,a.position==DockBinding.MAIN&&this.subscribe(BroadcastMessages.CLOSE_VIEWS)},ViewBinding.prototype.getDefinition=function(){return this._viewDefinition},ViewBinding.prototype.handleAction=function(a){ViewBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case RootBinding.ACTION_PHASE_1:case RootBinding.ACTION_PHASE_2:case RootBinding.ACTION_PHASE_3:a.type==RootBinding.ACTION_PHASE_1&&this.isActivated&&!b.isActivated&&b.onActivate(),a.consume();break;case Binding.ACTION_DIMENSIONCHANGED:1==this.isFreeFloating&&b==this._snapBinding&&1==this.isVisible&&(this.updatePositionDimension(),a.consume());break;case Binding.ACTION_VISIBILITYCHANGED:1==this.isFreeFloating&&b==this._snapBinding&&(1==b.isVisible?this.show():this.hide());break;case WindowBinding.ACTION_LOADED:case WindowBinding.ACTION_ONLOAD:if(b.getContentWindow().isPostBackDocument){if(a.type==WindowBinding.ACTION_ONLOAD){var c=this._viewDefinition.argument;null!=c&&null!=c.list&&null!=c.url&&(b.post(c.list,c.url),c.list=null,c.url=null)}}else if(1==Client.isExplorer){if(b==this.windowBinding){var d=this;DOMEvents.addEventListener(b.getContentWindow(),DOMEvents.UNLOAD,{handleEvent:function(a){1==Binding.exists(d._coverBinding)&&d._coverBinding.show()}})}a.type==WindowBinding.ACTION_ONLOAD&&this._coverBinding&&this._coverBinding.hide()}if(a.type==WindowBinding.ACTION_ONLOAD){var e=b.getContentWindow();null==e.WindowManager&&(this._isLoaded||this._onLoadingCompleted(b))}a.consume();break;case PageBinding.ACTION_ATTACHED:!b.label&&this._viewDefinition.label&&(b.label=this._viewDefinition.label),!b.image&&this._viewDefinition.image&&(b.image=this._viewDefinition.image),b.bindingWindow==this.getContentWindow()&&(this._pageBinding=b,this._injectPageArgument());case PageBinding.ACTION_INITIALIZED:b.bindingWindow==this.getContentWindow()&&(Client.isExplorer&&this._coverBinding&&this._coverBinding.hide(),this._isLoaded||this._onLoadingCompleted());break;case Binding.ACTION_DISPOSED:this.isFreeFloating&&b==this._snapBinding&&(this.removeActionListener(Binding.ACTION_DISPOSED),this.dispose(),a.consume());break;case WizardPageBinding.ACTION_NAVIGATE_NEXT:case WizardPageBinding.ACTION_NAVIGATE_PREVIOUS:case WizardPageBinding.ACTION_FINISH:EventBroadcaster.broadcast(BroadcastMessages.VIEW_OPENING,this.getHandle()),a.consume();break;case ViewBinding.ACTION_DETACH:this.setDefinition(ViewDefinitions["Composite.Management.Null"]),ViewBinding._instances.set(ViewBinding.normalizeHandle(this._viewDefinition.handle),this)}},ViewBinding.prototype.handleBroadcast=function(a,b){switch(ViewBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.CLOSE_VIEW:b==this._viewDefinition.handle&&this.dispatchAction(ViewBinding.ACTION_ONCLOSE);break;case BroadcastMessages.CLOSE_VIEWS:this._viewDefinition.position==DockBinding.MAIN&&this.dispatchAction(ViewBinding.ACTION_ONCLOSE_FORCE);break;case BroadcastMessages.APPLICATION_SHUTDOWN:this.dispose()}},ViewBinding.prototype._onLoadingCompleted=function(){this._isLoaded||(this._open(),this._isLoaded=!0)},ViewBinding.prototype._open=function(){ViewBinding._instances.set(ViewBinding.normalizeHandle(this._viewDefinition.handle),this),this.dispatchAction(ViewBinding.ACTION_LOADED),EventBroadcaster.broadcast(BroadcastMessages.VIEW_OPENED,this._viewDefinition.handle),this.show(),this.logger.fine('ViewBinding opened: "'+this._viewDefinition.handle+'"')},ViewBinding.prototype.update=function(){this.dispatchAction(Binding.ACTION_ACTIVATED),this._injectPageArgument()},ViewBinding.prototype._injectPageArgument=function(){var a=this._pageBinding,b=this._viewDefinition;if(null!=a){var c=b.argument;null!=c&&a.setPageArgument(c);var d=b.width;null!=d&&(a.width=d);var e=b.height;null!=e&&(a.height=e)}},ViewBinding.prototype.handleCrawler=function(a){switch(ViewBinding.superclass.handleCrawler.call(this,a),a.type){case NodeCrawler.TYPE_DESCENDING:1==this.isFreeFloating&&a.id==FocusCrawler.ID&&a.previousNode!=this._snapBinding.bindingElement&&(a.response=NodeCrawler.SKIP_NODE);break;case NodeCrawler.TYPE_ASCENDING:1==this.isFreeFloating&&(a.nextNode=this._snapBinding.bindingElement)}},ViewBinding.prototype.show=function(){if(!this.isVisible)if(1==this.isFreeFloating){Client.isWebKit&&(this.bindingElement.style.display=""),this._type==ViewBinding.TYPE_DOCKVIEW&&null!=this.windowBinding&&(this.windowBinding.getBindingElement().style.position="static");var a=this;setTimeout(function(){a.updatePositionDimension(),a.isVisible=!0},0)}else ViewBinding.superclass.show.call(this)},ViewBinding.prototype.hide=function(){1==this.isVisible&&(1==this.isFreeFloating?(this.windowBinding&&(this.windowBinding.getBindingElement().style.position="absolute"),this.bindingElement.style.top="-10000px",Client.isWebKit&&(this.bindingElement.style.display="none"),this.isVisible=!1):ViewBinding.superclass.hide.call(this))},ViewBinding.prototype.setPosition=function(a){a.x+=ViewBinding.HORIZONTAL_ADJUST,this.bindingElement.style.left=a.x+"px",this.bindingElement.style.top=a.y+"px"},ViewBinding.prototype.setDimension=function(a){a.h-=ViewBinding.VERTICAL_ADJUST,a.w-=ViewBinding.HORIZONTAL_ADJUST,a.w-=1,a.h<0&&(a.h=0),a.w<0&&(a.w=0),this.bindingElement.style.width=String(a.w)+"px",this.bindingElement.style.height=String(a.h)+"px"},ViewBinding.prototype.snapToBinding=function(a,b){this.isFlexBoxBehavior=!1,a.addActionListener(Binding.ACTION_DIMENSIONCHANGED,this),a.addActionListener(Binding.ACTION_VISIBILITYCHANGED,this),a.addActionListener(Binding.ACTION_DISPOSED,this),this._snapBinding&&(this._snapBinding.removeActionListener(Binding.ACTION_DIMENSIONCHANGED,this),this._snapBinding.removeActionListener(Binding.ACTION_VISIBILITYCHANGED,this),this._snapBinding.removeActionListener(Binding.ACTION_DISPOSED,this),this._snapBinding.viewBinding=null),this._snapBinding=a,this._snapBinding.viewBinding=this,this.isFreeFloating=b!==!1,this._isViewBindingInitialized||this.initialize()},ViewBinding.prototype.getMigrationParent=function(){var a=null;return a=1==this.isFreeFloating?this._snapBinding.getBindingElement():ViewBinding.superclass.getMigrationParent.call(this)},ViewBinding.prototype.getContentWindow=function(){return this.windowBinding.getContentWindow()},ViewBinding.prototype.getContentDocument=function(){return this.windowBinding.getContentDocument()},ViewBinding.prototype.getRootBinding=function(){return this.windowBinding.getRootBinding()},ViewBinding.prototype.getPageBinding=function(){return this._pageBinding},ViewBinding.prototype.reload=function(a){this._isLoaded=!1,this.windowBinding.reload(a),EventBroadcaster.broadcast(BroadcastMessages.VIEW_OPENING,this.getHandle())},ViewBinding.prototype.saveContainedEditor=function(){var a=!1,b=this._pageBinding;null!=b&&b instanceof EditorPageBinding&&b.canSave()&&(b.doSave(),a=!0),a||this.logger.error("saveContainedEditor failed")},ViewBinding.prototype.onActivate=function(){if(!this.isActivated){this.isActivated=!0;var a=this.getRootBinding();null!=a&&a.onActivate()}},ViewBinding.prototype.onDeactivate=function(){if(1==this.isActivated){this.isActivated=!1;var a=this.getRootBinding();null!=a&&this.getRootBinding().onDeactivate()}},ViewBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:view",a),c=UserInterface.registerBinding(b,ViewBinding);return c.windowBinding=c.add(WindowBinding.newInstance(a)),c},PageBinding.prototype=new FocusBinding,PageBinding.prototype.constructor=Binding,PageBinding.superclass=FocusBinding.prototype,PageBinding.ACTION_ATTACHED="page attached",PageBinding.ACTION_DETACHED="page detached",PageBinding.ACTION_INITIALIZED="page initialized",PageBinding.ACTION_DOPOSTBACK="page do postback",PageBinding.ACTION_VALIDATE="page validate",PageBinding.ACTION_DOVALIDATEDPOSTBACK="page do validated postback",PageBinding.ACTION_BLOCK_INIT="page block init",PageBinding.ACTION_UNBLOCK_INIT="page unblock init",PageBinding.ACTION_UPDATING="page updating",PageBinding.ACTION_UPDATED="page updated",PageBinding.ACTION_GETMESSAGES="page poll messagequeue",PageBinding.ACTION_RESPONSE="page response";PageBinding.CLASSNAME_SUBPAGE="dialogsubpage";PageBinding.TIMEOUT=250,PageBinding.prototype.toString=function(){return"[PageBinding]"},PageBinding.prototype.onBindingRegister=function(){PageBinding.superclass.onBindingRegister.call(this);var a=UserInterface.getBinding(this.bindingDocument.body);a.addActionListener(RootBinding.ACTION_PHASE_3,this),this.addActionListener(PageBinding.ACTION_DOPOSTBACK),this.addActionListener(PageBinding.ACTION_DOVALIDATEDPOSTBACK),this.addActionListener(BalloonBinding.ACTION_INITIALIZE),this.addActionListener(PageBinding.ACTION_BLOCK_INIT),this.addActionListener(PageBinding.ACTION_UNBLOCK_INIT),this.addActionListener(PageBinding.ACTION_GETMESSAGES),this.subscribe(BroadcastMessages.MESSAGEQUEUE_REQUESTED)},PageBinding.prototype.onBindingAttach=function(){PageBinding.superclass.onBindingAttach.call(this),Application.lock(this),this.parseDOMProperties(),this.dispatchAction(PageBinding.ACTION_ATTACHED)},PageBinding.prototype.onBindingDispose=function(){var a=UserInterface.getBinding(this.bindingDocument.body);a.removeActionListener(RootBinding.ACTION_PHASE_3,this),this.dispatchAction(PageBinding.ACTION_DETACHED)},PageBinding.prototype.parseDOMProperties=function(){this.getProperty("label")&&(this.label=this.getProperty("label")),this.getProperty("labelfield")&&(this.labelfield=this.getProperty("labelfield")),this.getProperty("image")&&(this.image=this.getProperty("image")),this.toolTip=this.getProperty("tooltip"),0==this.getProperty("fitasdialogsubpage")&&(this.isFitAsDialogSubPage=!1)},PageBinding.prototype.setPageArgument=function(a){Application.isOperational&&this.dispatchAction(DockPanelBinding.ACTION_FORCE_SELECT),this.pageArgument=a},PageBinding.prototype.onBeforePageInitialize=function(){this._isReadyForInitialize=!0,null==this._initBlockers&&this.onPageInitialize()},PageBinding.prototype.onPageInitialize=function(){if(this._isPageBindingInitialized){if(1!=Client.isExplorer)throw"PageBinding: Somehow initialized twice";this.logger.error("PageBinding: Somehow initialized twice"),this.logger.error(arguments.caller.callee.toString())}else{this._isPageBindingInitialized=!0,this._isDotNet()&&this._setupDotNet(),this.pageArgument&&this.pageArgument instanceof DataBindingMap&&this.bindingWindow.DataManager.populateDataBindings(this.pageArgument);var a=this;setTimeout(function(){try{1==Binding.exists(a)?(a.bindingElement.style.visibility="visible",a.dispatchAction(PageBinding.ACTION_INITIALIZED),a.onAfterPageInitialize()):(Application.unlock(Application,!0),SystemLogger.getLogger("PageBinding").warn("Premature PageBinding dispose? Please consult your developer."))}catch(b){throw a.logger.error(b),SystemDebug.stack(arguments),b}},PageBinding.TIMEOUT)}},PageBinding.prototype.onAfterPageInitialize=function(){this.removeActionListener(PageBinding.ACTION_BLOCK_INIT),this.removeActionListener(PageBinding.ACTION_UNBLOCK_INIT),Application.unlock(this),this.isActivationAware=!0;var a=UserInterface.getBinding(this.bindingDocument.body);a.makeActivationAware(this),UserInterface.isBindingVisible(this)&&this.dispatchAction(FocusBinding.ACTION_FOCUS)},PageBinding.prototype.onBeforeUpdates=function(){this._isUpdating=!0,this.dispatchAction(PageBinding.ACTION_UPDATING)},PageBinding.prototype.onAfterUpdates=function(){this.parseDOMProperties(),this._isUpdating=!1,this.dispatchAction(PageBinding.ACTION_UPDATED)},PageBinding.prototype.makeDialogSubPage=function(){this.isFitAsDialogSubPage&&(Client.isExplorer&&this.setFlexibility(!0),this.attachClassName(PageBinding.CLASSNAME_SUBPAGE),this.isDialogSubPage=!0)},PageBinding.prototype._setupDotNet=function(){var a=this,b=this.bindingDocument.forms[0],c=this.bindingWindow.__doPostBack,d=!1;!b.__isSetup&&this.isNonAjaxPage&&DOMEvents.addEventListener(this.bindingWindow,DOMEvents.UNLOAD,{handleEvent:function(){d&&Application.unlock(a)}}),this.bindingWindow.__doPostBack=function(e,f){!b.__isSetup&&a.isNonAjaxPage&&(Application.lock(a),d=!0),a.manifestAllDataBindings(),c(e,f),Application.isDeveloperMode&&a._debugDotNetPostback()}},PageBinding.prototype.postMessage=function(a,b){var c=this.bindingWindow.bindingMap.__REQUEST;if(null!=c&&this._isDotNet())switch(a){case EditorPageBinding.MESSAGE_SAVE:case EditorPageBinding.MESSAGE_PERSIST:this.bindingWindow.DataManager.isDirty&&this.validateAllDataBindings()&&(null!=b&&b.add(this),c.postback(a));break;default:c.postback(a)}null!=b&&this._postMessageToDescendants(a,b)},PageBinding.prototype._postMessageToDescendants=function(a,b){var c=this.getDescendantBindingsByType(WindowBinding);c.each(function(c){var d=c.getPageBinding();null!=d&&d.postMessage(a,b)})},PageBinding.prototype._debugDotNetPostback=function(){var a=new List;new List(this.bindingDocument.forms[0].elements).each(function(b){null!=b.name&&""!=b.name&&a.add({name:b.name,value:b.value})});var b="";a.each(function(a){b+=a.name+": "+a.value+"\n"}),this.logger.debug(b)},PageBinding.prototype.handleAction=function(a){PageBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case RootBinding.ACTION_PHASE_3:if(b==UserInterface.getBinding(this.bindingDocument.body)&&(b.removeActionListener(RootBinding.ACTION_PHASE_3,this),!this._isPageBindingInitialized))try{this.onBeforePageInitialize()}catch(a){throw alert(a),SystemDebug.stack(arguments),a}break;case PageBinding.ACTION_DOPOSTBACK:this._isDotNet()&&this.doPostBack(b),a.consume();break;case PageBinding.ACTION_DOVALIDATEDPOSTBACK:if(this._isDotNet()){var c=this.validateAllDataBindings();c&&this.doPostBack(b)}a.consume();break;case BalloonBinding.ACTION_INITIALIZE:a.consume();break;case PageBinding.ACTION_BLOCK_INIT:null==this._initBlockers&&(this._initBlockers=new Map),this._initBlockers.set(b.key,!0);break;case PageBinding.ACTION_UNBLOCK_INIT:if(null!=this._initBlockers&&this._initBlockers.has(b.key)&&(this._initBlockers.del(b.key),!this._initBlockers.hasEntries()&&(this._initBlockers=null,1==this._isReadyForInitialize))){var d=this;setTimeout(function(){d.onBeforePageInitialize()},0)}break;case PageBinding.ACTION_GETMESSAGES:if(UpdateMananger.isUpdating){var d=this,e={handleAction:function(a){a.target==d&&(d.removeActionListener(PageBinding.ACTION_UPDATED,e),MessageQueue.udpdate())}};this.addActionListener(PageBinding.ACTION_UPDATED,e)}else MessageQueue.udpdate();a.consume()}},PageBinding.prototype.handleBroadcast=function(a,b){switch(PageBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.MESSAGEQUEUE_REQUESTED:var c=b;this._canPostBack||c||(this._canPostBack=!0,Application.unlock(this))}},PageBinding.prototype._isDotNet=function(){var a=this.bindingDocument.forms[0];return null!=a&&"undefined"!=typeof this.bindingWindow.__doPostBack},PageBinding.prototype.doPostBack=function(a){if(this._canPostBack&&null!=a&&this._isDotNet()){var b=a.getCallBackID(),c=a.getCallBackArg();b=null!=b?b.replace(/_/g,"$"):"",null==c&&(c=""),this.bindingWindow.__doPostBack(b,c)}},PageBinding.prototype.validateAllDataBindings=function(a){for(var b=!0,c=this.bindingWindow.DataManager.getAllDataBindings();c.hasNext()&&b;){var d=c.getNext();if(d.isAttached){var e=d.validate();if(b&&!e){if(b=!1,this.logger.debug("Invalid DataBinding: "+d.toString()+" ("+d.getName()+")"),a){var f=d.getAncestorBindingByType(TabPanelBinding);if(null!=f&&!f.isVisible){var g=f.getAncestorBindingByType(TabBoxBinding),h=g.getTabBinding(f);g.select(h)}}break}}}return b},PageBinding.prototype.manifestAllDataBindings=function(){for(var a=new List,b=this.bindingWindow.DataManager.getAllDataBindings();b.hasNext();){var c=b.getNext();if(c.isAttached){var d=c.manifest();null!=d&&a.add(d)}}return a},PageBinding.prototype.cleanAllDataBindings=function(){for(var a=this.bindingWindow.DataManager.getAllDataBindings();a.hasNext();){var b=a.getNext();b.isAttached&&b.clean()}},PageBinding.prototype.getLabel=function(){var a="";if(!a&&this.labelfield){var b=this.bindingWindow.DataManager.getDataBinding(this.labelfield);null!=b&&b.getLabel?a=b.getLabel():null!=b&&b.getValue&&(a=b.getValue())}return!a&&this.label&&(a=this.label),a},PageBinding.prototype.getImage=function(){return this.image},PageBinding.prototype.getToolTip=function(){return this.toolTip},PageBinding.prototype.getHeight=function(){return this.bindingElement.offsetHeight},PageBinding.prototype.onActivate=function(){if(Binding.exists(this)&&!this.isActivated&&(this.isActivated=!0,this._isFocusManager&&UserInterface.isBindingVisible(this))){try{var a=this.bindingWindow;a.focus()}catch(a){}if(null!=this._cachedFocus){var b=this;setTimeout(function(){null==FocusBinding.focusedBinding&&b._focusPreviouslyFocused()},0)}else this._focusFirstFocusable()}},PageBinding.prototype.onDeactivate=function(){if(1==this.isActivated){if(this.isActivated=!1,null!=this._cachedFocus){var a=this._cachedFocus.getBinding();a&&a.blur()}FocusBinding.activeInstance==this&&(FocusBinding.activeInstance=null)}},DialogPageBinding.prototype=new PageBinding,DialogPageBinding.prototype.constructor=DialogPageBinding,DialogPageBinding.superclass=PageBinding.prototype,DialogPageBinding.DEFAULT_WIDTH=531,DialogPageBinding.DEFAULT_TABBOXED_WIDTH=476,DialogPageBinding.DEFAULT_HEIGHT="auto",DialogPageBinding.DEFAULT_CONTROLS="close",DialogPageBinding.DEFAULT_RESIZABLE=!1,DialogPageBinding.ACTION_RESPONSE="dialogpageresponse",DialogPageBinding.ACTION_LAYOUT_D="dialoglayoutd",DialogPageBinding.CLASSNAME_TABBOXED="tabboxed",DialogPageBinding.prototype.toString=function(){return"[DialogPageBinding]"},DialogPageBinding.prototype.onBindingRegister=function(){DialogPageBinding.superclass.onBindingRegister.call(this),this.addActionListener(PageBinding.ACTION_ATTACHED),this.addActionListener(Binding.ACTION_DIRTY),this.addActionListener(Binding.ACTION_VALID),this.addActionListener(Binding.ACTION_INVALID),this.addActionListener(ButtonBinding.ACTION_COMMAND)},DialogPageBinding.prototype.parseDOMProperties=function(){DialogPageBinding.superclass.parseDOMProperties.call(this);var a=this.getProperty("branded"),b=this.getAncestorBindingByType(DialogBinding,!0);if(b&&(a?b.attachClassName("branded"):b.detachClassName("branded")),null==this.width){var c=this.getProperty("width");c||(c=this.hasClassName(DialogPageBinding.CLASSNAME_TABBOXED)?DialogPageBinding.DEFAULT_TABBOXED_WIDTH:DialogPageBinding.DEFAULT_WIDTH),this.width=c}if(null==this.height){var d=this.getProperty("height");this.height=d?d:DialogPageBinding.DEFAULT_HEIGHT}if(null==this.minheight){var e=this.getProperty("minheight");null!=e&&(this.minheight=e)}if(null==this.controls){var f=this.getProperty("controls");this.controls=f?f:DialogPageBinding.DEFAULT_CONTROLS}if(!this.isResizable){var g=this.getProperty("resizable");this.isResizable=g?g:DialogPageBinding.DEFAULT_RESIZABLE}"auto"==this.height&&this.enableAutoHeightLayoutMode(!0)},DialogPageBinding.prototype.onBindingAttach=function(){DialogPageBinding.superclass.onBindingAttach.call(this);var a=this.getProperty("image"),b=this.getDescendantElementsByLocalName("dialogvignette").getFirst();a&&b&&(this.labelBinding=LabelBinding.newInstance(this.bindingDocument),this.labelBinding.setImage(a),b.appendChild(this.labelBinding.bindingElement),this.labelBinding.attach())},DialogPageBinding.prototype.setPageArgument=function(a){DialogPageBinding.superclass.setPageArgument.call(this,a),a&&a.image&&this.setProperty("image",a.image)},DialogPageBinding.prototype.enableAutoHeightLayoutMode=function(a){a!=this.isAutoHeightLayoutMode&&(a?this.attachClassName("auto"):this.detachClassName("auto"),this.isAutoHeightLayoutMode=a)},DialogPageBinding.prototype.handleAction=function(a){DialogPageBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case PageBinding.ACTION_ATTACHED:b!=this&&b.isFitAsDialogSubPage&&b.makeDialogSubPage();break;case ButtonBinding.ACTION_COMMAND:if(a.consume(),null!=b.response)switch(this.response=b.response,b.response){case Dialog.RESPONSE_ACCEPT:1==this.validateAllDataBindings()?this.onDialogAccept():this.onDialogInvalid();break;case Dialog.RESPONSE_CANCEL:this.onDialogCancel();break;default:this.onDialogResponse()}break;case Binding.ACTION_INVALID:this._disableAcceptButton(!0);break;case Binding.ACTION_VALID:this._disableAcceptButton(!1)}},DialogPageBinding.prototype._disableAcceptButton=function(a){var b=this.bindingWindow.bindingMap.buttonAccept;null!=b&&b.setDisabled(a)},DialogPageBinding.prototype.onDialogAccept=function(){if(null===this.result)try{this.result=this.bindingWindow.DataManager.getDataBindingResultMap()}catch(a){throw alert(a),a}this.onDialogResponse()},DialogPageBinding.prototype.onDialogInvalid=function(){},DialogPageBinding.prototype.onDialogCancel=function(){this.onDialogResponse()},DialogPageBinding.prototype.onDialogResponse=function(){this.dispatchAction(DialogPageBinding.ACTION_RESPONSE)},DialogPageBodyBinding.prototype=new FlexBoxBinding,DialogPageBodyBinding.prototype.constructor=DialogPageBodyBinding,DialogPageBodyBinding.superclass=FlexBoxBinding.prototype,DialogPageBodyBinding.FILLED_CLASSNAME="filled",DialogPageBodyBinding.prototype.toString=function(){return"[DialogPageBodyBinding]"},DialogPageBodyBinding.prototype._setFitnessHeight=function(a){var b=CSSComputer.getPadding(this.bindingElement),c=CSSComputer.getBorder(this.bindingElement);a+=b.top+b.bottom,a+=c.top+c.bottom,a>this.bindingElement.offsetHeight&&(this.bindingElement.style.height=a+"px")},EditorPageBinding.prototype=new PageBinding,EditorPageBinding.prototype.constructor=EditorPageBinding,EditorPageBinding.superclass=PageBinding.prototype,EditorPageBinding.ACTION_ATTACHED="editorpage attached",EditorPageBinding.ACTION_DIRTY="editorpage dirty",EditorPageBinding.ACTION_CLEAN="editorpage clean",EditorPageBinding.ACTION_SAVE="editorpage save",EditorPageBinding.ACTION_SAVE_AND_PUBLISH="editorpage save and publish",EditorPageBinding.ID_SAVEASBUTTON="saveasbutton",EditorPageBinding.ID_PREVIEWTAB="previewtab",EditorPageBinding.ID_MAINTABBOX="maintabbox",EditorPageBinding.ID_PREVIEWWINDOW="previewwindow",EditorPageBinding.MESSAGE_SAVE="save",EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH="saveandpublish",EditorPageBinding.MESSAGE_PERSIST="persist",EditorPageBinding.MESSAGE_REFRESH="refresh",EditorPageBinding.message=null,EditorPageBinding.isTabbing=!1,EditorPageBinding._registry=new Map,EditorPageBinding.register=function(a){var b=EditorPageBinding._registry;b.hasEntries()||top.app.bindingMap.broadcasterHasOpenEditors.enable(),b.set(a.key,a)},EditorPageBinding.unregister=function(a){var b=EditorPageBinding._registry;b.del(a.key),b.hasEntries()||top.app.bindingMap.broadcasterHasOpenEditors.disable()},EditorPageBinding.prototype.toString=function(){return"[EditorPageBinding]"},EditorPageBinding.prototype.onBindingRegister=function(){EditorPageBinding.superclass.onBindingRegister.call(this),this.addActionListener(Binding.ACTION_DIRTY),this.addActionListener(Binding.ACTION_VALID),this.addActionListener(Binding.ACTION_INVALID),this.addActionListener(EditorPageBinding.ACTION_SAVE),this.addActionListener(EditorPageBinding.ACTION_SAVE_AND_PUBLISH),this.addActionListener(ResponseBinding.ACTION_SUCCESS),this.addActionListener(ResponseBinding.ACTION_FAILURE),this.addActionListener(ResponseBinding.ACTION_OOOOKAY),EditorPageBinding.register(this),this._invalidBindings=new Map,this._messengers=new List,this._messages=new List},EditorPageBinding.prototype.onBindingDispose=function(){this.dispatchAction(EditorPageBinding.ACTION_CLEAN),1==this._isPreviewWindowVisible&&setTimeout(function(){EventBroadcaster.broadcast(BroadcastMessages.XHTML_MARKUP_OFF)},250),EditorPageBinding.unregister(this),EditorPageBinding.superclass.onBindingDispose.call(this)},EditorPageBinding.prototype.onBeforePageInitialize=function(){this._setupPreviewListeners(),EditorPageBinding.superclass.onBeforePageInitialize.call(this)},EditorPageBinding.prototype.onPageInitialize=function(){EditorPageBinding.superclass.onPageInitialize.call(this),this.enableSaveAs()},EditorPageBinding.prototype._setupPreviewListeners=function(){var a=this.bindingDocument.getElementById(EditorPageBinding.ID_MAINTABBOX),b=this.bindingDocument.getElementById(EditorPageBinding.ID_PREVIEWTAB),c=this.bindingDocument.getElementById(EditorPageBinding.ID_PREVIEWWINDOW);null!=a&&(this._tabBoxBinding=UserInterface.getBinding(a),this._tabBoxBinding.addActionListener(TabBoxBinding.ACTION_SELECTED,this),this._tabBoxBinding.addActionListener(TabBoxBinding.ACTION_UNSELECTED,this),null!=b&&null!=c&&(this._tabBinding=UserInterface.getBinding(b),this._windowBinding=UserInterface.getBinding(c),this._windowBinding.addActionListener(WindowBinding.ACTION_LOADED,this),this._windowBinding.addActionListener(WindowBinding.ACTION_ONLOAD,this),this.subscribe(BroadcastMessages.HIGHLIGHT_KEYWORDS),this._tabBinding.isSelected&&this._startPreview()))},EditorPageBinding.prototype.onSaveSuccess=function(){this.enableSave(!1),this.enableSaveAs(),this.cleanAllDataBindings(),this.isDirty=!1,EditorPageBinding.message=null,this.dispatchAction(EditorPageBinding.ACTION_CLEAN)},EditorPageBinding.prototype.handleAction=function(a){EditorPageBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case EditorPageBinding.ACTION_SAVE:this.postMessage(EditorPageBinding.MESSAGE_SAVE);break;case EditorPageBinding.ACTION_SAVE_AND_PUBLISH:this.postMessage(EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH);break;case ResponseBinding.ACTION_OOOOKAY:Application.isDeveloperMode;break;case ResponseBinding.ACTION_SUCCESS:if(Application.isDeveloperMode,this._messengers.hasEntries()){var c=-1;if(this._messengers.each(function(a){var d=a.bindingWindow==b.bindingWindow;return d?(a.bindingWindow.DataManager.isDirty=!1,c==-1&&(c=0)):c++,d}),c>-1&&this._messengers.del(c),!this._messengers.hasEntries())switch(this._message){case EditorPageBinding.MESSAGE_SAVE:this._saveEditorPage();break;case EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH:this._saveAndPublishEditorPage();break;case EditorPageBinding.MESSAGE_PERSIST:this._refresh(),this._message=null,this._isWaitingForPreview&&(this._isWaitingForPreview=!1,this._startPreview())}}else this._refresh(),this._message=null;break;case ResponseBinding.ACTION_FAILURE:Application.isDeveloperMode,this._message=null,this._messengers=new List;break;case Binding.ACTION_DIRTY:this.canSave()&&(this.isDirty||(this.enableSave(!0),this.isDirty=!0,this.dispatchAction(EditorPageBinding.ACTION_DIRTY))),a.consume();break;case Binding.ACTION_INVALID:this.enableSave(!1),this._invalidBindings.set(b.key,b),b instanceof FieldsBinding&&this._updateStatusBar();break;case Binding.ACTION_VALID:this._invalidBindings.del(b.key),b instanceof FieldsBinding&&this._updateStatusBar(),this._invalidBindings.hasEntries()||this.enableSave(!0);break;case TabBoxBinding.ACTION_SELECTED:if(b==this._tabBoxBinding&&null!=this._windowBinding){var d=b.getSelectedTabBinding();d.getID()==EditorPageBinding.ID_PREVIEWTAB?(this._isPreviewing=!0,this._messengers.hasEntries()?this._isWaitingForPreview=!0:this._startPreview()):this._isPreviewing&&(this._isPreviewing=!1,this._stopPreview())}a.consume();break;case TabBoxBinding.ACTION_UNSELECTED:b==this._tabBoxBinding&&this.postMessage(EditorPageBinding.MESSAGE_PERSIST),a.consume();break;case WindowBinding.ACTION_LOADED:b==this._windowBinding&&(1==this._isGeneratingPreview&&(this._generatePreview(),this._isGeneratingPreview=!1),a.consume());break;case WindowBinding.ACTION_ONLOAD:if(b==this._windowBinding&&1!=b.getContentWindow().isPostBackDocument){Client.isPrism&&Prism.enableCache();var e=this;if(setTimeout(function(){Application.unlock(e)},100),EventBroadcaster.hasSubscribers(BroadcastMessages.XHTML_MARKUP_ON)){var f=WindowBinding.getMarkup(this._windowBinding);EventBroadcaster.broadcast(BroadcastMessages.XHTML_MARKUP_ON,f)}}}},EditorPageBinding.prototype.canSave=function(){return null!=this.bindingWindow.bindingMap.savebutton},EditorPageBinding.prototype.doSave=function(){var a=this.bindingWindow.bindingMap.savebutton;null==a||a.isDisabled||a.fireCommand()},EditorPageBinding.prototype._wakeAndValidateAllDataBindings=function(a){function b(){e+=1,e===d&&f()}for(var c=this.bindingWindow.DataManager.getAllDataBindings(),d=c.getLength(),e=0,f=function(){this.validateAllDataBindings(!0)&&a()}.bind(this);c.hasNext();){var g=c.getNext();if(g.isRequired||g.getProperty("required")){for(;g&&!g.isLazy;)g=g.getAncestorBindingByType(Binding);g?g.wakeUp(b):b()}else b()}},EditorPageBinding.prototype._saveEditorPage=function(a){this._wakeAndValidateAllDataBindings(function(){this.bindingWindow.DataManager.isDirty=!1;var b=this.bindingWindow.bindingMap.__REQUEST;if(null!=b){var c=a?EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH:EditorPageBinding.MESSAGE_SAVE;b.postback(c)}else this.logger.error("and publish ")}.bind(this))},EditorPageBinding.prototype._saveAndPublishEditorPage=function(){this._saveEditorPage(!0)},EditorPageBinding.prototype._refresh=function(){Application.isDeveloperMode,this.postMessage(EditorPageBinding.MESSAGE_REFRESH)},EditorPageBinding.prototype.postMessage=function(a){switch(this._message=null,a){case EditorPageBinding.MESSAGE_SAVE:case EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH:this._postMessageToDescendants(a,this._messengers),this._messengers.hasEntries()?this._message=a:a==EditorPageBinding.MESSAGE_SAVE_AND_PUBLISH?this._saveAndPublishEditorPage():this._saveEditorPage();break;case EditorPageBinding.MESSAGE_PERSIST:this._message=a,EditorPageBinding.superclass.postMessage.call(this,a,this._messengers);break;case EditorPageBinding.MESSAGE_REFRESH:EditorPageBinding.superclass.postMessage.call(this,a,this._messengers)}},EditorPageBinding.prototype.handleBroadcast=function(a,b){switch(EditorPageBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.HIGHLIGHT_KEYWORDS:var c=b;UserInterface.isBindingVisible(this._windowBinding)&&WindowBinding.highlightKeywords(this._windowBinding,c)}},EditorPageBinding.prototype.onActivate=function(){EditorPageBinding.superclass.onActivate.call(this),1==this._isPreviewWindowVisible&&EventBroadcaster.broadcast(BroadcastMessages.XHTML_MARKUP_ACTIVATE)},EditorPageBinding.prototype.onDeactivate=function(){EditorPageBinding.superclass.onDeactivate.call(this),1==this._isPreviewWindowVisible&&EventBroadcaster.broadcast(BroadcastMessages.XHTML_MARKUP_DEACTIVATE)},EditorPageBinding.prototype._updateStatusBar=function(){var a=new List;if(this._invalidBindings.each(function(b,c){var d=c.getInvalidLabels();d&&d.each(function(b){a.add(b)})}),a.hasEntries()){for(var b="";a.hasNext();)b+=a.getNext().toLowerCase(),b+=a.hasNext()?", ":".";var c=StringBundle.getString("ui","Website.App.StatusBar.ErrorInField");StatusBar.error(c+" "+b)}else StatusBar.clear()},EditorPageBinding.prototype._startPreview=function(){this._isGeneratingPreview=!0,Client.isPrism&&Prism.disableCache(),this._windowBinding.setURL(WindowBinding.POSTBACK_URL)},EditorPageBinding.prototype._stopPreview=function(){this._windowBinding.reset()},EditorPageBinding.prototype.enableSave=function(a){var b=this.bindingDocument.getElementById("broadcasterCanSave");if(!b)throw new Error("A required BroadcasterBinding could not be located.");var c=UserInterface.getBinding(b);a?c.enable():c.disable()},EditorPageBinding.prototype.enableSaveAs=function(){var a=this.bindingDocument.getElementById(EditorPageBinding.ID_SAVEASBUTTON);null!=a&&UserInterface.getBinding(a).enable()},EditorPageBinding.prototype.handleInvalidData=function(){this.logger.error("INVALID DATA :("),this._isGeneratingPreview&&(this._isGeneratingPreview=!1,this._windowBinding.error(),this._message=null,this._messengers=new List,Application.unlock(this))},EditorPageBinding.prototype._generatePreview=function(){var a=this._windowBinding.getContentDocument().title;if(a==WindowBinding.POSTBACK_TITLE)if(this.validateAllDataBindings()){
this.manifestAllDataBindings();var b=this._tabBinding.getCallBackID(),c=new List;new List(this.bindingDocument.forms[0].elements).each(function(a){"__EVENTTARGET"==a.name&&b&&(a.value=b),c.add({name:a.name,value:a.value})});var d=String(this.bindingDocument.location);this._windowBinding.getContentWindow().submit(c,d),this._latestPostbackList=c.reset()}else this.handleInvalidData()},ResponsePageBinding.prototype=new DialogPageBinding,ResponsePageBinding.prototype.constructor=ResponsePageBinding,ResponsePageBinding.superclass=DialogPageBinding.prototype,ResponsePageBinding.prototype.toString=function(){return"[ResponsePageBinding]"},ResponsePageBinding.prototype.parseDOMProperties=function(){ResponsePageBinding.superclass.parseDOMProperties.call(this);var a=this.getProperty("responseid");this.responseid=a},ResponsePageBinding.prototype.onBindingAttach=function(){ResponsePageBinding.superclass.onBindingAttach.call(this),this.addActionListener(ResponseBinding.ACTION_SUCCESS),this.addActionListener(ResponseBinding.ACTION_FAILURE),this.addActionListener(ResponseBinding.ACTION_OOOOKAY)},ResponsePageBinding.prototype.handleAction=function(a){switch(ResponsePageBinding.superclass.handleAction.call(this,a),a.type){case ResponseBinding.ACTION_SUCCESS:this.onDialogAccept();break;case ResponseBinding.ACTION_FAILURE:}},ResponsePageBinding.prototype.onDialogAccept=function(){this.response=Dialog.RESPONSE_ACCEPT,this.responseid&&this.bindingDocument.getElementById(this.responseid)&&(this.result=this.bindingDocument.getElementById(this.responseid).value),ResponsePageBinding.superclass.onDialogAccept.call(this)},WizardPageBinding.prototype=new DialogPageBinding,WizardPageBinding.prototype.constructor=WizardPageBinding,WizardPageBinding.superclass=DialogPageBinding.prototype,WizardPageBinding.ID_NEXTBUTTON="nextbutton",WizardPageBinding.ID_PREVIOUSBUTTON="previousbutton",WizardPageBinding.ID_FINISHBUTTON="finishbutton",WizardPageBinding.ACTION_NAVIGATE_NEXT="wizardnavigatenext",WizardPageBinding.ACTION_NAVIGATE_PREVIOUS="wizardnavigateprevious",WizardPageBinding.ACTION_FINISH="wizardfinish",WizardPageBinding.prototype.toString=function(){return"[WizardPageBinding]"},WizardPageBinding.prototype.onPageInitialize=function(){WizardPageBinding.superclass.onPageInitialize.call(this),this.addActionListener(WizardPageBinding.ACTION_NAVIGATE_NEXT,this),this.addActionListener(WizardPageBinding.ACTION_NAVIGATE_PREVIOUS,this),this.addActionListener(WizardPageBinding.ACTION_FINISH,this)},WizardPageBinding.prototype.handleAction=function(a){WizardPageBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case WizardPageBinding.ACTION_NAVIGATE_NEXT:case WizardPageBinding.ACTION_FINISH:1==this.validateAllDataBindings()?this.doPostBack(b):a.consume();break;case WizardPageBinding.ACTION_NAVIGATE_PREVIOUS:this.doPostBack(b);break;case Binding.ACTION_INVALID:this._enableNextAndFinish(!1),a.consume();break;case Binding.ACTION_VALID:this._enableNextAndFinish(!0),a.consume()}},WizardPageBinding.prototype._enableNextAndFinish=function(a){var b=this.bindingWindow.bindingMap.nextbutton,c=this.bindingWindow.bindingMap.finishbutton;b&&b.setDisabled(!a),c&&c.setDisabled(!a)},MarkupAwarePageBinding.prototype=new PageBinding,MarkupAwarePageBinding.prototype.constructor=MarkupAwarePageBinding,MarkupAwarePageBinding.superclass=PageBinding.prototype,MarkupAwarePageBinding.prototype.toString=function(){return"[MarkupAwarePageBinding]"},MarkupAwarePageBinding.prototype.onBeforePageInitialize=function(){MarkupAwarePageBinding.superclass.onBeforePageInitialize.call(this),this.subscribe(BroadcastMessages.XHTML_MARKUP_ON),this.subscribe(BroadcastMessages.XHTML_MARKUP_OFF),this.subscribe(BroadcastMessages.XHTML_MARKUP_ACTIVATE),this.subscribe(BroadcastMessages.XHTML_MARKUP_DEACTIVATE)},MarkupAwarePageBinding.prototype.handleBroadcast=function(a,b){MarkupAwarePageBinding.superclass.handleBroadcast.call(this,a,b);var c=this;switch(a){case BroadcastMessages.XHTML_MARKUP_ON:this._activate(!0),this._handleMarkup(b);break;case BroadcastMessages.XHTML_MARKUP_OFF:this._activate(!1);break;case BroadcastMessages.XHTML_MARKUP_ACTIVATE:this._isWaiting=!0,this._activate(!0),setTimeout(function(){c._isWaiting=!1},20);break;case BroadcastMessages.XHTML_MARKUP_DEACTIVATE:setTimeout(function(){c._isActivated||c._activate(!1)},0)}},MarkupAwarePageBinding.prototype.onActivate=function(){MarkupAwarePageBinding.superclass.onActivate.call(this),this._activate(!0),this._isActivated=!0},MarkupAwarePageBinding.prototype.onDeactivate=function(){MarkupAwarePageBinding.superclass.onDeactivate.call(this),this._isActivated=!1;var a=this;setTimeout(function(){a._isWaiting||a._activate(!1)},0)},MarkupAwarePageBinding.prototype._handleMarkup=function(a){},MarkupAwarePageBinding.prototype._activate=function(a){},SystemToolBarBinding.prototype=new ToolBarBinding,SystemToolBarBinding.prototype.constructor=SystemToolBarBinding,SystemToolBarBinding.superclass=ToolBarBinding.prototype,SystemToolBarBinding.prototype.toString=function(){return"[SystemToolBarBinding]"},SystemToolBarBinding.prototype.onBindingAttach=function(){SystemToolBarBinding.superclass.onBindingAttach.call(this),System.hasActivePerspectives?(this.subscribe(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED),this.subscribe(this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST),this.subscribe(BroadcastMessages.INVOKE_DEFAULT_ACTION),this.addActionListener(ButtonBinding.ACTION_COMMAND)):this.hide(),"perspective"===this.getProperty("target")&&(this._syncHandle=StageBinding.perspectiveNode.getHandle())},SystemToolBarBinding.prototype.onBindingInitialize=function(){var a=this.bindingWindow.bindingMap.moreactionstoolbargroup;this._moreActionsWidth=a.boxObject.getDimension().w,a.hide();var b=this.boxObject.getDimension().h;this.bindingElement.style.height=b+"px";var c=this,d=this.bindingWindow.bindingMap.moreactionsbutton;d.addActionListener(ButtonBinding.ACTION_COMMAND,{handleAction:function(a){c._showMoreActions(),a.consume()}});var e=this.bindingWindow.bindingMap.moreactionspopup;e.addActionListener(MenuItemBinding.ACTION_COMMAND,{handleAction:function(a){var b=a.target;c._handleSystemAction(b.associatedSystemAction)}}),SystemToolBarBinding.superclass.onBindingInitialize.call(this)},SystemToolBarBinding.prototype.handleBroadcast=function(a,b){switch(SystemToolBarBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED:var c=this;if(null!=b&&b.syncHandle==this.getSyncHandle())if(null!=b.actionProfile&&b.actionProfile.hasEntries()){this._actionProfile=b.actionProfile,this._node=b.actionProfile.Node;var d=this._getProfileKey();d!=this._currentProfileKey&&setTimeout(function(){c.emptyLeft(),c._actionFolderNames={},c.buildLeft(),c._currentProfileKey=d},0)}else setTimeout(function(){c.emptyLeft(),c._actionFolderNames={},c._currentProfileKey=null,c._node=null;var a=c.bindingWindow.bindingMap.moreactionstoolbargroup;null!=a&&a.hide()},0);break;case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:this.bindingWindow.WindowManager;this._toolBarBodyLeft.refreshToolBarGroups(),this._containAllButtons();break;case BroadcastMessages.INVOKE_DEFAULT_ACTION:null!=b&&b.syncHandle==this.getSyncHandle()&&this._invokeDefaultAction()}},SystemToolBarBinding.prototype._getProfileKey=function(){var a=new String("");return this._actionProfile.each(function(b,c){c.each(function(b){a+=b.getHandle()+";"+b.getKey()+";",b.isDisabled()&&(a+="isDisabled='true';")})}),a},SystemToolBarBinding.prototype.handleAction=function(a){switch(SystemToolBarBinding.superclass.handleAction.call(this,a),a.type){case ButtonBinding.ACTION_COMMAND:var b=a.target;this._handleSystemAction(b.associatedSystemAction)}},SystemToolBarBinding.prototype._handleSystemAction=function(a){null!=a&&SystemAction.invoke(a,this._node)},SystemToolBarBinding.prototype.buildLeft=function(){if(this.isInitialized&&null!=this._actionProfile&&this._actionProfile.hasEntries()){var a=this.bindingDocument,b=this,c=PopupSetBinding.getPopupSet(a,"bundlepopup"),d=new Map;this._actionProfile.each(function(e,f){var g=new List;for(f.reset();f.hasNext();){var h=f.getNext(),i=null;if(h.isInToolBar()){var j=h.getBundleName();if(j){var k;d.has(j)?k=c.getPopupByRel(j):(i=ToolBarComboButtonBinding.newInstance(a),i.setProperty("bundle",j),i.setProperty("keepstate",this._keepBundleState),d.set(j,i),k=c.createNewPopupByRel(j),k.showTextOnly());var l=SystemTreePopupBinding.prototype.getMenuItemBinding.call(this,h);k.add(l),l.attach(),l.menuHandle=h.getHandle()}else i=b.getToolBarButtonBinding(h)}null!=i&&g.add(i)}if(g.hasEntries()){var m=ToolBarGroupBinding.newInstance(a);g.each(function(a){m.add(a)}),b.addLeft(m)}},this),this.attachRecursive(),d.each(function(a,b){b.setPopup(c.getPopupByRel(a))}),this._containAllButtons()}},SystemToolBarBinding.prototype._containAllButtons=function(){var a=this.bindingWindow.bindingMap.moreactionstoolbargroup,b=CSSComputer.getPadding(this.bindingElement),c=this.bindingElement.offsetWidth-b.left-b.right;if(Localization.isUIRtl&&(c=this.bindingElement.offsetWidth-b.left-b.right),!(c<=0)){for(var d,e=0,f=new List,g=this._toolBarBodyLeft.getDescendantBindingsByLocalName("toolbarbutton");null!=(d=g.getNext());){d.isVisible||d.show();var h=CSSComputer.getMargin(d.bindingElement);e+=d.boxObject.getDimension().w+h.left+h.right,(e>=c||e+this._moreActionsWidth>=c&&g.hasNext())&&(f.add(d),d.hide())}if(f.hasEntries()){var i=f.getFirst().bindingElement.parentNode;for(UserInterface.getBinding(i).setLayout(ToolBarGroupBinding.LAYOUT_LAST),this._moreActions=new List;null!=(d=f.getNext());)d instanceof ToolBarComboButtonBinding?d.getAssociatedSystemActions().each(function(a){this._moreActions.add(a)},this):this._moreActions.add(d.associatedSystemAction);a.show()}else this._moreActions=null,a.hide()}},SystemToolBarBinding.prototype._showMoreActions=function(){if(null!=this._moreActions){var a=this.bindingWindow.bindingMap.moreactionspopup;for(a.empty();null!=(action=this._moreActions.getNext());){var b=MenuItemBinding.newInstance(a.bindingDocument);SystemTreePopupBinding.prototype.setSystemAction.call(this,b,action),a.add(b)}a.attachRecursive(),this._moreActions=null}},SystemToolBarBinding.prototype.getToolBarButtonBinding=function(a){var b=ToolBarButtonBinding.newInstance(this.bindingDocument),c=a.getLabel(),d=a.getToolTip(),e=a.getImage();a.isDisabled();return e&&b.setImage(e),c&&b.setLabel(c),d&&b.setToolTip(d),a.isDisabled()&&b.disable(),Application.isTestEnvironment&&b.setProperty("data-qa",a.getKey()),b.associatedSystemAction=a,b},SystemToolBarBinding.prototype._invokeDefaultAction=function(){var a=this.getDescendantBindingByLocalName("toolbarbutton");null!=a&&a.fireCommand()},SystemToolBarBinding.prototype.getActivePosition=function(){return this._activePosition},SystemToolBarBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbar",a);return UserInterface.registerBinding(b,SystemToolBarBinding)},SystemToolBarBinding.prototype.setPosition=function(a){this.bindingElement.style.left=a.x+"px",this.bindingElement.style.top=a.y+"px"},SystemToolBarBinding.prototype.setDimension=function(a){a.h-=ViewBinding.VERTICAL_ADJUST,a.w-=ViewBinding.HORIZONTAL_ADJUST,a.w-=1,a.h<0&&(a.h=0),a.w<0&&(a.w=0),this.bindingElement.style.width=String(a.w)+"px",this.bindingElement.style.height=String(a.h)+"px"},SystemToolBarBinding.prototype.setSyncHandle=function(a){this._syncHandle=a},SystemToolBarBinding.prototype.getSyncHandle=function(){return this._syncHandle},SystemTreeBinding.prototype=new TreeBinding,SystemTreeBinding.prototype.constructor=SystemTreeBinding,SystemTreeBinding.superclass=TreeBinding.prototype,SystemTreeBinding.HAS_NO_MEMORY=!1,SystemTreeBinding.clipboard=null,SystemTreeBinding.clipboardOperation=null,SystemTreeBinding.URL_DIALOG_DETAILEDPASTE="${root}/content/dialogs/systemtrees/detailedpaste.aspx",SystemTreeBinding.prototype.toString=function(){return"[SystemTreeBinding]"},SystemTreeBinding.prototype.onBindingRegister=function(){SystemTreeBinding.superclass.onBindingRegister.call(this),this.perspectiveNode=StageBinding.perspectiveNode,this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESH),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_FOCUS),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_CUT),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_COPY),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_PASTE),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_COLLAPSEALL),this.subscribe(BroadcastMessages.DOCKTABBINDING_SELECT),this.subscribe(BroadcastMessages.STAGEDIALOG_OPENED),this.addActionListener(SystemTreeNodeBinding.ACTION_REFRESHED_YEAH),this.addActionListener(TreeNodeBinding.ACTION_COMMAND),this._entityTokenRegistry=new Map,this._refreshingTreeNodes=new Map,0==this.getProperty("actionaware")?this._isActionProfileAware=!1:this.setContextMenu(top.app.bindingMap.systemtreepopup),1==this.getProperty("treeselector")&&(this._activePosition=SystemAction.activePositions.SelectorTree),null!=this.getProperty("locktoeditor")&&(this.isLockedToEditor=this.getProperty("locktoeditor"))},SystemTreeBinding.prototype.add=function(a){var b=SystemTreeBinding.superclass.add.call(this,a);return null===this._defaultTreeNode&&a instanceof SystemTreeNodeBinding&&(this._defaultTreeNode=a),b},SystemTreeBinding.prototype.handleAction=function(a){SystemTreeBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case TreeNodeBinding.ACTION_ONFOCUS:case TreeNodeBinding.ACTION_ONMULTIFOCUS:this._restorableFocusHandle=null,this._restorableFocusParentHandle=null;break;case SystemTreeNodeBinding.ACTION_REFRESHED_YEAH:this._updateRefreshingTrees(b.key),this._updateFocusedNode(),a.consume();break;case TreeNodeBinding.ACTION_DISPOSE:case TreeNodeBinding.ACTION_BLUR:var c=this;if(setTimeout(function(){c._focusedTreeNodeBindings.hasEntries()||EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{position:c._activePosition})},0),a.type==TreeNodeBinding.ACTION_BLUR){this._restorableFocusHandle=b.getHandle();var d=b.getParent();d&&(this._restorableFocusParentHandle=d.getHandle())}break;case TreeNodeBinding.ACTION_COMMAND:EventBroadcaster.broadcast(BroadcastMessages.INVOKE_DEFAULT_ACTION,{syncHandle:this.getSyncHandle()}),a.consume()}},SystemTreeBinding.prototype._focusDefault=function(){this._attemptRestorableFocus(),this.getFocusedTreeNodeBindings().hasEntries()||SystemTreeBinding.superclass._focusDefault.call(this)},SystemTreeBinding.prototype.getSyncHandle=function(){return 1==this.getProperty("treeselector")?this.getAncestorBindingByType(PageBinding).getID():this.perspectiveNode.getHandle()},SystemTreeBinding.prototype._attemptRestorableFocus=function(){if(this._treeNodeBindings.has(this._restorableFocusHandle)){var a=this._treeNodeBindings.get(this._restorableFocusHandle);this.focusSingleTreeNodeBinding(a)}else if(this._treeNodeBindings.has(this._restorableFocusParentHandle)){var a=this._treeNodeBindings.get(this._restorableFocusParentHandle);this.focusSingleTreeNodeBinding(a)}this._restorableFocusHandle=null,this._restorableFocusParentHandle=null},SystemTreeBinding.prototype._handleSystemTreeFocus=function(){this.getFocusedTreeNodeBindings().hasEntries()&&(this._computeClipboardSetup(),this._computeRefreshSetup(),this._isActionProfileAware&&EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{activePosition:this._activePosition,actionProfile:this.getCompiledActionProfile(),syncHandle:this.getSyncHandle(),source:this}))},SystemTreeBinding.prototype.getTokens=function(a){return a.node.getEntityTokens()},SystemTreeBinding.prototype.registerTreeNodeBinding=function(a){a.getHandles().each(function(b){if(this._treeNodeBindings.has(b))throw"Duplicate treenodehandles registered: "+a.getLabel();this._treeNodeBindings.set(b,a);var c=this._openTreeNodesBackupMap;null!=c&&c.has(b)&&a.open()},this);var b=this._entityTokenRegistry;this.getTokens(a).each(function(c){b.has(c)?b.get(c).add(a):b.set(c,new List([a]))},this);var c=a.node.getEntityToken(),d=null;this.isLockedToEditor?c==StageBinding.entityToken&&a.node.isTreeLockEnabled()&&(d=a):null!=this._backupfocushandle&&this._backupfocushandle==a.node.getHandle()&&(d=a),null!=d&&this.focusSingleTreeNodeBinding(d)},SystemTreeBinding.prototype.unRegisterTreeNodeBinding=function(a){a.getHandles().each(function(a){this._treeNodeBindings.del(a)},this);var b=this._entityTokenRegistry;if(this.getTokens(a).each(function(c){if(b.has(c)){var d=b.get(c);d.del(a),d.hasEntries()||b.del(c)}else this.logger.fatal("SystemTreeBinding out of synch: unRegisterTreeNodeBinding"),Application.isDeveloperMode&&Dialog.error("Attention Developer","Tree is out of synch. Please reproduce this bug and file a report.")},this),!this.isLockedToEditor&&a.isFocused&&null==this._backupfocushandle){this._backupfocushandle=a.node.getHandle();var c=this;setTimeout(function(){c._backupfocushandle=null},200)}},SystemTreeBinding.prototype._updateRefreshingTrees=function(a){var b=this._refreshingTreeNodes;b.hasEntries()&&b.has(a)&&(b.del(a),b.hasEntries()||(EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this._refreshToken),this._refreshToken=null,this._attemptRestorableFocus(),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED_AFTER,{syncHandle:this.getSyncHandle()})))},SystemTreeBinding.prototype._updateFocusedNode=function(){if(!this._focusedTreeNodeBindings.hasEntries()&&this._activePosition!=SystemAction.activePositions.SelectorTree){var a=StageBinding.entityToken;null!=a&&this._focusTreeNodeByEntityToken(a)}},SystemTreeBinding.prototype._computeClipboardSetup=function(){var a=!1,b=this.getFocusedTreeNodeBindings();if(this._activePosition==SystemAction.activePositions.SelectorTree)a=!1;else if(b.hasEntries())for(a=!0;a&&b.hasNext();){var c=b.getNext();c.isDraggable||(a=!1)}SystemTreePopupBinding.isCutAllowed=a},SystemTreeBinding.prototype._computeRefreshSetup=function(){SystemTreePopupBinding.isRefreshAllowed=null===SystemTreeBinding.clipboard},SystemTreeBinding.prototype.handleBroadcast=function(a,b){switch(SystemTreeBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEMTREEBINDING_REFRESH:(null!=b||this.isFocused)&&this._handleCommandBroadcast(a,b);break;case BroadcastMessages.SYSTEMTREEBINDING_CUT:case BroadcastMessages.SYSTEMTREEBINDING_COPY:case BroadcastMessages.SYSTEMTREEBINDING_PASTE:this.isFocused&&this._handleCommandBroadcast(a);break;case BroadcastMessages.SYSTEMTREEBINDING_COLLAPSEALL:this.collapse(!0);break;case BroadcastMessages.DOCKTABBINDING_SELECT:if(this.isLockedToEditor){var c=b;"Composite.Management.Explorer"!=c.getHandle()&&this._handleDockTabSelect(c)}break;case BroadcastMessages.STAGEDIALOG_OPENED:this.isLockedToEditor&&this.blurSelectedTreeNodes(),EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{activePosition:this._activePosition});break;case BroadcastMessages.SYSTEMTREEBINDING_FOCUS:if(StageBinding.perspectiveNode===this.perspectiveNode){var d=this,e=b;setTimeout(function(){null!=e&&d._focusTreeNodeByEntityToken(e)},250)}}},SystemTreeBinding.prototype._handleDockTabSelect=function(a){var b=null==a.perspectiveNode;if(b||(b=a.perspectiveNode==this.perspectiveNode),b)if(a.isExplorerTab){var c=this.getHandleToken(),d=this;this.setHandleToken(null);var e=this.getFocusedTreeNodeBindings().getFirst();e&&e.node.getEntityToken()===c?EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREENODEBINDING_FOCUS,e):setTimeout(function(){null!=c&&d._focusTreeNodeByEntityToken(c)},250)}else this.setHandleToken(a.getEntityToken())},SystemTreeBinding.prototype.setHandleToken=function(a){this._handleToken=a},SystemTreeBinding.prototype.getHandleToken=function(){return this._handleToken},SystemTreeBinding.prototype._focusTreeNodeByEntityToken=function(a,b){var c=null;if(this._entityTokenRegistry.has(a)){var d=this._entityTokenRegistry.get(a);d.each(function(a){var b=!0;return a.node.isTreeLockEnabled()&&(c=a,b=!1),b}),null!=c&&(c.isFocused&&c.node.getEntityToken()===a?c.dispatchAction(TreeNodeBinding.ACTION_FOCUSED):(c.selectToken(a),this.focusSingleTreeNodeBinding(c,!0)))}if(null==c&&1!=b){Application.lock(this),StatusBar.busy();var e=this;setTimeout(function(){Binding.exists(e)&&(e._fetchTreeForEntityToken(a),e._focusTreeNodeByEntityToken(a,!0)),Application.unlock(e),StatusBar.clear()},0)}else null==c&&(this.getFocusedTreeNodeBindings().each(function(a){a.blur()}),EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{activePosition:this._activePosition,syncHandle:this.getSyncHandle()}))},SystemTreeBinding.prototype._fetchTreeForEntityToken=function(a){function b(a,b){a.hasBeenOpened||b.hasEntries()&&(b.each(function(b){if(!j.has(b.getHandle())){var c=SystemTreeNodeBinding.newInstance(b,i.bindingDocument);k.set(b.getHandle(),c),a.add(c)}}),a.attachRecursive()),a.open(!0)}var c=new List;if(this._activePosition==SystemAction.activePositions.SelectorTree)for(var d=this.getRootTreeNodeBindings();d.hasNext();){var e=d.getNext();c.add(e.node.getEntityToken())}else c.add(StageBinding.perspectiveNode.getEntityToken());for(;c.hasNext();){var f=c.getNext(),g=this.getOpenSystemNodes(),h=System.getInvisibleBranch(f,a,g);if(null==h)this.isLockedToEditor=!1,Application.isDeveloperMode&&Dialog.warning("Ouch!","Because the web service failed, tree has disabled the lock-tree-to-editor feature. Otherwise, re-focus would fire the error indefinitely. Please try again.");else if(h.hasEntries()){var i=this,j=this._treeNodeBindings,k=new Map;h.each(function(a,c){if(j.has(a)){var d=j.get(a);b(d,c)}else if(k.has(a)){var e=k.get(a);b(e,c)}})}}},SystemTreeBinding.prototype._handleCommandBroadcast=function(a,b){switch(a){case BroadcastMessages.SYSTEMTREEBINDING_REFRESH:var c=b;null!=c?this._invokeServerRefresh(c):this._invokeManualRefresh();break;case BroadcastMessages.SYSTEMTREEBINDING_CUT:null!=SystemTreeBinding.clipboard&&SystemTreeBinding.clipboard.hideDrag();var d=this.getFocusedTreeNodeBindings().getFirst();SystemTreeBinding.clipboardOperation=SystemTreePopupBinding.CMD_CUT,SystemTreeBinding.clipboard=d,d.showDrag();break;case BroadcastMessages.SYSTEMTREEBINDING_COPY:var d=this.getFocusedTreeNodeBindings().getFirst();SystemTreeBinding.clipboardOperation=SystemTreePopupBinding.CMD_COPY,SystemTreeBinding.clipboard=d;break;case BroadcastMessages.SYSTEMTREEBINDING_PASTE:this._handlePaste()}},SystemTreeBinding.prototype._invokeServerRefresh=function(a){if(null!=a&&"null"==a&&Application.isDeveloperMode&&alert("Saa har vi balladen."),this._entityTokenRegistry.has(a)){var b=this._entityTokenRegistry.get(a).reset();for(this._refreshToken=a,EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this._refreshToken);b.hasNext();){var c=b.getNext();this._refreshingTreeNodes.set(c.key,!0),setTimeout(function(){c.refresh(!0)},0)}}},SystemTreeBinding.prototype.hasToken=function(a){return this._entityTokenRegistry.has(a)},SystemTreeBinding.prototype._invokeManualRefresh=function(){var a=this.getFocusedTreeNodeBindings().getFirst();if(a){var b=a.getLabel(),c=a.getAncestorBindingByLocalName("treenode");if(c&&(a=c),this._refreshToken=null,this._refreshingTreeNodes.set(a.key,!0),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,null),!StatusBar.state){var d=StringBundle.getString("ui","Website.App.StatusBar.Refreshing");StatusBar.busy(d,[b])}a.refresh()}},SystemTreeBinding.prototype._handlePaste=function(){var a=SystemTreeBinding.clipboard;if(a){var b=a.dragType,c=this.getFocusedTreeNodeBindings().getFirst();c.dragAccept?c.acceptor.isAccepting(b)?this._performPaste(c):Dialog.message(StringBundle.getString("ui","Website.Misc.Trees.DialogTitle.PasteTypeNotAllowed"),StringBundle.getString("ui","Website.Misc.Trees.DialogText.PasteTypeNotAllowed")):Dialog.message(StringBundle.getString("ui","Website.Misc.Trees.DialogTitle.PasteNotAllowed"),StringBundle.getString("ui","Website.Misc.Trees.DialogText.PasteNotAllowed"))}},SystemTreeBinding.prototype._performPaste=function(a){function b(){MessageQueue.update(),Application.unlock(c)}var c=this;if(a.node.hasDetailedDropSupport())if(a.node.hasChildren()){var d=a.node.getChildren();Dialog.invokeModal(SystemTreeBinding.URL_DIALOG_DETAILEDPASTE,{handleDialogResponse:function(d,e){if(d==Dialog.RESPONSE_ACCEPT){Application.lock(c);var f=e.get("switch"),g=e.get("sibling");"after"==f&&g++;var h=a.accept(SystemTreeBinding.clipboard,g);h?(SystemTreeBinding.clipboard=null,SystemTreeBinding.clipboardOperation=null,setTimeout(b,0)):b()}}},d)}else{Application.lock(c);var e=a.accept(SystemTreeBinding.clipboard,0);e?(SystemTreeBinding.clipboard=null,SystemTreeBinding.clipboardOperation=null,setTimeout(b,0)):b()}else{Application.lock(c);var e=a.accept(SystemTreeBinding.clipboard,0);e&&(SystemTreeBinding.clipboard=null,SystemTreeBinding.clipboardOperation=null),b()}},SystemTreeBinding.prototype.selectDefault=function(){if(this._defaultTreeNode!==!1){var a=System.getDefaultEntityToken(this.perspectiveNode.getEntityToken());if(null!=a)this._focusTreeNodeByEntityToken(a);else if(this._defaultTreeNode)this._defaultTreeNode.focus(),this._defaultTreeNode.isContainer&&!this._defaultTreeNode.isOpen&&this._defaultTreeNode.open(),this._defaultTreeNode=null;else{var b=this.getDescendantBindingByType(TreeNodeBinding);b&&b.focus()}}},SystemTreeBinding.prototype.collapse=function(a){if(EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{activePosition:this._activePosition}),a){this.blurSelectedTreeNodes();var b=this.getRootTreeNodeBindings();b.each(function(a){a.isContainer&&a.isOpen&&(a.close(),a.hasBeenOpened=!1,a.empty())})}else SystemTreeBinding.superclass.collapse.call(this)},SystemTreeBinding.prototype.setLockToEditor=function(a){a!=this.isLockedToEditor&&(this.isLockedToEditor=a,a&&EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_LOCKTOEDITOR))},SystemTreeBinding.prototype.getOpenSystemNodes=function(){var a=new List([StageBinding.perspectiveNode]);this._activePosition==SystemAction.activePositions.SelectorTree&&(a=new List);var b=this.getRootTreeNodeBindings();return b.each(function(b){var c=b.getOpenSystemNodes();null!=c&&c.hasEntries()?a.merge(c):b.isOpen&&a.add(b.node)}),a},SystemTreeBinding.prototype.focusSingleTreeNodeBinding=function(a){SystemTreeBinding.superclass.focusSingleTreeNodeBinding.call(this,a),null!=a&&this._handleSystemTreeFocus()},SystemTreeBinding.prototype.setActionGroup=function(a){if(a){var b=new List(a.split(" "));for(this._actionGroup={};b.hasNext();)this._actionGroup[b.getNext()]=!0}},SystemTreeBinding.prototype.getCompiledActionProfile=function(){var a=new Map,b=this.getFocusedTreeNodeBindings().getFirst(),c=b.node.getActionProfile();if(null!=c){var d=this;c.each(function(b,c){var e=new List;c.each(function(a){a.getActivePositions()&d._activePosition&&(d._actionGroup&&!d._actionGroup[a.getGroupName()]||e.add(a))}),e.hasEntries()&&a.set(b,e)})}a.activePosition=this._activePosition;var e=b.node.getPropertyBag();return e&&e.Uri&&"application/x-composite-page"===e.ElementType&&(a.Uri=e.Uri),a.EnitityToken=b.node.getEntityToken(),a.Node=b.node,a},SystemTreePopupBinding.prototype=new PopupBinding,SystemTreePopupBinding.prototype.constructor=SystemTreePopupBinding;SystemTreePopupBinding.superclass=PopupBinding.prototype;SystemTreePopupBinding.CMD_CUT="cut",SystemTreePopupBinding.CMD_COPY="copy",SystemTreePopupBinding.CMD_PASTE="paste",SystemTreePopupBinding.CMD_REFRESH="refresh",SystemTreePopupBinding.isCutAllowed=!1,SystemTreePopupBinding.isRefreshAllowed=!0,SystemTreePopupBinding.prototype.onBindingRegister=function(){SystemTreePopupBinding.superclass.onBindingRegister.call(this),this.subscribe(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED),this.addActionListener(MenuItemBinding.ACTION_COMMAND,this)},SystemTreePopupBinding.prototype.onBindingAttach=function(){SystemTreePopupBinding.superclass.onBindingAttach.call(this),this._indexMenuContent()},SystemTreePopupBinding.prototype.handleBroadcast=function(a,b){switch(SystemTreePopupBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED:null!=b&&null!=b.actionProfile?(this._node=b.actionProfile.Node,this._actionProfile=b.actionProfile):this._currentProfileKey=null}},SystemTreePopupBinding.prototype._getProfileKey=SystemToolBarBinding.prototype._getProfileKey,SystemTreePopupBinding.prototype.show=function(){var a=this._getProfileKey();a!=this._currentProfileKey&&(this.disposeContent(),this.constructContent(),this._currentProfileKey=a),this._setupClipboardItems(),this._setupRefreshItem(),SystemTreePopupBinding.superclass.show.call(this)},SystemTreePopupBinding.prototype._setupClipboardItems=function(){var a=this.getMenuItemForCommand(SystemTreePopupBinding.CMD_CUT),b=this.getMenuItemForCommand(SystemTreePopupBinding.CMD_COPY),c=this.getMenuItemForCommand(SystemTreePopupBinding.CMD_PASTE);a.setDisabled(!SystemTreePopupBinding.isCutAllowed),b.setDisabled(!SystemTreePopupBinding.isCutAllowed),c.setDisabled(null==SystemTreeBinding.clipboard)},SystemTreePopupBinding.prototype._setupRefreshItem=function(){var a=this.getMenuItemForCommand(SystemTreePopupBinding.CMD_REFRESH);a.setDisabled(!SystemTreePopupBinding.isRefreshAllowed)},SystemTreePopupBinding.prototype.handleAction=function(a){switch(SystemTreePopupBinding.superclass.handleAction.call(this,a),a.type){case MenuItemBinding.ACTION_COMMAND:var b=a.target,c=b.associatedSystemAction;if(c){if(SystemAction.invoke(c,this._node),this._keepBundleState){var d=c.getBundleName();null!=d&&LocalStorage.set(ToolBarComboButtonBinding.STORAGE_PREFFIX+d,c.getHandle())}}else{var e=b.getProperty("cmd");e&&this._handleCommand(e)}this._currentProfileKey=null}},SystemTreePopupBinding.prototype._handleCommand=function(a){var b=null;switch(a){case SystemTreePopupBinding.CMD_CUT:b=BroadcastMessages.SYSTEMTREEBINDING_CUT;break;case SystemTreePopupBinding.CMD_COPY:b=BroadcastMessages.SYSTEMTREEBINDING_COPY;break;case SystemTreePopupBinding.CMD_PASTE:b=BroadcastMessages.SYSTEMTREEBINDING_PASTE;break;case SystemTreePopupBinding.CMD_REFRESH:b=BroadcastMessages.SYSTEMTREEBINDING_REFRESH}b&&setTimeout(function(){EventBroadcaster.broadcast(b)},0)},SystemTreePopupBinding.prototype.disposeContent=function(){for(var a=new List(DOMUtil.getElementsByTagName(this.bindingElement,"menugroup")).reverse();a.hasNext();){var b=UserInterface.getBinding(a.getNext());b.getProperty("rel")||b.dispose()}},SystemTreePopupBinding.prototype.constructContent=function(){if(null!=this._actionProfile){var a=this.bindingDocument,b=new List,c=this,d=new Map;for(this._actionProfile.each(function(e,f){var g=MenuGroupBinding.newInstance(a);f.each(function(b){var e=c.getMenuItemBinding(b),f=b.getBundleName();if(f)if(d.has(f)){var h=d.get(f);if(null==h.getChildBindingByType(MenuPopupBinding)){h.setProperty("hasaction",!0);var i=MenuPopupBinding.newInstance(a),j=i.add(MenuBodyBinding.newInstance(a)),k=j.add(MenuGroupBinding.newInstance(a));h.add(i),(this._keepBundleState||h.isDisabled)&&k.add(c.getMenuItemBinding(h.associatedSystemAction))}var l=h.getDescendantBindingByType(MenuGroupBinding);l&&l.add(e)}else g.add(e),d.set(f,e);else g.add(e)},this),b.add(g)},this),b.reverse();b.hasNext();)this._bodyBinding.addFirst(b.getNext());this._bodyBinding.attachRecursive(),d.each(function(a,b){if(b.isMenuContainer&&(this._keepBundleState||b.isDisabled)){var c=b.getDescendantBindingsByType(MenuItemBinding),d=null;if(this._keepBundleState){var e=LocalStorage.get(ToolBarComboButtonBinding.STORAGE_PREFFIX+a);c.each(function(a){return!(a.associatedSystemAction&&a.associatedSystemAction.getHandle()===e&&!a.isDisabled)||(d=a,!1)})}null==d&&c.each(function(a){return!!a.isDisabled||(d=a,!1)}),null==d&&(d=c.getFirst()),this.setSystemAction(b,d.associatedSystemAction),Binding.prototype.hide.call(d)}},this)}},SystemTreePopupBinding.prototype.getMenuItemBinding=function(a){
var b=MenuItemBinding.newInstance(this.bindingDocument);return SystemTreePopupBinding.prototype.setSystemAction.call(this,b,a),b},SystemTreePopupBinding.prototype.setSystemAction=function(a,b){var c=b.getLabel(),d=b.getToolTip(),e=b.getImage(),f=b.getDisabledImage(),g=b.isCheckBox();c&&a.setLabel(c),d&&a.setToolTip(d),e&&(a.imageProfile=new ImageProfile({image:e,imageDisabled:f})),g&&(a.setType(MenuItemBinding.TYPE_CHECKBOX),b.isChecked()?a.check(!0):a.uncheck(!0)),b.isDisabled()?a.disable():a.isDisabled&&a.enable(),a.associatedSystemAction=b},SystemTreePopupBinding.prototype.snapToMouse=function(a){var b=a.target?a.target:a.srcElement,c=DOMUtil.getLocalName(b),d=null;if("tree"!=c){switch(c){case"treenode":break;default:b=DOMUtil.getAncestorByLocalName("treenode",b),null!=b&&(d=UserInterface.getBinding(b),d.isDisabled&&(d=null))}null!=d&&null!=d.node&&null!=d.node.getActionProfile()&&SystemTreePopupBinding.superclass.snapToMouse.call(this,a)}},SystemTreeNodeBinding.prototype=new TreeNodeBinding,SystemTreeNodeBinding.prototype.constructor=SystemTreeNodeBinding,SystemTreeNodeBinding.superclass=TreeNodeBinding.prototype,SystemTreeNodeBinding.ACTION_REFRESHED="systemtreenoderefreshed",SystemTreeNodeBinding.ACTION_REFRESHED_YEAH="systemtreenoderefreshedyeah!",SystemTreeNodeBinding.MAX_CHILD_IMPORT=1e4,SystemTreeNodeBinding.prototype.onBindingAttach=function(){this.addActionListener(SystemTreeNodeBinding.ACTION_REFRESHED),this.subscribe(BroadcastMessages.SYSTEMTREENODEBINDING_FORCE_OPEN),this.isDisabled=this.node.isDisabled();var a=this.node.getLabel();a&&this.setLabel(a);var b=this.node.getToolTip();b&&this.setToolTip(b);var c=this.node.getHandle();c&&this.setHandle(c);var d=this.node.getPropertyBag();if(d)for(var e in d)switch(e.toLowerCase()){case"id":case"key":throw new Error("Illegal propertybag key: "+e);default:this.setProperty(e,d[e])}SystemTreeNodeBinding.superclass.onBindingAttach.call(this),this.perspectiveNode=this.containingTreeBinding.perspectiveNode},SystemTreeNodeBinding.prototype._initializeBindingDragAndDropFeatures=function(){if(this.node.hasDragType()&&this.setProperty("dragtype",this.node.getDragType()),this.node.hasDragAccept()){for(var a="",b=this.node.getDragAccept();b.hasNext();)a+=b.getNext(),b.hasNext()&&(a+=" ");this.setProperty("dragaccept",a)}SystemTreeNodeBinding.superclass._initializeBindingDragAndDropFeatures.call(this)},SystemTreeNodeBinding.prototype.handleAction=function(a){switch(SystemTreeNodeBinding.superclass.handleAction.call(this,a),a.type){case SystemTreeNodeBinding.ACTION_REFRESHED:a.target==this&&(this.isOpen||(this.hasBeenOpened=!1,a.consume()))}},SystemTreeNodeBinding.prototype.handleBroadcast=function(a,b){switch(SystemTreeNodeBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEMTREENODEBINDING_FORCE_OPEN:if(b==this.node.getEntityToken()&&this.isContainer&&!this.isOpen){this._isForcedOpen=!0,EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREENODEBINDING_FORCING_OPEN,this);var c=this;setTimeout(function(){c.open()},0)}}},SystemTreeNodeBinding.prototype._computeImageProfile=function(){},SystemTreeNodeBinding.prototype.computeImage=function(){var a=null,b=this.node.getImageProfile();return b&&(a=this.isOpen?b.getActiveImage():b.getDefaultImage()),a||(a=SystemTreeNodeBinding.superclass.computeImage.call(this)),a},SystemTreeNodeBinding.prototype.open=function(a){var b=this.isContainer&&!this.isOpen,c=!this.hasBeenOpened;SystemTreeNodeBinding.superclass.open.call(this),b&&(c||SystemTreeBinding.HAS_NO_MEMORY)&&1!=a&&(this.refresh(),this._isForcedOpen&&(EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREENODEBINDING_FORCED_OPEN,this),this._isForcedOpen=!1))},SystemTreeNodeBinding.prototype.refresh=function(){var a=null;this.isContainer&&(a=this.getOpenSystemNodes()),this.isRefreshing=!0,Application.lock(this),StatusBar.busy();var b=this;setTimeout(function(){Binding.exists(b)?(b._performRefresh(a),Application.unlock(b)):Application.unlock(Application,!0),StatusBar.clear()},0)},SystemTreeNodeBinding.prototype._performRefresh=function(a){this.activeBundles=new List,this.getDescendantBindingsByType(SystemTreeNodeBinding).each(function(a){a.node.isMultiple()&&this.activeBundles.add(a.node.getHandle())},this),null!=a?this._refreshBranch(a):this._refreshChildren(),this.isRefreshing=!1,this.activeBundles=null,this.isContainer=null!=DOMUtil.getElementsByTagName(this.bindingElement,"treenode").item(0),this.updateClassNames(),this.dispatchAction(SystemTreeNodeBinding.ACTION_REFRESHED),this.dispatchAction(SystemTreeNodeBinding.ACTION_REFRESHED_YEAH)},SystemTreeNodeBinding.prototype._refreshChildren=function(){var a=(new List,this.node.getChildren());this.empty(),a.hasEntries()&&this._insertTreeNodesRegulated(a)},SystemTreeNodeBinding.prototype._insertTreeNodesRegulated=function(a){for(var b=0,c=new List([]);a.hasEntries()&&b<=SystemTreeNodeBinding.MAX_CHILD_IMPORT;){var d=SystemTreeNodeBinding.newInstance(a.extractFirst(),this.bindingDocument);d.node.isMultiple()&&d.node.getDatas().each(function(a){return!this.activeBundles.has(a.ElementKey)||(d.node.select(a.ElementKey),!1)},this),d.autoExpand=this.autoExpand,this.add(d),d.attach(),b++,this.autoExpand&&(1==b&&!a.hasEntries()||LocalStore.openedNodes.has(d.node))&&c.add(d)}a.hasEntries()&&this._insertBufferTreeNode(a),c.each(function(a){if(a.isContainer&&!a.isOpen){var b=a;setTimeout(function(){b.open()},0)}})},SystemTreeNodeBinding.prototype._insertBufferTreeNode=function(a){alert("Max treenode count reached. This is not handled!"),alert("TODO: SystemTreeNodeBinding#._insertBufferTreeNode")},SystemTreeNodeBinding.prototype._refreshBranch=function(a){var b=this.node.getDescendantBranch(a);b.hasEntries()&&this.XXX(b)},SystemTreeNodeBinding.prototype.XXX=function(a){var b=this,c=new Map;this.empty(),a.each(function(a,d){new Map;d.hasEntries()&&d.each(function(d){var e=SystemTreeNodeBinding.newInstance(d,b.bindingDocument);if(e.node.isMultiple()&&e.node.getDatas().each(function(a){return!this.activeBundles.has(a.ElementKey)||(e.node.select(a.ElementKey),!1)},this),c.set(d.getHandle(),e),c.has(a)){var f=c.get(a);f.add(e),f.isOpen=!0,f.hasBeenOpened=!0,d.searchToken=f.node.searchToken}else a==b.node.getHandle()&&(b.add(e),d.searchToken=b.node.searchToken)},this)},this),this.attachRecursive(),a.dispose(),c.dispose()},SystemTreeNodeBinding.prototype.getOpenDescendants=function(){var a=new TreeCrawler,b=new List;return a.mode=TreeCrawler.MODE_GETOPEN,a.crawl(this.bindingElement,b),b.hasEntries()&&b.extractFirst(),a.dispose(),b},SystemTreeNodeBinding.prototype.getOpenSystemNodes=function(){var a=null,b=this.getOpenDescendants();return b.hasEntries()&&(a=new List([this.node]),b.each(function(b){a.add(b.node)})),a},SystemTreeNodeBinding.prototype.updateClassNames=function(){this.isRefreshing||SystemTreeNodeBinding.superclass.updateClassNames.call(this)},SystemTreeNodeBinding.prototype.acceptTreeNodeBinding=function(a,b){var c=SystemTreeBinding.clipboardOperation==SystemTreePopupBinding.CMD_COPY;a instanceof SystemTreeNodeBinding&&TreeService.ExecuteDropElementAction&&TreeService.ExecuteDropElementAction(a.node.getData(),this.node.getData(),b?b:this.containingTreeBinding.getDropIndex(),Application.CONSOLE_ID,c)},SystemTreeNodeBinding.prototype.invokeManagedFocus=function(a){if(!this.isFocused){SystemTreeNodeBinding.superclass.invokeManagedFocus.call(this);var b=this.containingTreeBinding;b.isLockedToEditor&&EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREENODEBINDING_FOCUS,this)}},SystemTreeNodeBinding.prototype.hasChildren=function(){return this.node.hasChildren()},SystemTreeNodeBinding.prototype.getHandles=function(){return this.node.getHandles()},SystemTreeNodeBinding.prototype.selectToken=function(a){this.node.selectByToken(a),this.isDisabled=this.node.isDisabled(),this.setLabel(this.node.getLabel()),this.setToolTip(this.node.getToolTip()),this.setImage(this.computeImage()),this.setHandle(this.node.getHandle())},SystemTreeNodeBinding.prototype.getProperty=function(a){return"EntityToken"==a&&this.node&&this.node.getEntityToken()?this.node.getEntityToken():SystemTreeNodeBinding.superclass.getProperty.call(this,a)},SystemTreeNodeBinding.newInstance=function(a,b){var c=DOMUtil.createElementNS(Constants.NS_UI,"ui:treenode",b),d=UserInterface.registerBinding(c,SystemTreeNodeBinding);return d.node=a,d},SystemPageBinding.prototype=new PageBinding,SystemPageBinding.prototype.constructor=SystemPageBinding,SystemPageBinding.superclass=PageBinding.prototype,SystemPageBinding.prototype.toString=function(){return"[SystemPageBinding]"},SystemPageBinding.prototype.onBindingRegister=function(){SystemPageBinding.superclass.onBindingRegister.call(this),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESH),this.addActionListener(ButtonBinding.ACTION_COMMAND)},SystemPageBinding.prototype.setPageArgument=function(a){this.node=a,SystemPageBinding.superclass.setPageArgument.call(this,a)},SystemPageBinding.prototype.onBeforePageInitialize=function(){if(!this.node)throw"SystemPageBinding requires a SystemNode";if(this._tree=this.bindingWindow.bindingMap.tree,!this._tree)throw"SystemPageBinding requires a SystemTreeBinding";this._buildTree(),SystemPageBinding.superclass.onBeforePageInitialize.call(this)},SystemPageBinding.prototype._buildTree=function(){var a=this.node.getChildren();if(a.hasEntries())for(;a.hasNext();){var b=SystemTreeNodeBinding.newInstance(a.getNext(),this.bindingDocument);this._tree.add(b),b.attach()}},SystemPageBinding.prototype._refreshTree=function(){var a=this._tree._treeBodyBinding.getChildBindingsByLocalName("treenode");a.each(function(a){a.isContainer||(a.isOpen=!0)});var b=new TreeCrawler,c=new List;b.mode=TreeCrawler.MODE_GETOPEN,b.crawl(this.bindingElement,c),b.dispose();var d=new List([this.node]);c.each(function(a){d.add(a.node)}),this._tree.empty();var e=this.node.getDescendantBranch(d);if(e.hasEntries()){var f=this,g=new Map;e.each(function(a,b){b.each(function(b){var c=SystemTreeNodeBinding.newInstance(b,f.bindingDocument);if(g.set(b.getHandle(),c),g.has(a)){var d=g.get(a);d.add(c),d.isOpen=!0}else a==f.node.getHandle()&&f._tree.add(c)})}),this._tree.attachRecursive()}},SystemPageBinding.prototype.onAfterPageInitialize=function(){if(SystemPageBinding.superclass.onAfterPageInitialize.call(this),this._tree.selectDefault(),Application.isTestEnvironment)try{this.setProperty("data-qa",this.node.getTag())}catch(a){}},SystemPageBinding.prototype.handleAction=function(a){switch(SystemPageBinding.superclass.handleAction.call(this,a),a.type){case ButtonBinding.ACTION_COMMAND:var b=a.target;switch(b.getID()){case"locktreebutton":this._tree.setLockToEditor(b.isChecked);break;case"collapsebutton":this._tree.collapse()}}},SystemPageBinding.prototype.handleBroadcast=function(a,b){switch(SystemPageBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEMTREEBINDING_REFRESH:var c=b;if(this.node&&this.node.getEntityToken()==c)try{EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,c);var d=this;Application.lock(this),setTimeout(function(){d._refreshTree(),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,c),Application.unlock(d)},0)}catch(a){alert(a),SystemDebug.stack(arguments)}}},StageContainerBinding.prototype=new FlexBoxBinding,StageContainerBinding.prototype.constructor=StageContainerBinding,StageContainerBinding.superclass=FlexBoxBinding.prototype,StageContainerBinding.prototype.toString=function(){return"[StageContainerBinding]"},StageContainerBinding.prototype.onBindingAttach=function(){StageContainerBinding.superclass.onBindingAttach.call(this),this.subscribe(BroadcastMessages.APPLICATION_OPERATIONAL)},StageContainerBinding.prototype.handleBroadcast=function(a,b){StageContainerBinding.superclass.handleBroadcast.call(this,a,b);var c=this.bindingWindow.WindowManager;switch(a){case BroadcastMessages.APPLICATION_OPERATIONAL:this.subscribe(c.WINDOW_RESIZED_BROADCAST),this._fit(),this.reflex();break;case c.WINDOW_RESIZED_BROADCAST:if(1==Client.isMozilla)this._fit(),this.reflex();else{Application.lock(this);var d=this;setTimeout(function(){d._fit(),d.reflex(),Application.unlock(d)},0)}}},StageContainerBinding.prototype._fit=function(){var a=this.bindingWindow.WindowManager;this.bindingElement.style.width=a.getWindowDimensions().w+"px"},StageBinding.prototype=new FocusBinding,StageBinding.prototype.constructor=StageBinding,StageBinding.superclass=FocusBinding.prototype,StageBinding.ACTION_DECK_LOADED="stage deck loaded",StageBinding.CLASSNAME_EMPTY="empty",StageBinding.ACTION_START_LOADED="stage start loaded",StageBinding.bindingInstance=null,StageBinding.perspectiveNode=null,StageBinding.entityToken=null,StageBinding.treeSelector=null,StageBinding.placeholderWidth=null,StageBinding.handleViewPresentation=function(a,b){if(StageBinding.isViewOpen(a))EventBroadcaster.broadcast(BroadcastMessages.CLOSE_VIEW,a);else{var c=ViewDefinitions[a];StageBinding.presentViewDefinition(c,b)}},StageBinding.isViewOpen=function(a){return null!=StageBinding.bindingInstance._activeViewDefinitions[a]},StageBinding.setSelectionByHandle=function(a){StageBinding.bindingInstance._explorerBinding.setSelectionByHandle(a)},StageBinding.getSelectionHandle=function(){return StageBinding.bindingInstance._explorerBinding.getSelectionHandle()},StageBinding.selectBrowserTab=function(){StageBinding.bindingInstance.selectBrowserTab()},StageBinding.presentViewDefinition=function(a,b){if(null!=a.label){var c=StringBundle.getString("ui","Website.App.StatusBar.Opening");StatusBar.busy(c,[a.label])}else StatusBar.busy();StageBinding.bindingInstance._presentViewDefinition(a,b)},StageBinding.select=function(a){var b=new Promise(function(b,c){if(a&&a!=StageBinding.getSelectionHandle()){var d={handleBroadcast:function(c,d){switch(c){case BroadcastMessages.STAGEDECK_CHANGED:d==a&&(EventBroadcaster.unsubscribe(BroadcastMessages.STAGEDECK_CHANGED,this),StageBinding.selectBrowserTab(),b())}}};EventBroadcaster.subscribe(BroadcastMessages.STAGEDECK_CHANGED,d),StageBinding.setSelectionByHandle(a)}else b()});return b},StageBinding.prototype.toString=function(){return"[StageBinding]"},StageBinding.prototype.onBindingRegister=function(){StageBinding.superclass.onBindingRegister.call(this),StageBinding.bindingInstance=this,StageBoxHandlerAbstraction.onBindingRegister.call(this),this.addActionListener(StageDecksBinding.ACTION_INITIALIZED),this.addActionListener(TabBoxBinding.ACTION_ATTACHED),this.addActionListener(TabBoxBinding.ACTION_SELECTED),this.addActionListener(WindowBinding.ACTION_LOADED),this.addActionListener(StageBinding.ACTION_DECK_LOADED),this.addActionListener(StageDeckBinding.ACTION_LOADED),this.addActionListener(ErrorBinding.ACTION_INITIALIZE),DOMEvents.addEventListener(top,DOMEvents.HASHCHANGE,this),this.subscribe(BroadcastMessages.VIEW_CLOSED),this.subscribe(BroadcastMessages.VIEW_OPENED),this.subscribe(BroadcastMessages.COMPOSITE_START),this.subscribe(BroadcastMessages.COMPOSITE_STOP),this.subscribe(BroadcastMessages.DOCK_MAXIMIZED),this.subscribe(BroadcastMessages.DOCK_NORMALIZED),app.bindingMap.explorer.addActionListener(ExplorerBinding.ACTION_INITIALIZED,this),app.bindingMap.explorer.addActionListener(ExplorerMenuBinding.ACTION_SELECTIONCHANGED,this),app.bindingMap.app.addActionListener(StageBinding.ACTION_START_LOADED,this),this._initializeUsergroup();var a=System.getRootNode();this._initializeRootActions(a),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESH,{handleBroadcast:function(b,c){c==a.getEntityToken()&&EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHALL)}});var b=System.getPerspectiveNodes();b.hasEntries()?this._initializeSystemViewDefinitions(b):(top.app.bindingMap.stagecontainer.hide(),top.app.bindingMap.app.attachClassName(StageBinding.CLASSNAME_EMPTY),this._onStageReady(),Dialog.message(StringBundle.getString("ui","Website.Dialogs.NoAccessTitle"),StringBundle.getString("ui","Website.Dialogs.NoAccessText")))},StageBinding.prototype._renameThisMethod=function(){if(LocalStore.isInitialized)this._initializeWorkbenchLayout();else{var a=this;EventBroadcaster.subscribe(BroadcastMessages.LOCALSTORE_INITIALIZED,{handleBroadcast:function(){a._initializeWorkbenchLayout()}})}},StageBinding.prototype._initializeWorkbenchLayout=function(){if(this._explorerBinding){var a=null;LocalStore.isEnabled&&(a=LocalStore.getProperty(LocalStore.SELECTED_PERSPECTIVE_HANDLE)),a&&ViewDefinitions[a]?(alert("StageBinding#_initializeWorkbenchLayout !!!!"),this._explorerBinding.setSelectionByHandle(unescape(a))):this._explorerBinding.setSelectionDefault()}else this._onStageReady()},StageBinding.prototype._onStageReady=function(){this._isStageReady||(top.app.bindingMap.maindecks&&top.app.bindingMap.maindecks.select("stagedeck"),EventBroadcaster.broadcast(BroadcastMessages.STAGE_INITIALIZED),this._isStageReady=!0)},StageBinding.prototype._initializeUsergroup=function(a){LoginService.GetUserDisplayName(!0,function(a){top.app.bindingMap.usermenu.setLabel(a)})},StageBinding.prototype._initializeRootActions=function(a){var b=a.getActionProfile();if(b&&b.hasEntries()){var c=top.app.bindingMap.toolsmenugroup,d=new Map;c&&(b.each(function(a,b){b.each(function(a){var b=MenuItemBinding.newInstance(c.bindingDocument);b.setLabel(a.getLabel()),b.setToolTip(a.getToolTip()),b.setImage(a.getImage()),b.setDisabled(a.isDisabled()),b.associatedSystemAction=a;var e=c,f=a.getTag();if(null!=f)switch(f){case SystemAction.TAG_CHANGEFROMLANGUAGE:e=top.app.bindingMap.translationsmenugroup;case SystemAction.TAG_USER:e=top.app.bindingMap.usermenugroup}var g=a.getBundleName();if(g){if(!d.has(g)){var h=MenuItemBinding.newInstance(c.bindingDocument);h.setLabel(g),h.setImage(a.getImage()),e.add(h);var i=MenuPopupBinding.newInstance(c.bindingDocument),j=i.add(MenuBodyBinding.newInstance(c.bindingDocument)),k=j.add(MenuGroupBinding.newInstance(c.bindingDocument));h.add(i),d.set(g,k)}e=d.get(g)}e.add(b)})}),c.attachRecursive())}},StageBinding.prototype._initializeSystemViewDefinitions=function(a){for(;a.hasNext();){var b=a.getNext(),c=b.getHandle();ViewDefinitions[c]=new SystemViewDefinition(b)}},StageBinding.prototype.handleAction=function(a){StageBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case StageDecksBinding.ACTION_INITIALIZED:Application.isOperational||ProgressBarBinding.notch(4),this._decksBinding=b,this._inflateBinding(b),a.consume();break;case ExplorerBinding.ACTION_INITIALIZED:Application.isOperational||ProgressBarBinding.notch(4),this._explorerBinding=b,this._inflateBinding(b),a.consume();break;case ExplorerMenuBinding.ACTION_SELECTIONCHANGED:Application.isOperational||ProgressBarBinding.notch(5),this.handlePerspectiveChange(app.bindingMap.explorermenu);var c=app.bindingMap.explorermenu.getSelectionTag();EventBroadcaster.broadcast(BroadcastMessages.PERSPECTIVE_CHANGED,c),a.consume();break;case TabBoxBinding.ACTION_ATTACHED:if(b instanceof DockBinding){switch(b.reference){case DockBinding.START:case DockBinding.ABSBOTTOMLEFT:case DockBinding.ABSBOTTOMRIGHT:case DockBinding.ABSRIGHTTOP:case DockBinding.ABSRIGHTBOTTOM:this._dockBindings.set(b.reference,b)}this.handleAttachedDock(b),a.consume()}break;case TabBoxBinding.ACTION_SELECTED:b instanceof DockBinding&&(this.handleSelectedDockTab(b.getSelectedTabBinding()),a.consume());break;case WindowBinding.ACTION_LOADED:break;case StageBinding.ACTION_DECK_LOADED:this._isExplorerReady=!0,1==this._isDecksReady&&(this._isStageReady||(ProgressBarBinding.notch(3),this._onStageReady()));break;case StageBinding.ACTION_START_LOADED:Application.hasStartPage&&KickStart.justLogged&&!Client.isPad?EventBroadcaster.broadcast(BroadcastMessages.START_COMPOSITE):ViewBinding.hasInstance("Composite.Management.Start")&&ViewBinding.getInstance("Composite.Management.Start").hide();break;case StageSplitPanelBinding.ACTION_LAYOUTUPDATE:if(!this._isFlexAbort&&Application.isOperational){this._isFlexAbort=!0,this.reflex(!0);var d=this;setTimeout(function(){1==Client.isMozilla&&d.reflex(!0),d._isFlexAbort=!1},0)}a.consume();break;case StageDeckBinding.ACTION_LOADED:if(this._isDecksReady=!0,1==this._isExplorerReady&&(this._isStageReady||this._onStageReady()),b.isDefaultStageDeck){var e=a.target;this._activeViewDefinitions["Composite.Management.Browser"]=e.definition;var f=ViewDefinitions["Composite.Management.Browser"];f.image=e.definition.image,f.label=e.definition.label,f.toolTip=e.definition.toolTip,f.argument.SystemViewDefinition=e.definition,f.argument.URL=null,f.argument.image=e.definition.image,f.argument.label=e.definition.label,f.argument.toolTip=e.definition.toolTip,e._browserTab=e._dockBindings.get("main").prepareNewView(f),e._browserTab.isExplorerTab=!0}break;case ErrorBinding.ACTION_INITIALIZE:a.consume()}StageBoxHandlerAbstraction.handleAction.call(this,a)},StageBinding.prototype.handleBroadcast=function(a,b){switch(StageBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.VIEW_OPENED:Application.unlock(this);break;case BroadcastMessages.VIEW_CLOSED:var c=b;this._dontView(c);break;case BroadcastMessages.COMPOSITE_START:this._showStart(!0);break;case BroadcastMessages.COMPOSITE_STOP:this._showStart(!1);break;case BroadcastMessages.DOCK_MAXIMIZED:this._stabilizeExplorer(),this._isShowingStart&&EventBroadcaster.broadcast(BroadcastMessages.STOP_COMPOSITE);break;case BroadcastMessages.DOCK_NORMALIZED:this._stabilizeExplorer()}},StageBinding.prototype.handleEvent=function(a){switch(StageBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.HASHCHANGE:this.handleHash(a.target),a.preventDefault()}},StageBinding.prototype.handleHash=function(a){if(a&&a.location&&a.location.hash){var b=a.location.hash.replace(/^#/,"");b&&(a.history&&a.history.replaceState?a.history.replaceState({},a.document.title,a.location.href.split("#")[0]):a.location.hash="",MessageQueue.placeConsoleCommand(decodeURIComponent(b)),MessageQueue.update(),EventBroadcaster.broadcast(BroadcastMessages.COMPOSITE_STOP))}},StageBinding.prototype._stabilizeExplorer=function(){if(1==Client.isExplorer){var a=this;1==Client.isExplorer&&setTimeout(function(){a.reflex(!0)},0)}},StageBinding.prototype._showStart=function(a){if(a!=this._isShowingStart){var b=ViewBinding.getInstance("Composite.Management.Start"),c=this._dockBindings.get(DockBinding.START);a?b.show():(b.hide(),null!=c&&c.isActive&&c.deActivate()),this._isShowingStart=a}},StageBinding.prototype._inflateBinding=function(a){for(var b in ViewDefinitions){var c=ViewDefinitions[b];c instanceof SystemViewDefinition&&a.mountDefinition(c)}var d=null!=this._decksBinding&&null!=this._explorerBinding;if(d){var e=this;setTimeout(function(){e._renameThisMethod()},0)}},StageBinding.prototype.iterateContainedStageBoxBindings=function(a){var b=new StageCrawler;b.mode=a,b.crawl(this.bindingElement),b.dispose()},StageBinding.prototype.handlePerspectiveChange=function(a){var b=a.getSelectionHandle();this._decksBinding.setSelectionByHandle(b),LocalStore.isEnabled&&LocalStore.setProperty(LocalStore.SELECTED_PERSPECTIVE_HANDLE,escape(b))},StageBinding.prototype.handleAttachedDock=function(a){var b=a.getTabBindings();if(b.hasEntries())for(;b.hasNext();){var c=b.getNext(),d=c.getHandle();if(d){var e=ViewDefinitions[d];e?this._view(a,c,e,!1):alert("StageBinding: no such predefined viewdefinition ("+d+")")}}},StageBinding.prototype._presentViewDefinition=function(a,b){var c=null,d=!1;switch(a.position){case Dialog.MODAL:c=app.bindingMap.masterdialogset.getModalInstance();break;case Dialog.NON_MODAL:c=app.bindingMap.masterdialogset.getInstance();break;default:if(this._dockBindings.hasEntries())switch(a.position){case DockBinding.ABSBOTTOMLEFT:case DockBinding.ABSBOTTOMRIGHT:case DockBinding.ABSRIGHTTOP:case DockBinding.ABSRIGHTBOTTOM:c=this._dockBindings.get(a.position);break;case DockBinding.EXTERNAL:window.open(a.url),d=!0;break;case DockBinding.SLIDE:var e=this._decksBinding.getSelectedDeckBinding(),f=e.getDockBindingByReference(DockBinding.MAIN),g=f.getSelectedTabPanelBinding(),h=SlideInViewBinding.newInstance(g.viewBinding.getContentDocument());h.setDefinition(a),h.attach(),h.snapToBinding(g.viewBinding.getRootBinding()),d=!0;break;default:var e=this._decksBinding.getSelectedDeckBinding();c=e.isPlaceholder()?this._dockBindings.get(DockBinding.ABSRIGHTTOP):e.getDockBindingByReference(a.position),this._isShowingStart&&EventBroadcaster.broadcast(BroadcastMessages.STOP_COMPOSITE)}else d=!0}if(!d){if(null==c)throw"StageBinding: Could not position view: "+a.handle;if(void 0!=b&&Interfaces.isImplemented(IContextContainerBinding,c)){var i=ContextContainer.getContextContainer(b);null!=i&&(c.setContextContainer(i),a&&a.argument&&a.argument.url&&(a.argument.url=ContextContainer.resolve(a.argument.url,i)))}this._view(c,null,a,!0)}},StageBinding.prototype._view=function(a,b,c,d){var e=c.handle;if(c.isMutable&&(e+=KeyMaster.getUniqueKey()),this._activeViewDefinitions[e]){var f=ViewBinding.getInstance(e);null!=f?(a._selectTabByView(f),f.update()):this.logger.error("Could not update ViewBinding (declared open): \n"+e)}else switch(this._activeViewDefinitions[e]=c,Application.lock(this),a.constructor){case DockBinding:d?a.prepareNewView(c):a.prepareOpenView(c,b);break;case StageDialogBinding:d&&a.prepareNewView(c)}},StageBinding.prototype._dontView=function(a){null!=this._activeViewDefinitions[a]?delete this._activeViewDefinitions[a]:this.logger.debug("Could not unregister active view: "+a)},StageBinding.prototype.selectBrowserTab=function(){var a=this._decksBinding.getSelectedDeckBinding(),b=a.getBrowserTab();if(b&&!b.isSelected){var c=a.getSystemTree();null!=c&&c.setHandleToken(null),b.containingTabBoxBinding.select(b,!0)}},StageBinding.prototype.handleSelectedDockTab=function(a){},StageCrawler.prototype=new BindingCrawler,StageCrawler.prototype.constructor=StageCrawler,StageCrawler.superclass=BindingCrawler.prototype,StageCrawler.ID="stagecrawler",StageCrawler.MODE_MAXIMIZE="maximize",StageCrawler.MODE_UNMAXIMIZE="minimize",StageCrawler.prototype._construct=function(){StageCrawler.superclass._construct.call(this);var a=this;this.addFilter(function(b){var c=UserInterface.getBinding(b),d=null;if(c)switch(c.constructor){case StageSplitBoxBinding:case StageSplitPanelBinding:case StageSplitterBinding:switch(a.mode){case StageCrawler.MODE_MAXIMIZE:c.handleMaximization();break;case StageCrawler.MODE_UNMAXIMIZE:c.handleUnMaximization()}break;case DockBinding:d=NodeCrawler.SKIP_NODE}return d})},StageDialogSetBinding.prototype=new DialogSetBinding,StageDialogSetBinding.prototype.constructor=StageDialogSetBinding,StageDialogSetBinding.superclass=DialogSetBinding.prototype,StageDialogSetBinding.prototype.toString=function(){return"[StageDialogSetBinding]"},StageDialogSetBinding.prototype.getInstance=function(){var a=null;return this._dialogs.each(function(b){return b.isVisible||(a=b),null!=a}),a||(this._newInstance(),a=this._dialogs.getLast()),a.setModal(!1),a},StageDialogSetBinding.prototype.getModalInstance=function(){var a=this.getInstance();return a.setModal(!0),a},StageDialogSetBinding.prototype._newInstance=function(){var a=this.add(StageDialogBinding.newInstance(this.bindingDocument));this._dialogs.add(a),a.attach()},StageDialogBinding.prototype=new DialogBinding,StageDialogBinding.prototype.constructor=StageDialogBinding,StageDialogBinding.superclass=DialogBinding.prototype,StageDialogBinding.prototype.toString=function(){return"[StageDialogBinding]"},StageDialogBinding.prototype.onBindingRegister=function(){StageDialogBinding.superclass.onBindingRegister.call(this),this.addActionListener(PageBinding.ACTION_INITIALIZED),this.addActionListener(PageBinding.ACTION_DETACHED),this.addActionListener(DialogPageBinding.ACTION_RESPONSE),this.addActionListener(Binding.ACTION_INVALID),this.addActionListener(Binding.ACTION_VALID),this.addActionListener(ViewBinding.ACTION_LOADED),this.addActionListener(ViewBinding.ACTION_ONCLOSE),this.addActionListener(ViewBinding.ACTION_CLOSED),this.addActionListener(ErrorBinding.ACTION_INITIALIZE),this.addActionListener(PageBinding.ACTION_UPDATING),this.addActionListener(PageBinding.ACTION_UPDATED),this.addActionListener(DialogBinding.ACTION_CLOSE),this.subscribe(BroadcastMessages.KEY_ESCAPE)},StageDialogBinding.prototype.onBindingAttach=function(){StageDialogBinding.superclass.onBindingAttach.call(this),this.defaultSetup()},StageDialogBinding.prototype.prepareNewView=function(a){if(a instanceof DialogViewDefinition){var b=ViewBinding.newInstance(this.bindingDocument);if(b.setDefinition(a),b.setType(ViewBinding.TYPE_DIALOGVIEW),a.handler){if(!Interfaces.isImplemented(IDialogResponseHandler,a.handler))throw"IDialogResponseHandler not implemented";this._dialogResponseHandler=a.handler}this._viewBinding=b,this._body.add(b),b.attach(),b.initialize()}},StageDialogBinding.prototype.handleAction=function(a){StageDialogBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case PageBinding.ACTION_INITIALIZED:this._handleInitializedPageBinding(b),a.consume();break;case PageBinding.ACTION_DETACHED:b.bindingDocument==this._viewBinding.getContentDocument()&&(this._pageBinding=null),a.consume();break;case DialogPageBinding.ACTION_RESPONSE:b.response&&this._handleDialogPageResponse(b),a.consume();break;case Binding.ACTION_INVALID:this._disableDialogAcceptButton(!0),a.consume();break;case Binding.ACTION_VALID:this._disableDialogAcceptButton(!1),a.consume();break;case ViewBinding.ACTION_ONCLOSE:this.close(),a.consume();break;case ViewBinding.ACTION_CLOSED:this._isFirstPage=!0,a.consume();break;case ErrorBinding.ACTION_INITIALIZE:a.consume();break;case PageBinding.ACTION_UPDATING:this._isUpdating=!0,a.consume();break;case PageBinding.ACTION_UPDATED:this._isUpdating&&(this._isUpdating=!1,this._fit()),a.consume();break;case Binding.ACTION_UPDATED:this._isUpdating||this._fit(),a.consume();break;case DialogBinding.ACTION_CLOSE:b==this&&(this._viewBinding.dispose(),this.defaultSetup())}},StageDialogBinding.prototype.handleBroadcast=function(a,b){switch(StageDialogBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.KEY_ESCAPE:1==this.isVisible&&(PopupBinding.hasActiveInstances()||this._defaultClose())}},StageDialogBinding.prototype._fit=function(a){var b=new FitnessCrawler,c=new List;a&&(b.mode=FitnessCrawler.MODE_BRUTAL),b.crawl(this.bindingElement,c),b.dispose(),c.hasEntries()&&(c.reverse(),c.each(function(b){b.fit(a)}),c.dispose(),this._fitMe())},StageDialogBinding.prototype._fitMe=function(){if(null!=this._pageBinding){this._pageBinding.enableAutoHeightLayoutMode(!0),this._fixAutoHeight(this._pageBinding),this._pageBinding.enableAutoHeightLayoutMode(!1);var a=this.getDimension().h;this.reflex(!0);var b=this;if(this.getDimension().h==a){var b=this;setTimeout(function(){b.reflex(!0)},0)}}},StageDialogBinding.prototype._handleContextMenuItemBinding=function(a){var b=a.getProperty("cmd");switch(b){case DialogTitleBarPopupBinding.CMD_CLOSE:this._defaultClose();break;case DialogTitleBarPopupBinding.CMD_REFRESH:this._titlebar.setLabel(DockTabBinding.LABEL_TABLOADING),this._titlebar.setImage(DockTabBinding.IMG_TABLOADING),this._pageBinding=null,this._viewBinding.reload(Application.isDeveloperMode);break;case DialogTitleBarPopupBinding.CMD_VIEWSOURCE:case DialogTitleBarPopupBinding.CMD_VIEWGENERATED:case DialogTitleBarPopupBinding.CMD_VIEWSERIALIZED:this._viewSource(b);break;default:alert("TODO!")}},StageDialogBinding.prototype._viewSource=DockTabBinding.prototype._viewSource,StageDialogBinding.prototype._handleInitializedPageBinding=function(a){a.bindingDocument==this._viewBinding.getContentDocument()?(a instanceof DialogPageBinding&&(null==this._pageBinding&&this._parsePageBinding(a),this._pageBinding=a,"auto"==a.height&&(a.enableAutoHeightLayoutMode(!0),this._fixAutoHeight(a),a.enableAutoHeightLayoutMode(!1),this.reflex(!0))),StatusBar.state==StatusBar.BUSY&&StatusBar.clear(),this._isFirstPage&&(EventBroadcaster.broadcast(BroadcastMessages.VIEW_COMPLETED,this._viewBinding.getHandle()),
EventBroadcaster.broadcast(BroadcastMessages.STAGEDIALOG_OPENED))):a.isDialogSubPage&&(this._pageBinding.enableAutoHeightLayoutMode(!0),this._fixAutoHeight(a),this._pageBinding.enableAutoHeightLayoutMode(!1),this._fit(!0),this.reflex(!0)),this._isFirstPage=!1},StageDialogBinding.prototype._disableDialogAcceptButton=function(a){var b=this._viewBinding.getContentDocument().getElementById("dialogacceptbutton");if(b){var c=UserInterface.getBinding(b);c.setDisabled(a)}},StageDialogBinding.prototype._handleDialogPageResponse=function(a){null!=this._dialogResponseHandler&&this._dialogResponseHandler.handleDialogResponse(a.response,null!=a.result?a.result:null);var b=this;setTimeout(function(){b.close()},0)},StageDialogBinding.prototype.handleInvokedControl=function(a){a.controlType==ControlBinding.TYPE_CLOSE&&this._defaultClose(),StageDialogBinding.superclass.handleInvokedControl.call(this,a)},StageDialogBinding.prototype.buildDescendantBindings=function(){StageDialogBinding.superclass.buildDescendantBindings.call(this),this._titlebar.setContextMenu(app.bindingMap.dialogtitlebarpopup);var a=this;this._titlebar.handleAction=function(b){switch(b.type){case MenuItemBinding.ACTION_COMMAND:b.listener==this.contextMenuBinding&&a._handleContextMenuItemBinding(b.target)}}},StageDialogBinding.prototype._parsePageBinding=function(a){var b=a.label,c=a.image,d=a.width,e=a.height,f=a.controls,g=a.isResizable;if(b&&this.setLabel(b),c&&this.setImage(c),d||e){var h=this.getDimension(),i=new Dimension;this._isFirstPage?i.w=d?d:h.w:i.w=h.w,i.h=null!=e&&"auto"!=e?e:h.h,this._isResizable&&(i.h=top.window.innerHeight<i.h?top.window.innerHeight:i.h,i.w=top.window.innerWidth<i.w?top.window.innerWidth:i.w),this.setDimension(i)}if(f){this.controlBindings[ControlBinding.TYPE_MAXIMIZE].hide(),this.controlBindings[ControlBinding.TYPE_MINIMIZE].hide(),this.controlBindings[ControlBinding.TYPE_CLOSE].hide();for(var j,k=new List(f.split(" "));null!=(j=k.getNext());)this.controlBindings[j].show()}g!=this._isResizable&&this.setResizable(g),"auto"==e&&this._fixAutoHeight(a),a==this._pageBinding&&this.centerOnScreen(),this.isOpen||(this.reflex(!0),this.open(!0))},StageDialogBinding.prototype._fixAutoHeight=function(a){var b=this.getDimension(),c=0,d=0;a.isDialogSubPage&&(a=this._pageBinding),c=this._isFirstPage&&null!=a.width?a.width:b.w,d=a.bindingElement.offsetHeight,d+=this._titlebar.bindingElement.offsetHeight;var e=CSSComputer.getPadding(this.bindingElement),f=CSSComputer.getBorder(this.bindingElement);d+=e.top+e.bottom,d+=f.top+f.bottom,null!=a.minheight&&d<a.minheight&&(d=a.minheight),d=top.window.innerHeight<d?top.window.innerHeight:d,this.setDimension(new Dimension(c,d)),this.startPoint=this.getPosition(),this._setComputedPosition(new Point(0,0))},StageDialogBinding.prototype._defaultClose=function(){null!=this._dialogResponseHandler&&this._dialogResponseHandler.handleDialogResponse(Dialog.RESPONSE_CANCEL),this.close()},StageDialogBinding.prototype.open=function(){StageDialogBinding.superclass.open.call(this),1==this.isVisible&&this._viewBinding.onActivate()},StageDialogBinding.prototype.defaultSetup=function(){this.setImage(LabelBinding.DEFAULT_IMAGE),this.setLabel(""),this.setDimension(new Dimension(DialogBinding.DEFAULT_WIDTH,DialogBinding.DEFAULT_HEIGHT)),this.controlBindings[ControlBinding.TYPE_MAXIMIZE].hide(),this.controlBindings[ControlBinding.TYPE_MINIMIZE].hide(),this.controlBindings[ControlBinding.TYPE_CLOSE].show(),this._pageBinding=null,this._dialogResponseHandler=null,this._isResizable||this.setResizable(!0)},StageDialogBinding.prototype.setPosition=function(a){StageDialogBinding.superclass.setPosition.call(this,a),this._body.dispatchAction(Binding.ACTION_POSITIONCHANGED)},StageDialogBinding.prototype.setDimension=function(a){StageDialogBinding.superclass.setDimension.call(this,a),this._body.dispatchAction(Binding.ACTION_DIMENSIONCHANGED)},StageDialogBinding.prototype.activate=function(){this.isActive||(StageDialogBinding.superclass.activate.call(this),this._viewBinding.onActivate())},StageDialogBinding.prototype.deActivate=function(){1==this.isActive&&(StageDialogBinding.superclass.deActivate.call(this),this._viewBinding.onDeactivate())},StageDialogBinding.prototype.getContextContainer=function(){return this._contextContainer},StageDialogBinding.prototype.setContextContainer=function(a){this._contextContainer=a},StageDialogBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:dialog",a),c=UserInterface.registerBinding(b,StageDialogBinding);return c.setProperty("controls","minimize maximize close"),c},StageDecksBinding.prototype=new DecksBinding,StageDecksBinding.prototype.constructor=StageDecksBinding,StageDecksBinding.superclass=DecksBinding.prototype,StageDecksBinding.NODENAME_DECK="stagedeck",StageDecksBinding.ACTION_INITIALIZED="stagedecks initialized",StageDecksBinding.prototype.toString=function(){return"[StageDecksBinding]"},StageDecksBinding.prototype.onBindingInitialize=function(){StageDecksBinding.superclass.onBindingInitialize.call(this),this.dispatchAction(StageDecksBinding.ACTION_INITIALIZED)},StageDecksBinding.prototype.mountDefinition=function(a){var b=StageDeckBinding.newInstance(this.bindingDocument);b.handle=a.handle,b.perspectiveNode=a.node,b.definition=a,Application.isTestEnvironment&&b.setProperty("data-qa","perspective"+a.label),this._decks[b.handle]=b,this.add(b),b.attach()},StageDecksBinding.prototype.setSelectionByHandle=function(a){var b=this._decks[a];StageBinding.perspectiveNode=b.perspectiveNode,this.select(b)},StageDeckBinding.prototype=new DeckBinding,StageDeckBinding.prototype.constructor=StageDeckBinding,StageDeckBinding.superclass=DeckBinding.prototype,StageDeckBinding.ACTION_LOADED="stagedeck loaded",StageDeckBinding.NODENAME_DECKS="stagedecks",StageDeckBinding.DEFAULT_URL="${root}/content/misc/stage/stagedeck.aspx",StageDeckBinding.CLASSNAME_TOOLS_OPEN="toolsopen",StageDeckBinding.prototype.toString=function(){return"[StageDeckBinding]"},StageDeckBinding.prototype.onBindingRegister=function(){StageDeckBinding.superclass.onBindingRegister.call(this),StageBoxHandlerAbstraction.onBindingRegister.call(this),this._dockBindings=new Map,this.addActionListener(WindowBinding.ACTION_LOADED),this.addActionListener(TabBoxBinding.ACTION_ATTACHED),this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHALL)},StageDeckBinding.prototype.handleAction=function(a){StageDeckBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case WindowBinding.ACTION_LOADED:b==this.windowBinding&&(top.app.bindingMap.stagedeckscover.hide(),this.removeActionListener(WindowBinding.ACTION_LOADED),this.addActionListener(StageSplitBoxBinding.ACTION_DOCK_EMPTIED),this.addActionListener(StageSplitBoxBinding.ACTION_DOCK_OPENED),this.dispatchAction(StageDeckBinding.ACTION_LOADED),a.consume());break;case TabBoxBinding.ACTION_ATTACHED:b instanceof DockBinding&&(this._dockBindings.set(b.reference,b),b.perspectiveNode=this.perspectiveNode);break;case StageSplitBoxBinding.ACTION_DOCK_OPENED:this._dockBindingCount++,a.consume();break;case StageSplitBoxBinding.ACTION_DOCK_EMPTIED:this._dockBindingCount--,a.consume()}StageBoxHandlerAbstraction.handleAction.call(this,a),StageDeckBinding.superclass.handleAction.call(this,a)},StageDeckBinding.prototype.iterateContainedStageBoxBindings=function(a){var b=new StageCrawler;b.mode=a,b.crawl(this.windowBinding.getContentDocument().body),b.dispose()},StageDeckBinding.prototype.select=function(){this._isStageDeckBindingInitialized?EventBroadcaster.broadcast(BroadcastMessages.STAGEDECK_CHANGED,this.handle):this.initialize(),StageDeckBinding.superclass.select.call(this),1==this._isRefreshRequired&&(this._refreshTree(),this._isRefreshRequired=!1)},StageDeckBinding.prototype.getDockBindingByReference=function(a){return this._dockBindings.get(a)},StageDeckBinding.prototype.isPlaceholder=function(){return null!=this.path},StageDeckBinding.prototype.initialize=function(){if(!this._isStageDeckBindingInitialized){this.path=this.perspectiveNode.getPropertyBag()?this.perspectiveNode.getPropertyBag().Path:null,this.isDefaultStageDeck=void 0==this.path,top.app.bindingMap.stagedeckscover.show(),this.windowBinding=this.add(WindowBinding.newInstance(this.bindingDocument));var a=this.isDefaultStageDeck?StageDeckBinding.DEFAULT_URL+"?handle="+this.handle:this.path;this.windowBinding.setURL(a),this.windowBinding.attach(),this._isStageDeckBindingInitialized=!0,this.isDefaultStageDeck||(top.app.bindingMap.stagedeckscover.hide(),this.dispatchAction(StageDeckBinding.ACTION_LOADED),this.dispatchAction(StageBinding.ACTION_DECK_LOADED))}},StageDeckBinding.prototype.getBrowserTab=function(){return this._browserTab},StageDeckBinding.prototype.getBrowserPage=function(){var a=this.getBrowserTab();if(null==a)return null;var b=a.getAssociatedView();if(null==b)return null;var c=b.getContentWindow();return null==c?null:null==c.bindingMap?null:c.bindingMap.browserpage},StageDeckBinding.prototype.getSystemTree=function(){var a=null,b=this.getBrowserPage();return b&&(a=b.getSystemTree()),a},StageDeckBinding.prototype.handleBroadcast=function(a,b){switch(StageDeckBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.SYSTEMTREEBINDING_REFRESHALL:1==this.isSelected?this._refreshTree():null!=this.perspectiveNode&&(this._isRefreshRequired=!0);break;case BroadcastMessages.SYSTEMTREEBINDING_REFRESHED:this.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED),this.select()}},StageDeckBinding.prototype._refreshTree=function(){this.perspectiveNode&&this.perspectiveNode.getEntityToken&&(this.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESH,this.perspectiveNode.getEntityToken()))},StageDeckBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:stagedeck",a),c=UserInterface.registerBinding(b,StageDeckBinding);return c},StageDeckRootBinding.prototype=new RootBinding,StageDeckRootBinding.prototype.constructor=StageDeckRootBinding,StageDeckRootBinding.superclass=RootBinding.prototype,StageDeckRootBinding.DEFAULT_TEMPLATE="defaultstagedeck.xml",StageDeckRootBinding.prototype.toString=function(){return"[StageDeckRootBinding]"},StageSplitBoxBinding.prototype=new SplitBoxBinding,StageSplitBoxBinding.prototype.constructor=StageSplitBoxBinding,StageSplitBoxBinding.superclass=SplitBoxBinding.prototype,StageSplitBoxBinding.ACTION_HIDE="stagesplitboxbinding hide",StageSplitBoxBinding.ACTION_SHOW="stagesplitboxbinding show",StageSplitBoxBinding.ACTION_DOCK_EMPTIED="stagesplitbox says dock emptied",StageSplitBoxBinding.ACTION_DOCK_OPENED="stagesplitbox says dock opened",StageSplitBoxBinding.prototype.toString=function(){return"[StageSplitBoxBinding]"},StageSplitBoxBinding.prototype.onBindingRegister=function(){StageSplitBoxBinding.superclass.onBindingRegister.call(this),StageBoxAbstraction.onBindingRegister.call(this),this.addActionListener(DockBinding.ACTION_EMPTIED,this),this.addActionListener(DockBinding.ACTION_OPENED,this),this.addActionListener(StageSplitBoxBinding.ACTION_SHOW,this),this.addActionListener(StageSplitBoxBinding.ACTION_HIDE,this)},StageSplitBoxBinding.prototype.handleAction=function(a){StageSplitBoxBinding.superclass.handleAction.call(this,a),StageBoxAbstraction.handleAction.call(this,a);var b=a.target,c=null,d=null;switch(a.type){case DockBinding.ACTION_EMPTIED:d=this.getChildBindingByLocalName("splitter"),d.isVisible&&d.hide(),c=this.getDescendantBindingsByLocalName("dock"),c.getFirst().isEmpty&&c.getLast().isEmpty?c.getFirst().type!=DockBinding.TYPE_EDITORS&&(this.dispatchAction(StageSplitBoxBinding.ACTION_HIDE),this.hide()):(this.flex(),this.invokeLayout()),this.dispatchAction(StageSplitBoxBinding.ACTION_DOCK_EMPTIED),a.consume();break;case DockBinding.ACTION_OPENED:c=this.getDescendantBindingsByLocalName("dock"),c.getFirst().isEmpty||c.getLast().isEmpty||(d=this.getChildBindingByLocalName("splitter"),d.isVisible||d.show()),this.isVisible||(this.show(),this.dispatchAction(StageSplitBoxBinding.ACTION_SHOW)),this.flex(),this.invokeLayout(),this.dispatchAction(StageSplitBoxBinding.ACTION_DOCK_OPENED),a.consume();break;case StageSplitBoxBinding.ACTION_HIDE:b!=this&&(d=this.getChildBindingByLocalName("splitter"),d.isVisible&&d.hide(),this.invokeLayout(),a.consume());break;case StageSplitBoxBinding.ACTION_SHOW:if(b!=this){var e=this.getChildBindingsByLocalName("splitpanel");e.getFirst().isVisible&&e.getLast().isVisible&&(d=this.getChildBindingByLocalName("splitter"),d.isVisible||d.show()),this.invokeLayout(),a.consume()}}},StageSplitBoxBinding.prototype.handleMaximization=function(){StageBoxAbstraction.handleMaximization.call(this)};StageSplitBoxBinding.prototype.handleUnMaximization=function(){StageBoxAbstraction.handleUnMaximization.call(this)};StageSplitBoxBinding.prototype.flex=function(){null==this.isMaximizedForReal&&StageSplitBoxBinding.superclass.flex.call(this)},StageSplitBoxBinding.prototype.handleCrawler=function(a){switch(StageSplitBoxBinding.superclass.handleCrawler.call(this,a),a.id){case FlexBoxCrawler.ID:0==this.isMaximizedForReal&&(a.response=NodeCrawler.SKIP_CHILDREN)}},StageSplitBoxBinding.prototype.hasBothPanelsVisible=function(){var a=this.getChildBindingsByLocalName("splitpanel");return a.getFirst().isVisible&&a.getLast().isVisible},StageSplitBoxBinding.prototype.hasBothPanelsFixed=function(){var a=this.getChildBindingsByLocalName("splitpanel");return a.getFirst().isFixed&&a.getLast().isFixed},StageSplitPanelBinding.prototype=new SplitPanelBinding,StageSplitPanelBinding.prototype.constructor=StageSplitPanelBinding,StageSplitPanelBinding.superclass=SplitPanelBinding.prototype,StageSplitPanelBinding.ACTION_LAYOUTUPDATE="stagesplitpanel layout changed",StageSplitPanelBinding.prototype.toString=function(){return"[StageSplitPanelBinding]"},StageSplitPanelBinding.prototype.onBindingRegister=function(){StageSplitPanelBinding.superclass.onBindingRegister.call(this),StageBoxAbstraction.onBindingRegister.call(this),this.addActionListener(DockBinding.ACTION_OPENED,this),this.addActionListener(DockBinding.ACTION_EMPTIED,this),this.addActionListener(StageSplitBoxBinding.ACTION_HIDE,this),this.addActionListener(StageSplitBoxBinding.ACTION_SHOW,this),this.addActionListener(StageSplitPanelBinding.ACTION_LAYOUTUPDATE,this)},StageSplitPanelBinding.prototype.handleAction=function(a){switch(StageSplitPanelBinding.superclass.handleAction.call(this,a),StageBoxAbstraction.handleAction.call(this,a),a.type){case DockBinding.ACTION_EMPTIED:case StageSplitBoxBinding.ACTION_HIDE:1==this.isMaximized&&this.normalize();var b=this.getContainedDock();if(b&&b.type==DockBinding.TYPE_EDITORS?(this._invisibilize(!0),a.type==StageSplitBoxBinding.ACTION_HIDE&&a.consume()):(this.hide(),1==this.isFixed&&this.setFix(!1)),a.type==DockBinding.ACTION_EMPTIED){var c=this;setTimeout(function(){c.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE)},0)}break;case DockBinding.ACTION_OPENED:case StageSplitBoxBinding.ACTION_SHOW:var b=this.getContainedDock();b&&b.type==DockBinding.TYPE_EDITORS?(this._invisibilize(!1),a.type==StageSplitBoxBinding.ACTION_SHOW&&a.consume()):(this.show(),1==this.isFixed&&this.setFix(!1));break;case StageSplitPanelBinding.ACTION_LAYOUTUPDATE:var d=a.target;if(d!=this&&d.getContainedDock()&&this._containingSplitBoxBinding.getOrient()==SplitBoxBinding.ORIENT_VERTICAL){var e=d._containingSplitBoxBinding;if(e.getOrient()==SplitBoxBinding.ORIENT_HORIZONTAL){var f=e.getChildBindingsByLocalName("splitpanel"),g=f.getFirst(),h=f.getLast();1==this.isFixed?g.isFixed&&h.isFixed&&(e.hasBothPanelsVisible()||!d.isMinimizedForReal)||(this.setFix(!1),a.consume(),this.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE)):(e.hasBothPanelsFixed()||!e.hasBothPanelsVisible()&&d.isMinimizedForReal)&&(this.setFix(d.getContainedDock().getHeight()),a.consume(),this.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE))}}}},StageSplitPanelBinding.prototype.handleMaximization=function(){StageBoxAbstraction.handleMaximization.call(this);var a=this.getContainedDock();a&&(1==this.isMaximizePrepared||a.interceptDisplayChange(!1))},StageSplitPanelBinding.prototype.handleUnMaximization=function(){StageBoxAbstraction.handleUnMaximization.call(this);var a=this.getContainedDock();a&&(a.type==DockBinding.TYPE_EDITORS&&a.isEmpty&&this._invisibilize(!0),1==this.isMaximized?this.normalize():a.interceptDisplayChange(!0))},StageSplitPanelBinding.prototype.maximize=function(){1==this.isMinimized&&this.normalize(!0),StageSplitPanelBinding.superclass.maximize.call(this),this.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE);var a=this.getContainedDock();a&&(a.activate(),EventBroadcaster.broadcast(BroadcastMessages.DOCK_MAXIMIZED,a))},StageSplitPanelBinding.prototype.minimize=function(){var a=this._containingSplitBoxBinding.getOrient()==SplitBoxBinding.ORIENT_HORIZONTAL,b=this.getContainedDock();b&&(b.collapse(a),a?this.setFix(b.getWidth()):this.setFix(b.getHeight())),1==this.isMaximized&&this.normalize(!0),StageSplitPanelBinding.superclass.minimize.call(this),this.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE),b&&b.isActive&&(b.deActivate(),EventBroadcaster.broadcast(BroadcastMessages.DOCK_MINIMIZED,b))},StageSplitPanelBinding.prototype.normalize=function(a){var b=this._containingSplitBoxBinding.getOrient()==SplitBoxBinding.ORIENT_HORIZONTAL,c=this.getContainedDock();c&&1==this.isMinimized&&(c.unCollapse(b),this.setFix(!1)),StageSplitPanelBinding.superclass.normalize.call(this),a||(this.dispatchAction(StageSplitPanelBinding.ACTION_LAYOUTUPDATE),c&&(c.activate(),EventBroadcaster.broadcast(BroadcastMessages.DOCK_NORMALIZED,c)))},StageSplitPanelBinding.prototype.getContainedDock=function(){return this.getChildBindingByLocalName("dock")},StageSplitPanelBinding.prototype.invisibilize=function(a){var b=!0,c=this.getContainedDock();null!=c&&c.type==DockBinding.TYPE_EDITORS&&1==c.isEmpty&&(b=!1),1==b&&this._invisibilize(a)},StageSplitPanelBinding.prototype._invisibilize=function(a){a!=this._isInvisibilized&&(a?this.bindingElement.style.visibility="hidden":this.bindingElement.style.visibility="visible",this._isInvisibilized=!this._isInvisibilized)},StageSplitterBinding.prototype=new SplitterBinding,StageSplitterBinding.prototype.constructor=StageSplitterBinding,StageSplitterBinding.superclass=SplitterBinding.prototype,StageSplitterBinding.prototype.toString=function(){return"[StageSplitterBinding]"},StageSplitterBinding.prototype.handleMaximization=function(){this._wasHidden=!this.isVisible,this.bindingElement.style.display="none"},StageSplitterBinding.prototype.handleUnMaximization=function(){this._wasHidden||(this.bindingElement.style.display="block",this._wasHidden=null)},StageSplitterBinding.prototype.onDragStart=function(a){var b=top.app.bindingMap.stagesplittercover,c=this._containingSplitBoxBinding.getOrient();switch(c){case SplitBoxBinding.ORIENT_HORIZONTAL:b.bindingElement.style.cursor="e-resize";break;case SplitBoxBinding.ORIENT_VERTICAL:b.bindingElement.style.cursor="n-resize"}b.show();var d=top.app.bindingMap.stagesplitterbody;d.setPosition(this.getPosition()),d.setDimension(this.getDimension()),d.setOrient(c),d.show(),this.isDragging=!0},StageSplitterBinding.prototype.onDrag=function(a){this._updateSplitterBodyPosition(this.getEvaluatedDiff(a))},StageSplitterBinding.prototype.onDragStop=function(a){this._updateSplitterBodyPosition(this.getEvaluatedDiff(a)),top.app.bindingMap.stagesplitterbody.hide(),top.app.bindingMap.stagesplittercover.hide(),this.isDragging=!1,this.offset=this._containingSplitBoxBinding.isHorizontalOrient()?a.x:a.y,this.dispatchAction(SplitterBinding.ACTION_DRAGGED)},StageSplitterBinding.prototype._updateSplitterBodyPosition=function(a){var b=this.getPosition();b.x+=a.x,b.y+=a.y,app.bindingMap.stagesplitterbody.setPosition(b)},StageSplitterBinding.prototype.getPosition=function(){return DOMUtil.getUniversalPosition(this.bindingElement)},StageSplitterBinding.prototype.getDimension=function(){return new Dimension(this.bindingElement.offsetWidth,this.bindingElement.offsetHeight)},StageSplitterBodyBinding.prototype=new Binding,StageSplitterBodyBinding.prototype.constructor=StageSplitterBodyBinding,StageSplitterBodyBinding.superclass=Binding.prototype,StageSplitterBodyBinding.prototype.toString=function(){return"[StageSplitterBodyBinding]"},StageSplitterBodyBinding.prototype.setOrient=function(a){this._orient=a,this.attachClassName(a)},StageSplitterBodyBinding.prototype.setPosition=function(a){var b=!0,c=!0;switch(this._orient){case SplitBoxBinding.ORIENT_HORIZONTAL:c=!1;break;case SplitBoxBinding.ORIENT_VERTICAL:b=!1}b&&(this.bindingElement.style.left=a.x+"px"),c&&(this.bindingElement.style.top=a.y+"px")},StageSplitterBodyBinding.prototype.setDimension=function(a){this.bindingElement.style.width=a.w+"px",this.bindingElement.style.height=a.h+"px"},StageSplitterBodyBinding.prototype.show=function(){this.bindingElement.style.display="block"},StageSplitterBodyBinding.prototype.hide=function(){this.bindingElement.style.display="none",this.detachClassName(SplitBoxBinding.ORIENT_HORIZONTAL),this.detachClassName(SplitBoxBinding.ORIENT_VERTICAL),this._orient=null},StageBoxAbstraction.ACTION_HIDDENSTUFF_UPDATED="hidden stagebox stuff updated",StageBoxAbstraction.onBindingRegister=function(){this.addActionListener(ControlBoxBinding.ACTION_MAXIMIZE),this.addActionListener(ControlBoxBinding.ACTION_MINIMIZE),this.addActionListener(ControlBoxBinding.ACTION_NORMALIZE),this.addActionListener(TabBoxBinding.ACTION_UPDATED)},StageBoxAbstraction.handleAction=function(a){switch(a.type){case ControlBoxBinding.ACTION_MAXIMIZE:this.isMaximizePrepared=!0;break;case ControlBoxBinding.ACTION_MINIMIZE:this.isMinimizedForReal=!0;break;case ControlBoxBinding.ACTION_NORMALIZE:this.isMaximizePrepared=!1,this.isMinimizedForReal=null;break;case TabBoxBinding.ACTION_UPDATED:a.target instanceof DockBinding&&(this.isHiddenForReal?this.dispatchAction(StageBoxAbstraction.ACTION_HIDDENSTUFF_UPDATED):this.isMinimizedForReal&&this.normalize()),a.consume()}},StageBoxAbstraction.handleMaximization=function(){if(1==this.isMaximizePrepared)if(this.isMaximizedForReal=!0,this.isHiddenForReal=!1,this.isFlexible=!1,1==Client.isMozilla){var a=this.bindingElement.style;a.position="absolute",a.width="100%",a.height="100%",a.top="0",a.left="0"}else this.attachClassName("maximized"),this instanceof StageSplitPanelBinding&&StageBoxAbstraction._emulateBasicCSS(this,!0);else this.isMaximizedForReal=!1,this.isHiddenForReal=!0,this instanceof StageSplitPanelBinding&&this.invisibilize(!0)},StageBoxAbstraction.handleUnMaximization=function(){if(1==this.isMaximizedForReal)if(this.isFlexible=!0,1==Client.isMozilla){var a=this.bindingElement.style;a.position="relative",a.width="auto",a.height="auto",a.top="auto",a.left="auto"}else this.detachClassName("maximized"),this instanceof StageSplitPanelBinding&&StageBoxAbstraction._emulateBasicCSS(this,!1);else this instanceof StageSplitPanelBinding&&this.invisibilize(!1);this.isMaximizePrepared=!1,this.isMaximizedForReal=null,this.isHiddenForReal=null},StageBoxAbstraction._emulateBasicCSS=function(a,b){var c=a.bindingElement.style,d=a.bindingElement.parentNode,e=a._containingSplitBoxBinding;1==Client.isExplorer&&(b?(a._unmodifiedFlexMethod=a.flex,a.flex=function(){c.width=d.offsetWidth+"px",c.height=d.offsetHeight+"px"}):(c.width="100%",c.height="100%",e.isHorizontalOrient()||setTimeout(function(){c.width="auto",c.height="auto",e.reflex(!0)},0),a.flex=a._unmodifiedFlexMethod,a._unmodifiedFlexMethod=null))},StageBoxHandlerAbstraction.onBindingRegister=function(){this.addActionListener(ControlBoxBinding.ACTION_MAXIMIZE,this),this.addActionListener(ControlBoxBinding.ACTION_NORMALIZE,this),this.addActionListener(StageBoxAbstraction.ACTION_HIDDENSTUFF_UPDATED,this),this.addActionListener(StageSplitPanelBinding.ACTION_LAYOUTUPDATE,this)},StageBoxHandlerAbstraction.handleAction=function(a){var b=a.target;switch(a.type){case ControlBoxBinding.ACTION_MAXIMIZE:case ControlBoxBinding.ACTION_NORMALIZE:b instanceof StageSplitPanelBinding&&(StageBoxHandlerAbstraction.handleControlBoxAction.call(this,a),a.consume());break;case StageBoxAbstraction.ACTION_HIDDENSTUFF_UPDATED:this.isSubPanelMaximized&&(this.iterateContainedStageBoxBindings(StageCrawler.MODE_UNMAXIMIZE),this.isSubPanelMaximized=!1),a.consume();break;case StageSplitPanelBinding.ACTION_LAYOUTUPDATE:}},StageBoxHandlerAbstraction.handleControlBoxAction=function(a){var b=null;switch(a.type){case ControlBoxBinding.ACTION_MAXIMIZE:this.isSubPanelMaximized||(b=StageCrawler.MODE_MAXIMIZE,this.isSubPanelMaximized=!0);break;case ControlBoxBinding.ACTION_NORMALIZE:this.isSubPanelMaximized&&(b=StageCrawler.MODE_UNMAXIMIZE,this.isSubPanelMaximized=!1)}null!=b&&this.iterateContainedStageBoxBindings(b)},StageMenuBarBinding.prototype=new MenuBarBinding,StageMenuBarBinding.prototype.constructor=StageMenuBarBinding,StageMenuBarBinding.superclass=MenuBarBinding.prototype,StageMenuBarBinding.prototype.toString=function(){return"[StageMenuBarBinding]"},StageMenuBarBinding.prototype.onBindingAttach=function(){if(StageMenuBarBinding.superclass.onBindingAttach.call(this),System.hasActivePerspectives)this.addActionListener(MenuItemBinding.ACTION_COMMAND);else{var a=this;setTimeout(function(){for(var b=a.getChildBindingsByLocalName("menu");b.hasNext();){var c=b.getNext();"usermenu"!=c.bindingElement.id&&Binding.prototype.hide.call(c)}},0)}},StageMenuBarBinding.prototype.handleAction=function(a){switch(StageMenuBarBinding.superclass.handleAction.call(this,a),a.type){case MenuItemBinding.ACTION_COMMAND:var b=a.target.associatedSystemAction;Application.isLoggedIn&&(this._rootNode||(this._rootNode=System.getRootNode()),b&&SystemAction.invoke(b,this._rootNode)),a.consume()}},StageViewMenuItemBinding.prototype=new MenuItemBinding,StageViewMenuItemBinding.prototype.constructor=StageViewMenuItemBinding,StageViewMenuItemBinding.superclass=MenuItemBinding.prototype,StageViewMenuItemBinding.prototype.toString=function(){return"[StageViewMenuItemBinding]"},StageViewMenuItemBinding.prototype.onBindingAttach=function(){StageViewMenuItemBinding.superclass.onBindingAttach.call(this),this.type==MenuItemBinding.TYPE_CHECKBOX&&(this.subscribe(BroadcastMessages.VIEW_OPENED),this.subscribe(BroadcastMessages.VIEW_CLOSED),this.subscribe(BroadcastMessages.STAGE_INITIALIZED))},StageViewMenuItemBinding.prototype.buildDOMContent=function(){StageViewMenuItemBinding.superclass.buildDOMContent.call(this);var a=this.getProperty("handle");if(!a)throw new Error("StageViewMenuItemBinding: missing handle");this._handle=a,StageBinding.isViewOpen(a)&&this.type==MenuItemBinding.TYPE_CHECKBOX&&this.check(!0),this.oncommand=function(){var b=this;Application.lock(b),setTimeout(function(){StageBinding.handleViewPresentation(a),Application.unlock(b)},Client.hasTransitions?Animation.DEFAULT_TIME:0)}},StageViewMenuItemBinding.prototype.setHandle=function(a){this.setProperty("handle",a)},StageViewMenuItemBinding.prototype.handleBroadcast=function(a,b){if(StageViewMenuItemBinding.superclass.handleBroadcast.call(this,a,b),this.type==MenuItemBinding.TYPE_CHECKBOX)switch(a){case BroadcastMessages.STAGE_INITIALIZED:this.isChecked&&this.fireCommand();break;case BroadcastMessages.VIEW_OPENED:b==this._handle&&this.check(!0);break;case BroadcastMessages.VIEW_CLOSED:b==this._handle&&this.uncheck(!0)}},StageViewMenuItemBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menuitem",a);return UserInterface.registerBinding(b,StageViewMenuItemBinding),UserInterface.getBinding(b)},StageStatusBarBinding.prototype=new ToolBarBinding,StageStatusBarBinding.prototype.constructor=StageStatusBarBinding,StageStatusBarBinding.superclass=ToolBarBinding.prototype,StageStatusBarBinding.prototype.toString=function(){return"[StageStatusBarBinding]"},StageStatusBarBinding.prototype.onBindingInitialize=function(){this._label=this.bindingWindow.bindingMap.statusbarlabel,StatusBar.initialize(this),StageStatusBarBinding.superclass.onBindingInitialize.call(this)},StageStatusBarBinding.prototype.setLabel=function(a){this._label.setLabel(a)},StageStatusBarBinding.prototype.setImage=function(a){this._label.setImage(a)},StageStatusBarBinding.prototype.clear=function(){this._label.setLabel(null),this._label.setImage(!1)},StageStatusBarBinding.prototype.startFadeOut=function(a){this.logger.debug("START FADEOUT")},ExplorerBinding.prototype=new FlexBoxBinding,ExplorerBinding.prototype.constructor=ExplorerBinding,ExplorerBinding.superclass=FlexBoxBinding.prototype,ExplorerBinding.ACTION_INITIALIZED="explorer initialized",ExplorerBinding.PERSPECTIVE_CONTENT="Content",ExplorerBinding.PERSPECTIVE_MEDIA="Media",ExplorerBinding.PERSPECTIVE_DATA="Datas",ExplorerBinding.PERSPECTIVE_DESIGN="Design",ExplorerBinding.PERSPECTIVE_FUNCTIONS="Functions",ExplorerBinding.PERSPECTIVE_USERS="Users",ExplorerBinding.PERSPECTIVE_SYSTEM="System",ExplorerBinding.bindingInstance=null,ExplorerBinding.getFocusedTreeNodeBindings=function(){var a=ExplorerBinding.bindingInstance.getSelectedDeckBinding(),b=a.getSystemTree();if(!b)return new List;var c=b.getFocusedTreeNodeBindings();return!c.hasEntries()&&StageBinding.treeSelector&&(c=StageBinding.treeSelector.getFocusedTreeNodeBindings()),c},ExplorerBinding.saveFocusedNodes=function(){var a=this.getFocusedTreeNodeBindings();LocalStore.focuseNodes.clear(),a.each(function(a){LocalStore.focuseNodes.add(a.node)})},ExplorerBinding.restoreFocuseNodes=function(){var a=LocalStore.focuseNodes.getEntityTokens(),b=ExplorerBinding.bindingInstance.getSelectedDeckBinding(),c=b.getSystemTree();a=new List(TreeService.GetCurrentLocaleEntityTokens(a.toArray())),a.each(function(a){c._focusTreeNodeByEntityToken(a)}),LocalStore.focuseNodes.clear()},ExplorerBinding.prototype.toString=function(){return"[ExplorerBinding]"},ExplorerBinding.prototype.onBindingAttach=function(){ExplorerBinding.superclass.onBindingAttach.call(this),this._menuBinding=this.addMember(this.getDescendantBindingByLocalName("explorermenu"))},ExplorerBinding.prototype.onBindingRegister=function(){ExplorerBinding.superclass.onBindingRegister.call(this),this.setContextMenu(top.app.bindingMap.explorerpopup)},ExplorerBinding.prototype.onBindingInitialize=function(){ExplorerBinding.bindingInstance=this,ExplorerBinding.superclass.onBindingInitialize.call(this),this.dispatchAction(ExplorerBinding.ACTION_INITIALIZED),this._menuBinding.updateScroll()},ExplorerBinding.prototype.setSelectionByHandle=function(a){this._menuBinding.setSelectionByHandle(a)},ExplorerBinding.prototype.getSelectionHandle=function(){return this._menuBinding.getSelectionHandle()},ExplorerBinding.prototype.setSelectionDefault=function(){this._menuBinding.setSelectionDefault()},ExplorerBinding.prototype.getPerspectives=function(){return this._menuBinding.getButtons()},ExplorerBinding.prototype.getSelectedDeckBinding=function(){return app.bindingMap.stagedecks.getSelectedDeckBinding()},ExplorerBinding.prototype.mountDefinition=function(a){a instanceof SystemViewDefinition&&this._menuBinding.mountDefinition(a)},ExplorerMenuBinding.prototype=new Binding,ExplorerMenuBinding.prototype.constructor=ExplorerMenuBinding,ExplorerMenuBinding.superclass=Binding.prototype,ExplorerMenuBinding.ACTION_SELECTIONCHANGED="explorermenu selectionchanged",ExplorerMenuBinding.SCROLLUP_CLASSNAME="scrollup",ExplorerMenuBinding.SCROLLDOWN_CLASSNAME="scrolldown",ExplorerMenuBinding.prototype.toString=function(){return"[ExplorerMenuBinding]"},ExplorerMenuBinding.prototype.onBindingRegister=function(){ExplorerMenuBinding.superclass.onBindingRegister.call(this),this.addActionListener(RadioGroupBinding.ACTION_SELECTIONCHANGED,this),this.subscribe(this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST),this.addEventListener(DOMEvents.SCROLL)},ExplorerMenuBinding.prototype.onBindingAttach=function(){ExplorerMenuBinding.superclass.onBindingAttach.call(this),this.addMember(this.getChildBindingByLocalName("explorertoolbar"));
},ExplorerMenuBinding.prototype.onMemberInitialize=function(a){switch(a.constructor){case ExplorerToolBarBinding:this._group=a.getToolBarGroupByIndex(0)}ExplorerMenuBinding.superclass.onMemberInitialize.call(this,a)},ExplorerMenuBinding.prototype.mountDefinition=function(a){this._buttons.set(a.handle,this._mountMinButton(a)),this._index++},ExplorerMenuBinding.prototype.getButtons=function(){return this._buttons},ExplorerMenuBinding.prototype._mountMinButton=function(a){var b=ExplorerToolBarButtonBinding.newInstance(this.bindingDocument,ExplorerToolBarButtonBinding.TYPE_NORMAL);return b.setLabel(a.label),b.setToolTip(a.label),b.handle=a.handle,b.node=a.node,Application.isTestEnvironment&&b.setProperty("data-qa",a.node.getTag()),this._group.add(b),this._list.add(b),b.attach(),b},ExplorerMenuBinding.prototype.handleAction=function(a){switch(ExplorerMenuBinding.superclass.handleAction.call(this,a),a.type){case RadioGroupBinding.ACTION_SELECTIONCHANGED:this.collapse();var b=a.target,c=b.getCheckedButtonBinding(),d=c.handle;this._selectedHandle=d,this._selectedTag=c.node.getTag(),this.dispatchAction(ExplorerMenuBinding.ACTION_SELECTIONCHANGED),a.consume()}},ExplorerMenuBinding.prototype.handleEvent=function(a){switch(ExplorerMenuBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.SCROLL:this.updateScroll()}},ExplorerMenuBinding.prototype.handleBroadcast=function(a,b){switch(ExplorerMenuBinding.superclass.handleBroadcast.call(this,a,b),a){case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:this.collapse(),this.updateScroll()}},ExplorerMenuBinding.prototype.setSelectionByHandle=function(a){var b=this._buttons.get(a);b?b.check():this.setSelectionDefault()},ExplorerMenuBinding.prototype.getSelectionHandle=function(){return this._selectedHandle},ExplorerMenuBinding.prototype.getSelectionTag=function(){return this._selectedTag},ExplorerMenuBinding.prototype.setSelectionDefault=function(){if(this._list.hasEntries()){var a=this._list.getFirst();this._list.each(function(b){if(b.node&&b.node.getPropertyBag){var c=b.node.getPropertyBag();if(c&&c.IsTool)return!0}return a=b,!1},this),a.check()}},ExplorerMenuBinding.prototype.toggle=function(){top.app.bindingMap.app.hasClassName("exploler-expanded")?this.collapse():this.expand()},ExplorerMenuBinding.prototype.collapse=function(){top.app.bindingMap.app.detachClassName("exploler-expanded"),top.app.bindingMap.menutogglebutton.setImage("${icon:menu}")},ExplorerMenuBinding.prototype.expand=function(){top.app.bindingMap.app.attachClassName("exploler-expanded"),top.app.bindingMap.menutogglebutton.setImage("${icon:arrow-left}")},ExplorerMenuBinding.prototype.updateScroll=function(){var a=this.bindingElement.scrollTop,b=this.bindingElement.scrollHeight,c=this.bindingElement.clientHeight;0===a?ExplorerBinding.bindingInstance.detachClassName(ExplorerMenuBinding.SCROLLUP_CLASSNAME):ExplorerBinding.bindingInstance.attachClassName(ExplorerMenuBinding.SCROLLUP_CLASSNAME),a+c<b?this.attachClassName(ExplorerMenuBinding.SCROLLDOWN_CLASSNAME):this.detachClassName(ExplorerMenuBinding.SCROLLDOWN_CLASSNAME)},ExplorerToolBarBinding.prototype=new ToolBarBinding,ExplorerToolBarBinding.prototype.constructor=ExplorerToolBarBinding,ExplorerToolBarBinding.superclass=ToolBarBinding.prototype,ExplorerToolBarBinding.prototype.toString=function(){return"[ExplorerToolBarBinding]"},ExplorerToolBarBinding.prototype.onBindingRegister=function(){ExplorerToolBarBinding.superclass.onBindingRegister.call(this),this.setImageSize(ToolBarBinding.ICONSIZE_22)},ExplorerToolBarBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:explorertoolbar",a);return UserInterface.registerBinding(b,ExplorerToolBarBinding)},ExplorerToolBarButtonBinding.prototype=new ToolBarButtonBinding,ExplorerToolBarButtonBinding.prototype.constructor=ExplorerToolBarButtonBinding,ExplorerToolBarButtonBinding.superclass=ToolBarButtonBinding.prototype,ExplorerToolBarButtonBinding.TYPE_NORMAL="normal",ExplorerToolBarButtonBinding.TYPE_LARGE="large",ExplorerToolBarButtonBinding.prototype.toString=function(){return"[ExplorerToolBarButtonBinding]"},ExplorerToolBarButtonBinding.prototype.onBindingAttach=function(){this.addEventListener(DOMEvents.MOUSEUP);var a=this.explorerToolBarButtonType==ExplorerToolBarButtonBinding.TYPE_LARGE,b=a?ToolBarBinding.IMAGESIZE_LARGE:ToolBarBinding.IMAGESIZE_NORMAL;this.imageProfile=this.node.getImageProfile(b),ExplorerToolBarButtonBinding.superclass.onBindingAttach.call(this)},ExplorerToolBarButtonBinding.prototype.handleEvent=function(a){if(ExplorerToolBarButtonBinding.superclass.handleEvent.call(this,a),!this.isDisabled&&!BindingDragger.isDragging)switch(a.type){case DOMEvents.MOUSEUP:a.button!=ButtonStateManager.RIGHT_BUTTON&&this.isChecked&&StageBinding.bindingInstance.selectBrowserTab()}},ExplorerToolBarButtonBinding.newInstance=function(a,b){var c="ui:explorertoolbarbutton",d=DOMUtil.createElementNS(Constants.NS_UI,c,a),e=UserInterface.registerBinding(d,ExplorerToolBarButtonBinding);return e.explorerToolBarButtonType=b,e},ExplorerPopupBinding.prototype=new SystemTreePopupBinding,ExplorerPopupBinding.prototype.constructor=ExplorerPopupBinding,ExplorerPopupBinding.superclass=SystemTreePopupBinding.prototype,ExplorerPopupBinding.prototype.onBindingRegister=function(){SystemTreePopupBinding.superclass.onBindingRegister.call(this),this.addActionListener(MenuItemBinding.ACTION_COMMAND,this)},ExplorerPopupBinding.prototype._setupClipboardItems=function(){},ExplorerPopupBinding.prototype.handleAction=function(a){switch(a.type){case MenuItemBinding.ACTION_COMMAND:var b=this;StageBinding.select(this._pespectiveKey).then(function(){ExplorerPopupBinding.superclass.handleAction.call(b,a)})}},ExplorerPopupBinding.prototype.snapToMouse=function(a){var b=a.target?a.target:a.srcElement,c=DOMUtil.getLocalName(b),d=null;if("tree"!=c){switch(c){default:var e=DOMUtil.getAncestorByLocalName("explorertoolbarbutton",b);null!=e&&(d=UserInterface.getBinding(e),d.isDisabled&&(d=null))}null!=d&&null!=d.node&&null!=d.node.getActionProfile()&&(this._node=d.node,this._actionProfile=this.getCompiledActionProfile(d.node),this._pespectiveKey=d.handle,SystemTreePopupBinding.superclass.snapToMouse.call(this,a))}},ExplorerPopupBinding.prototype.getCompiledActionProfile=function(a){var b=new Map,c=a.getActionProfile();if(null!=c){c.each(function(a,c){var d=new List;c.each(function(a){1&a.getActivePositions()&&d.add(a)}),d.hasEntries()&&b.set(a,d)})}return b.Node=a,b},EditorBinding.prototype=new WindowBinding,EditorBinding.prototype.constructor=EditorBinding,EditorBinding.superclass=WindowBinding.prototype,EditorBinding.isActive=!1,EditorBinding.ACTION_ATTACHED=null,EditorBinding.URL_DIALOG_MOZ_CONFIGURE="${root}/content/dialogs/wysiwygeditor/mozsecuritynote/mozsecuritynote.aspx",EditorBinding.URL_UPDATERENDERING="${root}/content/dialogs/functions/editFunctionCall.aspx?type={0}&pageId={context:pageId}&containerClasses={context:containerClasses}",EditorBinding.ABSURD_NUMBER=-999999999,EditorBinding.LINE_BREAK_ENTITY_HACK="C1.LINE.BREAK.ENTITY.HACK",EditorBinding.invokeFunctionEditorDialog=function(a,b,c,d){c=c?c:"";var e=FunctionService.GetCustomEditorSettingsByMarkup(a),f=ViewDefinitions["Composite.Management.PostBackDialog"];if(e){var g=top.WindowManager.getWindowDimensions();f.width=e.Width?e.Width>g.w?g.w:e.Width:void 0,f.height=e.Height?e.Height>g.h?g.h:e.Height:void 0,e.Url&&(e.Url=e.Url.indexOf("?")>-1?e.Url+"&consoleId="+Application.CONSOLE_ID:e.Url+"?consoleId="+Application.CONSOLE_ID)}else f.width=500,f.height=520;f.label="${string:Composite.Web.FormControl.FunctionCallsDesigner:DialogTitle}",f.image="${icon:parameter_overloaded}",f.handler=b,f.argument={url:e?e.Url:EditorBinding.URL_UPDATERENDERING.replace("{0}",c),list:new List([{name:"functionmarkup",value:a}])},StageBinding.presentViewDefinition(f,d)},EditorBinding._components=new Map,EditorBinding._editors=new Map,EditorBinding.registerComponent=function(a,b){var c=EditorBinding._components,d=EditorBinding._editors,e=b.key,f=Interfaces.isImplemented(IWysiwygEditorComponent,a);if(f||(f=Interfaces.isImplemented(ISourceEditorComponent,a)),!f)throw"Editor component interface not implemented: "+a;d.has(e)?d.get(e).initializeEditorComponent(a):(c.has(e)||c.set(e,new List),c.get(e).add(a))},EditorBinding.claimComponents=function(a,b){var c=EditorBinding._components,d=EditorBinding._editors,e=b.key;d.set(e,a);var f=null;return c.has(e)&&(f=c.get(e).copy(),c.del(e)),f},EditorBinding.prototype.toString=function(){return"[EditorBinding]"},EditorBinding.prototype.onBindingRegister=function(){EditorBinding.superclass.onBindingRegister.call(this),this._url=this.url_default,this._coverBinding=this.add(CoverBinding.newInstance(this.bindingDocument));var a=this.getProperty("name");null!=a&&""!=a||(a="generated"+KeyMaster.getUniqueKey()),this._registerWithDataManager(a)},EditorBinding.prototype.onBindingAttach=function(){Application.lock(this),this.hasCallBackID()&&Binding.dotnetify(this),this._setup(),this.setURL(this._url),this.addActionListener(Binding.ACTION_DIRTY),EditorBinding.superclass.onBindingAttach.call(this)},EditorBinding.prototype._setup=function(){var a=this.getProperty("value");null!=a&&(a=decodeURIComponent(a),this._startContent=a)},EditorBinding.prototype.onBindingDispose=function(){EditorBinding.superclass.onBindingDispose.call(this);var a=this.getProperty("name");if(null!=a){var b=this.bindingWindow.DataManager;b.unRegisterDataBinding(a)}},EditorBinding.prototype._initialize=function(){this.subscribe(BroadcastMessages.STAGEDIALOG_OPENED),this.subscribe(BroadcastMessages.MOUSEEVENT_MOUSEUP),null==this._startContent&&(this._startContent=new String("")),this.addEditorEvents();var a=this;setTimeout(function(){a._finalize()},0)},EditorBinding.prototype._finalize=function(){this.resetUndoRedo(),this._popupBinding=this.getEditorPopupBinding(),Application.unlock(this),this._isFinalized=!0,this.dispatchAction(this.action_initialized)},EditorBinding.prototype.initializeEditorComponents=function(a){var b=EditorBinding.claimComponents(this,a);if(null!=b)for(;b.hasNext();)this.initializeEditorComponent(b.getNext())},EditorBinding.prototype._registerWithDataManager=function(a){if(a&&""!=a){var b=this.bindingWindow.DataManager;b.getDataBinding(a)&&b.unRegisterDataBinding(a),b.registerDataBinding(a,this)}},EditorBinding.prototype.addEditorEvents=function(){var a=this.getEditorDocument();null!=a&&(Application.framework(a),DOMEvents.addEventListener(a,DOMEvents.CONTEXTMENU,this),DOMEvents.addEventListener(a,DOMEvents.KEYPRESS,this),DOMEvents.addEventListener(a,DOMEvents.MOUSEDOWN,this),DOMEvents.addEventListener(a,DOMEvents.MOUSEMOVE,this)),DOMEvents.addEventListener(this.bindingElement,DOMEvents.MOUSEDOWN,{handleEvent:function(a){DOMEvents.stopPropagation(a),DOMEvents.preventDefault(a)}})},EditorBinding.prototype.checkForDirty=function(a){if(!this.isDirty||!this.bindingWindow.DataManager.isDirty)if(1==a)this.bindingWindow.DataManager.dirty(this);else{var b=this;setTimeout(function(){b._checkForRealDirty()},0)}},EditorBinding.prototype._checkForRealDirty=function(){var a=this.getCheckSum();a!=this._checksum&&(this.bindingWindow.DataManager.dirty(this),this._checksum=a)},EditorBinding.prototype.getCheckSum=function(){var a=null;return Binding.exists(this._pageBinding)&&(a=this._pageBinding.getCheckSum(this._checksum)),a},EditorBinding.prototype.handleEvent=function(a){EditorBinding.superclass.handleEvent.call(this,a);var b=DOMEvents.getTarget(a);switch(a.type){case DOMEvents.CONTEXTMENU:Client.isFirefox&&a.ctrlKey||(DOMEvents.preventDefault(a),this._popupBinding.editorBinding=this,this.handleContextMenu(a));break;case DOMEvents.KEYPRESS:this.checkForDirty(),(!this._isActivated||this.isFocusable&&!this.isFocused)&&this._activateEditor(!0);break;case DOMEvents.MOUSEDOWN:b.ownerDocument==this.getEditorDocument()&&(!this._isActivated||this.isFocusable&&!this.isFocused)&&this._activateEditor(!0);break;case DOMEvents.MOUSEMOVE:Client.isAnyExplorer&&Application.isBlurred&&(this._isActivated||this.getContentWindow().focus())}},EditorBinding.prototype.handleContextMenu=function(a){this.createBookmark(),this._popupBinding.snapToMouse(a)},EditorBinding.prototype.handleBroadcast=function(a,b){EditorBinding.superclass.handleBroadcast.call(this,a,b);var c=null;switch(a){case BroadcastMessages.STAGEDIALOG_OPENED:this._isActivated&&this._activateEditor(!1);break;case BroadcastMessages.MOUSEEVENT_MOUSEUP:if(!this.isDialogMode)try{var d=!0;b instanceof Binding?1==Interfaces.isImplemented(IEditorControlBinding,b)&&b.isEditorControlBinding&&(d=!1):(c=DOMEvents.getTarget(b),c&&c.ownerDocument==this.getEditorDocument()&&(d=!1)),d&&this._isActivated&&this._activateEditor(!1)}catch(a){throw this.unsubscribe(BroadcastMessages.MOUSEEVENT_MOUSEUP),a}}},EditorBinding.prototype._activateEditor=function(a){if(a!=this._isActivated){this._isActivated=a,EditorBinding.isActive=a;var b=this.getEditorWindow().standardEventHandler,c=this.getContentWindow().bindingMap.broadcasterIsActive;if(null==c)throw"Required broadcaster not found";a?(this.hasBookmark()&&this.deleteBookmark(),c.enable(),Client.isExplorer&&this._sanitizeExplorer(),this.focus(),b.enableNativeKeys(!0)):(c.disable(),b.disableNativeKeys(),this.blur())}},EditorBinding.prototype._sanitizeExplorer=function(){if(Client.isExplorer){var a=this.getEditorDocument().selection.createRange();a.select()}},EditorBinding.prototype._sanitizeMozilla=function(){},EditorBinding.prototype.hasSelection=function(){var a=!1;try{var b=this.getEditorWindow().getSelection();if(null!=b&&(a=b.toString().length>0,!a)){for(var c=b.getRangeAt(0),d=c.cloneContents(),e=this.getEditorDocument().createElement("element");d.hasChildNodes();)e.appendChild(d.firstChild);var f=e.getElementsByTagName("img").item(0);null!=f&&(VisualEditorBinding.isReservedElement(f)||(a=!0))}}catch(a){}return a},EditorBinding.prototype.isCommandEnabled=function(a){var b=!0;switch(a){case"Cut":case"Copy":case"Paste":b=this.getEditorDocument().queryCommandEnabled(a)}return b},EditorBinding.prototype.handleCommand=function(a,b,c){var d=!1;switch(this.restoreBookmark(),a){case"Cut":case"Copy":case"Paste":var e=null;e="Paste"==a?null:this.hasSelection();try{this.getEditorDocument().execCommand(a,b,e)}catch(a){if(1!=Client.isMozilla)throw"Clipboard operation malfunction. Contact your developer.";Dialog.invokeModal(EditorBinding.URL_DIALOG_MOZ_CONFIGURE)}finally{d=!0}}return d},EditorBinding.prototype.getButtonForCommand=function(a){var b=this.getContentWindow().bindingMap.toolbar,c=b.getButtonForCommand(a);if(!c)throw"No button for command "+a;return c},EditorBinding.prototype.getName=function(){return this.getProperty("name")},EditorBinding.prototype.dirty=DataBinding.prototype.dirty,EditorBinding.prototype.clean=function(){this.isDirty=!1,this._checksum=this.getCheckSum()},EditorBinding.prototype.enableDialogMode=function(){if(!this.isDialogMode){this.isDialogMode=!0,this.hasBookmark()||this.createBookmark();var a=this;setTimeout(function(){a._activateEditor(!1)},0)}},EditorBinding.prototype.disableDialogMode=function(){if(this.isDialogMode){this.hasBookmark()&&this.restoreBookmark();var a=this;setTimeout(function(){a.isDialogMode=!1,a.blurEditor()},100)}},EditorBinding.prototype.blurEditor=function(){var a=this.getContentDocument().getElementById("focusableinput");if(null==a)throw"Required element not found: focusableinput";a.style.display="block",FocusBinding.focusElement(a),a.style.display="none"},EditorBinding.prototype.handleAction=function(a){EditorBinding.superclass.handleAction.call(this,a);a.target,this.shadowTree.iframe;switch(a.type){case Binding.ACTION_DIRTY:a.target!=this&&this.checkForDirty()}},EditorBinding.prototype._onPageInitialize=function(a){null==this._pageBinding&&(this.reflex(),null!=this._coverBinding&&this._coverBinding.isVisible&&this._coverBinding.hide()),EditorBinding.superclass._onPageInitialize.call(this,a)},EditorBinding.prototype.handleElement=function(a){return!0},EditorBinding.prototype.updateElement=function(a){return!0},EditorBinding.prototype.focus=DataBinding.prototype.focus,EditorBinding.prototype.blur=DataBinding.prototype.blur,EditorBinding.prototype.manifest=function(){this.shadowTree.dotnetinput.value=encodeURIComponent(this.getValue())},EditorBinding.prototype.getContextContainer=HTMLDataDialogBinding.prototype.getContextContainer,EditorBinding.prototype.setContextContainer=function(a){},EditorBinding.prototype.getEditorWindow=Binding.ABSTRACT_METHOD,EditorBinding.prototype.getEditorDocument=Binding.ABSTRACT_METHOD,EditorBinding.prototype.getEditorPopupBinding=Binding.ABSTRACT_METHOD;EditorBinding.prototype.createBookmark=Binding.ABSTRACT_METHOD;EditorBinding.prototype.restoreBookmark=Binding.ABSTRACT_METHOD,EditorBinding.prototype.hasBookmark=Binding.ABSTRACT_METHOD,EditorBinding.prototype.deleteBookmark=Binding.ABSTRACT_METHOD,EditorBinding.prototype.resetUndoRedo=Binding.ABSTRACT_METHOD,EditorBinding.prototype.validate=Binding.ABSTRACT_METHOD,EditorBinding.prototype.getValue=Binding.ABSTRACT_METHOD,EditorBinding.prototype.getResult=Binding.ABSTRACT_METHOD,EditorPopupBinding.prototype=new PopupBinding,EditorPopupBinding.prototype.constructor=EditorPopupBinding,EditorPopupBinding.superclass=PopupBinding.prototype,EditorPopupBinding.CONTENT_TEMPLATE=null,EditorPopupBinding.prototype.toString=function(){return"[EditorPopupBinding]"},EditorPopupBinding.prototype.show=function(){if(this._isEditorPopupBindingInitialized)EditorPopupBinding.superclass.show.call(this);else{var a=this;Application.lock(this),setTimeout(function(){a._initialize(),Application.unlock(a)},0)}},EditorPopupBinding.prototype._initialize=function(){this._isEditorPopupBindingInitialized||(this.subTreeFromString(Templates.getTemplateElementText(this.constructor.CONTENT_TEMPLATE)),this._bodyBinding=this.getChildBindingByLocalName("menubody"),this.addActionListener(MenuItemBinding.ACTION_COMMAND,this),this._indexMenuContent(),this._isEditorPopupBindingInitialized=!0,this._onInitialize())},EditorPopupBinding.prototype._onInitialize=function(){this._configure(),this.show()},EditorPopupBinding.prototype.configure=function(){this._isEditorPopupBindingInitialized&&this._configure()},EditorPopupBinding.prototype._configure=Binding.ABSTRACT_METHOD,EditorPopupBinding.prototype._showMenuGroups=function(a){var b=this._menuGroups[a];b instanceof List&&b.each(function(a){a.show()})},EditorPopupBinding.prototype._hideMenuGroups=function(a){var b=this._menuGroups[a];b instanceof List&&b.each(function(a){a.hide()})},EditorPopupBinding.prototype.handleAction=function(a){EditorPopupBinding.superclass.handleAction.call(this,a);var b=a.target;if(a.type==MenuItemBinding.ACTION_COMMAND){this.hide();var c=b.getProperty("cmd"),d=b.getProperty("gui"),e=b.getProperty("val");this.handleCommand(c,d,e)}},EditorPopupBinding.prototype.handleCommand=Binding.ABSTRACT_METHOD,EditorClickButtonBinding.prototype=new ClickButtonBinding,EditorClickButtonBinding.prototype.constructor=EditorClickButtonBinding,EditorClickButtonBinding.superclass=ClickButtonBinding.prototype,EditorClickButtonBinding.prototype.toString=function(){return"[EditorClickButtonBinding]"},EditorClickButtonBinding.prototype.onBindingAttach=function(){EditorClickButtonBinding.superclass.onBindingAttach.call(this),this._setupEditorButton()},EditorClickButtonBinding.prototype._setupEditorButton=function(){this.cmd=this.getProperty("cmd"),this.val=this.getProperty("val"),this.gui=this.getProperty("gui"),0==this.getProperty("editorcontrol")&&(this.isEditorControlBinding=!1);var a=this.bindingWindow.bindingMap.tinywindow,b=this.bindingWindow.bindingMap.codepresswindow;a?EditorBinding.registerComponent(this,a):b&&EditorBinding.registerComponent(this,b)},EditorClickButtonBinding.prototype.buildDOMContent=function(){EditorClickButtonBinding.superclass.buildDOMContent.call(this),this._buildDesignModeSanitizer()},EditorClickButtonBinding.prototype.initializeComponent=function(a,b,c,d){this._editorBinding=a,this._tinyEngine=b,this._tinyInstance=c,this._tinyTheme=d,this._setupEditorBookmarking()},EditorClickButtonBinding.prototype.initializeSourceEditorComponent=function(a,b,c){this._editorBinding=a,this._codePressFrame=b,this._codePressEngine=c},EditorClickButtonBinding.prototype._buildDesignModeSanitizer=function(){if(Client.isAnyExplorer){var a=this.bindingDocument.createElement("img");a.className="designmodesanitizer",a.src=Resolver.resolve("${root}/images/blank.png"),a.ondragstart=function(a){a.preventDefault()},this.shadowTree.designmodesanitizer=a,this.bindingElement.appendChild(a)}},EditorClickButtonBinding.prototype._setupEditorBookmarking=function(){var a=this._editorBinding;if(null!=a){var b=this,c={handleEvent:function(c){switch(c.type){case DOMEvents.MOUSEDOWN:a.hasBookmark()||a.createBookmark();break;case DOMEvents.MOUSEUP:b.isEditorSimpleControl&&null==b.popupBinding&&a.hasBookmark()&&a.restoreBookmark()}}};DOMEvents.addEventListener(this.bindingElement,DOMEvents.MOUSEDOWN,c),DOMEvents.addEventListener(this.bindingElement,DOMEvents.MOUSEUP,c)}},EditorClickButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:clickbutton",a);return UserInterface.registerBinding(b,EditorClickButtonBinding)},EditorToolBarButtonBinding.prototype=new ToolBarButtonBinding,EditorToolBarButtonBinding.prototype.constructor=EditorToolBarButtonBinding,EditorToolBarButtonBinding.superclass=ToolBarButtonBinding.prototype,EditorToolBarButtonBinding.prototype.toString=function(){return"[EditorToolBarButtonBinding]"},EditorToolBarButtonBinding.prototype.onBindingAttach=function(){EditorToolBarButtonBinding.superclass.onBindingAttach.call(this),this._setupEditorButton()},EditorToolBarButtonBinding.prototype._setupEditorButton=EditorClickButtonBinding.prototype._setupEditorButton,EditorToolBarButtonBinding.prototype.buildDOMContent=function(){EditorToolBarButtonBinding.superclass.buildDOMContent.call(this),this._buildDesignModeSanitizer()},EditorToolBarButtonBinding.prototype.initializeComponent=EditorClickButtonBinding.prototype.initializeComponent,EditorToolBarButtonBinding.prototype.initializeSourceEditorComponent=EditorClickButtonBinding.prototype.initializeSourceEditorComponent,EditorToolBarButtonBinding.prototype._buildDesignModeSanitizer=EditorClickButtonBinding.prototype._buildDesignModeSanitizer,EditorToolBarButtonBinding.prototype._setupEditorBookmarking=EditorClickButtonBinding.prototype._setupEditorBookmarking,EditorToolBarButtonBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:toolbarbutton",a);return UserInterface.registerBinding(b,EditorToolBarButtonBinding)},EditorSelectorBinding.prototype=new SelectorBinding,EditorSelectorBinding.prototype.constructor=EditorSelectorBinding,EditorSelectorBinding.superclass=SelectorBinding.prototype,EditorSelectorBinding.prototype.toString=function(){return"[EditorSelectorBinding]"},EditorSelectorBinding.prototype.onBindingAttach=function(){0==this.getProperty("editorcontrol")&&(this.isEditorControlBinding=!1,this.BUTTON_IMPLEMENTATION=ClickButtonBinding,this.MENUITEM_IMPLEMENTATION=MenuItemBinding);var a=this.bindingWindow.bindingMap.tinywindow;EditorBinding.registerComponent(this,a),Client.isPad&&this.setProperty("width",140),EditorSelectorBinding.superclass.onBindingAttach.call(this)},EditorSelectorBinding.prototype.buildButton=function(){EditorSelectorBinding.superclass.buildButton.call(this),this._buttonBinding.isEditorSimpleControl=!1,0==this.isEditorControlBinding&&(this._buttonBinding.isEditorControlBinding=!1)},EditorSelectorBinding.prototype.initializeComponent=function(a,b,c,d){this._editorBinding=a,this._tinyEngine=b,this._tinyInstance=c,this._tinyTheme=d},EditorSelectorBinding.prototype.handleAction=function(a){switch(EditorSelectorBinding.superclass.handleAction.call(this,a),a.type){case MenuItemBinding.ACTION_COMMAND:if(this._editorBinding.hasBookmark()){var b=this;setTimeout(function(){b._editorBinding.isDialogMode||(b._editorBinding.restoreBookmark(),b._tinyInstance.focus())},0)}}},EditorSelectorBinding.prototype._grabKeyboard=function(){},EditorSelectorBinding.prototype._releaseKeyboard=function(){},EditorMenuItemBinding.prototype=new MenuItemBinding,EditorMenuItemBinding.prototype.constructor=EditorMenuItemBinding,EditorMenuItemBinding.superclass=MenuItemBinding.prototype,EditorMenuItemBinding.prototype.toString=function(){return"[EditorMenuItemBinding]"},EditorMenuItemBinding.prototype.buildDOMContent=function(){EditorMenuItemBinding.superclass.buildDOMContent.call(this),Client.isAnyExplorer&&this._buildDesignModeSanitizer()},EditorMenuItemBinding.prototype._buildDesignModeSanitizer=function(){if(Client.isAnyExplorer){var a=this.bindingDocument.createElement("img");a.className="designmodesanitizer",a.src=Resolver.resolve("${root}/images/blank.png"),a.ondragstart=function(a){a.preventDefault()},this.shadowTree.designmodesanitizer=a,this.bindingElement.appendChild(a)}},EditorMenuItemBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menuitem",a);return UserInterface.registerBinding(b,EditorMenuItemBinding)},VisualEditorBinding.prototype=new EditorBinding,VisualEditorBinding.prototype.constructor=VisualEditorBinding,VisualEditorBinding.superclass=EditorBinding.prototype,VisualEditorBinding.FUNCTION_CLASSNAME="compositeFunctionWysiwygRepresentation",VisualEditorBinding.FIELD_CLASSNAME="compositeFieldReferenceWysiwygRepresentation",VisualEditorBinding.HTML_CLASSNAME="compositeHtmlWysiwygRepresentation",VisualEditorBinding.ACTION_INITIALIZED="visualeditor initialized",VisualEditorBinding.DEFAULT_CONTENT="<p></p>",VisualEditorBinding.URL_DIALOG_CONTENTERROR="${root}/content/dialogs/wysiwygeditor/errors/contenterror.aspx",VisualEditorBinding.XHTML='<html xmlns="http://www.w3.org/1999/xhtml">\n\t<head></head>\n\t<body>\n${body}\n\t</body>\n</html>',VisualEditorBinding.getTinyLessClassName=function(a){for(var b,c=0,d=[],e=a.split(" ");null!=(b=e[c++]);)b.length>=3&&"mce"==b.substring(0,3)||b.length>=14&&"compositemedia"==b.substring(0,14)||d.push(b);return d.join(" ")},VisualEditorBinding.getStructuredContent=function(a){var b=null;WebServiceProxy.isFaultHandler=!1;var c=XhtmlTransformationsService.TinyContentToStructuredContent(a);return c instanceof SOAPFault||(b=c.XhtmlFragment,b||(b="")),WebServiceProxy.isFaultHandler=!0,b},VisualEditorBinding.getTinyContent=function(a,b){var c=null;null!=a&&a.replace(/\s*/gm,"").length||(a=VisualEditorBinding.DEFAULT_CONTENT),WebServiceProxy.isFaultHandler=!1;var d=b.getSoapTinyContent(a);if(d instanceof SOAPFault){var e=d,f={handleDialogResponse:function(){b.dispatchAction(Binding.ACTION_VALID)}};Dialog.invokeModal(VisualEditorBinding.URL_DIALOG_CONTENTERROR,f,e)}else c=d.XhtmlFragment,null==c&&(c=new String("")),c=c.replace(/\s+<li>/g,"<li>");return WebServiceProxy.isFaultHandler=!0,c},VisualEditorBinding.isImage=function(a){return a&&"IMG"==a.nodeName},VisualEditorBinding.isImageElement=function(a){return VisualEditorBinding.isImage(a)&&!VisualEditorBinding.isReservedElement(a)},VisualEditorBinding.isReservedElement=function(a){return!!VisualEditorBinding.isFunctionElement(a)||(!!VisualEditorBinding.isFieldElement(a)||!!VisualEditorBinding.isHtmlElement(a))},VisualEditorBinding.isFunctionElement=function(a){return VisualEditorBinding.isImage(a)&&CSSUtil.hasClassName(a,VisualEditorBinding.FUNCTION_CLASSNAME)},VisualEditorBinding.isFieldElement=function(a){return VisualEditorBinding.isImage(a)&&CSSUtil.hasClassName(a,VisualEditorBinding.FIELD_CLASSNAME)},VisualEditorBinding.isHtmlElement=function(a){return VisualEditorBinding.isImage(a)&&CSSUtil.hasClassName(a,VisualEditorBinding.HTML_CLASSNAME)},VisualEditorBinding.prototype.onBindingRegister=function(){VisualEditorBinding.superclass.onBindingRegister.call(this),StringBundle.getString("Composite.Web.VisualEditor","Preload.Key")},VisualEditorBinding.prototype.onBindingAttach=function(){var a=this.getProperty("embedablefieldstypenames");null!=a&&(this.embedableFieldConfiguration=VisualEditorFieldGroupConfiguration.getConfiguration(a));var b=this.getProperty("formattingconfiguration");null!=b&&(this._url+="?config="+b),this._previewPageId=this.getProperty("previewpageid"),null==this._previewPageId&&(this._previewPageId="00000000-0000-0000-0000-000000000000"),this._previewTemplateId=this.getProperty("previewtemplateid"),null==this._previewTemplateId&&(this._previewTemplateId="00000000-0000-0000-0000-000000000000"),this._previewPlaceholder=this.getProperty("previewplaceholder"),VisualEditorBinding.superclass.onBindingAttach.call(this),this.subscribe(BroadcastMessages.TINYMCE_INITIALIZED),this.subscribe(this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST)},VisualEditorBinding.prototype.toString=function(){return"[VisualEditorBinding]"},VisualEditorBinding.prototype.handleBroadcast=function(a,b){VisualEditorBinding.superclass.handleBroadcast.call(this,a,b);var c=this.getContentWindow().bindingMap.tinywindow,d=c.getContentWindow();switch(a){case BroadcastMessages.TINYMCE_INITIALIZED:b.broadcastWindow==d&&(this._tinyEngine=b.tinyEngine,this._tinyInstance=b.tinyInstance,this._tinyTheme=b.tinyTheme,this._tinyTheme.initC1(this,this._tinyEngine,this._tinyInstance),this.initializeEditorComponents(c),this._initialize(),this.unsubscribe(BroadcastMessages.TINYMCE_INITIALIZED));break;case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:this.handleCommand("CompositeUpdateLayout",!1,null)}},VisualEditorBinding.prototype.initializeEditorComponent=function(a){a.initializeComponent(this,this._tinyEngine,this._tinyInstance,this._tinyTheme)},VisualEditorBinding.prototype._finalize=function(){VisualEditorBinding.superclass._finalize.call(this),this._startContent=this.normalizeToDocument(this._startContent),this._startContent=this.extractBody(this._startContent);var a=VisualEditorBinding.getTinyContent(this._startContent,this);0==a.replace(/\s*/gm,"").length&&(a=VisualEditorBinding.DEFAULT_CONTENT),this._tinyInstance.setContent(a,{format:"raw"}),this._tinyInstance.undoManager.clear(),this._tinyInstance.undoManager.add(),this.updateBodyWidth(),this.updateCssClasses(),this._maybeShowEditor()},VisualEditorBinding.prototype._onPageInitialize=function(a){VisualEditorBinding.superclass._onPageInitialize.call(this,a),this._maybeShowEditor()},VisualEditorBinding.prototype._maybeShowEditor=function(){this._isFinalized&&null!=this._pageBinding&&(this._checksum=this.getCheckSum(),this._pageBinding.showEditor(!0))},VisualEditorBinding.prototype.extractBody=function(a){var b=null,c=/(<body\s*[^>]*>)([\S\s]*)(<\/body>)/i,d=a.match(c);return d?(b=d[2],this._xhtml=a.replace(c,"$1\n${body}\n\t$3")):(b=new String(""),this._xhtml=VisualEditorBinding.XHTML),b},VisualEditorBinding.prototype.normalizeToDocument=function(a){var b=a;return this._isNormalizedDocument(a)||(b=this._getHtmlMarkup().replace("${body}",a.replace(/\$/g,"$$$$"))),b},VisualEditorBinding.prototype._isNormalizedDocument=function(a){var b=!1,c=XMLParser.parse(a,!0);return null!=c&&"html"==c.documentElement.nodeName&&(b=!0),Client.isWebKit&&0!==a.indexOf("<html")&&(b=!1),b},VisualEditorBinding.prototype._getHtmlMarkup=function(){return null!=this._xhtml?this._xhtml:VisualEditorBinding.XHTML},VisualEditorBinding.prototype.handleCommand=function(a,b,c){var d=VisualEditorBinding.superclass.handleCommand.call(this,a,b,c);if(!d){try{this._tinyInstance.execCommand(a,b,c,{skip_focus:!0}),this.checkForDirty()}catch(a){SystemDebug.stack(arguments)}d=!0}return d},VisualEditorBinding.prototype.handleContextMenu=function(a){var b=DOMEvents.getTarget(a);this._popupBinding.configure(this._tinyInstance,this._tinyEngine,b),VisualEditorBinding.superclass.handleContextMenu.call(this,a)},VisualEditorBinding.prototype.getEditorWindow=function(){return DOMUtil.getParentWindow(this.getEditorDocument())},VisualEditorBinding.prototype.getEditorDocument=function(){return this._tinyInstance.getDoc()},
VisualEditorBinding.prototype.getEditorPopupBinding=function(){return app.bindingMap.visualeditorpopup},VisualEditorBinding.prototype.createBookmark=function(){this._bookmark=this._tinyInstance.selection.getBookmark(!0)},VisualEditorBinding.prototype.restoreBookmark=function(){this.hasBookmark()&&(this._tinyInstance.selection.moveToBookmark(this._bookmark),this.deleteBookmark())},VisualEditorBinding.prototype.hasBookmark=function(){return null!=this._bookmark},VisualEditorBinding.prototype.deleteBookmark=function(){this._bookmark=null},VisualEditorBinding.prototype.resetUndoRedo=function(){this._tinyInstance.undoManager.clear(),this._tinyInstance.undoManager.add(),null!=this._pageBinding&&this._pageBinding.updateUndoBroadcasters()},VisualEditorBinding.prototype.validate=function(){return this._pageBinding.validate()},VisualEditorBinding.prototype.getValue=function(){return this._pageBinding.getContent()},VisualEditorBinding.prototype.setValue=function(a){this._isFinalized?Binding.exists(this._pageBinding)&&this._pageBinding.setContent(a):null==this._startContent&&(this._startContent=a)},VisualEditorBinding.prototype.getResult=function(){},VisualEditorBinding.prototype.clean=function(){VisualEditorBinding.superclass.clean.call(this),null!=this._pageBinding&&this._pageBinding.clean()},VisualEditorBinding.prototype.getSoapTinyContent=function(a){var b=this.getEffectiveWidth();return XhtmlTransformationsService.StructuredContentToTinyContentMultiTemplate(a,this._previewPageId,this._previewTemplateId,this._previewPlaceholder,b)},VisualEditorBinding.prototype.getImageTagForFunctionCall=function(a){var b=this.getEffectiveWidth();return XhtmlTransformationsService.GetImageTagForFunctionCall2(a,this._previewPageId,this._previewTemplateId,this._previewPlaceholder,b)},VisualEditorBinding.prototype.getEffectiveWidth=function(){var a=this._tinyInstance.getBody(),b=(CSSComputer.getPadding(a),this.getContentWindow().bindingMap.editorsplitpanel),c=b.bindingElement.offsetWidth-52;return 32*Math.floor(c/32)},VisualEditorBinding.prototype.getPlaceholderWidth=function(){return StageBinding.placeholderWidth},VisualEditorBinding.prototype.updateBodyWidth=function(a){void 0==a&&(a=this.getPlaceholderWidth()),a?this._tinyInstance.getBody().style.maxWidth=a+52+"px":this._tinyInstance.getBody().style.maxWidth=""},VisualEditorBinding.prototype.updateCssClasses=function(){var a=ContextContainer.getContextContainer(this);if(null!=a){var b=this._tinyInstance.getBody();b.className="",a.getContainerClassesList().each(function(a){CSSUtil.attachClassName(b,a)})}},VisualEditorBinding.prototype.focus=function(){VisualEditorBinding.superclass.focus.call(this),Client.isExplorer&&this._tinyInstance&&this._tinyInstance.selection.setRng(this._tinyInstance.selection.getRng())},VisualEditorBinding.prototype.restoreEditorFocus=function(){this._tinyInstance.focus()},VisualEditorBinding.prototype.setResult=function(a){},VisualEditorPopupBinding.prototype=new EditorPopupBinding,VisualEditorPopupBinding.prototype.constructor=VisualEditorPopupBinding,VisualEditorPopupBinding.superclass=EditorPopupBinding.prototype,VisualEditorPopupBinding.CONTENT_TEMPLATE="wysiwygeditor/popup.xml",VisualEditorPopupBinding.prototype.toString=function(){return"[VisualEditorPopupBinding]"},VisualEditorPopupBinding.prototype.configure=function(a,b,c){var d=this.editorBinding.hasSelection();this.tinyInstance=a,this.tinyEngine=b,this.tinyElement=c,this.hasSelection=d,VisualEditorPopupBinding.superclass.configure.call(this)},VisualEditorPopupBinding.prototype.handleCommand=function(a,b,c){this.editorBinding.blurEditor(),this.editorBinding.handleCommand(a,!!b&&b,c)},VisualEditorPopupBinding.prototype._configure=function(){this._isEditorPopupBindingInitialized&&(this._configureLinkGroup(),this._configureInsertGroup(),this._configureTableGroup(),this._configureRenderingGroup(),this._configureFieldGroup(),this._configureImageGroup(),this._configureSpellCheckGroup())},VisualEditorPopupBinding.prototype._configureLinkGroup=function(){var a=!1;this.hasSelection?a=!0:this.tinyElement&&("A"!=this.tinyElement.nodeName||this.tinyElement.getAttribute("name")?"IMG"==this.tinyElement.nodeName&&(a=!0):a=!0),a?(this._showMenuGroups("link"),this._configureLinkGroupDetails()):this._hideMenuGroups("link")},VisualEditorPopupBinding.prototype._configureLinkGroupDetails=function(){var a=this.getMenuItemForCommand("compositeInsertLink"),b=this.getMenuItemForCommand("unlink"),c=(this.editorBinding.getButtonForCommand("compositeInsertLink"),this.editorBinding.getButtonForCommand("unlink"));b.setDisabled(c.isDisabled),b.isDisabled?a.setLabel("${string:Composite.Web.VisualEditor:ContextMenu.LabelLink}"):a.setLabel("${string:Composite.Web.VisualEditor:ContextMenu.LabelLinkProperties}")},VisualEditorPopupBinding.prototype._configureInsertGroup=function(){var a=this.editorBinding.embedableFieldConfiguration,b=this.getMenuItemForCommand("compositeInsertFieldParent"),c=this.bindingDocument;if(b&&b.dispose(),b=MenuItemBinding.newInstance(c),b.setLabel("${string:Composite.Web.VisualEditor:ContextMenu.LabelField}"),b.image="${icon:fields}",b.imageDisabled="${icon:fields-disabled}",b.setProperty("cmd","compositeInsertFieldParent"),a){var d=a.getGroupNames();if(d.hasEntries()){var e=MenuPopupBinding.newInstance(c),f=e.add(MenuBodyBinding.newInstance(c)),g=f.add(MenuGroupBinding.newInstance(c));d.each(function(b){var d=a.getFieldNames(b);d.each(function(a){var d=g.add(MenuItemBinding.newInstance(c));d.setLabel(a),d.setImage("${icon:field}"),d.setProperty("cmd","compositeInsertField"),d.setProperty("val",b+":"+a),g.add(d)})}),b.add(e)}}else b.disable();this._menuGroups.insertions.getFirst().add(b),b.attachRecursive(),this._menuItems.compositeInsertFieldParent=b},VisualEditorPopupBinding.prototype._configureTableGroup=function(){var a=this.tinyInstance.dom.getParent(this.tinyElement,"table,td"),b=null,c=null;a&&("TD"==a.nodeName&&(b=a.getAttribute("colspan"),c=a.getAttribute("rowspan")),this._menuItems.mceTableSplitCells.setDisabled("1"==b&&"1"==c),this._menuItems.mceTablePasteRowBefore.setDisabled(null==this.tinyInstance.tableRowClipboard),this._menuItems.mceTablePasteRowAfter.setDisabled(null==this.tinyInstance.tableRowClipboard)),a?this._showMenuGroups("table"):this._hideMenuGroups("table")},VisualEditorPopupBinding.prototype._configureRenderingGroup=function(){VisualEditorBinding.isFunctionElement(this.tinyElement)?this._showMenuGroups("rendering"):this._hideMenuGroups("rendering")},VisualEditorPopupBinding.prototype._configureFieldGroup=function(){VisualEditorBinding.isFieldElement(this.tinyElement)?this._showMenuGroups("field"):this._hideMenuGroups("field")},VisualEditorPopupBinding.prototype._configureImageGroup=function(){VisualEditorBinding.isImageElement(this.tinyElement)?this._showMenuGroups("image"):this._hideMenuGroups("image")},VisualEditorPopupBinding.prototype._configureSpellCheckGroup=function(){Client.isFirefox?this._showMenuGroups("spellcheck"):this._hideMenuGroups("spellcheck")},VisualEditorFormattingConfiguration._configurations=new Map,VisualEditorFormattingConfiguration._options=null,VisualEditorFormattingConfiguration.getConfiguration=function(a){var b=VisualEditorFormattingConfiguration._configurations;return b.has(a)||b.set(a,new VisualEditorFormattingConfiguration),b.get(a)},VisualEditorFormattingConfiguration._getOptions=function(){if(null==VisualEditorFormattingConfiguration._options){var a="Composite.Web.VisualEditor";VisualEditorFormattingConfiguration._options={p:StringBundle.getString(a,"FormatSelector.LabelParagraph"),address:StringBundle.getString(a,"FormatSelector.LabelAddress"),blockquote:StringBundle.getString(a,"FormatSelector.LabelBlockQuote"),div:StringBundle.getString(a,"FormatSelector.LabelDivision"),h1:StringBundle.getString(a,"FormatSelector.LabelHeading1"),h2:StringBundle.getString(a,"FormatSelector.LabelHeading2"),h3:StringBundle.getString(a,"FormatSelector.LabelHeading3"),h4:StringBundle.getString(a,"FormatSelector.LabelHeading4"),h5:StringBundle.getString(a,"FormatSelector.LabelHeading5"),h6:StringBundle.getString(a,"FormatSelector.LabelHeading6")}}return VisualEditorFormattingConfiguration._options},VisualEditorFormattingConfiguration.prototype.getFormattingOptions=function(){return this._options},VisualEditorFieldGroupConfiguration._configurations=new Map,VisualEditorFieldGroupConfiguration.getConfiguration=function(a){var b=VisualEditorFieldGroupConfiguration._configurations;return b.has(a)||b.set(a,new VisualEditorFieldGroupConfiguration(EditorConfigurationService.GetEmbedableFieldGroupConfigurations(a))),b.get(a)},VisualEditorFieldGroupConfiguration.prototype.getGroupNames=function(){return this._groups.toList(!0)},VisualEditorFieldGroupConfiguration.prototype.getFieldNames=function(a){return this._groups.get(a).toList(!0)},VisualEditorFieldGroupConfiguration.prototype.getTinyMarkup=function(a,b){return this._groups.get(a).get(b).xhtml},VisualEditorFieldGroupConfiguration.prototype.getStructuredMarkup=function(a){return this._groups.get(groupname).get(fieldname).xml},VisualMultiEditorBinding.prototype=new VisualEditorBinding,VisualMultiEditorBinding.prototype.constructor=VisualMultiEditorBinding,VisualMultiEditorBinding.superclass=VisualEditorBinding.prototype,VisualMultiEditorBinding.prototype.toString=function(){return"[VisualMultiEditorBinding]"},VisualMultiEditorBinding.prototype._maybeShowEditor=function(){this._hasPlaceHolders&&VisualMultiEditorBinding.superclass._maybeShowEditor.call(this)},VisualMultiEditorBinding.prototype._setup=function(){this._xhtmls=new Map;for(var a=this.getDescendantElementsByLocalName("textarea");a.hasNext();){var b=a.getNext();"true"==b.getAttribute("selected")&&(this._startContent=b.value,this._textareaname=b.getAttribute("placeholderid"))}null==this._startContent&&(this._startContent=VisualEditorBinding.DEFAULT_CONTENT)},VisualMultiEditorBinding.prototype._initialize=function(){var a=this,b=this.getContentWindow().bindingMap.templatetree;b.addActionListener(TreeBinding.ACTION_SELECTIONCHANGED,{handleAction:function(c){var d=b.getSelectedTreeNodeBindings().getFirst();a._placeHolderSelected(d.textareaname),c.consume()}}),b.addActionListener(Binding.ACTION_FOCUSED,{handleAction:function(b){a._activateEditor(!1)}}),this._updatePlaceHolders();var c=this.getContentWindow().bindingMap.toolsplitter;c.unCollapse(),VisualMultiEditorBinding.superclass._initialize.call(this)},VisualMultiEditorBinding.prototype._updatePlaceHolders=function(){templatetree=this.getContentWindow().bindingMap.templatetree;var a=this.getDescendantElementsByLocalName("textarea");templatetree.empty(),a.hasEntries()?(this._hasPlaceHolders=!0,this._parsePlaceHolders(a),this._isFinalized&&this._pageBinding.showEditor(!0)):(this._hasPlaceHolders=!1,this._noPlaceHolders(),this._isFinalized&&this._pageBinding.showEditor(!1))},VisualMultiEditorBinding.prototype._parsePlaceHolders=function(a){for(this._textareas=new Map;a.hasNext();){var b=a.getNext(),c=b.getAttribute("placeholderid");this._textareas.set(c,{placeholderid:c,placeholdername:b.getAttribute("placeholdername"),placeholdermarkup:b.value,textareaelement:b,isSelected:"true"==b.getAttribute("selected")})}var d=new Map;if(this._textareas.each(function(a,b){var c=templatetree.add(TreeNodeBinding.newInstance(templatetree.bindingDocument));c.setLabel(b.placeholdername),c.setImage("${icon:placeholder}"),c.setProperty("placeholder",!0),c.textareaname=a,d.set(b.placeholdername,c),b.isSelected&&(selected=c)}),templatetree.attachRecursive(),null!=selected){var e=this._textareas.get(selected.textareaname);this._textareaname=selected.textareaname,this._placeholdername=e.placeholdername,this._setContentFromPlaceHolder(selected.textareaname),selected.focus()}},VisualMultiEditorBinding.prototype._noPlaceHolders=function(){var a=this.getContentWindow().bindingMap.templatetree,b=a.add(TreeNodeBinding.newInstance(a.bindingDocument));b.setLabel(StringBundle.getString("Composite.Web.VisualEditor","TemplateTree.NoTemplateWarning")),b.setImage("${icon:warning}"),b.attach();var c=this.getContentWindow().bindingMap.statusbar;c.setPlaceHolderName(null)},VisualMultiEditorBinding.prototype._setContentFromPlaceHolder=function(a){if(1==this._isFinalized){var b=this._textareas.get(a),c=b.placeholdermarkup;this.setValue(this.normalizeToDocument(c)),this.resetUndoRedo()}},VisualMultiEditorBinding.prototype._placeHolderSelected=function(a){1==this._isFinalized&&this._textareaname&&this._textareas.has(this._textareaname)&&(this._textareas.get(this._textareaname).placeholdermarkup=this.getValue()),this._textareaname=a,this._placeholdername=this._textareas.get(this._textareaname).placeholdername;var b=this.getContentWindow().bindingMap.statusbar;if(b.setPlaceHolderName(this._placeholdername),1==this._isFinalized){var c=this;Application.lock(c),setTimeout(function(){c._setContentFromPlaceHolder(a),Application.unlock(c)},0)}this.updateCssClasses()},VisualMultiEditorBinding.prototype.extractBody=function(a){var b=VisualMultiEditorBinding.superclass.extractBody.call(this,a);return this._xhtmls.set(this._textareaname,this._xhtml),b},VisualMultiEditorBinding.prototype._getHtmlMarkup=function(){var a=VisualEditorBinding.XHTML;return this._xhtmls.has(this._textareaname)&&(a=this._xhtmls.get(this._textareaname),null==a&&(a=VisualEditorBinding.XHTML)),a},VisualMultiEditorBinding.prototype.manifest=function(){null!=this._textareas&&this._textareas.hasEntries()&&(this._textareas.get(this._textareaname).placeholdermarkup=this.getValue(),this._textareas.each(function(a,b){b.textareaelement.value=b.placeholdermarkup}))},VisualMultiEditorBinding.prototype.updateElement=function(a,b,c){var d=a.getElementsByTagName("div").item(0),e=b.getElementsByTagName("div").item(0),f=new List(d.getElementsByTagName("textarea")),g=new List(e.getElementsByTagName("textarea"));if(f.getLength()!=g.getLength())c=!0;else{f.each(function(a,b){var d=g.get(b),e=a.getAttribute("placeholderid"),f=d.getAttribute("placeholderid"),h=a.getAttribute("placeholdername"),i=d.getAttribute("placeholdername");return e==f&&h==i||(c=!0),!c})}if(c){var h=null;null!=d.innerHTML?h=d.innerHTML:(h=DOMSerializer.serialize(d),h=h.substring(h.indexOf(">")+1,h.length),h=h.substring(0,h.lastIndexOf("<")));var i=this.bindingElement.getElementsByTagName("div").item(0);null!=i&&(i.innerHTML=h),this._updatePlaceHolders()}return!0},VisualMultiEditorBinding.prototype.getContextContainer=function(){var a=null,b=this.getContainerClasses();if(void 0!=b){var c=ContextContainer.getAncestorContextContainer(this);a=null==c?new ContextContainer:c.clone(),a.setContainerClasses(b)}return a},VisualMultiEditorBinding.prototype.getContainerClasses=function(){var a=null,b=this._textareas.get(this._textareaname);return null!=b&&(a=b.containerclasses),a},VisualMultiTemplateEditorBinding.prototype=new VisualMultiEditorBinding,VisualMultiTemplateEditorBinding.prototype.constructor=VisualMultiTemplateEditorBinding,VisualMultiTemplateEditorBinding.superclass=VisualMultiEditorBinding.prototype,VisualMultiTemplateEditorBinding.prototype.toString=function(){return"[VisualMultiTemplateEditorBinding]"},VisualMultiTemplateEditorBinding.prototype.onBindingAttach=function(){VisualMultiTemplateEditorBinding.superclass.onBindingAttach.call(this),this._oldtextareas=new Map,this.getProperty("pageid")&&(this._pageId=this.getProperty("pageid"))},VisualMultiTemplateEditorBinding.prototype._onPageInitialize=function(a){VisualMultiTemplateEditorBinding.superclass._onPageInitialize.call(this,a),this.bindingElement.offsetWidth>1e3&&this.getContentWindow().bindingMap.visualeditorsplitbox.setLayout("4:1");var b=this;this.getContentWindow().bindingMap.visualeditorsplitbox.addActionListener(SplitterBinding.ACTION_DRAGGED,{handleAction:function(){b.handleCommand("CompositeUpdateLayout",!1,null)}})},VisualMultiTemplateEditorBinding.prototype._initialize=function(){var a=this,b=this.getDescendantBindingByLocalName("selector");b.attach(),this._populateTemplateSelector();var c=this.getContentWindow().bindingMap.templateselector;c.addActionListener(SelectorBinding.ACTION_SELECTIONCHANGED,{handleAction:function(){setTimeout(function(){a._onTemplateSelectionChanged()},0)}}),this.getContentWindow().bindingMap.templatetoolbar.show(),VisualMultiTemplateEditorBinding.superclass._initialize.call(this),this.updateTemplatePreview()},VisualMultiTemplateEditorBinding.prototype._populateTemplateSelector=function(){var a=this.getDescendantBindingByLocalName("selector"),b=this.getContentWindow().bindingMap.templateselector;a.selections.each(function(a){a.imageProfile=new ImageProfile({image:"${icon:page-template-template}"})}),b.populateFromList(a.selections)},VisualMultiTemplateEditorBinding.prototype._onTemplateSelectionChanged=function(){var a=this.getDescendantBindingByLocalName("selector"),b=this.getContentWindow().bindingMap.templateselector;a.selectByValue(b.getValue()),a.dispatchAction(PageBinding.ACTION_DOPOSTBACK),this.checkForDirty(!0)},VisualMultiTemplateEditorBinding.prototype._parsePlaceHolders=function(a){function b(a,b){var c=b;return d.has(a)&&(c=d.get(a).placeholdermarkup),c}var c=this._textareas,d=this._oldtextareas;for(null!=c&&c.each(function(a,b){d.set(a,b)}),this._textareas=new Map;a.hasNext();){var e=a.getNext(),f=e.getAttribute("placeholderid");this._textareas.set(f,{placeholderid:f,placeholdername:e.getAttribute("placeholdername"),placeholdermarkup:b(f,e.value),textareaelement:e,isSelected:"true"==e.getAttribute("selected"),containerclasses:e.getAttribute("containerclasses")})}var g=null,h=this.getContentWindow().bindingMap.templatetree,i=new Map;if(this._textareas.each(function(a,b){var c=h.add(TreeNodeBinding.newInstance(h.bindingDocument));c.setLabel(b.placeholdername),c.setImage("${icon:placeholder}"),c.setProperty("placeholder",!0),c.textareaname=a,i.set(b.placeholdername,c),b.isSelected&&(g=c)}),h.attachRecursive(),null!=g){var j=!0;if(this._oldtextareas.hasEntries()){j=!1;var k=new Map;this._textareas.each(function(a,b){k.set(b.placeholdername,!0)}),k.has(this._placeholdername)||(j=!0)}if(j){var l=this._textareas.get(g.textareaname);this._textareaname=g.textareaname,this._placeholdername=l.placeholdername,this._setContentFromPlaceHolder(g.textareaname),g.focus()}else{var m=i.get(this._placeholdername);this._textareaname=m.textareaname,m.focus()}}},VisualMultiTemplateEditorBinding.prototype._placeHolderSelected=function(a){VisualMultiTemplateEditorBinding.superclass._placeHolderSelected.call(this,a),this.updateBodyWidth()},VisualMultiTemplateEditorBinding.prototype._getElementsByTagName=function(a,b){var c=null;return c=Client.isWebKit||Client.isExplorer?a.getElementsByTagName(b):a.getElementsByTagName("ui:"+b)},VisualMultiTemplateEditorBinding.prototype.updateElement=function(a,b){var c=this._getElementsByTagName(a,"selector").item(0),d=this._getElementsByTagName(b,"selector").item(0),e=!1,f=!1;if(null!=c&&null!=d){var g=new List(this._getElementsByTagName(c,"selection")),h=new List(this._getElementsByTagName(d,"selection"));g.getLength()!=h.getLength()?(e=!0,f=!0):(g.each(function(a,b){var c=a.getAttribute("value"),d=h.get(b).getAttribute("value");return c!=d&&(e=!0),!e}),g.each(function(a,b){var c=a.getAttribute("selected"),d=h.get(b).getAttribute("selected");return c!=d&&(f=!0),!f}))}if(e){var i=this.bindingElement.getElementsByTagName("div").item(1);this.bindingWindow.DocumentManager.detachBindings(i,!0),i.innerHTML=DOMSerializer.serialize(c),this.bindingWindow.DocumentManager.attachBindings(i),this._populateTemplateSelector()}return f&&this.updateTemplatePreview(),VisualMultiTemplateEditorBinding.superclass.updateElement.call(this,a,b,f)},VisualMultiTemplateEditorBinding.prototype.enableDialogMode=function(){StageBinding.placeholderWidth=this.getPlaceholderWidth(),VisualMultiTemplateEditorBinding.superclass.enableDialogMode.call(this)},VisualMultiTemplateEditorBinding.prototype.disableDialogMode=function(){StageBinding.placeholderWidth=null,VisualMultiTemplateEditorBinding.superclass.disableDialogMode.call(this)},VisualMultiTemplateEditorBinding.prototype.getPlaceholderWidth=function(a){var b=null;void 0==a&&(a=this._textareaname);return this._templatePreview&&new List(this._templatePreview.Placeholders).each(function(c){if(c.PlaceholderId==a)return b=c.ClientRectangle.Width,!1}),b},VisualMultiTemplateEditorBinding.prototype.updateTemplatePreview=function(a){var b=this._pageId,c=this.getDescendantBindingByLocalName("selector").getValue();this._templatePreview=null;var d=this;PageTemplateService.GetTemplatePreviewInformation(b,c,function(a){d._templatePreview=a,d.updateBodyWidth()})},VisualMultiTemplateEditorBinding.prototype.getSoapTinyContent=function(a){var b=this._pageId,c=this._textareaname,d=this.getDescendantBindingByLocalName("selector").getValue(),e=this.getEffectiveWidth();return XhtmlTransformationsService.StructuredContentToTinyContentMultiTemplate(a,b,d,c,e)},VisualMultiTemplateEditorBinding.prototype.getImageTagForFunctionCall=function(a){var b=this._pageId,c=this._textareaname,d=this.getDescendantBindingByLocalName("selector").getValue(),e=this.getEffectiveWidth();return XhtmlTransformationsService.GetImageTagForFunctionCall2(a,b,d,c,e)},VisualMultiTemplateEditorBinding.prototype.getContextContainer=function(){var a=null,b=this._pageId,c=this.getContainerClasses(),d=ContextContainer.getAncestorContextContainer(this);return a=null==d?new ContextContainer:d.clone(),void 0!=c&&a.setContainerClasses(c),a.setProperty("pageId",b),a},CodeMirrorEditorPopupBinding.prototype=new EditorPopupBinding,CodeMirrorEditorPopupBinding.prototype.constructor=CodeMirrorEditorPopupBinding,CodeMirrorEditorPopupBinding.superclass=EditorPopupBinding.prototype,CodeMirrorEditorPopupBinding.CONTENT_TEMPLATE="sourceeditor/popup.xml",CodeMirrorEditorPopupBinding.prototype.toString=function(){return"[CodeMirrorEditorPopupBinding]"},CodeMirrorEditorPopupBinding.prototype.configure=function(a,b,c){this._editorBinding=a,this._codePressFrame=b,this._codePressEngine=c,WysiwygEditorPopupBinding.superclass.configure.call(this)},CodeMirrorEditorPopupBinding.prototype._configure=function(){switch(this._editorBinding.syntax){case SourceEditorBinding.syntax.XML:case SourceEditorBinding.syntax.XSL:case SourceEditorBinding.syntax.HTML:this._showMenuGroups("xml");break;default:this._hideMenuGroups("xml")}},CodeMirrorEditorPopupBinding.prototype.handleCommand=function(a,b,c){var d=this._editorBinding.getContentWindow(),e=null;switch(a){case"compositeInsert":e=d.bindingMap.insertbutton;break;case"compositeFormat":e=d.bindingMap.formatbutton}null!=e&&e.handleCommand(a,b,c)},CodeMirrorEditorBinding.prototype=new EditorBinding,CodeMirrorEditorBinding.prototype.constructor=CodeMirrorEditorBinding,CodeMirrorEditorBinding.superclass=EditorBinding.prototype,CodeMirrorEditorBinding.ACTION_INITIALIZED="codemirroreditor initialized",CodeMirrorEditorBinding.syntax={TEXT:"text",XML:"xml",XSL:"xsl",HTML:"html",CSS:"css",JAVASCRIPT:"js",CSHARP:"cs",CSHTML:"cshtml",ASPX:"aspx",SQL:"sql",SASS:"sass"},CodeMirrorEditorBinding.prototype.toString=function(){return"[CodeMirrorEditorBinding]"},CodeMirrorEditorBinding.prototype.onBindingRegister=function(){CodeMirrorEditorBinding.superclass.onBindingRegister.call(this),StringBundle.getString("Composite.Web.SourceEditor","Preload.Key")},CodeMirrorEditorBinding.prototype.onBindingAttach=function(){this.subscribe(BroadcastMessages.CODEMIRROR_LOADED),1==this.getProperty("embedded")&&(this._isEmbedded=!0);var a=this.getProperty("validate");1==a&&(this._hasStrictValidation=!0);var b=this.getProperty("strictsave");b===!1&&(this._strictSave=!1);var c=this.getProperty("validator");null!=c&&(this._validator=c),this.syntax=this.getProperty("syntax"),this.getProperty("debug")&&(this._startContent=Templates.getPlainText("sourcecodeeditor/"+this.syntax+".txt")),CodeMirrorEditorBinding.superclass.onBindingAttach.call(this)},CodeMirrorEditorBinding.prototype.handleBroadcast=function(a,b){switch(CodeMirrorEditorBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.CODEMIRROR_LOADED:var c=this.getContentWindow().bindingMap.codemirrorwindow;if(null!=c){var d=c.getContentWindow();if(b.broadcastWindow==d){switch(this._codemirrorWindow=d,this._codemirrorEditor=b.codemirrorEditor,this._codemirrorWrapperElement=b.codemirrorEditor.getWrapperElement(),this.syntax){case CodeMirrorEditorBinding.syntax.XML:this._codemirrorEditor.setOption("mode","application/xml");break;case CodeMirrorEditorBinding.syntax.XSL:case CodeMirrorEditorBinding.syntax.HTML:this._codemirrorEditor.setOption("mode","text/html");break;case CodeMirrorEditorBinding.syntax.CSS:this._codemirrorEditor.setOption("mode","text/css");break;case CodeMirrorEditorBinding.syntax.CSHARP:this._codemirrorEditor.setOption("mode","text/x-csharp");break;case CodeMirrorEditorBinding.syntax.CSHTML:this._codemirrorEditor.setOption("mode","application/x-cshtml");break;case CodeMirrorEditorBinding.syntax.JAVASCRIPT:this._codemirrorEditor.setOption("mode","text/javascript");break;case CodeMirrorEditorBinding.syntax.ASPX:this._codemirrorEditor.setOption("mode","application/x-aspx");break;case CodeMirrorEditorBinding.syntax.SASS:this._codemirrorEditor.setOption("mode","text/x-sass");break;case CodeMirrorEditorBinding.syntax.SQL:this._codemirrorEditor.setOption("mode","text/x-mssql");break;case CodeMirrorEditorBinding.syntax.TEXT:this._codemirrorEditor.setOption("mode","")}this.initializeEditorComponents(c);var e=this;this._codemirrorEditor.on("change",function(a){e.checkForDirty()}),this._codemirrorEditor.on("focus",function(a){e._activateEditor(!0)}),null!=this._pageBinding&&this._initialize(),this.unsubscribe(a)}}}},CodeMirrorEditorBinding.prototype._onPageInitialize=function(a){CodeMirrorEditorBinding.superclass._onPageInitialize.call(this,a),(Client.isExplorer||null!=this._codemirrorEditor)&&this._initialize()};CodeMirrorEditorBinding.prototype._activateEditor=function(a){if(a!=this._isActivated||this.isFocusable&&!this.isFocused){this._isActivated=a,EditorBinding.isActive=a;var b=this._codemirrorWindow.standardEventHandler;a?b.enableNativeKeys(!0):b.disableNativeKeys();var c=this.getContentWindow().bindingMap.broadcasterIsActive;null!=c&&(a?c.enable():c.disable()),a?(this.focus(),this._codemirrorWindow.focus()):(this._codemirrorWindow.blur(),this.blur())}};CodeMirrorEditorBinding.prototype.handleCommand=function(a,b,c){var d=CodeMirrorEditorBinding.superclass.handleCommand.call(this,a,c);return d},CodeMirrorEditorBinding.prototype._finalize=function(){this.setContent(this._startContent),CodeMirrorEditorBinding.superclass._finalize.call(this)},CodeMirrorEditorBinding.prototype.initializeEditorComponent=function(a){a.initializeSourceEditorComponent(this,this._codemirrorEditor)},CodeMirrorEditorBinding.prototype.handleContextMenu=function(a){},CodeMirrorEditorBinding.prototype.getEditorPopupBinding=function(){return top.app.bindingMap.sourcecodeeditorpopup},CodeMirrorEditorBinding.prototype.getEditorWindow=function(){return this._codemirrorWindow},CodeMirrorEditorBinding.prototype.getEditorDocument=function(){return null!=this._codemirrorWrapperElement?this._codemirrorWrapperElement.ownerDocument:null},CodeMirrorEditorBinding.prototype.setContent=function(a){return this._isFinalized||a!=this._startContent&&(this._startContent=a),this.isInitialized&&null!=this.getContentWindow().bindingMap&&(this.getContentWindow().bindingMap.editorpage.setContent(a),this.resetUndoRedo(),this._checksum=this.getCheckSum()),!0},CodeMirrorEditorBinding.prototype.getContent=function(){var a=this.getContentWindow().bindingMap.editorpage.getContent();return a?a:""},CodeMirrorEditorBinding.prototype.resetUndoRedo=function(){this._codemirrorEditor.clearHistory()},CodeMirrorEditorBinding.prototype.cover=function(a){null!=this._pageBinding&&this._pageBinding.cover(a)},CodeMirrorEditorBinding.prototype.updateElement=function(a){if(null!=a&&null!=this.shadowTree.dotnetinput){var b=a.getAttribute("value");null!=b&&b!=this.shadowTree.dotnetinput.value&&this.setValue(decodeURIComponent(b))}return!0},CodeMirrorEditorBinding.prototype.blurEditor=function(){},CodeMirrorEditorBinding.prototype.validate=function(){var a=!0,b=this.getContent();if(null!=this._validator)a=Validator.validateInformed(b,this._validator);else switch(this.syntax){case CodeMirrorEditorBinding.syntax.XML:case CodeMirrorEditorBinding.syntax.XSL:case CodeMirrorEditorBinding.syntax.HTML:var c=b.replace("&nbsp;","&#160;").replace("&ldquo;","“").replace("&rdguo;","”").replace("&lsquo;","‘").replace("&rsquo;","’").replace("&laquo;","«").replace("&raquo;","»").replace("&lsaquo;","‹").replace("&rsaquo;","›").replace("&bull;","•").replace("&deg;","°").replace("&hellip;","…").replace("&trade;","™").replace("&copy;","©").replace("&reg;","®").replace("&mdash;","—").replace("&ndash;","–").replace("&sup2;","²").replace("&sup3;","³").replace("&frac14;","¼").replace("&frac12;","½").replace("&frac34;","¾").replace("&times;","×").replace("&larr;","←").replace("&rarr;","→").replace("&uarr;","↑").replace("&darr;","↓").replace("&middot;","·").replace("<!doctype","<!DOCTYPE");if(c!=b&&(b=c,this.setContent(c)),a=XMLParser.isWellFormedDocument(b,!0,!this._strictSave),1==a&&this._hasStrictValidation)switch(this.syntax){case CodeMirrorEditorBinding.syntax.HTML:a=this._isValidHTML(b)}}return a},CodeMirrorEditorBinding.prototype._isValidHTML=function(a){var b=!0,c=XMLParser.parse(a),d=new List;if(null!=c){var e=c.documentElement;"html"!=e.nodeName&&d.add("MissingHtml"),e.namespaceURI!=Constants.NS_XHTML&&d.add("NamespaceURI");for(var f=null,g=null,h=new List(e.childNodes);h.hasNext();){var i=h.getNext();if(i.nodeType==Node.ELEMENT_NODE)switch(i.nodeName){case"head":null!=f&&d.add("MultipleHead"),null!=g&&d.add("HeadBodyIndex"),f=i;break;case"body":null!=g&&d.add("MultipleBody"),g=i;break;default:d.add("NotAllowedHtmlChild")}}null==f&&d.add("MissingHead"),null==g&&d.add("MissingBody")}return d.hasEntries()&&(b=!1,Dialog.error(StringBundle.getString("Composite.Web.SourceEditor","Invalid.HTML.DialogTitle"),StringBundle.getString("Composite.Web.SourceEditor","Invalid.HTML."+d.getFirst()))),b},CodeMirrorEditorBinding.prototype._isValidXSL=function(){return!0},CodeMirrorEditorBinding.prototype.getValue=CodeMirrorEditorBinding.prototype.getContent,CodeMirrorEditorBinding.prototype.setValue=CodeMirrorEditorBinding.prototype.setContent,CodeMirrorEditorBinding.prototype.getResult=CodeMirrorEditorBinding.prototype.getContent,CodeMirrorEditorBinding.prototype.setResult=CodeMirrorEditorBinding.prototype.setContent,CodeMirrorEditorBinding.prototype.createBookmark=function(){},CodeMirrorEditorBinding.prototype.restoreBookmark=function(){},CodeMirrorEditorBinding.prototype.hasBookmark=function(){},CodeMirrorEditorBinding.prototype.deleteBookmark=function(){},CodeMirrorEditorBinding.prototype.getCheckSum=function(){var a=null,b=this._pageBinding;return null!=b&&(a=b.getCheckSum()),a},ProgressBarBinding.prototype=new Binding,ProgressBarBinding.prototype.constructor=ProgressBarBinding,ProgressBarBinding.superclass=Binding.prototype,ProgressBarBinding.WIDTH=190,ProgressBarBinding.NOTCH=9,ProgressBarBinding._bindingInstance=null,ProgressBarBinding.notch=function(a){var b=ProgressBarBinding._bindingInstance;null!=b&&b.notch(a)},ProgressBarBinding.reload=function(){ProgressBarBinding._bindingInstance._cover.setWidth(ProgressBarBinding.WIDTH)},ProgressBarBinding.prototype.toString=function(){return"[ProgressBarBinding]"},ProgressBarBinding.prototype.onBindingAttach=function(){ProgressBarBinding.superclass.onBindingAttach.call(this),ProgressBarBinding._bindingInstance=this,this._cover=this.add(CoverBinding.newInstance(this.bindingDocument)),this._cover.setBusy(!1),this._cover.setWidth(ProgressBarBinding.WIDTH),this.shadowTree.cover=this._cover},ProgressBarBinding.prototype.notch=function(a){a=a?a:1;var b=this._cover.getWidth()-ProgressBarBinding.NOTCH*a;this._cover.setWidth(b>=0?b:0)},StartMenuItemBinding.prototype=new MenuItemBinding,
StartMenuItemBinding.prototype.constructor=StartMenuItemBinding,StartMenuItemBinding.superclass=MenuItemBinding.prototype,StartMenuItemBinding.prototype.toString=function(){return"[StartMenuItemBinding]"},StartMenuItemBinding.prototype.onBindingRegister=function(){StartMenuItemBinding.superclass.onBindingRegister.call(this),this.subscribe(BroadcastMessages.COMPOSITE_START),this.subscribe(BroadcastMessages.COMPOSITE_STOP)},StartMenuItemBinding.prototype.handleBroadcast=function(a,b){switch(StartMenuItemBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.COMPOSITE_START:this.isChecked||this.check(!0);break;case BroadcastMessages.COMPOSITE_STOP:this.isChecked&&this.uncheck(!0)}},StartMenuItemBinding.prototype.setChecked=function(a,b){StartMenuItemBinding.superclass.setChecked.call(this,a,b),b||(this.isChecked?EventBroadcaster.broadcast(BroadcastMessages.START_COMPOSITE):EventBroadcaster.broadcast(BroadcastMessages.STOP_COMPOSITE))},StartMenuItemBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:menuitem",a);return UserInterface.registerBinding(b,StartMenuItemBinding),UserInterface.getBinding(b)},KeySetBinding.prototype=new Binding,KeySetBinding.prototype.constructor=KeySetBinding,KeySetBinding.superclass=Binding.prototype,KeySetBinding.keyEventHandlers={},KeySetBinding.registerKeyEventHandler=function(a,b,c,d){var e=KeySetBinding.keyEventHandlers;if(1==Interfaces.isImplemented(IKeyEventHandler,d,!0)){"*"!=c&&(c=KeySetBinding._sanitizeKeyModifiers(c));var f=window.KeyEventCodes[b];f||(f=b.charCodeAt(0)),e[a]||(e[a]={}),e[a][f]||(e[a][f]={}),e[a][f][c]=d}},KeySetBinding.handleKey=function(a,b){var c=!1,d=b.keyCode,e=KeySetBinding.keyEventHandlers;if(e[a]&&e[a][d]){var f="[default]";f+=d!=KeyEventCodes.VK_SHIFT&&b.shiftKey?" shift":"",f+=Client.isMac?d!=KeyEventCodes.VK_COMMAND&&b.metaKey?" control":"":d!=KeyEventCodes.VK_CONTROL&&b.ctrlKey?" control":"",f+=d!=KeyEventCodes.VK_ALT&&b.altKey?" alt":"";var g=e[a][d][f];null==g&&(g=e[a][d]["*"]),null!=g&&(g.handleKeyEvent(b),c=!0)}return c},KeySetBinding._sanitizeKeyModifiers=function(a){function b(a){d[a]&&(c+=" "+a)}var c="[default]",d={};return a&&(new List(a.split(" ")).each(function(a){d[a]=!0}),b("shift"),b("control")),c},KeySetBinding.prototype.toString=function(){return"[KeySetBinding]"},KeySetBinding.prototype.onBindingAttach=function(){KeySetBinding.superclass.onBindingAttach.call(this);var a=this,b=new List(DOMUtil.getElementsByTagName(this.bindingElement,"key"));b.each(function(b){var c=b.getAttribute("oncommand"),d="true"==b.getAttribute("preventdefault");KeySetBinding.registerKeyEventHandler(a.bindingDocument,b.getAttribute("key"),b.getAttribute("modifiers"),{handleKeyEvent:function(b){DOMEvents.stopPropagation(b),d&&DOMEvents.preventDefault(b);a.bindingWindow.WindowManager;top.setTimeout(function(){Binding.evaluate(c,a)},0)}})})},CursorBinding.prototype=new Binding,CursorBinding.prototype.constructor=CursorBinding,CursorBinding.superclass=Binding.prototype,CursorBinding.fadeIn=function(a){a instanceof CursorBinding&&(a.setOpacity(0),a.show(),new Animation({modifier:9,onstep:function(b){a.setOpacity(Math.sin(b*Math.PI/180))},onstop:function(){a.setOpacity(1)}}).play())},CursorBinding.fadeOut=function(a){a instanceof CursorBinding&&new Animation({modifier:9,onstep:function(b){a.setOpacity(Math.cos(b*Math.PI/180))},onstop:function(){a.hide()}}).play()},CursorBinding.moveOut=function(a,b,c){a instanceof CursorBinding&&(c.x-=16,c.y-=16,new Animation({modifier:3,onstep:function(d){var e=Math.sin(d*Math.PI/180);a.setPosition(new Point((1-e)*b.x+(0+e)*c.x,(1-e)*b.y+(0+e)*c.y))},onstop:function(){CursorBinding.fadeOut(a)}}).play())},CursorBinding.prototype.toString=function(){return"[CursorBinding]"},CursorBinding.prototype.onBindingAttach=function(){CursorBinding.superclass.onBindingAttach.call(this),this._labelBinding=this.add(LabelBinding.newInstance(this.bindingDocument));var a=this.getProperty("image");null!=a&&this.setImage(a),this._stopIndicatorBinding=this.add(LabelBinding.newInstance(this.bindingDocument)),this._stopIndicatorBinding.attachClassName("indicator"),this._stopIndicatorBinding.setImage("${icon:cancel}"),this.hide(),this._stopIndicatorBinding.hide()},CursorBinding.prototype.setImage=function(a){this._labelBinding.setImage(a)},CursorBinding.prototype.showAcceptance=function(){if(this.isAccepting=!0,Client.isMozilla)this._stopIndicatorBinding.hide();else{var a=this;setTimeout(function(){a.isAccepting&&a._stopIndicatorBinding.hide()},0)}},CursorBinding.prototype.hideAcceptance=function(){if(this.isAccepting=!1,Client.isMozilla)this._stopIndicatorBinding.show();else{var a=this;setTimeout(function(){a.isAccepting||a._stopIndicatorBinding.show()},0)}},CursorBinding.prototype.show=function(){CursorBinding.superclass.show.call(this)},CursorBinding.prototype.setOpacity=function(a){this.bindingElement.style.opacity=new String(a),this._opacity=a},CursorBinding.prototype.getOpacity=function(){return this._opacity},CursorBinding.prototype.setPosition=function(a){this.bindingElement.style.left=a.x+"px",this.bindingElement.style.top=a.y+"px"},CursorBinding.prototype.getPosition=function(){return new Point(this.bindingElement.offsetLeft,this.bindingElement.offsetTop)},CursorBinding.prototype.fadeIn=function(){CursorBinding.fadeIn(this)},CursorBinding.prototype.fadeOut=function(){CursorBinding.fadeOut(this)},CoverBinding.prototype=new Binding,CoverBinding.prototype.constructor=CoverBinding,CoverBinding.superclass=Binding.prototype,CoverBinding.CLASSNAME_TRANSPARENT="transparent",CoverBinding.fadeOut=function(a){function b(b){a.bindingElement.style.opacity=new String(b)}a instanceof CoverBinding&&new Animation({modifier:18,onstep:function(c){Binding.exists(a)&&b(Math.cos(c*Math.PI/180))},onstop:function(){Binding.exists(a)&&a.hide()}}).play()},CoverBinding.fadeIn=function(a){function b(b){a.bindingElement.style.MozOpacity=new String(b)}a instanceof CoverBinding&&new Animation({modifier:18,onstart:function(){Binding.exists(a)&&(b(0),a.show())},onstep:function(c){Binding.exists(a)&&b(Math.sin(c*Math.PI/180))},onstop:function(){b(1)}}).play()},CoverBinding.prototype.toString=function(){return"[CoverBinding]"},CoverBinding.prototype.onBindingRegister=function(){CoverBinding.superclass.onBindingRegister.call(this),this.getProperty("blockevents")&&(this.addEventListener(DOMEvents.MOUSEDOWN),this.addEventListener(DOMEvents.MOUSEUP),this.addEventListener(DOMEvents.MOUSEMOVE),this.addEventListener(DOMEvents.CLICK),this.addEventListener(DOMEvents.DOUBLECLICK)),this.getProperty("doubletouchunlock")&&this.addEventListener(DOMEvents.TOUCHEND),1==this.getProperty("transparent")&&this.setTransparent(!0),0==this.getProperty("busy")&&(this._isBusy=!1),this._isBusy&&(this.bindingElement.style.cursor="wait")},CoverBinding.prototype.show=function(){CoverBinding.superclass.show.call(this),this._isBusy&&this.isVisible&&this.addEventListener(DOMEvents.MOUSEMOVE)},CoverBinding.prototype.hide=function(){CoverBinding.superclass.hide.call(this),this._isBusy&&!this.isVisible&&this._position&&(UncoverBinding.uncover(this._position),this.removeEventListener(DOMEvents.MOUSEMOVE))},CoverBinding.prototype.handleEvent=function(a){switch(CoverBinding.superclass.handleEvent.call(this,a),DOMEvents.stopPropagation(a),a.type){case DOMEvents.MOUSEMOVE:this._position=DOMUtil.getUniversalMousePosition(a);break;case DOMEvents.TOUCHEND:this.lastTouch&&Date.now()-this.lastTouch<300&&Application.isLocked&&Application.unlock(Application,!0),this.lastTouch=Date.now()}},CoverBinding.prototype.setBusy=function(a){a!=this._isBusy&&(a?this.bindingElement.style.cursor="wait":this.bindingElement.style.cursor="default",this._isBusy=a)},CoverBinding.prototype.setTransparent=function(a){a!=this._isTransparent&&(a?this.attachClassName(CoverBinding.CLASSNAME_TRANSPARENT):this.detachClassName(CoverBinding.CLASSNAME_TRANSPARENT),this._isTransparent=a)},CoverBinding.prototype.setWidth=function(a){a>=0&&(this.bindingElement.style.width=new String(a+"px"))},CoverBinding.prototype.getWidth=function(){return this.bindingElement.offsetWidth},CoverBinding.prototype.setHeight=function(a){a>=0&&(this.bindingElement.style.height=new String(a+"px"))},CoverBinding.prototype.getHeight=function(){return this.bindingElement.offsetHeight},CoverBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:cover",a);return UserInterface.registerBinding(b,CoverBinding)},UncoverBinding.prototype=new Binding,UncoverBinding.prototype.constructor=UncoverBinding,UncoverBinding.superclass=Binding.prototype,UncoverBinding._bindingInstance=null,UncoverBinding.uncover=function(a){var b=UncoverBinding._bindingInstance;Binding.exists(b)&&b.setPosition(a)},UncoverBinding.prototype.toString=function(){return"[UncoverBinding]"},UncoverBinding.prototype.setPosition=function(a){this.bindingElement.style.display="block";var b=this.boxObject.getDimension();a.x-=.5*b.w,a.y-=.5*b.h,a.x=a.x<0?0:a.x,a.y=a.y<0?0:a.y,this.bindingElement.style.left=String(a.x)+"px",this.bindingElement.style.top=String(a.y)+"px",this.bindingElement.style.cursor="wait";var c=this;setTimeout(function(){c.bindingElement.style.cursor="default",c.bindingElement.style.display="none"},0)},TheatreBinding.prototype=new Binding,TheatreBinding.prototype.constructor=TheatreBinding,TheatreBinding.superclass=Binding.prototype,TheatreBinding.CLASSNAME_INITIALIZED="initialized",TheatreBinding.prototype.toString=function(){return"[TheatreBinding]"},TheatreBinding.prototype.onBindingAttach=function(){TheatreBinding.superclass.onBindingAttach.call(this),this._canvas=document.createElement("canvas"),this.bindingElement.appendChild(this._canvas)},TheatreBinding.prototype.play=function(a){this._isFading=1==a,this._isPlaying||(Application.lock(this),this.show(),this._isPlaying=!0,this._isFading&&this._fade())},TheatreBinding.prototype._fade=function(){var a=this._canvas.getContext("2d"),b=parseInt(0);TheatreBinding._interval=top.setInterval(function(){b<.5?(a.fillStyle="rgba(0,0,0,"+new String(b)+")",a.clearRect(0,0,300,150),a.fillRect(0,0,300,150),b+=.002):(top.clearInterval(TheatreBinding._interval),TheatreBinding._interval=null)},50)},TheatreBinding.prototype.stop=function(){if(this._isPlaying){if(this._isFading){null!=TheatreBinding._interval&&top.clearInterval(TheatreBinding._interval);var a=this._canvas.getContext("2d");a.clearRect(0,0,300,150)}Application.unlock(this,!0),this.hide(),this._isPlaying=!1}},SourceCodeViewerBinding.prototype=new WindowBinding,SourceCodeViewerBinding.prototype.constructor=SourceCodeViewerBinding,SourceCodeViewerBinding.superclass=WindowBinding.prototype,SourceCodeViewerBinding.ACTION_INITIALIZED="sourcecodeviewer initialized",SourceCodeViewerBinding.URL_DEFAULT="${root}/content/misc/viewers/sourcecodeviewer/viewsourcecontent.aspx",SourceCodeViewerBinding.syntax={XML:"xml"},SourceCodeViewerBinding.stylesheets={xml:Resolver.resolve("${root}/transformations/viewsource-xml.xsl")},SourceCodeViewerBinding.prototype.toString=function(){return"[SourceCodeViewerBinding]"},SourceCodeViewerBinding.prototype.onBindingAttach=function(){switch(this._syntax=this.getProperty("syntax"),this._syntax){case SourceCodeViewerBinding.syntax.XML:var a=SourceCodeViewerBinding.stylesheets[this._syntax];this._transformer=new XSLTransformer,this._transformer.importStylesheet(a);break;default:throw"SourceCodeViewer: Syntax error!"}var b=DOMUtil.getElementsByTagName(this.bindingElement,"textarea").item(0);b&&(this._startcontent=b.value),this.setURL(SourceCodeViewerBinding.URL_DEFAULT),this.addActionListener(WindowBinding.ACTION_ONLOAD),SourceCodeViewerBinding.superclass.onBindingAttach.call(this)},SourceCodeViewerBinding.prototype.handleAction=function(a){switch(SourceCodeViewerBinding.superclass.handleAction.call(this,a),a.type){case WindowBinding.ACTION_ONLOAD:a.target==this&&(this._startcontent&&this.view(this._startcontent),this.dispatchAction(SourceCodeViewerBinding.ACTION_INITIALIZED),a.consume())}SourceCodeViewerBinding.superclass.handleAction.call(this,a)},SourceCodeViewerBinding.prototype.view=function(a){switch(this._syntax){case SourceCodeViewerBinding.syntax.XML:this._viewXML(a)}},SourceCodeViewerBinding.prototype._viewXML=function(a){var b=null;if(a&&(typeof a==Types.STRING?b=XMLParser.parse(a):a.nodeType&&a.nodeType==Node.DOCUMENT_NODE&&(b=object)),b){var c=this._transformer.transformToString(b);this._inject(c)}},SourceCodeViewerBinding.prototype._viewHTML=function(a){},SourceCodeViewerBinding.prototype._viewJavascript=function(a){},SourceCodeViewerBinding.prototype._inject=function(a){this.getContentDocument().body.innerHTML=a},PersistanceBinding.prototype=new Binding,PersistanceBinding.prototype.constructor=PersistanceBinding,PersistanceBinding.superclass=Binding.prototype,PersistanceBinding.USERDATAKEY="persistance",PersistanceBinding.GLOBALSTOREKEY=document.location.host,PersistanceBinding.TEMPLATE="storagetemplates/persistance.xml",PersistanceBinding.prototype.toString=function(){return"[PersistanceBinding]"},PersistanceBinding.prototype.getPersistanceMap=function(){var a=null,b=null;return a=1==Client.isExplorer?this._getDocExplorer():this._getDocMozilla(),null!=a&&(this._document=a,this.logger.fine(DOMSerializer.serialize(a,!0)),b=this._getPersistanceMap(this._document)),b},PersistanceBinding.prototype.persist=function(a){var b=this._getPersistanceDoc(a);alert(DOMSerializer.serialize(b,!0)),1==Client.isExplorer?this._persistDocExplorer(b):this._persistDocMozilla(b)},PersistanceBinding.prototype._getPersistanceMap=function(a){var b={};null==this._resolver&&(this._resolver=new XPathResolver,this._resolver.setNamespacePrefixResolver({p:Constants.NS_PERSISTANCE}));for(var c=this._resolver.resolveAll("p:persist",a.documentElement);c.hasNext();){var d=c.getNext(),e=d.getAttribute("id");b[e]={};for(var f=this._resolver.resolveAll("p:att",d);f.hasNext();){var g=f.getNext(),h=g.getAttribute("name"),i=g.getAttribute("value");b[e][h]=i}}return b},PersistanceBinding.prototype._getPersistanceDoc=function(a){var b=this._document,c=b.documentElement;for(c.setAttribute("version",Installation.versionString);c.hasChildNodes();)c.removeChild(c.lastChild);for(var d in a){var e=DOMUtil.createElementNS(Constants.NS_PERSISTANCE,"persist",b);e.setAttribute("id",d);for(var f in a[d]){var g=DOMUtil.createElementNS(Constants.NS_PERSISTANCE,"att",b);g.setAttribute("name",f),g.setAttribute("value",a[d][f]),e.appendChild(g)}c.appendChild(e)}return b},PersistanceBinding.prototype._getDocExplorer=function(){this.bindingElement.load(PersistanceBinding.USERDATAKEY);var a=this.bindingElement.XMLDocument;if(""==a.documentElement.namespaceURI){var b=PersistanceBinding.TEMPLATE,c=Templates.getTemplateElementText(b);a.loadXML(c);for(var d=a.documentElement;d.hasChildNodes();)d.removeChild(d.firstChild)}return a},PersistanceBinding.prototype._persistDocExplorer=function(a){var b=DOMSerializer.serialize(a,!0);this.bindingElement.XMLDocument.loadXML(b),this.bindingElement.save(PersistanceBinding.USERDATAKEY)},PersistanceBinding.prototype._getDocMozilla=function(){delete window.globalStorage[PersistanceBinding.GLOBALSTOREKEY].persistance;var a=null,b=window.globalStorage[PersistanceBinding.GLOBALSTOREKEY].persistance;if(b)a=XMLParser.parse(b);else{var c=PersistanceBinding.TEMPLATE;a=Templates.getTemplateDocument(c);for(var d=a.documentElement;d.hasChildNodes();)d.removeChild(d.lastChild)}return a},PersistanceBinding.prototype._persistDocMozilla=function(a){var b=DOMSerializer.serialize(a,!0);window.globalStorage[PersistanceBinding.GLOBALSTOREKEY].persistance=b},LocalizationSelectorBinding.prototype=new MenuBinding,LocalizationSelectorBinding.prototype.constructor=LocalizationSelectorBinding,LocalizationSelectorBinding.superclass=MenuBinding.prototype,LocalizationSelectorBinding.prototype.toString=function(){return"[LocalizationSelectorBinding]"},LocalizationSelectorBinding.prototype.onBindingAttach=function(){LocalizationSelectorBinding.superclass.onBindingAttach.call(this),this.subscribe(BroadcastMessages.UPDATE_LANGUAGES),this.subscribe(BroadcastMessages.TOLANGUAGE_UPDATED),this._populateFromLanguages(Localization.languages),this.addActionListener(MenuItemBinding.ACTION_COMMAND)},LocalizationSelectorBinding.prototype.handleBroadcast=function(a,b){switch(LocalizationSelectorBinding.superclass.handleBroadcast.call(this,a,b),a){case BroadcastMessages.TOLANGUAGE_UPDATED:ExplorerBinding.restoreFocuseNodes();break;case BroadcastMessages.UPDATE_LANGUAGES:this._populateFromLanguages(b);break;case BroadcastMessages.SAVE_ALL_DONE:this.unsubscribe(BroadcastMessages.SAVE_ALL_DONE),EventBroadcaster.broadcast(BroadcastMessages.CLOSE_VIEWS),this._invokeAction()}},LocalizationSelectorBinding.prototype.handleAction=function(a){switch(LocalizationSelectorBinding.superclass.handleAction.call(this,a),a.type){case MenuItemBinding.ACTION_COMMAND:this.onValueChange(a.target.selectionValue)}},LocalizationSelectorBinding.prototype._populateFromLanguages=function(a){if(null!=a&&a.hasEntries()&&a.getLength()>1){var b=new List;a.each(function(a){b.add(new SelectorBindingSelection(a.Name,a.SerializedActionToken,a.IsCurrent,null))}),this.populateFromList(b),this.bindingElement.style.display="block"}else this.bindingElement.style.display="none"},LocalizationSelectorBinding.prototype.populateFromList=function(a){if(!this.isAttached)throw"Could not populate unattached selector";var b=this.getDescendantBindingByLocalName("menugroup");if(b.detachRecursive(),b.bindingElement.innerHTML="",a.hasEntries())for(;a.hasNext();){var c=a.getNext();c.isSelected&&this.setLabel(c.label);var d=MenuItemBinding.newInstance(this.bindingDocument);d.imageProfile=c.imageProfile,d.setLabel(c.label),null!=c.tooltip&&d.setToolTip(c.tooltip),d.selectionValue=c.value,b.add(d),d.attach()}},LocalizationSelectorBinding.prototype.onValueChange=function(a){ExplorerBinding.saveFocusedNodes();var b=this;Dialog.warning(StringBundle.getString(StringBundle.UI,"UserElementProvider.ChangeOtherActiveLocaleDialogTitle"),StringBundle.getString(StringBundle.UI,"UserElementProvider.ChangeOtherActiveLocaleDialogText"),Dialog.BUTTONS_ACCEPT_CANCEL,{handleDialogResponse:function(c){switch(c){case Dialog.RESPONSE_ACCEPT:b._token=a,Application.hasDirtyDockTabs()?(b.subscribe(BroadcastMessages.SAVE_ALL_DONE),EventBroadcaster.broadcast(BroadcastMessages.SAVE_ALL)):(EventBroadcaster.broadcast(BroadcastMessages.CLOSE_VIEWS),b._invokeAction());break;case Dialog.RESPONSE_CANCEL:}}})},LocalizationSelectorBinding.prototype._invokeAction=function(){var a=SystemNode.taggedNodes.get("Root"),b=new SystemAction({Label:"Generated Action: Change Locale",ActionToken:this._token});SystemAction.invoke(b,a)},ResponseBinding.prototype=new Binding,ResponseBinding.prototype.constructor=ResponseBinding,ResponseBinding.superclass=Binding.prototype,ResponseBinding.ACTION_SUCCESS="response success",ResponseBinding.ACTION_OOOOKAY="response ooookay",ResponseBinding.ACTION_FAILURE="response failure",ResponseBinding.prototype.toString=function(){return"[ResponseBinding]"},ResponseBinding.prototype.onBindingAttach=function(){ResponseBinding.superclass.onBindingAttach.call(this),this.propertyMethodMap.checksum=this._update,this._update()},ResponseBinding.prototype._update=function(){this.getProperty("dirty")===!0&&this.dispatchAction(Binding.ACTION_DIRTY);var a=this.getProperty("status");if(null!=a)switch(a){case"success":this.dispatchAction(ResponseBinding.ACTION_SUCCESS);break;case"failure":this.dispatchAction(ResponseBinding.ACTION_FAILURE);break;case"ooookay":this.dispatchAction(ResponseBinding.ACTION_OOOOKAY)}var b=this.getProperty("messagequeueindex");null!=b&&b>MessageQueue.index&&MessageQueue.update(!0)},AddressBarBinding.prototype=new DataInputBinding,AddressBarBinding.prototype.constructor=AddressBarBinding,AddressBarBinding.superclass=DataInputBinding.prototype,AddressBarBinding.prototype.toString=function(){return"[AddressBarBinding]"},AddressBarBinding.prototype.onBindingAttach=function(){AddressBarBinding.superclass.onBindingAttach.call(this),this.pathBinding=PathBinding.newInstance(this.bindingDocument),this.shadowTree.box.appendChild(this.pathBinding.bindingElement),this.pathBinding.attach()},AddressBarBinding.prototype.handleEvent=function(a){switch(AddressBarBinding.superclass.handleEvent.call(this,a),a.type){case DOMEvents.CLICK:a.target===this.pathBinding.bindingElement&&(this._hideBreadcrumb(),this.shadowTree.input.value="",this.shadowTree.input.focus())}},AddressBarBinding.prototype.blur=function(){AddressBarBinding.superclass.blur.call(this),!this.isBreadcrumb||this.shadowTree.input.value||this.pathBinding.isVisible||this._showBreadcrumb()},AddressBarBinding.prototype.showBreadcrumb=function(a,b){this._stateKey=KeyMaster.getUniqueKey();var c=this.pathBinding;if(c.detachRecursive(),c.bindingElement.innerHTML="",void 0!=b&&b.reverse().each(function(a){var b=ToolBarButtonBinding.newInstance(c.bindingDocument);b.setLabel(a.getLabel()),c.add(b),b.attach(),b.entityToken=a.getEntityToken(),b.node=a,b.oncommand=function(){this.dispatchAction(PathBinding.ACTION_COMMAND)}},this),void 0!=a){var d=ToolBarButtonBinding.newInstance(c.bindingDocument);d.setLabel(a.getLabel()),c.add(d),d.attach()}this.shadowTree.input.value="",this.shadowTree.input.style.display="none",this.pathBinding.show(),this.isBreadcrumb=!0},AddressBarBinding.prototype.showAddreesbar=function(a){this.newState();var b=this.getState(),c=this;PageService.ConvertRelativePageUrlToAbsolute(a,function(a){b===c.getState()&&c.setValue(a)}),this._hideBreadcrumb(),this.isBreadcrumb=!0},AddressBarBinding.prototype._hideBreadcrumb=function(){this.pathBinding.hide(),this.shadowTree.input.style.display="block"},AddressBarBinding.prototype._showBreadcrumb=function(){this.shadowTree.input.style.display="none",this.pathBinding.show()},AddressBarBinding.prototype.newState=function(){return this._stateKey=KeyMaster.getUniqueKey(),this._stateKey},AddressBarBinding.prototype.getState=function(){return this._stateKey},GenericViewBinding.prototype=new TreeBinding,GenericViewBinding.prototype.constructor=GenericViewBinding,GenericViewBinding.superclass=TreeBinding.prototype,GenericViewBinding.CLASSNAME="genericview",GenericViewBinding.CLASSNAME_SINGLE="single",GenericViewBinding.CLASSNAME_ICONSIZE="icons-s-170",GenericViewBinding.CLASSNAME_SINGLE_ICONSIZE="icons-s-400",GenericViewBinding.IMAGE_MAXWIDTH=300,GenericViewBinding.IMAGE_MAXHEIGHT=170,GenericViewBinding.LIST_IMAGE="listimage",GenericViewBinding.ACTION_COMMAND="generic action open",GenericViewBinding.prototype.toString=function(){return"[GenericViewBinding]"},GenericViewBinding.prototype.onBindingRegister=function(){GenericViewBinding.superclass.onBindingRegister.call(this),this.addActionListener(TreeNodeBinding.ACTION_COMMAND),this.attachClassName(GenericViewBinding.CLASSNAME),this.setContextMenu(top.app.bindingMap.systemtreepopup),this.perspectiveNode=StageBinding.perspectiveNode,1==this.getProperty("treeselector")&&(this._activePosition=SystemAction.activePositions.SelectorTree)},GenericViewBinding.prototype.handleAction=function(a){a.target;switch(a.type){case TreeNodeBinding.ACTION_COMMAND:case TreeNodeBinding.ACTION_OPEN:this.dispatchAction(new Action(a.target,GenericViewBinding.ACTION_COMMAND)),a.consume();break;case TreeNodeBinding.ACTION_COMMAND:a.consume()}GenericViewBinding.superclass.handleAction.call(this,a)},GenericViewBinding.prototype.setNode=function(a){if(this.node=a,this.empty(),this.detachClassName(GenericViewBinding.CLASSNAME_SINGLE),this.detachClassName(GenericViewBinding.CLASSNAME_SINGLE_ICONSIZE),this.detachClassName(GenericViewBinding.CLASSNAME_ICONSIZE),this.node)if(this.node.hasChildren())for(var b=this.node.getChildren();b.hasEntries();){var c=b.extractFirst();this.addNode(c),this.attachClassName(GenericViewBinding.CLASSNAME_ICONSIZE)}else this.attachClassName(GenericViewBinding.CLASSNAME_SINGLE),this.attachClassName(GenericViewBinding.CLASSNAME_SINGLE_ICONSIZE),this.addNode(this.node)},GenericViewBinding.prototype.addNode=function(a){var b=TreeNodeBinding.newInstance(this.bindingDocument);b.node=a;var c=b.node.getLabel();c&&b.setLabel(c);var d=b.node.getPropertyBag(),e=b.node.getImageProfile();if(d&&d.ListViewImage?this.hasClassName(GenericViewBinding.CLASSNAME_SINGLE)?b.setImage(d.ListViewImage.replace("{width}",this.bindingElement.offsetWidth-60).replace("{height}",this.bindingElement.offsetHeight-130)):(b.setImage(d.ListViewImage.replace("{width}",GenericViewBinding.IMAGE_MAXWIDTH).replace("{height}",GenericViewBinding.IMAGE_MAXHEIGHT)),b.attachClassName(GenericViewBinding.LIST_IMAGE)):e&&b.setImage(e.getDefaultImage()),d)for(var f in d)switch(f.toLowerCase()){case"id":case"key":break;default:b.setProperty(f,d[f])}b.isContainer=b.node.hasChildren(),this.add(b),b.attach()},GenericViewBinding.prototype.getSyncHandle=function(){return this.perspectiveNode.getHandle()},GenericViewBinding.prototype._handleSystemTreeFocus=function(){this.getFocusedTreeNodeBindings().hasEntries()&&EventBroadcaster.broadcast(BroadcastMessages.SYSTEM_ACTIONPROFILE_PUBLISHED,{activePosition:this._activePosition,actionProfile:this.getCompiledActionProfile(),syncHandle:this.getSyncHandle(),source:this})},GenericViewBinding.prototype.focusSingleTreeNodeBinding=function(a){GenericViewBinding.superclass.focusSingleTreeNodeBinding.call(this,a),null!=a&&this._handleSystemTreeFocus()},GenericViewBinding.prototype._navigateByKey=function(a){var b=this.getFocusedTreeNodeBindings();if(b.hasEntries()){var c=b.getFirst(),d=null;switch(a){case KeyEventCodes.VK_LEFT:d=c.getPreviousBindingByLocalName("treenode");break;case KeyEventCodes.VK_RIGHT:d=c.getNextBindingByLocalName("treenode");break;case KeyEventCodes.VK_DOWN:for(d=c.getNextBindingByLocalName("treenode");d&&d.bindingElement.offsetTop==c.bindingElement.offsetTop;)d=d.getNextBindingByLocalName("treenode");for(;d&&d.bindingElement.offsetLeft<c.bindingElement.offsetLeft;)d=d.getNextBindingByLocalName("treenode");break;case KeyEventCodes.VK_UP:for(d=c.getPreviousBindingByLocalName("treenode");d&&d.bindingElement.offsetTop==c.bindingElement.offsetTop;)d=d.getPreviousBindingByLocalName("treenode");for(;d&&d.bindingElement.offsetLeft>c.bindingElement.offsetLeft;)d=d.getPreviousBindingByLocalName("treenode")}null!=d&&this.focusSingleTreeNodeBinding(d)}},GenericViewBinding.prototype.getCompiledActionProfile=SystemTreeBinding.prototype.getCompiledActionProfile,GenericViewBinding.prototype.setActionGroup=SystemTreeBinding.prototype.setActionGroup,GenericViewBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:tree",a),c=UserInterface.registerBinding(b,GenericViewBinding);return c.treeBodyBinding=TreeBodyBinding.newInstance(a),c},GenericViewBinding.prototype.getSyncHandle=function(){return 1==this.getProperty("treeselector")?this.getAncestorBindingByType(PageBinding).getID():this.perspectiveNode.getHandle()},PathBinding.prototype=new Binding,PathBinding.prototype.constructor=PathBinding,PathBinding.superclass=Binding.prototype,PathBinding.ACTION_COMMAND="pathcommand",PathBinding.prototype.toString=function(){return"[PathBinding]"},PathBinding.prototype.onBindingRegister=function(){PathBinding.superclass.onBindingRegister.call(this)},PathBinding.prototype.onBindingAttach=function(){PathBinding.superclass.onBindingAttach.call(this)},PathBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:path",a);return UserInterface.registerBinding(b,PathBinding)};BrandSnippetBinding.prototype=new Binding;BrandSnippetBinding.prototype.constructor=BrandSnippetBinding,BrandSnippetBinding.superclass=Binding.prototype,BrandSnippetBinding.SHIPPET_URL="${root}/content/branding/{0}.inc?"+Application.CONSOLE_ID,BrandSnippetBinding.SHIPPETBRANDED_URL="${root}/content/branding/{0}-branded.inc?"+Application.CONSOLE_ID,BrandSnippetBinding.SnippetName=null,BrandSnippetBinding.snippetLoading=!1,BrandSnippetBinding.snippetLoaded=!1,BrandSnippetBinding.snippetLoad=function(a){function b(){var b=this;b.responseText?(BrandSnippetBinding.snippetLoading=!1,a.bindingElement.innerHTML=b.responseText):(b.open("GET",Resolver.resolve(a.getSnippetUrl())),b.send())}BrandSnippetBinding.snippetLoading=!0;var c=new XMLHttpRequest;c.onload=b,c.open("GET",Resolver.resolve(a.getSnippetBrandedUrl())),c.send()},BrandSnippetBinding.prototype.toString=function(){return"[BrandSnippetBinding]"},BrandSnippetBinding.prototype.onBindingRegister=function(){BrandSnippetBinding.superclass.onBindingRegister.call(this),BrandSnippetBinding.snippetLoad(this)},BrandSnippetBinding.prototype.onBindingAttach=function(){BrandSnippetBinding.superclass.onBindingAttach.call(this)},BrandSnippetBinding.prototype.getSnippetBrandedUrl=function(){return BrandSnippetBinding.SHIPPETBRANDED_URL.replace("{0}",this.getProperty("snippetname"))},BrandSnippetBinding.prototype.getSnippetUrl=function(){return BrandSnippetBinding.SHIPPET_URL.replace("{0}",this.getProperty("snippetname"))},BrandSnippetBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:brandsnippet",a);return UserInterface.registerBinding(b,BrandSnippetBinding)},UserInterfaceMapping.prototype.merge=function(a){for(var b in a.map)this.map[b]=a.getBindingImplementation(b)},UserInterfaceMapping.prototype.getBindingImplementation=function(a){var b=null,c=a.nodeName.toLowerCase();return this.map[c]&&(b=this.map[c]),b};var UserInterface=new function(){function a(a){if(1==Binding.exists(a)){var b=a.key;Binding.destroy(a),b&&(e[b]?(e[b].binding=null,e[b].element=null,delete e[b],a=null):d.error("URGH: "+b))}}var b=Client.isMozilla?MozEditorTextBoxBinding:IEEditorTextBoxBinding,c=new UserInterfaceMapping({body:RootBinding,"ui:binding":Binding,"ui:box":Binding,"ui:brandsnippet":BrandSnippetBinding,"ui:dialog":DialogBinding,"ui:dialoghead":DialogHeadBinding,"ui:dialogbody":DialogBodyBinding,"ui:dialogset":DialogSetBinding,"ui:dialogborder":DialogBorderBinding,"ui:dialogcover":DialogCoverBinding,"ui:titlebar":DialogTitleBarBinding,"ui:titlebarbody":DialogTitleBarBodyBinding,"ui:window":WindowBinding,"ui:controlgroup":ControlGroupBinding,"ui:control":ControlBinding,"ui:menubar":MenuBarBinding,"ui:menu":MenuBinding,"ui:menubody":MenuBodyBinding,"ui:menugroup":MenuGroupBinding,"ui:menuitem":MenuItemBinding,"ui:menupopup":MenuPopupBinding,"ui:tabbox":TabBoxBinding,"ui:tabs":TabsBinding,"ui:tab":TabBinding,"ui:tabpanels":TabPanelsBinding,"ui:tabpanel":TabPanelBinding,"ui:splitbox":SplitBoxBinding,"ui:splitpanel":SplitPanelBinding,"ui:splitter":SplitterBinding,"ui:decks":DecksBinding,"ui:deck":DeckBinding,"ui:toolbar":ToolBarBinding,"ui:toolbargroup":ToolBarGroupBinding,"ui:toolbarbody":ToolBarBodyBinding,"ui:toolbarbutton":ToolBarButtonBinding,"ui:toolbarlabel":ToolBarLabelBinding,"ui:labelbox":LabelBinding,"ui:text":TextBinding,"ui:clickbutton":ClickButtonBinding,"ui:tree":TreeBinding,"ui:treebody":TreeBodyBinding,"ui:treenode":TreeNodeBinding,"ui:flexbox":FlexBoxBinding,"ui:scrollbox":ScrollBoxBinding,"ui:popupset":PopupSetBinding,"ui:popup":PopupBinding,"ui:sourceeditor":CodeMirrorEditorBinding,"ui:visualeditor":VisualEditorBinding,"ui:visualmultieditor":VisualMultiEditorBinding,"ui:visualmultitemplateeditor":VisualMultiTemplateEditorBinding,"ui:wysiwygeditortoolbarbutton":EditorToolBarButtonBinding,"ui:dock":DockBinding,"ui:docktabs":DockTabsBinding,"ui:docktab":DockTabBinding,"ui:dockpanels":DockPanelsBinding,"ui:dockpanel":DockPanelBinding,"ui:page":PageBinding,"ui:editorpage":EditorPageBinding,"ui:dialogpage":DialogPageBinding,"ui:pagebody":DialogPageBodyBinding,"ui:wizardpage":WizardPageBinding,"ui:explorer":ExplorerBinding,"ui:explorermenu":ExplorerMenuBinding,"ui:explorertoolbar":ExplorerToolBarBinding,"ui:explorertoolbarbutton":ExplorerToolBarButtonBinding,"ui:stagecontainer":StageContainerBinding,"ui:stage":StageBinding,"ui:stagedecks":StageDecksBinding,"ui:stagedeck":StageDeckBinding,"ui:viewset":ViewSetBinding,"ui:view":ViewBinding,
"ui:broadcasterset":BroadcasterSetBinding,"ui:broadcaster":BroadcasterBinding,"ui:fields":FieldsBinding,"ui:fieldgroup":FieldGroupBinding,"ui:field":FieldBinding,"ui:fielddesc":FieldDescBinding,"ui:fielddata":FieldDataBinding,"ui:fieldhelp":FieldHelpBinding,"ui:datainput":DataInputBinding,"ui:selector":SelectorBinding,"ui:simpleselector":SimpleSelectorBinding,"ui:multiselector":MultiSelectorBinding,"ui:hierarchicalselector":HierarchicalSelectorBinding,"ui:datainputselector":DataInputSelectorBinding,"ui:datainputdialog":DataInputDialogBinding,"ui:urlinputdialog":UrlInputDialogBinding,"ui:datainputbutton":DataInputButtonBinding,"ui:textbox":TextBoxBinding,"ui:editortextbox":b,"ui:radiodatagroup":RadioDataGroupBinding,"ui:radio":RadioDataBinding,"ui:checkbutton":CheckButtonBinding,"ui:checkbox":CheckBoxBinding,"ui:checkboxgroup":CheckBoxGroupBinding,"ui:datadialog":DataDialogBinding,"ui:postbackdialog":PostBackDataDialogBinding,"ui:nullpostbackdialog":NullPostBackDataDialogBinding,"ui:htmldatadialog":HTMLDataDialogBinding,"ui:functioneditor":FunctionEditorDataBinding,"ui:parametereditor":ParameterEditorDataBinding,"ui:keyset":KeySetBinding,"ui:cover":CoverBinding,"ui:uncover":UncoverBinding,"ui:cursor":CursorBinding,"ui:dialogtoolbar":DialogToolBarBinding,"ui:focus":FocusBinding,"ui:balloonset":BalloonSetBinding,"ui:balloon":BalloonBinding,"ui:error":ErrorBinding,"ui:progressbar":ProgressBarBinding,"ui:lazybinding":LazyBindingBinding,"ui:sourcecodeviewer":SourceCodeViewerBinding,"ui:theatre":TheatreBinding,"ui:persistance":PersistanceBinding,"ui:filepicker":FilePickerBinding,"ui:request":RequestBinding,"ui:response":ResponseBinding,"ui:stylesheet":StyleBinding,"ui:resolvercontainer":ResolverContainerBinding}),d=SystemLogger.getLogger("UserInterface"),e={};this.registerBinding=function(a,b){var d=null;if(!this.hasBinding(a)){var f=DOMUtil.getParentWindow(a);if("bindingmapping"!=DOMUtil.getLocalName(a)){if(!b&&null!=a.getAttribute("binding")){var g=a.getAttribute("binding");if(b=f[g],null==b)throw"No such binding in scope: "+g}if(!b){var h=f.DocumentManager;if(h){var i=h.customUserInterfaceMapping;i&&(b=i.getBindingImplementation(a))}}if(b||(b=c.getBindingImplementation(a)),null!=b&&!Application.isMalFunctional)try{d=new b}catch(a){throw Application.isMalFunctional=!0,alert("No such binding!\n"+a.message+(a.stack?"\n"+a.stack:"")),a}if(d){var j=KeyMaster.getUniqueKey();a.setAttribute("key",j),d.key=j,a.id||(a.id=j),e[j]={element:a,binding:d},d.onBindingRegister()}}}return d},this.unRegisterBinding=function(b){a(b)},this.getElement=function(a){var b=null;return e[a.key]&&(b=e[a.key].element),b},this.getBinding=function(a){var b=null;if(a&&a.nodeType==Node.ELEMENT_NODE)try{var c=a.getAttribute("key");c&&e[c]&&(b=e[c].binding)}catch(b){alert("getBinding exception occurred on element:\n\n\t\t"+a),b.stack&&alert(b.stack)}return b},this.getBindingByKey=function(a){var b=null;return e[a]&&(b=e[a].binding),b},this.hasBinding=function(a){return null!=this.getBinding(a)},this.isBindingVisible=function(a){var b=Application.isOperational;if(1==b){var c=new Crawler;c.type=NodeCrawler.TYPE_ASCENDING,c.id="visibilitycrawler",c.addFilter(function(a){var c=UserInterface.getBinding(a),d=0;return c.isVisible||(b=!1,d=NodeCrawler.STOP_CRAWLING),d}),c.crawl(a.bindingElement),c.dispose()}return b};var f=null;this.getBindingCount=function(){var a=0;for(var b in e)a++;return a},this.setPoint=function(){f={};for(var a in e)f[a]=!0},this.getPoint=function(){var a=null;if(f){a=new List;for(var b in e)f[b]||a.add(b)}return a},this.clearPoint=function(){f=null},this.trackUndisposedBindings=function(){var a=null;for(var b in e){var c=e[b];c.binding&&c.element&&Binding.exists(c.binding)||(a||(a="Bindings illdisposed: "),a+=c.binding+" ")}null!=a&&d.error(a)},this.autoTrackDisposedBindings=function(a){a?window.disposedbindingtrackinterval||(window.disposedbindingtrackinterval=window.setInterval(UserInterface.trackUndisposedBindings,1e4),this.trackUndisposedBindings()):window.disposedbindingtrackinterval&&(window.clearInterval(window.disposedbindingtrackinterval),window.disposedbindingtrackinterval=null)}};SOAPMessage.prototype={document:null,envelope:null,header:null,body:null,fault:null},SOAPRequest.prototype=new SOAPMessage,SOAPRequest.prototype.constructor=SOAPRequest,SOAPRequest.superclass=SOAPMessage.prototype,SOAPRequest.resolver=new XPathResolver,SOAPRequest.resolver.setNamespacePrefixResolver({soap:Constants.NS_ENVELOPE,xhtml:Constants.NS_XHTML}),SOAPRequest.newInstance=function(a,b){var c=a+"/"+b,d=new SOAPRequest(c),e=SOAPRequest.resolver;return d.document=Templates.getTemplateDocument("soapenvelope.xml"),d.envelope=e.resolve("soap:Envelope",d.document),d.header=e.resolve("soap:Header",d.envelope),d.body=e.resolve("soap:Body",d.envelope),d},SOAPRequest._parseResponse=function(a){var b=null,c=!1,d=a.responseXML;if(null!=d&&null!=d.documentElement)switch(d.documentElement.namespaceURI){case Constants.NS_ENVELOPE:b=SOAPRequestResponse.newInstance(a.responseXML),Application.isOffLine&&EventBroadcaster.broadcast(BroadcastMessages.SERVER_ONLINE);break;case Constants.NS_XHTML:if(!Application.isOffLine){var e=SOAPRequest.resolver.resolve("xhtml:html/xhtml:body",a.responseXML);e&&"offline"==e.getAttribute("id")&&(c=!0)}break;case Constants.NS_DOMPARSEERROR:var f=DOMSerializer.serialize(d);SystemLogger.getLogger("SOAPRequest._parseResponse (static)").error(f),Application.isDeveloperMode&&alert("SOAPRequest parseerror! \n\n"+f);break;default:Application.isDeveloperMode&&alert("SOAPRequest: "+d.documentElement.namespaceURI)}else if(!Application.isOffLine&&!Application.isLoggedOut){var g=a.responseText;if(503==a.status||g.indexOf('id="offline"')>-1)c=!0;else if(403==a.status){if(Application.isLoggedIn){Application.isLoggedIn=!1;var h="Warning",g="You have been logged out";Dialog.warning(h,g,Dialog.BUTTONS_ACCEPT,{handleDialogResponse:function(a){window.location.reload()}})}}else{var f="Invalid SOAP response: \n\n"+a.responseText;SystemLogger.getLogger("SOAPRequest._parseResponse (static)").error(f),Application.isDeveloperMode&&(alert("Invalid SOAP response"),window.open("about:blank").document.write(a.responseText))}}return 1==c&&EventBroadcaster.broadcast(BroadcastMessages.SERVER_OFFLINE),b},SOAPRequest.prototype.invoke=function(a){var b=DOMUtil.getXMLHTTPRequest(),c=null;b.open("post",a,!1),b.setRequestHeader("Content-Type","text/xml; charset=UTF-8"),b.setRequestHeader("SOAPAction",this.action);try{b.send(this.document),c=SOAPRequest._parseResponse(b)}catch(b){var d="Dysfuntion in SOAP invoke: "+a;throw null!=this.document&&(d+="\n"+DOMSerializer.serialize(this.document,!0)),this.logger.error(d),b}return b=null,c},SOAPRequest.prototype.asyncInvoke=function(a,b){var c=DOMUtil.getXMLHTTPRequest();c.open("post",a,!0),c.setRequestHeader("Content-Type","text/xml; charset=UTF-8"),c.setRequestHeader("SOAPAction",this.action),c.onreadystatechange=function(){if(4==c.readyState){var a=SOAPRequest._parseResponse(c);b(a),c=null}},c.send(this.document)},SOAPRequest.prototype.dispose=function(){for(var a in this)this[a]=null},SOAPRequestResponse.prototype=new SOAPMessage,SOAPRequestResponse.prototype.constructor=SOAPRequestResponse,SOAPRequestResponse.superclass=SOAPMessage.prototype,SOAPRequestResponse.logger=SystemLogger.getLogger("SOAPRequestResponse"),SOAPRequestResponse.resolver=new XPathResolver,SOAPRequestResponse.resolver.setNamespacePrefixResolver({soap:Constants.NS_ENVELOPE}),SOAPRequestResponse.newInstance=function(a){var b=null;if(a&&a.documentElement){b=new SOAPRequestResponse;var c=SOAPRequestResponse.resolver;b.document=a,b.envelope=c.resolve("soap:Envelope",b.document),b.header=c.resolve("soap:Header",b.envelope),b.body=c.resolve("soap:Body",b.envelope);var d=c.resolve("soap:Fault",b.body);d&&(SOAPRequestResponse.logger.fatal(DOMSerializer.serialize(d,!0)),b.fault={element:d,faultNamespaceURI:d.namespaceURI,faultCode:DOMUtil.getTextContent(c.resolve("faultcode",d)),faultString:DOMUtil.getTextContent(c.resolve("faultstring",d)),detail:d.getElementsByTagName("detail").item(0)})}return b},SOAPFault.prototype.getOperationName=function(){return this._operationName},SOAPFault.prototype.getOperationAddress=function(){return this._operationAddress},SOAPFault.prototype.getFaultString=function(){return this._faultString},SOAPFault.newInstance=function(a,b){return new SOAPFault(a.name,a.address,b.faultString)},SOAPEncoder.prototype.encode=function(a){for(var b=SOAPRequest.newInstance(this._namespace,this._operation),c=this._appendElement(b.body,this._operation),d=this._wsdl.getSchema(),e=d.lookup(this._operation),f=e.getListedDefinitions();f.hasNext();){var g=f.getNext(),h=this._appendElement(c,g.name),i=a.getNext();this._resolve(h,g,i)}return b},SOAPEncoder.prototype._resolve=function(a,b,c){var d=this._wsdl.getSchema();if(b.isSimpleValue)this._appendText(a,c,"string"==b.type);else{var e=d.lookup(b.type);if(e instanceof SchemaSimpleType)alert("SOAPEncoder: SchemaSimpleType support not implemented!");else{var f=e.getListedDefinitions();if(e.isArray)for(var g=new List(c),h=f.getNext();g.hasNext();){var i=this._appendElement(a,h.name),j=g.getNext();this._resolve(i,h,j)}else if("undefined"==typeof c)this.logger.error("SOAPEncoder: value is undefined");else for(;f.hasNext();)try{var h=f.getNext(),i=this._appendElement(a,h.name),j=c[h.name];this._resolve(i,h,j)}catch(a){this.logger.error("Mysterius malfunction in "+this._operation+":\n\n"+h.name+": "+c)}}}},SOAPEncoder.prototype._appendElement=function(a,b){var c=DOMUtil.createElementNS(this._namespace,b,a.ownerDocument);return a.appendChild(c),c},SOAPEncoder.prototype._appendText=function(a,b,c){if(null!=b){b=new String(b);for(var d,e=new String(""),f=b.split(""),g=!1,h=0;d=f[h++];){var i=!0,j=d.charCodeAt(0);switch(j){case 9:case 10:case 13:i=!1;break;default:(j>=32&&j<=55295||j>=57344&&j<=65533||j>=65536&&j<=1114111)&&(i=!1)}i?g=!0:e+=d}g&&this.logger.debug("Illegal XML character(s) was deleted from the string: "+b),a.appendChild(a.ownerDocument.createTextNode(e))}},SOAPDecoder.prototype.resolve=function(a,b){return this._resolver.resolve("result:"+a,b)},SOAPDecoder.prototype.resolveAll=function(a,b){return this._resolver.resolveAll("result:"+a,b)},SOAPDecoder.prototype.decode=function(a){for(var b=null,c=this._wsdl.getSchema(),d=this._operation+"Response",e=this.resolve(d,a.body),f=c.lookup(d),g=f.getListedDefinitions();!b&&g.hasNext();){var h=g.getNext(),i=this.resolve(h.name,e);if(h.type==SchemaDefinition.TYPE_XML_DOCUMENT){b=DOMUtil.getDOMDocument();var j=i.getElementsByTagName("*").item(0);b.appendChild(b.importNode(j,!0))}else b=this._compute(i,h)}return b},SOAPDecoder.prototype._compute=function(a,b){var c=null,d=this._wsdl.getSchema();if(b.isSimpleValue)c=this._getSimpleValue(a,b.type);else{var e=d.lookup(b.type);if(e instanceof SchemaSimpleType)c=this._getSimpleValue(a,e.restrictionType);else{var f=e.getListedDefinitions();if(e.isArray){c=[];for(var g=f.getNext(),h=this.resolveAll(g.type,a);h.hasNext();){var i=h.getNext();c.push(this._compute(i,g))}}else if(null==a)c=null;else for(c={},f.reset();f.hasNext();){var g=f.getNext(),i=this.resolve(g.name,a);if(i)c[g.name]=this._compute(i,g);else if(g.isRequired)throw new Error("SOAPDecoder: invalid SOAP response.")}}}return c},SOAPDecoder.prototype._getSimpleValue=function(a,b){var c=null;if(null!=a&&a.firstChild&&a.firstChild.nodeType==Node.TEXT_NODE)switch(Client.isMozilla&&a.childNodes.length>1&&a.normalize(),c=a.firstChild.data,b){case Schema.types.STRING:c=c;break;case Schema.types.INT:case Schema.types.FLOAT:case Schema.types.DOUBLE:c=Number(c);break;case Schema.types.BOOLEAN:c="true"==c;break;default:throw'SOAPDecoder: schema type "'+b+'" not handled.'}return c},Schema.prototype=new XPathResolver,Schema.prototype.constructor=Schema,Schema.superclass=XPathResolver.prototype,Schema.types={STRING:"string",INT:"int",FLOAT:"float",DOUBLE:"double",BOOLEAN:"boolean"},Schema.notSupportedException=new Error("Schema: Schema structure not supported!"),Schema.prototype._parseSchema=function(a){this.setNamespacePrefixResolver({wsdl:Constants.NS_WSDL,soap:Constants.NS_SOAP,s:Constants.NS_SCHEMA});for(var b={},c=null,d=this.resolveAll("s:*[@name]",a);d.hasNext();){var e=d.getNext();switch(DOMUtil.getLocalName(e)){case"element":c=new SchemaElementType(this,e);break;case"complexType":c=new SchemaComplexType(this,e);break;case"simpleType":c=new SchemaSimpleType(this,e)}b[e.getAttribute("name")]=c}return b},Schema.prototype.lookup=function(a){return this._map[a]},SchemaDefinition.TYPE_XML_DOCUMENT="xmldocument",SchemaDefinition.prototype._parse=function(a){var b=a.getAttribute("minOccurs"),c=(a.getAttribute("maxOccurs"),a.getAttribute("type"));if(this.name=a.getAttribute("name"),this.isRequired="0"!=b,c){var d=c.split(":"),e=d[0],f=d[1];this.isSimpleValue="tns"!=e,this.type=f}else{var g=a.getElementsByTagName("*").item(0);g&&"complexType"==DOMUtil.getLocalName(g)&&"true"==g.getAttribute("mixed")&&(g=g.getElementsByTagName("*").item(0),g&&"sequence"==DOMUtil.getLocalName(g)&&(g=g.getElementsByTagName("*").item(0),"any"==DOMUtil.getLocalName(g)&&(this.type=SchemaDefinition.TYPE_XML_DOCUMENT)))}},SchemaType.prototype={},SchemaElementType.prototype=new SchemaType,SchemaElementType.prototype.constructor=SchemaElementType,SchemaElementType.superclass=SchemaType.prototype,SchemaElementType.prototype._parseListedDefinitions=function(a,b){var c=a.resolveAll("s:complexType/s:sequence/s:element",b);if(!c.hasEntries())throw this.logger.warn("SchemaElementType: Unparsed SchemaDefinition encountered."),Schema.notSupportedException;for(;c.hasNext();)this._definitions.add(new SchemaDefinition(c.getNext()))},SchemaElementType.prototype.getListedDefinitions=function(){return this._definitions.copy()},SchemaComplexType.prototype=new SchemaType,SchemaComplexType.prototype.constructor=SchemaComplexType,SchemaComplexType.superclass=SchemaType.prototype,SchemaComplexType.prototype._parseListedDefinitions=function(a,b){var c=a.resolveAll("s:sequence/s:element",b);if(!c.hasEntries())throw Schema.notSupportedException;for(;c.hasNext();){var d=c.getNext();this._definitions.add(new SchemaDefinition(d))}},SchemaComplexType.prototype.getListedDefinitions=function(){return this._definitions.copy()},SchemaSimpleType.prototype=new SchemaType,SchemaSimpleType.prototype.constructor=SchemaSimpleType,SchemaSimpleType.superclass=SchemaType.prototype,SchemaSimpleType.prototype._parse=function(a,b){var c=a.resolve("s:restriction",b);if(!c)throw Schema.notSupportedException;this.restrictionType=c.getAttribute("base").split(":")[1]},WebServiceResolver.prototype=new XPathResolver,WebServiceResolver.prototype.constructor=WebServiceResolver,WebServiceResolver.superclass=XPathResolver.prototype,WebServiceResolver.prototype._getDocumentElement=function(a){var b=null,c=DOMUtil.getXMLHTTPRequest();if(c.open("get",a,!1),c.send(null),!c.responseXML)throw alert(c.responseText),new Error("WebServiceResolver: Could not read WSDL: "+a);return b=c.responseXML.documentElement},WebServiceResolver.prototype.getPortAddress=function(){return this._WSDLURL.split("?WSDL")[0]},WebServiceResolver.prototype.getTargetNamespace=function(){return this._root.getAttribute("targetNamespace")},WebServiceResolver.prototype.getOperations=function(){var a=new List,b=this.resolveAll("wsdl:portType/wsdl:operation",this._root);if(!b.hasEntries())throw new Error("WebServiceResolver: No portType found.");for(;b.hasNext();){var c=b.getNext(),d=c.getAttribute("name");a.add(new WebServiceOperation(d,this.getPortAddress(),new SOAPEncoder(this,d),new SOAPDecoder(this,d)))}return a},WebServiceResolver.prototype.getSchema=function(){return this._schema},WebServiceOperation.prototype={name:null,address:null,encoder:null,decoder:null},WebServiceProxy.isLoggingEnabled=!0,WebServiceProxy.isDOMResult=!1,WebServiceProxy.isFaultHandler=!0,WebServiceProxy.createProxy=function(a){var b=new WebServiceResolver(a),c=new WebServiceProxy,d=b.getOperations();return d.each(function(a){c[a.name]=WebServiceProxy.createProxyOperation(a)}),c},WebServiceProxy.prototype._log=function(a,b){if(WebServiceProxy.isLoggingEnabled&&Application.isDeveloperMode&&b){var c=b instanceof SOAPRequest?"SOAPRequest for ":"SOAPResponse from ";c+=a.address+": "+a.name+"\n\n",c+=DOMSerializer.serialize(b.document,!0),this.logger.fine(c)}},WebServiceProxy.createProxyOperation=function(a){return function(){var b=new List(arguments),c=null;if("function"!=typeof b.getLast()){var d=a.encoder.encode(new List(arguments));this._log(a,d);var e=d.invoke(a.address);return this._log(a,e),e&&(e.fault?(c=SOAPFault.newInstance(a,e.fault),WebServiceProxy.isFaultHandler&&WebServiceProxy.handleFault(c,d,e)):c=WebServiceProxy.isDOMResult?e.document:a.decoder.decode(e)),d.dispose(),c}var f=b.extractLast(),d=a.encoder.encode(b);this._log(a,d);var g=this,e=d.asyncInvoke(a.address,function(b){g._log(a,b);var e=null;b&&(b.fault?e=SOAPFault.newInstance(a,b.fault):c=WebServiceProxy.isDOMResult?b.document:a.decoder.decode(b)),d.dispose(),f(c,e)})}},WebServiceProxy.handleFault=function(a,b,c){try{Dialog.invokeModal(Dialog.URL_SERVICEFAULT,null,{soapFault:a,soapRequest:b,soapResponse:c})}catch(b){alert(a.getFaultString())}};var ConfigurationService=null,ConsoleMessageQueueService=null,EditorConfigurationService=null,FlowControllerService=null,InstallationService=null,LocalizationService=null,LoginService=null,MarkupFormatService=null,PageService=null,ReadyService=null,SecurityService=null,SEOService=null,SourceValidationService=null,StringService=null,TreeService=null,XhtmlTransformationsService=null,FunctionService=null;window.MessageQueue=new function(){function a(){EventBroadcaster.broadcast(BroadcastMessages.MESSAGEQUEUE_EVALUATED,t)}function b(a){var b=a.Level.toLowerCase();SystemLogger.getLogger(a.SenderId)[b](a.Message)}function c(a){var b=l(a.Argument);if(b.hasEntries()){var c=ViewDefinition.clone("Composite.Management.PostBackView",a.ViewId);c.entityToken=a.EntityToken,c.flowHandle=a.FlowHandle,c.position=w[a.ViewType],c.label=a.Label,c.image=a.Image,c.toolTip=a.ToolTip,c.argument={url:a.Url,list:b},StageBinding.presentViewDefinition(c)}else StageBinding.presentViewDefinition(new HostedViewDefinition({handle:a.ViewId,entityToken:a.EntityToken,flowHandle:a.FlowHandle,position:w[a.ViewType],url:a.Url,label:a.Label,image:a.Image,toolTip:a.ToolTip}))}function d(a){StageBinding.presentViewDefinition(new DialogViewDefinition({handle:a.ViewId,flowHandle:a.FlowHandle,position:Dialog.MODAL,url:a.Url,handler:{handleDialogResponse:function(){setTimeout(function(){MessageQueue._nextAction()},250)}}}))}function e(a){var b=a.DialogType.toLowerCase();if("question"==b)throw"Not supported!";Dialog[b](a.Title,a.Message,null,{handleDialogResponse:function(){setTimeout(function(){MessageQueue._nextAction()},250)}})}function f(a){var b={},c=!1;new List(a.Argument).each(function(a){b[a.Key]=a.Value,c=!0});var d=ViewDefinitions[a.Handle];if(null==d)throw"Unknown ViewDefinition: "+param.Handle;var e=null;if(0==d.isMutable)e=d;else{e=new HostedViewDefinition;for(var f in d)e[f]=d[f];e.handle=a.ViewId}e.argument=c?b:null,StageBinding.presentViewDefinition(e)}function g(a){var b=ViewDefinition.clone("Composite.Management.GenericView",a.ViewId);b.label=a.Label,b.toolTip=a.ToolTip,b.image=a.Image,b.argument={url:a.Url,list:l(a.UrlPostArguments)},StageBinding.presentViewDefinition(b)}function h(a){var b=ViewDefinition.clone("Composite.Management.ExternalView",a.ViewId);b.label=a.Label,b.toolTip=a.ToolTip,b.image=a.Image,b.url=a.Url,StageBinding.presentViewDefinition(b)}function i(a){try{var b=ViewDefinition.clone("Composite.Management.SlideView",a.ViewId);b.label=a.Label,b.toolTip=a.ToolTip,b.image=a.Image,b.url=a.Url,StageBinding.presentViewDefinition(b)}catch(a){}}function j(a){StageBinding.isViewOpen(a.ViewId)?EventBroadcaster.broadcast(BroadcastMessages.CLOSE_VIEW,a.ViewId):MessageQueue._nextAction()}function k(a){EventBroadcaster.broadcast(BroadcastMessages.CURRENT_SAVED,{handle:a.ViewId,isSuccess:a.Succeeded})}function l(a){var b=new List;return new List(a).each(function(a){b.add({name:a.Key,value:a.Value})}),b}this.INTERVAL_ONLINE=5e3,this.INTERVAL_OFFLINE=1e3,this._actions=new List,this._index={},this.index=0;var m=SystemLogger.getLogger("MessageQueue"),n=null,o=0,p=null,q=new Map,r=new Map,s=!1,t=!1,u=!1,v=!1,w={Main:DockBinding.MAIN,External:DockBinding.EXTERNAL,BottomLeft:DockBinding.BOTTOMLEFT,BottomRight:DockBinding.BOTTOMRIGHT,RightTop:DockBinding.RIGHTTOP,RightBottom:DockBinding.RIGHTBOTTOM,AbsBottomLeft:DockBinding.ABSBOTTOMLEFT,AbsBottomRight:DockBinding.ABSBOTTOMRIGHT,Slide:DockBinding.SLIDE};this.initialize=function(){n=ConsoleMessageQueueService,o=n.GetCurrentSequenceNumber("dummyparam!"),this.index=o,EventBroadcaster.subscribe(BroadcastMessages.VIEW_COMPLETED,this),EventBroadcaster.subscribe(BroadcastMessages.VIEW_CLOSED,this),EventBroadcaster.subscribe(BroadcastMessages.SERVER_OFFLINE,this),EventBroadcaster.subscribe(BroadcastMessages.SERVER_ONLINE,this),window.messageQueueInterval=window.setInterval(MessageQueue._autoupdate,MessageQueue.INTERVAL_ONLINE)},this._autoupdate=function(){if(!s&&!MessageQueue._actions.hasEntries()){var a=WebServiceProxy.isLoggingEnabled;Application.isLoggedIn&&(t=!0,WebServiceProxy.isLoggingEnabled=!1,MessageQueue.update(),WebServiceProxy.isLoggingEnabled=a,t=!1)}},this._pokeserver=function(){1==s&&ReadyService.IsServerReady(!0)&&MessageQueue._lockSystem(!1)},this.update=function(a){Application.isLoggedIn&&(EventBroadcaster.broadcast(BroadcastMessages.MESSAGEQUEUE_REQUESTED,t),this._updateMessages(a))},this._updateMessages=function(b){if(u)v=!0;else{u=!0;var c=this,d=function(b){if(null!=b)if(Types.isDefined(b.CurrentSequenceNumber)){var d=b.CurrentSequenceNumber;d<c.index&&m.debug("SERVER WAS RESTARTED! old messagequeue index: "+c.index+", new messagequeue index: "+d),c.index=d;var e=new List(b.ConsoleActions);e.hasEntries()?c.evaluate(e):c._actions.hasEntries()||a()}else m.error("No sequencenumber in MessageQueue response!");u=!1,v&&(v=!1,c._updateMessages())};b?d(n.GetMessages(Application.CONSOLE_ID,this.index)):n.GetMessages(Application.CONSOLE_ID,this.index,d)}},this.evaluate=function(a){var b=new List;a.hasEntries()&&(a.each(function(a){1!=this._index[a.Id]&&b.add(a),this._index[a.Id]=!0},this),b.hasEntries()&&(this._actions.hasEntries()?this._actions.merge(b):this._actions=b,this._nextAction()))},this._closeAllViews=function(a){var b="(No reason)";null!=a&&(b=a.Reason);var c="Warning",d='The server has requested a close of all active editors for the following reason: "${reason}". It is recommended that you accept this request by clicking OK.';d=d.replace("${reason}",b);var e=this;Dialog.warning(c,d,Dialog.BUTTONS_ACCEPT_CANCEL,{handleDialogResponse:function(a){a==Dialog.RESPONSE_ACCEPT&&EventBroadcaster.broadcast(BroadcastMessages.CLOSE_VIEWS),e._nextAction()}})},this._nextAction=function(){var l=null;if(this._actions.hasEntries()){var n=this._actions.extractFirst();switch(o=n.SequenceNumber,m.debug("MessageQueue action: "+n.ActionType+" > QUEUE-MAX-SEQNUM: "+this.index+" > CURRENT SEQNUM: "+o+" > ACTIONS-LEFT: "+this._actions.getLength()),n.ActionType){case"OpenView":l=n.OpenViewParams,"ModalDialog"==l.ViewType?d(l):(p=l.ViewId,c(l));break;case"CloseView":l=n.CloseViewParams,p=l.ViewId,j(l);break;case"RefreshTree":EventBroadcaster.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESH,n.RefreshTreeParams.EntityToken);var r="REFRESHING TREES: "+q.countEntries()+"\n";q.each(function(a){r+="\n\tTOKEN: "+a}),m.debug(r),q.hasEntries()||(EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this),EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this),this._nextAction());break;case"SelectElement":var s=n.SelectElementParams.PerspectiveElementKey,t=n.SelectElementParams.EntityToken;StageBinding.select(s).then(function(){EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_FOCUS,t)}),this._nextAction();break;case"MessageBox":e(n.MessageBoxParams);break;case"OpenViewDefinition":l=n.OpenViewDefinitionParams,p=l.Handle,f(l);break;case"LogEntry":b(n.LogEntryParams),this._nextAction();break;case"Reboot":Application.reload(!0);break;case"LockSystem":MessageQueue._lockSystem(!0);break;case"BroadcastMessage":l=n.BroadcastMessageParams,m.debug('Server says: EventBroadcaster.broadcast ( "'+l.Name+'", '+l.Value+" )"),EventBroadcaster.broadcast(l.Name,l.Value),this._nextAction();break;case"CollapseAndRefresh":EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_COLLAPSEALL),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this),EventBroadcaster.subscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this),EventBroadcaster.broadcast(BroadcastMessages.SYSTEMTREEBINDING_REFRESHALL),q.hasEntries()||(EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this),EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this),this._nextAction());break;case"CloseAllViews":this._closeAllViews(n.CloseAllViewsParams);break;case"SaveStatus":k(n.SaveStatusParams),this._nextAction();break;case"DownloadFile":Download.init(n.DownloadFileParams.Url),this._nextAction();break;case"ExpandTreeNode":this._nextAction();break;case"BindEntityTokenToView":l=n.BindEntityTokenToViewParams,EventBroadcaster.broadcast(BroadcastMessages.BIND_TOKEN_TO_VIEW,{handle:l.ViewId,entityToken:l.EntityToken}),this._nextAction();break;case"OpenGenericView":l=n.OpenGenericViewParams,g(l);break;case"OpenExternalView":l=n.OpenExternalViewParams,h(l);break;case"OpenSlideView":l=n.OpenSlideViewParams,i(l);break;default:Dialog.error("Dysfunction","Unhandled action: "+n.ActionType)}}else a()},this._lockSystem=function(a){var b=top.bindingMap.offlinetheatre;if(a)b.play(!0),window.clearInterval(window.messageQueueInterval),window.messageQueueInterval=window.setInterval(MessageQueue._pokeserver,MessageQueue.INTERVAL_OFFLINE);else{b.stop(),window.clearInterval(window.messageQueueInterval),window.messageQueueInterval=window.setInterval(MessageQueue._autoupdate,MessageQueue.INTERVAL_ONLINE);var c=this;setTimeout(function(){c._actions.hasEntries()&&c._nextAction()},0)}s=a},this.placeConsoleCommand=function(a){n.PlaceConsoleCommand(Application.CONSOLE_ID,a)},this.handleBroadcast=function(a,b){switch(a){case BroadcastMessages.APPLICATION_LOGIN:this.initialize();break;case BroadcastMessages.VIEW_COMPLETED:case BroadcastMessages.VIEW_CLOSED:null!=p&&b==p&&(p=null,this._nextAction());break;case BroadcastMessages.SYSTEMTREEBINDING_REFRESHING:null!=b?q.set(b,!0):m.debug("Saa har vi balladen!");break;case BroadcastMessages.SYSTEMTREEBINDING_REFRESHED:q.hasEntries()&&(q.del(b),m.debug("Refreshed tree: "+b+"\n("+q.countEntries()+" trees left!)"),q.hasEntries()||(EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHING,this),EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREEBINDING_REFRESHED,this),setTimeout(function(){MessageQueue._nextAction()},0)));break;case BroadcastMessages.SYSTEMTREENODEBINDING_FORCING_OPEN:r.set(b,!0);break;case BroadcastMessages.SYSTEMTREENODEBINDING_FORCED_OPEN:1==r.hasEntries()&&(r.del(b),r.hasEntries()||(EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREENODEBINDING_FORCING_OPEN,this),EventBroadcaster.unsubscribe(BroadcastMessages.SYSTEMTREENODEBINDING_FORCED_OPEN,this),MessageQueue._nextAction()));break;case BroadcastMessages.SERVER_OFFLINE:MessageQueue._lockSystem(!0);break;case BroadcastMessages.SERVER_ONLINE:MessageQueue._lockSystem(!1)}},EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_LOGIN,this)};var ViewDefinitions={"Composite.Management.Null":new HostedViewDefinition({isMutable:!0,handle:"Composite.Management.Null"}),"Composite.Management.PostBackDialog":new DialogViewDefinition({handle:"Composite.Management.PostBackDialog",isMutable:!0,position:Dialog.MODAL,url:"${root}/content/dialogs/postback/postbackdialog.aspx",argument:{url:null,list:null}}),"Composite.Management.PostBackView":new HostedViewDefinition({handle:"Composite.Management.PostBackView",isMutable:!0,position:DockBinding.MAIN,url:"${root}/postback.aspx",argument:{url:null,list:null}}),"Composite.Management.GenericView":new HostedViewDefinition({handle:"Composite.Management.GenericView",isMutable:!0,position:DockBinding.MAIN,url:"${root}/content/views/generic/generic.aspx",label:null,image:null,toolTip:null,argument:{url:null,list:null}}),"Composite.Management.ExternalView":new HostedViewDefinition({handle:"Composite.Management.ExternalView",isMutable:!0,position:DockBinding.EXTERNAL,url:null,label:null,image:null,toolTip:null}),"Composite.Management.SlideView":new HostedViewDefinition({handle:"Composite.Management.SlideView",isMutable:!0,position:DockBinding.SLIDE,url:null,label:null,image:null,toolTip:null}),"Composite.Management.Start":new HostedViewDefinition({handle:"Composite.Management.Start",position:DockBinding.START,label:"Welcome Travellers",isFloating:!1,url:"${root}/content/views/start/start.aspx"}),"Composite.Management.About":new DialogViewDefinition({handle:"Composite.Management.About",position:Dialog.MODAL,url:"${root}/content/dialogs/about/about.aspx"}),"Composite.Management.PermissionEditor":new HostedViewDefinition({isMutable:!0,handle:"Composite.Management.PermissionEditor",position:DockBinding.MAIN,url:"${root}/content/views/editors/permissioneditor/permissioneditor.aspx",argument:{serializedEntityToken:"entityTokenType='Composite\\.Plugins\\.Elements\\.ElementProviders\\.VirtualElementProvider\\.VirtualElementProviderEntityToken,Composite'entityToken='_EntityToken_Type_=\\'Composite\\\\\\.Plugins\\\\\\.Elements\\\\\\.ElementProviders\\\\\\.VirtualElementProvider\\\\\\.VirtualElementProviderEntityToken,Composite\\'_EntityToken_Source_=\\'VirtualElementProvider\\'_EntityToken_Id_=\\'DesignPerspective\\''\""}}),"Composite.Management.SystemLog":new HostedViewDefinition({handle:"Composite.Management.SystemLog",position:DockBinding.ABSBOTTOMLEFT,label:"System Log",url:"${root}/content/views/dev/systemlog/systemlog.aspx"}),"Composite.Management.Developer":new HostedViewDefinition({handle:"Composite.Management.Developer",position:DockBinding.ABSBOTTOMRIGHT,label:"Developer",url:"${root}/content/views/dev/developer/developer.aspx"}),"Composite.Management.IconPack.SpriteSVG":new HostedViewDefinition({handle:"Composite.Management.IconPack.SpriteSVG",position:DockBinding.MAIN,label:"Sprite SVG",image:"${icon:icon}",url:"${root}/console/?pageId=svg-sprites"}),"Composite.Management.Options":new DialogViewDefinition({handle:"Composite.Management.Options",position:Dialog.MODAL,url:"${root}/content/dialogs/options/options.aspx",label:"Options"}),"Composite.Management.VisualEditorDialog":new DialogViewDefinition({isMutable:!0,handle:"Composite.Management.VisualEditorDialog",position:Dialog.MODAL,url:"${root}/content/dialogs/wysiwygeditor/wysiwygeditordialog.aspx",width:1280,height:800,argument:{formattingconfiguration:null,embedablefieldstypenames:null}}),"Composite.Management.MultiSelectorDialog":new DialogViewDefinition({isMutable:!0,handle:"Composite.Management.MultiSelectorDialog",position:Dialog.MODAL,url:"${root}/content/dialogs/multiselector/multiselectordialog.aspx"}),"Composite.Management.Search":new HostedViewDefinition({handle:"Composite.Management.Search",position:DockBinding.RIGHTBOTTOM,url:"${root}/content/views/search/search.aspx",label:"Search",image:"${icon:view_search}",argument:null}),"Composite.Management.Browser":new HostedViewDefinition({isMutable:!1,isPinned:!0,handle:"Composite.Management.Browser",position:DockBinding.MAIN,perspective:ExplorerBinding.PERSPECTIVE_CONTENT,label:"${string:Composite.Management:Browser.Label}",image:"${icon:page-view-administrated-scope}",toolTip:"${string:Composite.Management:Browser.ToolTip}",
url:"${root}/content/views/browser/browser.aspx",argument:{URL:null}}),"Composite.Management.SEOAssistant":new HostedViewDefinition({handle:"Composite.Management.SEOAssistant",position:DockBinding.ABSBOTTOMRIGHT,perspective:ExplorerBinding.PERSPECTIVE_CONTENT,url:"${root}/content/views/seoassist/seoassist.aspx",label:"${string:Composite.Web.SEOAssistant:SEOAssistant}",image:"${icon:seoassistant}",toolTip:"${string:Composite.Web.SEOAssistant:SEOAssistant.ToolTip}"}),"Composite.Management.SourceCodeViewer":new HostedViewDefinition({isMutable:!0,handle:"Composite.Management.SourceCodeViewer",position:DockBinding.ABSBOTTOMLEFT,url:"${root}/content/views/dev/viewsource/viewsource.aspx",argument:{action:null,viewBinding:null}}),"Composite.User.SourceCodeViewer":new HostedViewDefinition({isMutable:!0,handle:"Composite.User.SourceCodeViewer",position:DockBinding.BOTTOMLEFT,url:"${root}/content/views/dev/viewsource/viewsource.aspx",argument:{action:null,viewBinding:null}}),"Composite.Management.Help":new HostedViewDefinition({label:"${string:Website.App.LabelHelp}",image:"${icon:help}",handle:"Composite.Management.Help",position:DockBinding.ABSRIGHTTOP,url:"${root}/content/views/help/help.aspx"}),"Composite.Management.Dialog.Translations":new DialogViewDefinition({handle:"Composite.Management.TranslationsDialog",position:Dialog.MODAL,url:"${root}/content/dialogs/translations/translations.aspx",label:"Translations",image:"${icon:users-changepublicculture}"}),"Composite.Management.ImageSelectorDialog":new DialogViewDefinition({isMutable:!0,handle:"Composite.Management.ImageSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_IMAGESELECTOR,argument:{label:"${string:Composite.Management:Website.Image.SelectDialog.Title}",image:"${icon:image}",selectionProperty:"ElementType",selectionValue:"image/jpeg image/gif image/png image/bmp image/tiff image/svg+xml",selectionResult:"Uri",nodes:[{key:"MediaFileElementProvider",search:"MediaFileElementProvider.WebImages"}]}}),"Composite.Management.MediaWritableFolderSelectorDialog":new DialogViewDefinition({isMutable:!0,handle:"Composite.Management.MediaWritableFolderSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREEACTIONSELECTOR,argument:{label:"${string:Composite.Management:Website.Folder.SelectDialog.Title}",image:"${icon:image}",selectionProperty:"ReadOnly",selectionValue:"False",selectionResult:"EntityToken",actionGroup:"Folder",nodes:[{key:"MediaFileElementProvider",search:"MediaFileElementProvider.WritableFolders"}]}}),"Composite.Management.EmbeddableMediaSelectorDialog":new DialogViewDefinition({isMutable:!0,handle:"Composite.Management.EmbeddableMediaSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREEACTIONSELECTOR,argument:{label:"${string:Composite.Management:Website.Media.SelectDialog.Title}",image:"${icon:media}",selectionProperty:"ElementType",selectionValue:null,selectionResult:"Uri",nodes:[{key:"MediaFileElementProvider",search:null}]}}),"Composite.Management.FrontendFileSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.EmbeddableMediaSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREEACTIONSELECTOR,argument:{label:"${string:Composite.Management:Website.FrontendFile.SelectDialog.Title}",image:"${icon:media}",selectionProperty:"ElementType",selectionValue:null,selectionResult:"Uri",nodes:[{key:"LayoutFileElementProvider"}]}}),"Composite.Management.PageSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.PageSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.Page.SelectDialog.Title}",image:"${icon:page}",selectionProperty:"Uri",selectionValue:null,selectionResult:"Uri",hasPreview:!0,nodes:[{key:"PageElementProvider"}]}}),"Composite.Management.PageIdSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.PageIdSelectorDialog",isMutable:!0,position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.Page.SelectDialog.Title}",image:"${icon:page}",selectionProperty:"DataId",selectionValue:null,selectionResult:"DataId",nodes:[{key:"PageElementProvider"}]}}),"Composite.Management.LinkableSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.LinkableSelectorDialog",isMutable:!0,position:Dialog.MODAL,url:Dialog.URL_TREEACTIONSELECTOR,argument:{label:"${string:Composite.Management:Website.ContentLink.SelectDialog.Title}",image:"${icon:link}",selectionProperty:"Uri",selectionValue:null,selectionResult:"Uri",hasPreview:!0,nodes:[{key:"PageElementProvider"},{key:"MediaFileElementProvider"}]}}),"Composite.Management.MediaSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.MediaSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.ContentLink.SelectDialog.Title}",image:"${icon:link}",selectionProperty:"Uri",selectionValue:null,selectionResult:"Uri",nodes:[{key:"MediaFileElementProvider"}]}}),"Composite.Management.TreeSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.TreeSelectorDialog",isMutable:!0,position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"",image:"${icon:link}",selectionProperty:"ElementType",selectionValue:null,selectionResult:null,nodes:[{key:null}]}}),"Composite.Management.FunctionSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.FunctionSelectorDialog",isMutable:!0,position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.Function.SelectDialog.Title}",image:"${icon:functioncall}",selectionProperty:"ElementType",selectionValue:MimeTypes.COMPOSITEFUNCTION,selectionResult:"ElementId",nodes:[{key:"AllFunctionsElementProvider"}]}}),"Composite.Management.WidgetFunctionSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.WidgetFunctionSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.Widget.SelectDialog.Title}",image:"${icon:functioncall}",selectionProperty:"ElementType",selectionValue:MimeTypes.COMPOSITEFUNCTION,selectionResult:"ElementId",nodes:[{key:"AllWidgetFunctionsElementProvider"}]}}),"Composite.Management.XhtmlDocumentFunctionSelectorDialog":new DialogViewDefinition({handle:"Composite.Management.XhtmlDocumentFunctionSelectorDialog",position:Dialog.MODAL,url:Dialog.URL_TREESELECTOR,argument:{label:"${string:Composite.Management:Website.Function.SelectDialog.Title}",image:"${icon:functioncall}",selectionProperty:"ElementType",selectionValue:MimeTypes.COMPOSITEFUNCTION,selectionResult:"ElementId",nodes:[{key:"AllFunctionsElementProvider",search:"AllFunctionsElementProvider.VisualEditorFunctions"}]}})},KickStart=new function(){function a(a){new List([BroadcastMessages.PERSISTANCE_INITIALIZED,BroadcastMessages.APPLICATION_STARTUP,BroadcastMessages.APPLICATION_LOGIN,BroadcastMessages.APPLICATION_OPERATIONAL]).each(function(b){a?EventBroadcaster.subscribe(b,KickStart):EventBroadcaster.unsubscribe(b,KickStart)})}function b(a){switch(a){case BroadcastMessages.PERSISTANCE_INITIALIZED:j=!0}j&&(null!=bindingMap.decks&&LoginService.IsLoggedIn(!0)?g():null!=bindingMap.decks?e():d()),c()}function c(){for(var a=document.getElementsByClassName("js-applicationname"),b=0;b<a.length;++b)a[b].innerHTML=Installation.applicationName}function d(){Application.unlock(KickStart),null!=window.Welcome&&Welcome.test()}function e(){EventBroadcaster.subscribe(BroadcastMessages.KEY_ENTER,KickStart),Application.unlock(KickStart),bindingMap.decks.select("logindeck"),setTimeout(function(){Application.isLocalHost&&((Application.isDeveloperMode||Client.isPerformanceTest)&&(DataManager.getDataBinding("username").setValue(l),DataManager.getDataBinding("password").setValue(m)),Client.isPerformanceTest&&KickStart.login()),setTimeout(function(){DataManager.getDataBinding("username").focus()},250)},0)}function f(){setTimeout(function(){bindingMap.cover.hide(),a(!1),Application.unlock(KickStart)},PageBinding.TIMEOUT)}function g(){setTimeout(function(){null!=bindingMap.decks&&bindingMap.decks.select("loadingdeck"),setTimeout(function(){Application.login()},0)},0)}function h(){setTimeout(function(){Application.unlock(KickStart),null!=bindingMap.decks&&(bindingMap.decks.select("changepassworddeck"),bindingMap.cover.attachClassName("widesplash"),setTimeout(function(){var a=document.getElementById("passwordexpired");a.textContent=a.textContent.replace("{0}",Installation.passwordExpirationTimeInDays),DataManager.getDataBinding("usernameold").setValue(DataManager.getDataBinding("username").getResult()),DataManager.getDataBinding("passwordold").focus()},0))},25)}function i(){var a=DataManager.getDataBinding("username"),b=DataManager.getDataBinding("password");a.blur(),b.blur(),a.setValue(""),b.setValue(""),a.clean(),b.clean(),a.focus(),document.getElementById("loginerror").style.display="block";var c={handleAction:function(a){document.getElementById("loginerror").style.display="none",a.target.removeActionListener(Binding.ACTION_DIRTY,c)}};bindingMap.loginfields.addActionListener(Binding.ACTION_DIRTY,c)}var j=!1,k=Client.qualifies(),l="admin",m="123456";return k?(this.fireOnLoad=function(){Client.isPad&&Client.isOS7&&window.innerHeight!=document.documentElement.clientHeight&&(document.documentElement.style.height=window.innerHeight+"px"),Application.lock(this),a(!0),EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_SHUTDOWN,this),SetupService=WebServiceProxy.createProxy(Constants.URL_WSDL_SETUPSERVICE),ReadyService=WebServiceProxy.createProxy(Constants.URL_WSDL_READYSERVICE),LoginService=WebServiceProxy.createProxy(Constants.URL_WSDL_LOGINSERVICE),InstallationService=WebServiceProxy.createProxy(Constants.URL_WSDL_INSTALLSERVICE),StringService=WebServiceProxy.createProxy(Constants.URL_WSDL_STRINGSERVICE),EventBroadcaster.broadcast(BroadcastMessages.APPLICATION_KICKSTART),setTimeout(function(){Persistance.initialize()},0)},this.justLogged=!1,this.handleBroadcast=function(a){switch(a){case BroadcastMessages.PERSISTANCE_INITIALIZED:b(a);break;case BroadcastMessages.APPLICATION_STARTUP:break;case BroadcastMessages.KEY_ENTER:if(null!=bindingMap.decks){var c=bindingMap.decks.getSelectedDeckBinding();if(null!=c)switch(c.getID()){case"logindeck":this.login();break;case"changepassworddeck":this.changePassword()}}break;case BroadcastMessages.APPLICATION_LOGIN:var d=window.bindingMap.appwindow;Client.isPad&&(d.bindingElement.style.borderLeft="1px solid #333"),d.setURL("app.aspx");break;case BroadcastMessages.APPLICATION_OPERATIONAL:f(),setTimeout(function(){StageBinding.bindingInstance.handleHash(window)},0);break;case BroadcastMessages.APPLICATION_SHUTDOWN:null!=bindingMap.decks&&bindingMap.decks.select("shutdowndeck"),bindingMap.cover.show()}},this.changePassword=function(){if(bindingMap.toppage.validateAllDataBindings()){var a=DataManager.getDataBinding("username").getResult(),b=DataManager.getDataBinding("passwordold").getResult(),c=DataManager.getDataBinding("passwordnew").getResult(),d=DataManager.getDataBinding("passwordnew2").getResult();if(c==d){var e=WebServiceProxy.isLoggingEnabled;WebServiceProxy.isLoggingEnabled=!1,WebServiceProxy.isFaultHandler=!1;var f=LoginService.ChangePassword(a,b,c);f instanceof SOAPFault?alert(f.getFaultString()):0==f.length?setTimeout(function(){top.window.location.reload(!0)},0):this.showPasswordErrors(f),WebServiceProxy.isFaultHandler=!0,e&&(WebServiceProxy.isLoggingEnabled=!0)}else this.showPasswordErrors([Resolver.resolve("${string:Composite.C1Console.Users:ChangePasswordForm.ConfirmationPasswordMimatch}")])}},this.showPasswordErrors=function(a){a=new List(a);var b=document.getElementById("passworderror");b.innerHTML="",a.each(function(a){var c=document.createElement("div");c.textContent=a,c.className="text-error text-sm",b.appendChild(c)}),b.style.display="block";var c={handleAction:function(a){document.getElementById("passworderror").style.display="none",a.target.removeActionListener(Binding.ACTION_DIRTY,c)}};bindingMap.passwordfields.addActionListener(Binding.ACTION_DIRTY,c),DataManager.getDataBinding("passwordold").clean(),DataManager.getDataBinding("passwordnew").clean(),DataManager.getDataBinding("passwordnew2").clean()},this.login=function(){Application.lock(KickStart),setTimeout(function(){bindingMap.toppage.validateAllDataBindings()?KickStart.doLogin(DataManager.getDataBinding("username").getResult(),DataManager.getDataBinding("password").getResult()):Application.unlock(KickStart)},25)},this.doLogin=function(a,b){var c=WebServiceProxy.isLoggingEnabled;WebServiceProxy.isLoggingEnabled=!1,WebServiceProxy.isFaultHandler=!1;var d=!1,e=!1,f=LoginService.ValidateAndLogin(a,b);f instanceof SOAPFault?alert(f.getFaultString()):("lockedAfterMaxAttempts"==f&&alert("The account was locked after maximum login attempts. Please contact administrator."),"lockedByAnAdministrator"==f&&alert("The account was locked by an administrator."),"passwordUpdateRequired"==f&&(e=!0),"success"==f&&(d=!0)),e?h():d?(EventBroadcaster.unsubscribe(BroadcastMessages.KEY_ENTER,KickStart),this.justLogged=!0,g()):(Application.unlock(KickStart),null!=bindingMap.decks&&i()),WebServiceProxy.isFaultHandler=!0,c&&(WebServiceProxy.isLoggingEnabled=!0)},WindowManager.fireOnLoad(this),void(k||(UpdateManager.isEnabled=!1))):void(document.location="unsupported.aspx")};"undefined"!=typeof KickStart&&"undefined"!=typeof EventBroadcaster&&EventBroadcaster.subscribe&&/Chrome/.test(navigator.userAgent)&&(KickStart.subscribeToRemoveObsoleteDecks=function(){this.isSubscribedToRemoveObsoleteDecks||(this.isSubscribedToRemoveObsoleteDecks=!0,EventBroadcaster.subscribe(BroadcastMessages.APPLICATION_LOGIN,{handleBroadcast:function(){try{if("undefined"!=typeof top&&top.bindingMap&&"undefined"!=typeof DocumentManager&&DocumentManager.detachBindings)for(var a=["logindeck","changepassworddeck"],b=0;b<a.length;b++)obsoletedDeckName=a[b],top.bindingMap[obsoletedDeckName]&&(obsoletedDeck=top.bindingMap[obsoletedDeckName],obsoletedDeck&&obsoletedDeck.bindingElement&&(DocumentManager.detachBindings(obsoletedDeck.bindingElement,!0),obsoletedDeck.bindingElement.innerHTML=""))}catch(a){}}}))},KickStart.subscribeToRemoveObsoleteDecks()),SelectorButtonBinding.prototype=new SelectorBinding,SelectorButtonBinding.prototype.constructor=SelectorButtonBinding,SelectorButtonBinding.superclass=SelectorBinding.prototype,SelectorButtonBinding.prototype.toString=function(){return"[SelectorButtonBinding]"},SelectorButtonBinding.prototype.onBindingAttach=function(){SelectorButtonBinding.superclass.onBindingAttach.call(this),this.isSearchSelectionEnabled=!1},SelectorButtonBinding.prototype.handleBroadcast=function(a,b){SelectorButtonBinding.superclass.handleBroadcast.call(this,a,b)},SelectorButtonBinding.prototype.handleAction=function(a){a.type===ButtonBinding.ACTION_COMMAND&&this.isSingle?(this._selectionValue=this.singleValue,this.onValueChange()):SelectorButtonBinding.superclass.handleAction.call(this,a)},SelectorButtonBinding.prototype.dirty=function(){},SelectorButtonBinding.prototype.populateFromList=function(a){var b=null;a.each(function(a){if(!a.isSelected){if(null!=b)return b=null,!1;b=a}return!0},this),null!=b?(this.isSingle=!0,this._buttonBinding.setLabel(b.label),this.singleValue=b.value,this._buttonBinding.setPopup(),this.setProperty("single",!0)):(this.isSingle=!1,this._buttonBinding.setPopup(this._popupBinding),this.deleteProperty("single"),SelectorButtonBinding.superclass.populateFromList.call(this,a))},SelectorButtonBinding.prototype.clear=function(a){SelectorButtonBinding.superclass.clear.call(this,a),this.isSingle=!1},SlideInViewBinding.prototype=new ViewBinding,SlideInViewBinding.prototype.constructor=SlideInViewBinding,SlideInViewBinding.superclass=ViewBinding.prototype,SlideInViewBinding.TRANSITION_CLASSNAME="transition",SlideInViewBinding.VIEWSET_ID="slideinviews",SlideInViewBinding.VIEWSET_CLASSNAME="slidein",SlideInViewBinding.prototype.toString=function(){return"[SlideInViewBinding]"},SlideInViewBinding.prototype.onBindingAttach=function(){SlideInViewBinding.superclass.onBindingAttach.call(this),this.subscribe(this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST),this.addActionListener(this.responseAction,this)},SlideInViewBinding.prototype.slideToBinding=function(a){this._snapBinding=a,this._isViewBindingInitialized||this.initialize()},SlideInViewBinding.prototype.show=function(){if(!this.isVisible){var a=this._snapBinding.boxObject.getDimension();this.bindingElement.style.left=String(a.w)+"px",this.attachClassName(SlideInViewBinding.TRANSITION_CLASSNAME)}SlideInViewBinding.superclass.show.call(this)},SlideInViewBinding.prototype.handleAction=function(a){SlideInViewBinding.superclass.handleAction.call(this,a);var b=a.target;switch(a.type){case this.responseAction:if(this.getContentWindow()===b.bindingWindow){var c=this;setTimeout(function(){c.dispose()},0)}a.consume()}},SlideInViewBinding.prototype.handleBroadcast=function(a,b){switch(SlideInViewBinding.superclass.handleBroadcast.call(this,a,b),a){case this.bindingWindow.WindowManager.WINDOW_RESIZED_BROADCAST:1==this.isVisible&&this.updatePositionDimension()}},SlideInViewBinding.newInstance=function(a){var b=DOMUtil.createElementNS(Constants.NS_UI,"ui:view",a),c=UserInterface.registerBinding(b,SlideInViewBinding);c.windowBinding=c.add(WindowBinding.newInstance(a));var d=c.bindingWindow.bindingMap[SlideInViewBinding.VIEWSET_ID];if(null==d){var e=UserInterface.getBinding(c.bindingDocument.body),f=DOMUtil.createElementNS(Constants.NS_UI,"ui:viewset",c.bindingDocument);f.setAttribute("id",SlideInViewBinding.VIEWSET_ID),d=UserInterface.registerBinding(f,ViewSetBinding),d.bindingElement.style.zIndex=5,d.attachClassName(SlideInViewBinding.VIEWSET_CLASSNAME),e.bindingElement.insertBefore(d.bindingElement,e.bindingElement.firstChild),d.attach()}return d.add(c),c},SlideInButtonBinding.prototype=new ToolBarButtonBinding,SlideInButtonBinding.prototype.constructor=SlideInButtonBinding,SlideInButtonBinding.superclass=ToolBarButtonBinding.prototype,SlideInButtonBinding.prototype.toString=function(){return"[SlideInButtonBinding]"},SlideInButtonBinding.prototype.onBindingAttach=function(){SlideInButtonBinding.superclass.onBindingAttach.call(this)},SlideInButtonBinding.prototype.handleBroadcast=function(a,b){SlideInButtonBinding.superclass.handleBroadcast.call(this,a,b)},SlideInButtonBinding.prototype.oncommand=function(){var a=this.getProperty("handle"),b=this.getProperty("url"),c=null;if(null!=a?c=ViewDefinitions[a]:null!=b&&(c=new HostedViewDefinition({url:b})),null!=c){var d=UserInterface.getBinding(this.bindingDocument.body);this._viewBinding=SlideInViewBinding.newInstance(this.bindingDocument),this._viewBinding.setDefinition(c),this._viewBinding.attach(),this._viewBinding.snapToBinding(d)}},SlideInButtonBinding.prototype.setURL=function(a){this.setProperty("url",a)};
//# sourceMappingURL=top.js.map